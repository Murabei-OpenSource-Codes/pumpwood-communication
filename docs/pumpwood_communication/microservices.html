<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>pumpwood_communication.microservices API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../pumpwood_communication.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;pumpwood_communication</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#break_in_chunks">break_in_chunks</a>
            </li>
            <li>
                    <a class="class" href="#PumpWoodMicroService">PumpWoodMicroService</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PumpWoodMicroService.list_registered_routes">list_registered_routes</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.is_microservice_registered">is_microservice_registered</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.list_registered_endpoints">list_registered_endpoints</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.dummy_call">dummy_call</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.dummy_raise">dummy_raise</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.get_pks_from_unique_field">get_pks_from_unique_field</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.list">list</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.list_by_chunks">list_by_chunks</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.list_without_pag">list_without_pag</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.list_dimensions">list_dimensions</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.list_dimension_values">list_dimension_values</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.list_actions">list_actions</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.execute_action">execute_action</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.search_options">search_options</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.fill_options">fill_options</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.list_options">list_options</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.retrieve_options">retrieve_options</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.fill_validation">fill_validation</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.pivot">pivot</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.flat_list_by_chunks">flat_list_by_chunks</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.bulk_save">bulk_save</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.flatten_parallel">flatten_parallel</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_request_get">parallel_request_get</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.paralell_request_post">paralell_request_post</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.paralell_request_delete">paralell_request_delete</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_retrieve">parallel_retrieve</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_retrieve_file">parallel_retrieve_file</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_list">parallel_list</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_list_without_pag">parallel_list_without_pag</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_list_one">parallel_list_one</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_save">parallel_save</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_delete">parallel_delete</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_delete_many">parallel_delete_many</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_execute_action">parallel_execute_action</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_bulk_save">parallel_bulk_save</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.parallel_pivot">parallel_pivot</a>
                        </li>
                        <li>
                                <a class="function" href="#PumpWoodMicroService.get_queue_matrix">get_queue_matrix</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../pumpwood_communication.html">pumpwood_communication</a><wbr>.microservices    </h1>

                        <div class="docstring"><p>Module microservice.py.</p>

<p>Class and functions to help communication between PumpWood like systems.</p>
</div>

                        <input id="mod-microservices-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-microservices-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;Module microservice.py.</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">Class and functions to help communication between PumpWood like systems.</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">io</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">simplejson</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">json</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">gzip</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">geopandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">geopd</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">copy</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">urljoin</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">shapely</span><span class="w"> </span><span class="kn">import</span> <span class="n">geometry</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Pool</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExcelWriter</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">copy</span><span class="w"> </span><span class="kn">import</span> <span class="n">deepcopy</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pumpwood_communication.exceptions</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a>    <span class="n">exceptions_dict</span><span class="p">,</span> <span class="n">PumpWoodException</span><span class="p">,</span> <span class="n">PumpWoodUnauthorized</span><span class="p">,</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a>    <span class="n">PumpWoodOtherException</span><span class="p">,</span> <span class="n">PumpWoodQueryException</span><span class="p">,</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a>    <span class="n">PumpWoodNotImplementedError</span><span class="p">)</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pumpwood_communication.serializers</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>    <span class="n">pumpJsonDump</span><span class="p">,</span> <span class="n">CompositePkBase64Converter</span><span class="p">)</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pumpwood_communication.misc</span><span class="w"> </span><span class="kn">import</span> <span class="n">unpack_dict_columns</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="c1"># Importing abstract classes for Micro Service</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pumpwood_communication.microservice_abc.simple</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>    <span class="n">ABCSimpleBatchMicroservice</span><span class="p">,</span> <span class="n">ABCPermissionMicroservice</span><span class="p">,</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a>    <span class="n">ABCSimpleRetriveMicroservice</span><span class="p">,</span> <span class="n">ABCSimpleDeleteMicroservice</span><span class="p">,</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a>    <span class="n">ABCSimpleSaveMicroservice</span><span class="p">)</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="k">def</span><span class="w"> </span><span class="nf">break_in_chunks</span><span class="p">(</span><span class="n">df_to_break</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>                    <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Break a dataframe in chunks of chunksize.</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a><span class="sd">    Args:</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="sd">        df_to_break: Dataframe to be break in chunks of `chunksize` size.</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">        chunksize: Length of each chuck of the breaks of `df_to_break`.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="sd">    Returns:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="sd">        Return a list dataframes with lenght chunksize of data from</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a><span class="sd">        `df_to_break`.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a>    <span class="n">to_return</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>    <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_to_break</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_to_break</span><span class="p">))</span> <span class="o">//</span> <span class="n">chunksize</span><span class="p">):</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a>        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a>    <span class="k">return</span> <span class="n">to_return</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PumpWoodMicroService</span><span class="p">(</span><span class="n">ABCPermissionMicroservice</span><span class="p">,</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>                           <span class="n">ABCSimpleBatchMicroservice</span><span class="p">,</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a>                           <span class="n">ABCSimpleRetriveMicroservice</span><span class="p">,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a>                           <span class="n">ABCSimpleDeleteMicroservice</span><span class="p">,</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>                           <span class="n">ABCSimpleSaveMicroservice</span><span class="p">):</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to define an inter-pumpwood MicroService.</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a><span class="sd">    Create an object ot help communication with Pumpwood based backends. It</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">    manage login and token refresh if necessary.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a><span class="sd">    It also implements parallel functions that split requests in parallel</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">    process to reduce processing time.</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_registered_routes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List routes that have been registed at Kong.&quot;&quot;&quot;</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>        <span class="n">list_url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/routes/&#39;</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a>        <span class="n">routes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">routes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a>        <span class="k">return</span> <span class="n">routes</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_microservice_registered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">microservice</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a>                                   <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a microservice (kong service) is registered at Kong.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="sd">        Args:</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a><span class="sd">            microservice (str):</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">                Service associated with microservice registered on</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="sd">                Pumpwood Kong.</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">        Returns:</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a><span class="sd">            Return true if microservice is registered.</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a>        <span class="n">routes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_registered_routes</span><span class="p">(</span><span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a>        <span class="k">return</span> <span class="n">microservice</span> <span class="ow">in</span> <span class="n">routes</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_registered_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a>                                  <span class="n">availability</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;front_avaiable&#39;</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a>                                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List all routes and services that have been registed at Kong.</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="sd">        It is possible to restrict the return to end-points that should be</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="sd">        avaiable at the frontend. Using this feature it is possibel to &#39;hide&#39;</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="sd">        services from GUI keeping them avaiable for programatic calls.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a><span class="sd">        Args:</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a><span class="sd">            auth_header:</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a><span class="sd">            availability:</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a><span class="sd">                Set the availability that is associated with the service.</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a><span class="sd">                So far it is implemented &#39;front_avaiable&#39; and &#39;all&#39;.</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="sd">        Returns:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="sd">            Return a list of serialized services objects containing the</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">            routes associated with at `route_set`.</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">            Service and routes have `notes__verbose` and `description__verbose`</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="sd">            that are  the repective strings associated with note and</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">            description but translated using Pumpwood&#39;s I8s,</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="sd">        Raises:</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="sd">            PumpWoodWrongParameters:</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">                Raise PumpWoodWrongParameters if availability passed as</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="sd">                paraemter is not implemented.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a>        <span class="n">list_url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/endpoints/&#39;</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a>        <span class="n">routes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;availability&#39;</span><span class="p">:</span> <span class="n">availability</span><span class="p">},</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a>        <span class="k">return</span> <span class="n">routes</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dummy_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a>                   <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dummy call to ensure headers and payload reaching app.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a><span class="sd">        The request just bounce on the server and return the headers and</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">        payload that reached the application. It is usefull for probing</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="sd">        proxy servers, API gateways and other security and load balance</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">        tools.</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a><span class="sd">        Args:</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="sd">            payload:</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="sd">                Payload to be returned by the dummy call end-point.</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="sd">            auth_header:</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="sd">        Returns:</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">            Return a dictonary with:</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="sd">            - **full_path**: Full path of the request.</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">            - **method**: Method used at the call</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">            - **headers**: Headers at the request.</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a><span class="sd">            - **data**: Post payload sent at the request.</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>        <span class="n">list_url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/dummy-call/&#39;</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>        <span class="k">if</span> <span class="n">payload</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>                <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>                <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>                <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dummy_raise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">exception_deep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>                    <span class="n">payload</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Raise an Pumpwood error with the payload.</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a><span class="sd">        This and point raises an Arbitrary PumpWoodException error, it can be</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a><span class="sd">        used for debuging error treatment.</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a><span class="sd">        Args:</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a><span class="sd">            exception_class:</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a><span class="sd">                Class of the exception to be raised.</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a><span class="sd">            exception_deep:</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a><span class="sd">                Deep of the exception in microservice calls. This arg will</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a><span class="sd">                make error recusive, calling the end-point it self for</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a><span class="sd">                `exception_deep` time before raising the error.</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a><span class="sd">            payload:</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a><span class="sd">                Payload that will be returned with error.</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a><span class="sd">            auth_header:</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a><span class="sd">        Returns:</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a><span class="sd">            Should not return any results, all possible call should result</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a><span class="sd">            in raising the correspondent error.</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a><span class="sd">        Raises:</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a><span class="sd">            Should raise the correspondent error passed on exception_class</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a><span class="sd">            arg, with payload.</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/dummy-raise/&#39;</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>        <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;exception_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exception_class</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a>        <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;exception_deep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exception_deep</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_pks_from_unique_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a>                                  <span class="n">values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get pk using unique fields values.</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a><span class="sd">        Use unique field values to retrieve pk of the objects. This end-point</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a><span class="sd">        is usefull for retrieving pks of the objects associated with unique</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="sd">        fields such as `description` (unique on most model of pumpwood).</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">        ```python</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">        # Using description to fetch pks from objects</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a><span class="sd">        data: pd.DataFrame = [data with unique description but without pk]</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">        data[&#39;attribute_id&#39;] = microservice.get_pks_from_unique_field(</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">            model_class=&quot;DescriptionAttribute&quot;,</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a><span class="sd">            field=&quot;description&quot;, values=data[&#39;attribute&#39;])[&#39;pk&#39;]</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="sd">        # Using a dimension key to fetch pk of the objects, dimension</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a><span class="sd">        # key must be unique</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a><span class="sd">        data[&#39;georea_id&#39;] = microservice.get_pks_from_unique_field(</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a><span class="sd">            model_class=&quot;DescriptionGeoarea&quot;, field=&quot;dimension-&gt;city&quot;,</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a><span class="sd">            values=data[&#39;city&#39;])[&#39;pk&#39;]</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a><span class="sd">        ```</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a><span class="sd">        Args:</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a><span class="sd">            model_class:</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="sd">                Model class of the objects.</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a><span class="sd">            field:</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a><span class="sd">                Unique field to fetch pk. It is possible to use dimension keys</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="sd">                as unique field, for that use `dimension-&gt;[key]` notation.</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a><span class="sd">            values:</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">                List of the unique fields used to fetch primary keys.</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a><span class="sd">        Return:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a><span class="sd">            Return a dataframe in same order as values with columns:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a><span class="sd">            - **pk**: Correspondent primary key of the unique value.</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a><span class="sd">            - **[field]**: Column with same name of field argument,</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a><span class="sd">                correspondent to pk.</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a><span class="sd">        Raises:</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a><span class="sd">            PumpWoodQueryException:</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a><span class="sd">                Raises if field is not found on the model and it is note</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a><span class="sd">                associated with a dimension tag.</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a><span class="sd">            PumpWoodQueryException:</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a><span class="sd">                Raises if `field` does not have a unique restriction on</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a><span class="sd">                database. Dimension keys does not check for uniqueness on</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a><span class="sd">                database, be carefull not to duplicate the lines.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>        <span class="n">is_dimension_tag</span> <span class="o">=</span> <span class="s1">&#39;dimensions-&gt;&#39;</span> <span class="ow">in</span> <span class="n">field</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_dimension_tag</span><span class="p">:</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>            <span class="n">fill_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_options</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>            <span class="n">field_details</span> <span class="o">=</span> <span class="n">fill_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>            <span class="k">if</span> <span class="n">field_details</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>                    <span class="s2">&quot;Field is not a dimension tag and not found on model &quot;</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>                    <span class="s2">&quot;fields. Field [</span><span class="si">{field}</span><span class="s2">]&quot;</span><span class="p">)</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>                <span class="k">raise</span> <span class="n">PumpWoodQueryException</span><span class="p">(</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a>                    <span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">field</span><span class="p">})</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>            <span class="n">is_unique_field</span> <span class="o">=</span> <span class="n">field_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unique&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_unique_field</span><span class="p">:</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Field [</span><span class="si">{}</span><span class="s2">] to get pk from is not unique&quot;</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>                <span class="k">raise</span> <span class="n">PumpWoodQueryException</span><span class="p">(</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>                    <span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">field</span><span class="p">})</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>        <span class="n">filter_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span> <span class="o">+</span> <span class="s2">&quot;__in&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">values</span><span class="p">))}</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>        <span class="n">pk_map</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_dimension_tag</span><span class="p">:</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>            <span class="n">list_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_without_pag</span><span class="p">(</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">filter_dict</span><span class="o">=</span><span class="n">filter_dict</span><span class="p">,</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a>                <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="n">field</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="n">field</span><span class="p">])</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a>            <span class="n">pk_map</span> <span class="o">=</span> <span class="n">list_results</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">field</span><span class="p">)[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a>        <span class="c1"># If is dimension tag, fetch dimension and unpack it</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a>            <span class="n">dimension_tag</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>            <span class="n">list_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_without_pag</span><span class="p">(</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">filter_dict</span><span class="o">=</span><span class="n">filter_dict</span><span class="p">,</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a>                <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="s2">&quot;dimensions&quot;</span><span class="p">]))</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a>            <span class="n">pk_map</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_results</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a>                <span class="n">pk_map</span> <span class="o">=</span> <span class="n">list_results</span>\
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a>                    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">unpack_dict_columns</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dimensions&quot;</span><span class="p">])</span>\
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a>                    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">dimension_tag</span><span class="p">)[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a>        <span class="n">values_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>            <span class="s2">&quot;pk&quot;</span><span class="p">:</span> <span class="n">values_series</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">pk_map</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a>            <span class="n">field</span><span class="p">:</span> <span class="n">values_series</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a>        <span class="p">})</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_list_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/list/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),)</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a>             <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">order_by</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>             <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a>             <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a>             <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a>             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List objects with pagination.</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">        List end-point (resumed data) of PumpWood like systems,</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">        results will be paginated. To get next pag, send all recived pk at</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">        exclude dict (ex.: `exclude_dict={pk__in: [1,2,...,30]}`).</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">        It is possible to return foreign keys objects associated with</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a><span class="sd">        `model_class`. Use this with carefull since increase the backend</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a><span class="sd">        infrastructure consumption, each object is a retrieve call per</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a><span class="sd">        foreign key (otimization in progress).</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a><span class="sd">        It is possible to use diferent operators using `__` after the name</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a><span class="sd">        of the field, some of the operators avaiable:</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a><span class="sd">        ### General operators</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a><span class="sd">        - **__eq:** Check if the value is the same, same results if no</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a><span class="sd">            operator is passed.</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a><span class="sd">        - **__gt:** Check if value is greter then argument.</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a><span class="sd">        - **__lt:** Check if value is less then argument.</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a><span class="sd">        - **__gte:** Check if value is greter or equal then argument.</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="sd">        - **__lte:** Check if value is less or equal then argument.</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="sd">        - **__in:** Check if value is at a list, the argument of this operator</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a><span class="sd">            must be a list.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a><span class="sd">        ### Text field operators</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a><span class="sd">        - **__contains:** Check if value contains a string. It is case and</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a><span class="sd">            accent sensitive.</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a><span class="sd">        - **__icontains:** Check if a values contains a string, It is case</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a><span class="sd">            insensitive and accent sensitive.</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a><span class="sd">        - **__unaccent_icontains:** Check if a values contains a string, It is</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a><span class="sd">            case insensitive and accent insensitive (consider a, à, á, ã, ...</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a><span class="sd">            the same).</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a><span class="sd">        - **__exact:** Same as __eq or not setting operator.</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a><span class="sd">        - **__iexact:** Same as __eq, but case insensitive and</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a><span class="sd">            accent sensitive.</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a><span class="sd">        - **__unaccent_iexact:** Same as __eq, but case insensitive and</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a><span class="sd">            accent insensitive.</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="sd">        - **__startswith:** Check if the value stats with a sub-string.</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a><span class="sd">            Case sensitive and accent sensitive.</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="sd">        - **__istartswith:** Check if the value stats with a sub-string.</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a><span class="sd">            Case insensitive and accent sensitive.</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">        - **__unaccent_istartswith:** Check if the value stats with a</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a><span class="sd">            sub-string. Case insensitive and accent insensitive.</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">        - **__endswith:** Check if the value ends with a sub-string. Case</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="sd">            sensitive and accent sensitive.</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">        - **__iendswith:** Check if the value ends with a sub-string. Case</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a><span class="sd">            insensitive and accent sensitive.</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">        - **__unaccent_iendswith:** Check if the value ends with a sub-string.</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">            Case insensitive and accent insensitive.</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a><span class="sd">        ### Null operators</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a><span class="sd">        - **__isnull:** Check if field is null, it uses as argument a `boolean`</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">            value false will return all non NULL values and true will return</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a><span class="sd">            NULL values.</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="sd">        ### Date and datetime operators:</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a><span class="sd">        - **__range:** Receive as argument a list of two elements and return</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">            objects that field dates are between those values.</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">        - **__year:** Return object that date field value year is equal to</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a><span class="sd">            argument.</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a><span class="sd">        - **__month:** Return object that date field value month is equal to</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a><span class="sd">            argument.</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a><span class="sd">        - **__day:** Return object that date field value day is equal to</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="sd">            argument.</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a><span class="sd">        ### Dictionary fields operators:</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a><span class="sd">        - **__json_contained_by:**</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a><span class="sd">            Uses the function [contained_by](https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.contained_by)</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="sd">            from SQLAlchemy to test if keys are a proper subset of the keys of</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a><span class="sd">            the argument jsonb expression (extracted from SQLAlchemy). The</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a><span class="sd">            argument is a list.</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="sd">        - **__json_has_any:**</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="sd">            Uses the function [has_any](https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.has_any)</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">            from SQLAlchemy to test for presence of a key. Note that the key</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a><span class="sd">            may be a SQLA expression. (extracted from SQLAlchemy). The</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a><span class="sd">            argument is a list.</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a><span class="sd">        - **__json_has_key:**</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a><span class="sd">            Uses the function [has_key](https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.has_key)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a><span class="sd">            from SQLAlchemy to Test for presence of a key. Note that the key</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a><span class="sd">            may be a SQLA expression. The argument is a str.</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a><span class="sd">        ### Text similarity operators</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a><span class="sd">        To use similariry querys on Postgres it is necessary to `pg_trgm` be</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a><span class="sd">        instaled on server. Check [oficial documentation]</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a><span class="sd">        (https://www.postgresql.org/docs/current/pgtrgm.html).</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a><span class="sd">        - **__similarity:** Check if two strings are similar uses the `%`</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a><span class="sd">            operador.</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a><span class="sd">        - **__word_similar_left:** Check if two strings are similar uses the</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a><span class="sd">            `&lt;%` operador.</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a><span class="sd">        - **__word_similar_right:** Check if two strings are similar uses the</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a><span class="sd">            `%&gt;` operador.</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a><span class="sd">        - **__strict_word__similar_left:** Check if two strings are similar</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a><span class="sd">            uses the `&lt;&lt;%` operador.</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a><span class="sd">        - **__strict_word__similar_right:** Check if two strings are similar</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a><span class="sd">            uses the `%&gt;&gt;` operador.</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a><span class="sd">        Some usage examples:</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a><span class="sd">        ```python</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a><span class="sd">        # Return the first 3 results ordered decreasing acording to `time` and</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a><span class="sd">        # them ordered by `modeling_unit_id`. Results must have time greater</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a><span class="sd">        # or equal to 2017-01-01 and less or equal to 2017-06-01. It also</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a><span class="sd">        # must have attribute_id equal to 6 and not contains modeling_unit_id</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a><span class="sd">        # 3 or 4.</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a><span class="sd">        microservice.list(</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a><span class="sd">            model_class=&quot;DatabaseVariable&quot;,</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a><span class="sd">            filter_dict={</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a><span class="sd">                &quot;time__gte&quot;: &quot;2017-01-01 00:00:00&quot;,</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a><span class="sd">                &quot;time__lte&quot;: &quot;2017-06-01 00:00:00&quot;,</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a><span class="sd">                &quot;attribute_id&quot;: 6},</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a><span class="sd">            exclude_dict={</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a><span class="sd">                &quot;modeling_unit_id__in&quot;: [3, 4]},</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a><span class="sd">            order_by=[&quot;-time&quot;, &quot;modeling_unit_id&quot;],</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="sd">            limit=3,</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a><span class="sd">            fields=[&quot;pk&quot;, &quot;model_class&quot;, &quot;time&quot;, &quot;modeling_unit_id&quot;, &quot;value&quot;])</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a><span class="sd">        # Return all elements that dimensions field has a key type with</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a><span class="sd">        # value contains `selling` insensitive to case and accent.</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="sd">        microservice.list(</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a><span class="sd">            model_class=&quot;DatabaseAttribute&quot;,</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a><span class="sd">            filter_dict={</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a><span class="sd">                &quot;dimensions-&gt;type__unaccent_icontains&quot;: &quot;selling&quot;})</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a><span class="sd">        ```</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="sd">        Args:</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="sd">            model_class:</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a><span class="sd">            filter_dict:</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="sd">            exclude_dict:</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">            order_by: Order results acording to list of strings</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a><span class="sd">                correspondent to fields. It is possible to use &#39;-&#39; at the</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">                begginng of the field name for reverse ordering. Ex.:</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a><span class="sd">                [&#39;description&#39;] for accendent ordering and [&#39;-description&#39;]</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a><span class="sd">                for descendent ordering.</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a><span class="sd">            auth_header:</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a><span class="sd">            fields (list):</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a><span class="sd">            default_fields (bool):</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a><span class="sd">            limit (int):</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a><span class="sd">                Set the limit of elements of the returned query. By default,</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a><span class="sd">                backend usually return 50 elements.</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a><span class="sd">            foreign_key_fields (bool):</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a><span class="sd">            **kwargs:</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a><span class="sd">                Other parameters for compatibility.</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a><span class="sd">        Returns:</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a><span class="sd">          Containing objects serialized by list Serializer.</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a><span class="sd">        Raises:</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a><span class="sd">          No especific raises.</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a><span class="sd">        &quot;&quot;&quot;</span> <span class="c1"># NOQA</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>            <span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>            <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="n">order_by</span><span class="p">,</span> <span class="s1">&#39;default_fields&#39;</span><span class="p">:</span> <span class="n">default_fields</span><span class="p">,</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>            <span class="s1">&#39;limit&#39;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> <span class="s1">&#39;foreign_key_fields&#39;</span><span class="p">:</span> <span class="n">foreign_key_fields</span><span class="p">}</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>            <span class="n">post_data</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_by_chunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>                       <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>                       <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a>                       <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50000</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List object fetching them by chucks using pk to paginate.</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="sd">        List data by chunck to load by datasets without breaking the backend</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a><span class="sd">        or receive server timeout. It load chunks orderring the results using</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a><span class="sd">        id of the tables, it can be changed but it should be unique otherwise</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a><span class="sd">        unexpected results may occur.</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a><span class="sd">        Args:</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a><span class="sd">            model_class:</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a><span class="sd">            filter_dict:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a><span class="sd">            exclude_dict:</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a><span class="sd">            auth_header:</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a><span class="sd">            fields:</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a><span class="sd">            default_fields:</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a><span class="sd">            chunk_size:</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a><span class="sd">                Number of objects to be fetched each query.</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a><span class="sd">            **kwargs:</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a><span class="sd">                Other parameters for compatibility.</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a><span class="sd">        Returns:</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a><span class="sd">          Containing objects serialized by list Serializer.</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a><span class="sd">        Raises:</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a><span class="sd">          No especific raises.</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a>        <span class="n">copy_filter_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">filter_dict</span><span class="p">)</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>        <span class="n">list_all_results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>        <span class="n">max_order_col</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- fetching chunk [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_order_col</span><span class="p">))</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>            <span class="n">copy_filter_dict</span><span class="p">[</span><span class="s2">&quot;pk__gt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_order_col</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>            <span class="n">temp_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">filter_dict</span><span class="o">=</span><span class="n">copy_filter_dict</span><span class="p">,</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>                <span class="n">exclude_dict</span><span class="o">=</span><span class="n">exclude_dict</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">],</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>                <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>                <span class="n">default_fields</span><span class="o">=</span><span class="n">default_fields</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">)</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>            <span class="c1"># Break if results is empty</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>                <span class="k">break</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a>            <span class="n">max_order_col</span> <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a>            <span class="n">list_all_results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">temp_results</span><span class="p">)</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>        <span class="k">return</span> <span class="n">list_all_results</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_list_without_pag_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/list-without-pag/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),)</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_without_pag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a>                         <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">order_by</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a>                         <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a>                         <span class="n">convert_geometry</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a>                         <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a>                         <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List object without pagination.</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a><span class="sd">        Function to post at list end-point (resumed data) of PumpWood like</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a><span class="sd">        systems, results won&#39;t be paginated.</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a><span class="sd">        **Be carefull with large returns.**</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a><span class="sd">        Args:</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a><span class="sd">            model_class (str):</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a><span class="sd">            filter_dict (dict):</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a><span class="sd">            exclude_dict (dict):</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a><span class="sd">            order_by (bool):</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a><span class="sd">                Order results acording to list of strings</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a><span class="sd">                correspondent to fields. It is possible to use &#39;-&#39; at the</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="sd">                begginng of the field name for reverse ordering. Ex.:</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="sd">                [&#39;description&#39;] for accendent ordering and [&#39;-description&#39;]</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a><span class="sd">                for descendent ordering.</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">            fields (List[str]):</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">            default_fields (bool):</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a><span class="sd">            limit (int):</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a><span class="sd">                Set the limit of elements of the returned query. By default,</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a><span class="sd">                backend usually return 50 elements.</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a><span class="sd">            foreign_key_fields (bool):</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a><span class="sd">            convert_geometry (bool):</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="sd">                If geometry columns should be convert to shapely geometry.</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a><span class="sd">                Fields with key &#39;geometry&#39; will be considered geometry.</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a><span class="sd">            return_type (str):</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a><span class="sd">                Set return type to list of dictinary `list` or to a pandas</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a><span class="sd">                dataframe `dataframe`.</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a><span class="sd">            **kwargs:</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a><span class="sd">                Other unused arguments for compatibility.</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a><span class="sd">        Returns:</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a><span class="sd">          Containing objects serialized by list Serializer.</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a><span class="sd">        Raises:</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a><span class="sd">          No especific raises.</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a>            <span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a>            <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="n">order_by</span><span class="p">,</span> <span class="s1">&#39;default_fields&#39;</span><span class="p">:</span> <span class="n">default_fields</span><span class="p">,</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>            <span class="s1">&#39;foreign_key_fields&#39;</span><span class="p">:</span> <span class="n">foreign_key_fields</span><span class="p">}</span>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a>        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a>            <span class="n">post_data</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a>        <span class="c1">##################################################</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a>        <span class="c1"># Converting geometry to Shapely objects in Python</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a>        <span class="n">geometry_in_results</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a>        <span class="k">if</span> <span class="n">convert_geometry</span><span class="p">:</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a>                <span class="n">geometry_value</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a>                <span class="k">if</span> <span class="n">geometry_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a>                    <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">geometry_value</span><span class="p">)</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a>                    <span class="n">geometry_in_results</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>        <span class="c1">##################################################</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a>        <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a>            <span class="k">return</span> <span class="n">results</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a>        <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s1">&#39;dataframe&#39;</span><span class="p">:</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;descriptiongeoarea&quot;</span><span class="p">)</span> <span class="ow">and</span> \
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a>                    <span class="n">geometry_in_results</span><span class="p">:</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a>                <span class="k">return</span> <span class="n">geopd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="s1">&#39;geometry&#39;</span><span class="p">)</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;return_type must be &#39;list&#39; or &#39;dataframe&#39;&quot;</span><span class="p">)</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_list_dimensions</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/list-dimensions/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),)</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>                        <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>                        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List dimensions avaiable for model_class.</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a><span class="sd">        It list all keys avaiable at dimension retricting the results with</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a><span class="sd">        query parameters `filter_dict` and `exclude_dict`.</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a><span class="sd">        Args:</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a><span class="sd">            model_class:</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a><span class="sd">            filter_dict:</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a><span class="sd">            exclude_dict:</span>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a><span class="sd">            auth_header:</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a><span class="sd">        Returns:</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a><span class="sd">            List of keys avaiable in results from the query dict.</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_dimensions</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">}</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_list_dimension_values</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/list-dimension-values/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="p">)</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_dimension_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a>                              <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a>                              <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">any</span><span class="p">]:</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List values associated with dimensions key.</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">        It list all keys avaiable at dimension retricting the results with</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="sd">        query parameters `filter_dict` and `exclude_dict`.</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a><span class="sd">        Args:</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a><span class="sd">            model_class:</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a><span class="sd">            filter_dict:</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a><span class="sd">            exclude_dict:</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a><span class="sd">            auth_header:</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="sd">            key:</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a><span class="sd">                Key to list the avaiable values using the query filter</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="sd">                and exclude.</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">        Returns:</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a><span class="sd">            List of values associated with dimensions key at the objects that</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">            are returned with `filter_dict` and `exclude_dict`.</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_dimension_values</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a>                     <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>                     <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of all actions avaiable at this model class.</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a><span class="sd">        Args:</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a><span class="sd">          model_class:</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a><span class="sd">              Model class to list possible actions.</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a><span class="sd">          auth_header:</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a><span class="sd">              Auth header to substitute the microservice original</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a><span class="sd">              at the request (user impersonation).</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a><span class="sd">        Returns:</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a><span class="sd">          List of possible actions and its descriptions.</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a><span class="sd">        Raises:</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a><span class="sd">            No particular errors.</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/actions/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_execute_action_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a>                                  <span class="n">pk</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/actions/</span><span class="si">%s</span><span class="s2">/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">action</span><span class="p">)</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>        <span class="k">if</span> <span class="n">pk</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>            <span class="n">url_str</span> <span class="o">=</span> <span class="n">url_str</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>        <span class="k">return</span> <span class="n">url_str</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">execute_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pk</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>                       <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">files</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>                       <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute action associated with a model class.</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a><span class="sd">        If action is static or classfunction no pk is necessary.</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="sd">        Args:</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a><span class="sd">            pk (int):</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a><span class="sd">                PK of the object to run action at. If not set action will be</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="sd">                considered a classmethod and will run over the class.</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a><span class="sd">            model_class:</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a><span class="sd">                Model class to run action the object</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a><span class="sd">            action:</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="sd">                Action that will be performed.</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a><span class="sd">            auth_header:</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="sd">            parameters:</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a><span class="sd">                Dictionary with the function parameters.</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a><span class="sd">            files:</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="sd">                A dictionary of files to be added to as a multi-part</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a><span class="sd">                post request. File must be passed as a file object with read</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a><span class="sd">                bytes.</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a><span class="sd">        Returns:</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a><span class="sd">            Return a dictonary with keys:</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a><span class="sd">            - **result:**: Result of the action that was performed.</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a><span class="sd">            - **action:**: Information of the action that was performed.</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a><span class="sd">            - **parameters:** Parameters that were passed to perform the</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a><span class="sd">                action.</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a><span class="sd">            - **object:** If a pk was passed to execute and action (not</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a><span class="sd">                classmethod or staticmethod), the object with the correspondent</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a><span class="sd">                pk is returned.</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a><span class="sd">        Raises:</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a><span class="sd">                &#39;There is no method {action} in rest actions for {class_name}&#39;.</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a><span class="sd">                This indicates that action requested is not associated with</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">                the model_class.</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="sd">            PumpWoodActionArgsException:</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="sd">                &#39;Function is not static and pk is Null&#39;. This indicate that</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a><span class="sd">                the action solicitated is not static/class method and a pk</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a><span class="sd">                was not passed as argument.</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="sd">            PumpWoodActionArgsException:</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a><span class="sd">                &#39;Function is static and pk is not Null&#39;. This indicate that</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a><span class="sd">                the action solicitated is static/class method and a pk</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a><span class="sd">                was passed as argument.</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a><span class="sd">            PumpWoodObjectDoesNotExist:</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a><span class="sd">                &#39;Requested object {model_class}[{pk}] not found.&#39;. This</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a><span class="sd">                indicate that pk associated with model class was not found</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a><span class="sd">                on database.</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_execute_action_url</span><span class="p">(</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a>            <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">search_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a>                       <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return search options.</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a><span class="sd">        DEPRECTED Use `list_options` function instead.</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a><span class="sd">        Return information of the fields including avaiable options for</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a><span class="sd">        options fields and model associated with the foreign key.</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a><span class="sd">        Args:</span>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a><span class="sd">            model_class:</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a><span class="sd">                Model class to check search parameters</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a><span class="sd">            auth_header:</span>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="sd">        Returns:</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a><span class="sd">            Return a dictonary with field names as keys and information of</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a><span class="sd">            them as values. Information at values:</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">            - **primary_key [bool]:**: Boolean indicating if field is part</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="sd">                of model_class primary key.</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a><span class="sd">            - **column [str]:**: Name of the column.</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="sd">            - **column__verbose [str]:** Name of the column translated using</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a><span class="sd">                Pumpwood I8s.</span>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a><span class="sd">            - **help_text [str]:** Help text associated with column.</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a><span class="sd">            - **help_text__verbose [str]:** Help text associated with column</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a><span class="sd">                translated using Pumpwood I8s.</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a><span class="sd">            - **type [str]:** Python type associated with the column.</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a><span class="sd">            - **nullable [bool]:** If field can be set as null (None).</span>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a><span class="sd">            - **read_only [bool]:** If field is marked as read-only. Passsing</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a><span class="sd">                information for this field will not be used in save end-point.</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a><span class="sd">            - **default [any]:** Default value of the field if not set using</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a><span class="sd">                save end-poin.</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a><span class="sd">            - **unique [bool]:** If the there is a constrain in database</span>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a><span class="sd">                setting this field to be unique.</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">            - **extra_info:** Some extra infomations used to pass associated</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a><span class="sd">                model class for forenging key and related fields.</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">            - **in [dict]:** At options fields, have their options listed in</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">                `in` keys. It will return the values as key and de description</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">                and description__verbose (translated by Pumpwood I8s)</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a><span class="sd">                as values.</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">            - **partition:** At pk field, this key indicates if the database</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a><span class="sd">                if partitioned. Partitioned will perform better in queries if</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="sd">                partition is used on filter or exclude clauses. If table has</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">                more than one level o partition, at least the first one must</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a><span class="sd">                be used when retrieving data.</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a><span class="sd">        Raises:</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a><span class="sd">            No particular raises.</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/options/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="p">)</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fill_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">,</span> <span class="n">parcial_obj_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>                     <span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options for object fields.</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a><span class="sd">        DEPRECTED Use `fill_validation` function instead.</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a><span class="sd">        This function send partial object data and return options to finish</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a><span class="sd">        object fillment.</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a><span class="sd">        Args:</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a><span class="sd">            model_class:</span>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a><span class="sd">                Model class to check search parameters</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a><span class="sd">            auth_header:</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a><span class="sd">            parcial_obj_dict:</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a><span class="sd">                Partial object that is sent to backend for validation and</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a><span class="sd">                update fill options acording to values passed for each field.</span>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a><span class="sd">            field:</span>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="sd">                Retrict validation for an especific field if implemented.</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a><span class="sd">        Returns:</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a><span class="sd">            Return a dictonary with field names as keys and information of</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="sd">            them as values. Information at values:</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="sd">            - **primary_key [bool]:**: Boolean indicating if field is part</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">                of model_class primary key.</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a><span class="sd">            - **column [str]:**: Name of the column.</span>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">            - **column__verbose [str]:** Name of the column translated using</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a><span class="sd">                Pumpwood I8s.</span>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="sd">            - **help_text [str]:** Help text associated with column.</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a><span class="sd">            - **help_text__verbose [str]:** Help text associated with column</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a><span class="sd">                translated using Pumpwood I8s.</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="sd">            - **type [str]:** Python type associated with the column.</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="sd">            - **nullable [bool]:** If field can be set as null (None).</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">            - **read_only [bool]:** If field is marked as read-only. Passsing</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">                information for this field will not be used in save end-point.</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">            - **default [any]:** Default value of the field if not set using</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a><span class="sd">                save end-poin.</span>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">            - **unique [bool]:** If the there is a constrain in database</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">                setting this field to be unique.</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">            - **extra_info:** Some extra infomations used to pass associated</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">                model class for forenging key and related fields.</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a><span class="sd">            - **in [dict]:** At options fields, have their options listed in</span>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">                `in` keys. It will return the values as key and de description</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">                and description__verbose (translated by Pumpwood I8s)</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="sd">                as values.</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a><span class="sd">            - **partition:** At pk field, this key indicates if the database</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a><span class="sd">                if partitioned. Partitioned will perform better in queries if</span>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a><span class="sd">                partition is used on filter or exclude clauses. If table has</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a><span class="sd">                more than one level o partition, at least the first one must</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a><span class="sd">                be used when retrieving data.</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a><span class="sd">        Raises:</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">            No particular raises.</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/options/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="p">)</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a>            <span class="n">url_str</span> <span class="o">=</span> <span class="n">url_str</span> <span class="o">+</span> <span class="n">field</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parcial_obj_dict</span><span class="p">,</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options to render list views.</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a><span class="sd">        This function send partial object data and return options to finish</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a><span class="sd">        object fillment.</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a><span class="sd">        Args:</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a><span class="sd">            model_class:</span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a><span class="sd">                Model class to check search parameters.</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a><span class="sd">            auth_header:</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a><span class="sd">        Returns:</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a><span class="sd">            Dictionary with keys:</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a><span class="sd">            - **default_list_fields:** Default list field defined on the</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a><span class="sd">                application backend.</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a><span class="sd">            - **field_descriptions:** Description of the fields associated</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a><span class="sd">                with the model class.</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a><span class="sd">        Raises:</span>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a><span class="sd">          No particular raise.</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">{basename}</span><span class="s2">/list-options/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a>            <span class="n">basename</span><span class="o">=</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">retrieve_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a>                         <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options to render retrieve views.</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a><span class="sd">        Return information of the field sets that can be used to create</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a><span class="sd">        frontend site. It also return a `verbose_field` which can be used</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">        to create the tittle of the page substituing the values with</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a><span class="sd">        information of the object.</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a><span class="sd">        Args:</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a><span class="sd">          model_class:</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">              Model class to check search parameters.</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a><span class="sd">          auth_header:</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a><span class="sd">              Auth header to substitute the microservice original</span>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a><span class="sd">              at the request (user impersonation).</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a><span class="sd">        Returns:</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a><span class="sd">            Return a dictinary with keys:</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a><span class="sd">            - **verbose_field:** String sugesting how the tittle of the</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a><span class="sd">                retrieve might be created. It will use Python format</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a><span class="sd">                information ex.: `&#39;{pk} | {description}&#39;`.</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a><span class="sd">            - **fieldset:** An dictinary with organization of data,</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="sd">                setting field sets that could be grouped toguether in</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a><span class="sd">                tabs.</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a><span class="sd">        Raises:</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a><span class="sd">            No particular raises.</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">{basename}</span><span class="s2">/retrieve-options/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>            <span class="n">basename</span><span class="o">=</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fill_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parcial_obj_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>                        <span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a>                        <span class="n">user_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;api&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options for object fields.</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a><span class="sd">        This function send partial object data and return options to finish</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a><span class="sd">        object fillment.</span>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="sd">        Args:</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a><span class="sd">            model_class:</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a><span class="sd">                Model class to check search parameters.</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a><span class="sd">            auth_header:</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a><span class="sd">            parcial_obj_dict:</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a><span class="sd">                Partial object data to be validated by the backend.</span>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a><span class="sd">            field:</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="sd">                Set an especific field to be validated if implemented.</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">            user_type:</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a><span class="sd">                Set the type of user is requesting fill validation. It is</span>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a><span class="sd">                possible to set `api` and `gui`. Gui user_type will return</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a><span class="sd">                fields listed in gui_readonly as read-only fields to</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a><span class="sd">                facilitate navegation.</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="sd">        Returns:</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a><span class="sd">            Return a dictinary with keys:</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="sd">            - **field_descriptions:** Same of fill_options, but setting as</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">                read_only=True fields listed on gui_readonly if</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a><span class="sd">                user_type=&#39;gui&#39;.</span>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="sd">            - **gui_readonly:** Return a list of fields that will be</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a><span class="sd">                considered as read-only if user_type=&#39;gui&#39; is requested.</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a><span class="sd">        Raises:</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a><span class="sd">            No particular raises.</span>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">{basename}</span><span class="s2">/retrieve-options/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a>            <span class="n">basename</span><span class="o">=</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;user_type&quot;</span><span class="p">:</span> <span class="n">user_type</span><span class="p">}</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a>        <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parcial_obj_dict</span><span class="p">,</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a>            <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_pivot_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">):</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/pivot/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="p">)</span>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pivot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a>              <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a>              <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">order_by</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a>              <span class="n">variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a>              <span class="n">add_pk_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a>              <span class="n">as_dataframe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a>              <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Pivot object data acording to columns specified.</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a><span class="sd">        Pivoting per-se is not usually used, beeing the name of the function</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a><span class="sd">        a legacy. Normality data transformation is done at the client level.</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a><span class="sd">        Args:</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a><span class="sd">            model_class (str):</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a><span class="sd">                Model class to check search parameters.</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a><span class="sd">            columns (List[str]):</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a><span class="sd">                List of fields to be used as columns when pivoting the data.</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a><span class="sd">            format (str):</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a><span class="sd">                Format to be used to convert pandas.DataFrame to</span>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a><span class="sd">                dictionary, must be in [&#39;dict&#39;,&#39;list&#39;,&#39;series&#39;,</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a><span class="sd">                &#39;split&#39;, &#39;records&#39;,&#39;index&#39;].</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a><span class="sd">            filter_dict (dict):</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a><span class="sd">                Same as list function.</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a><span class="sd">            exclude_dict (dict):</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a><span class="sd">                Same as list function.</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a><span class="sd">            order_by (List[str]):</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a><span class="sd">                 Same as list function.</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a><span class="sd">            variables (List[str]):</span>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a><span class="sd">                List of the fields to be returned, if None, the default</span>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a><span class="sd">                variables will be returned. Same as fields on list functions.</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a><span class="sd">            show_deleted (bool):</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a><span class="sd">                Fields with deleted column will have objects with deleted=True</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a><span class="sd">                omited from results. show_deleted=True will return this</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="sd">                information.</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a><span class="sd">            add_pk_column (bool):</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a><span class="sd">                If add pk values of the objects at pivot results. Adding</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a><span class="sd">                pk key on pivot end-points won&#39;t be possible to pivot since</span>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="sd">                pk is unique for each entry.</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="sd">            as_dataframe (bool):</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a><span class="sd">                If results should be returned as a dataframe.</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="sd">        Returns:</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a><span class="sd">            Return a list or a dictinary depending on the format set on</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a><span class="sd">            format parameter.</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">        Raises:</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="sd">                &#39;Columns must be a list of elements.&#39;. Indicates that the list</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a><span class="sd">                argument was not a list.</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="sd">                &#39;Column chosen as pivot is not at model variables&#39;. Indicates</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">                that columns that were set to pivot are not present on model</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">                variables.</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a><span class="sd">                &quot;Format must be in [&#39;dict&#39;,&#39;list&#39;,&#39;series&#39;,&#39;split&#39;,</span>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">                &#39;records&#39;,&#39;index&#39;]&quot;. Indicates that format set as paramenter</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">                is not implemented.</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a><span class="sd">                &quot;Can not add pk column and pivot information&quot;. If</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">                add_pk_column is True (results will have the pk column), it is</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">                not possible to pivot the information (pk is an unique value</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a><span class="sd">                for each object, there is no reason to pivot it).</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a><span class="sd">                &quot;&#39;value&#39; column not at melted data, it is not possible</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a><span class="sd">                to pivot dataframe.&quot;. Indicates that data does not have a value</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a><span class="sd">                column, it must have it to populate pivoted table.</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_pivot_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>            <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">,</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>            <span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>            <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="n">order_by</span><span class="p">,</span> <span class="s2">&quot;variables&quot;</span><span class="p">:</span> <span class="n">variables</span><span class="p">,</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a>            <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span> <span class="s2">&quot;add_pk_column&quot;</span><span class="p">:</span> <span class="n">add_pk_column</span><span class="p">}</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a>        <span class="n">pivot_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">add_pk_column</span><span class="p">:</span>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>            <span class="k">if</span> <span class="n">as_dataframe</span><span class="p">:</span>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pivot_results</span><span class="p">)</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>                <span class="k">return</span> <span class="n">pivot_results</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a>            <span class="n">pd_pivot_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pivot_results</span><span class="p">)</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd_pivot_results</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a>                <span class="n">fill_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_options</span><span class="p">(</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>                    <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a>                <span class="n">primary_keys</span> <span class="o">=</span> <span class="n">fill_options</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">][</span><span class="s2">&quot;column&quot;</span><span class="p">]</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>                <span class="n">pd_pivot_results</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_pivot_results</span><span class="p">[</span><span class="n">primary_keys</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a>                    <span class="n">CompositePkBase64Converter</span><span class="o">.</span><span class="n">dump</span><span class="p">,</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a>                    <span class="n">primary_keys</span><span class="o">=</span><span class="n">primary_keys</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a>            <span class="k">if</span> <span class="n">as_dataframe</span><span class="p">:</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a>                <span class="k">return</span> <span class="n">pd_pivot_results</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a>                <span class="k">return</span> <span class="n">pd_pivot_results</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_flat_list_by_chunks_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a>            <span class="c1"># Unpacking arguments</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a>            <span class="n">model_class</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;model_class&quot;</span><span class="p">]</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a>            <span class="n">filter_dict</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;filter_dict&quot;</span><span class="p">]</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a>            <span class="n">exclude_dict</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;exclude_dict&quot;</span><span class="p">]</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>            <span class="n">fields</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a>            <span class="n">show_deleted</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;show_deleted&quot;</span><span class="p">]</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a>            <span class="n">auth_header</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;auth_header&quot;</span><span class="p">]</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a>            <span class="n">chunk_size</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;chunk_size&quot;</span><span class="p">]</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>            <span class="n">temp_filter_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">filter_dict</span><span class="p">)</span>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a>            <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_pivot_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a>            <span class="n">max_pk</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a>            <span class="c1"># Fetch data until an empty result is returned</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a>            <span class="n">list_dataframes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a>                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a>                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a>                <span class="n">temp_filter_dict</span><span class="p">[</span><span class="s2">&quot;id__gt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_pk</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a>                <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a>                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a>                    <span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">temp_filter_dict</span><span class="p">,</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>                    <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>                    <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="s2">&quot;variables&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>                    <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>                    <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">,</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>                    <span class="s2">&quot;add_pk_column&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a>                <span class="n">temp_dateframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a>                    <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">))</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>                <span class="c1"># Break if results are less than chunk size, so no more results</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>                <span class="c1"># are avaiable</span>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_dateframe</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">chunk_size</span><span class="p">:</span>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a>                    <span class="n">list_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_dateframe</span><span class="p">)</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>                    <span class="k">break</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a>                <span class="n">max_pk</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">temp_dateframe</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a>                <span class="n">list_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_dateframe</span><span class="p">)</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_dataframes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">list_dataframes</span><span class="p">)</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Exception at flat_list_by_chunks:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">flat_list_by_chunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a>                            <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>                            <span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a>                            <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a>                            <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000000</span><span class="p">,</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a>                            <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a>                            <span class="n">create_composite_pk</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>                            <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a>                            <span class="n">end_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Incrementally fetch data from pivot end-point.</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a><span class="sd">        Fetch data from pivot end-point paginating by id of chunk_size lenght.</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a><span class="sd">        If table is partitioned it will split the query acording to partition</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a><span class="sd">        to facilitate query at the database.</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a><span class="sd">        If start_date and end_date are set, also breaks the query by month</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a><span class="sd">        retrieving each month data in parallel.</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a><span class="sd">        Args:</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a><span class="sd">            model_class (str):</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a><span class="sd">                Model class to be pivoted.</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a><span class="sd">            filter_dict (dict):</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a><span class="sd">                Dictionary to to be used in objects.filter argument</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a><span class="sd">                (Same as list end-point).</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a><span class="sd">            exclude_dict (dict):</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a><span class="sd">                Dictionary to to be used in objects.exclude argument</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a><span class="sd">                (Same as list end-point).</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a><span class="sd">            fields (List[str] | None):</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a><span class="sd">                List of the variables to be returned,</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a><span class="sd">                if None, the default variables will be returned.</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a><span class="sd">                If fields is set, dataframe will return that columns</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a><span class="sd">                even if data is empty.</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a><span class="sd">            start_date (datetime | str):</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a><span class="sd">                Set a begin date for the query. If begin and end date are</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a><span class="sd">                set, query will be splited with chucks by month that will be</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a><span class="sd">                requested in parallel.</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a><span class="sd">            end_date (datetime | str):</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a><span class="sd">                Set a end date for the query. If begin and end date are</span>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a><span class="sd">                set, query will be splited with chucks by month that will be</span>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a><span class="sd">                requested in parallel.</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a><span class="sd">            show_deleted (bool):</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a><span class="sd">                If deleted data should be returned.</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a><span class="sd">            chunk_size (int):</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a><span class="sd">                Limit of data to fetch per call.</span>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a><span class="sd">            n_parallel (int):</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a><span class="sd">                Number of parallel process to perform.</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a><span class="sd">            create_composite_pk (bool):</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a><span class="sd">                If true and table has a composite pk, it will create pk</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a><span class="sd">                value based on the hash on the json serialized dictionary</span>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a><span class="sd">                of the components of the primary key.</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">        Returns:</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="sd">            Returns a dataframe with all information fetched.</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">        Raises:</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a><span class="sd">            No particular raise.</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a>        <span class="n">temp_filter_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">filter_dict</span><span class="p">)</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a>        <span class="n">fill_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_options</span><span class="p">(</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a>            <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a>        <span class="n">primary_keys</span> <span class="o">=</span> <span class="n">fill_options</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">][</span><span class="s2">&quot;column&quot;</span><span class="p">]</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a>        <span class="n">partition</span> <span class="o">=</span> <span class="n">fill_options</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;partition&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a>        <span class="c1"># Create a list of month and include start and end dates if not at</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a>        <span class="c1"># the beginning of a month</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a>        <span class="n">month_sequence</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">start_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a>            <span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>            <span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>            <span class="n">list_month_sequence</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>                <span class="n">start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;MS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>            <span class="n">month_sequence</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>                <span class="p">[</span><span class="n">start_date</span><span class="p">]</span> <span class="o">+</span> <span class="n">list_month_sequence</span> <span class="o">+</span> <span class="p">[</span><span class="n">end_date</span><span class="p">]</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>            <span class="n">month_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="n">month_sequence</span><span class="p">})</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>            <span class="n">month_df</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">month_df</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>            <span class="n">month_df</span> <span class="o">=</span> <span class="n">month_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>            <span class="n">month_sequence</span> <span class="o">=</span> <span class="n">month_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">start_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">end_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a>                <span class="s2">&quot;To break query in chunks using start_date and end_date &quot;</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a>                <span class="s2">&quot;both must be set.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>                <span class="s2">&quot;start_date: </span><span class="si">{start_date}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a>                <span class="s2">&quot;end_date: </span><span class="si">{end_date}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a>                    <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">)</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>                <span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a>                    <span class="s2">&quot;start_date&quot;</span><span class="p">:</span> <span class="n">start_date</span><span class="p">,</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a>                    <span class="s2">&quot;end_date&quot;</span><span class="p">:</span> <span class="n">end_date</span><span class="p">})</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a>        <span class="n">resp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a>        <span class="c1">##########################################################</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a>        <span class="c1"># If table have more than one partition, run in parallel #</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a>        <span class="c1"># the {partition}__in elements along with dates          #</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a>        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">):</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>            <span class="n">partition_col_1st</span> <span class="o">=</span> <span class="n">partition</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a>            <span class="n">filter_dict_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_filter_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a>            <span class="n">partition_filter</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a>            <span class="n">count_partition_col_1st_filters</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">filter_dict_keys</span><span class="p">:</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a>                <span class="k">if</span> <span class="n">partition_col_1st</span> <span class="o">+</span> <span class="s2">&quot;__in&quot;</span> <span class="o">==</span> <span class="n">col</span><span class="p">:</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a>                    <span class="n">partition_filter</span> <span class="o">=</span> <span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a>                    <span class="k">del</span> <span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a>                    <span class="n">count_partition_col_1st_filters</span> <span class="o">=</span> \
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a>                        <span class="n">count_partition_col_1st_filters</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a>                <span class="k">elif</span> <span class="n">partition_col_1st</span> <span class="o">==</span> <span class="n">col</span><span class="p">:</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a>                    <span class="n">partition_filter</span> <span class="o">=</span> <span class="p">[</span><span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]]</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a>                    <span class="k">del</span> <span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a>                    <span class="n">count_partition_col_1st_filters</span> <span class="o">=</span> \
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a>                        <span class="n">count_partition_col_1st_filters</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a>            <span class="c1"># Validating query for partitioned tables</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a>            <span class="k">if</span> <span class="n">partition_filter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a>                    <span class="s2">&quot;Table is partitioned with sub-partitions, running &quot;</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a>                    <span class="s2">&quot;queries without at least first level partition will &quot;</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a>                    <span class="s2">&quot;lead to long waiting times or hanging queries. Please &quot;</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a>                    <span class="s2">&quot;use first partition level in filter_dict with equal &quot;</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a>                    <span class="s2">&quot;or in operators. Table partitions: </span><span class="si">{}</span><span class="s2">&quot;</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>            <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">count_partition_col_1st_filters</span><span class="p">:</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>                    <span class="s2">&quot;Please give some help for the dev here, use just one &quot;</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>                    <span class="s2">&quot;filter_dict entry for first partition...&quot;</span><span class="p">)</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>            <span class="c1"># Parallelizing query using partition columns</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>            <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>            <span class="k">for</span> <span class="n">filter_key</span> <span class="ow">in</span> <span class="n">partition_filter</span><span class="p">:</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>                <span class="n">request_filter_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">temp_filter_dict</span><span class="p">)</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>                <span class="n">request_filter_dict</span><span class="p">[</span><span class="n">partition_col_1st</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_key</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>                <span class="k">if</span> <span class="n">month_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>                    <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>                        <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>                        <span class="s2">&quot;filter_dict&quot;</span><span class="p">:</span> <span class="n">request_filter_dict</span><span class="p">,</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>                        <span class="s2">&quot;exclude_dict&quot;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>                        <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>                        <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>                        <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>                        <span class="s2">&quot;chunk_size&quot;</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">})</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">month_sequence</span><span class="p">)):</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>                        <span class="n">request_filter_dict_t</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>                            <span class="n">request_filter_dict</span><span class="p">)</span>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a>                        <span class="c1"># If is not the last interval, query using open</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>                        <span class="c1"># right interval so subsequence queries does</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>                        <span class="c1"># not overlap</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a>                        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">month_sequence</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__gte&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__lt&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>                        <span class="c1"># At the last interval use closed right interval so</span>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a>                        <span class="c1"># last element is also included in the interval</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__gte&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__lte&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a>                        <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a>                            <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a>                            <span class="s2">&quot;filter_dict&quot;</span><span class="p">:</span> <span class="n">request_filter_dict_t</span><span class="p">,</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a>                            <span class="s2">&quot;exclude_dict&quot;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a>                            <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>                            <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>                            <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>                            <span class="s2">&quot;chunk_size&quot;</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">})</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>            <span class="c1"># Perform parallel calls to backend each chucked by chunk_size</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel flat list: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">pool_arguments</span><span class="p">))</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>                <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>                    <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_flat_list_by_chunks_helper</span><span class="p">,</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>                        <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>                <span class="n">resp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>                <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">## Finished parallel flat list: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">pool_arguments</span><span class="p">))</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>        <span class="c1">############################################</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>        <span class="c1"># If table have partition, run in parallel #</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>                <span class="n">results_key_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flat_list_by_chunks_helper</span><span class="p">({</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>                    <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>                    <span class="s2">&quot;filter_dict&quot;</span><span class="p">:</span> <span class="n">temp_filter_dict</span><span class="p">,</span>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a>                    <span class="s2">&quot;exclude_dict&quot;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a>                    <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a>                    <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>                    <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a>                    <span class="s2">&quot;chunk_size&quot;</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">})</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a>                <span class="n">resp_df</span> <span class="o">=</span> <span class="n">results_key_data</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>                <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a>        <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">))</span> <span class="ow">and</span> <span class="n">create_composite_pk</span><span class="p">:</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Creating composite pk&quot;</span><span class="p">)</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a>            <span class="n">resp_df</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resp_df</span><span class="p">[</span><span class="n">primary_keys</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>                <span class="n">CompositePkBase64Converter</span><span class="o">.</span><span class="n">dump</span><span class="p">,</span>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a>                <span class="n">primary_keys</span><span class="o">=</span><span class="n">primary_keys</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a>            <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a>                <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pk&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">fields</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a>        <span class="c1"># Adjust columns to return the columns set at fields</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>            <span class="n">resp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resp_df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>        <span class="k">return</span> <span class="n">resp_df</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_bulk_save_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/bulk-save/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),)</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">bulk_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_to_save</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>                  <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Save a list of objects with one request.</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a><span class="sd">        It is used with a unique call save many objects at the same time. It</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a><span class="sd">        is necessary that the end-point is able to receive bulk save requests</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a><span class="sd">        and all objects been of the same model class.</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a><span class="sd">        Args:</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a><span class="sd">            model_class:</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a><span class="sd">                Data model class.</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a><span class="sd">            data_to_save:</span>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a><span class="sd">                A list of objects to be saved.</span>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a><span class="sd">            auth_header:</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a><span class="sd">        Returns:</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a><span class="sd">            A dictinary with `saved_count` as key indicating the number of</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a><span class="sd">            objects that were saved in database.</span>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a><span class="sd">        Raises:</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a><span class="sd">                &#39;Expected columns and data columns do not match: Expected</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a><span class="sd">                columns: {expected} Data columns: {data_cols}&#39;. Indicates</span>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a><span class="sd">                that the expected fields of the object were not met at the</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a><span class="sd">                objects passed to save.</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a><span class="sd">                Other sqlalchemy and psycopg2 errors not associated with</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a><span class="sd">                IntegrityError.</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a><span class="sd">                &#39;Bulk save not avaiable.&#39;. Indicates that Bulk save end-point</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a><span class="sd">                was not configured for this model_class.</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a><span class="sd">            PumpWoodIntegrityError:</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a><span class="sd">                Raise integrity errors from sqlalchemy and psycopg2. Usually</span>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a><span class="sd">                associated with uniqueness of some column.</span>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_bulk_save_url</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_to_save</span><span class="p">,</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>    <span class="c1">########################</span>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a>    <span class="c1"># Parallel aux functions</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">flatten_parallel</span><span class="p">(</span><span class="n">parallel_result</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Concat all parallel return to one list.</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a><span class="sd">        Args:</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a><span class="sd">            parallel_result:</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a><span class="sd">                A list of lists to be flated (concatenate</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a><span class="sd">                all lists into one).</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a><span class="sd">        Returns:</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a><span class="sd">            A list with all sub list itens.</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a>            <span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">parallel_result</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_request_get_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span><span class="o">**</span><span class="n">arguments</span><span class="p">)</span>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>            <span class="k">return</span> <span class="n">results</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error on parallel get: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_request_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">urls_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a>                             <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a>                             <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">any</span><span class="p">]:</span>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel get requests.</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">        Args:</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">            urls_list:</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a><span class="sd">                List of urls to make get requests.</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a><span class="sd">            parameters:</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="sd">                A list of dictionary or a dictionary that will be replicated</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a><span class="sd">                len(urls_list) and passed to parallel request as url</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a><span class="sd">                parameter. If not set, empty dictionary will be passed to all</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a><span class="sd">                request as default.</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a><span class="sd">            n_parallel:</span>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a><span class="sd">            auth_header:</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a><span class="sd">        Returns:</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a><span class="sd">            Return a list with all get request reponses. The results are</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a><span class="sd">            on the same order of argument list.</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a><span class="sd">        Raises:</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a><span class="sd">                &#39;lenght of urls_list[{}] is different of parameters[{}]&#39;.</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a><span class="sd">                Indicates that the function arguments `urls_list` and</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a><span class="sd">                `parameters` (when passed as a list of dictionaries)</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a><span class="sd">                does not have de same lenght.</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a><span class="sd">            PumpWoodNotImplementedError:</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a><span class="sd">                &#39;paraemters type[{}] is not implemented&#39;. Indicates that</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a><span class="sd">                `parameters` passed as function argument is not a list of dict</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a><span class="sd">                or a dictinary, so not implemented.</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a>        <span class="c1"># Create URL parameters if not set as parameter with</span>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a>        <span class="c1"># empty dicionaries</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>        <span class="n">n_urls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a>        <span class="n">parameters_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a>        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{</span><span class="n">parameters</span><span class="p">}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_urls</span><span class="p">:</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a>                <span class="n">parameters_list</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a>                    <span class="s1">&#39;lenght of urls_list[</span><span class="si">{}</span><span class="s1">] is different of &#39;</span> <span class="o">+</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a>                    <span class="s1">&#39;parameters[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a>                        <span class="n">n_urls</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;paraemters type[</span><span class="si">{}</span><span class="s1">] is not implemented&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a>                <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)))</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a>            <span class="k">raise</span> <span class="n">PumpWoodNotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a>        <span class="c1"># Create Pool arguments to run in parallel</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)):</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a>                <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">urls_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;auth_header&#39;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a>                <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="n">parameters_list</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a>        <span class="c1"># Run requests in parallel</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_request_get_wrapper</span><span class="p">,</span> <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>        <span class="k">return</span> <span class="n">results</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_request_post_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span><span class="o">**</span><span class="n">arguments</span><span class="p">)</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>            <span class="k">return</span> <span class="n">result</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error in parallel post: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">paralell_request_post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">urls_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>                              <span class="n">data_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>                              <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>                              <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>                              <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">any</span><span class="p">]:</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel post request.</span>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a><span class="sd">        Args:</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a><span class="sd">            urls_list:</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a><span class="sd">                List of urls to make get requests.</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a><span class="sd">            data_list:</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a><span class="sd">                List of data to be used as post payloads.</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a><span class="sd">            parameters:</span>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a><span class="sd">                URL paramenters to make the post requests.</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a><span class="sd">            n_parallel:</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a><span class="sd">            auth_header:</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a><span class="sd">        Returns:</span>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a><span class="sd">            List of the post request reponses.</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a><span class="sd">        Raises:</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a><span class="sd">            No particular raises</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a><span class="sd">        Example:</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a><span class="sd">            No example yet.</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>        <span class="c1"># Create URL parameters if not set as parameter with</span>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a>        <span class="c1"># empty dicionaries</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a>        <span class="n">n_urls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a>        <span class="n">parameters_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a>        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a>            <span class="n">parameters_list</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a>            <span class="n">parameters_list</span> <span class="o">=</span> <span class="p">[{</span><span class="n">parameters</span><span class="p">}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_urls</span><span class="p">:</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>                <span class="n">parameters_list</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>                    <span class="s1">&#39;lenght of urls_list[</span><span class="si">{}</span><span class="s1">] is different of &#39;</span> <span class="o">+</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>                    <span class="s1">&#39;parameters[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a>                        <span class="n">n_urls</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;paraemters type[</span><span class="si">{}</span><span class="s1">] is not implemented&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>                <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)))</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>            <span class="k">raise</span> <span class="n">PumpWoodNotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a>        <span class="c1"># Validate if length of URL is the same of data_list</span>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">):</span>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a>                <span class="s1">&#39;len(urls_list)[</span><span class="si">{}</span><span class="s1">] must be equal &#39;</span> <span class="o">+</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a>                <span class="s1">&#39;to len(data_list)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">))</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a>        <span class="c1"># Create the arguments for parallel requests</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)):</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>                <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">urls_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>                <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a>                <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="n">parameters_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a>                <span class="s1">&#39;auth_header&#39;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">})</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a>        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_request_post_wrapper</span><span class="p">,</span> <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a>        <span class="k">return</span> <span class="n">results</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_request_delete_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_delete</span><span class="p">(</span><span class="o">**</span><span class="n">arguments</span><span class="p">)</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a>            <span class="k">return</span> <span class="n">result</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error in parallel delete: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">paralell_request_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">urls_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a>                                <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a>                                <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a>                                <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel delete request.</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a><span class="sd">        Args:</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a><span class="sd">            urls_list:</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a><span class="sd">                List of urls to make get requests.</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a><span class="sd">            parameters:</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a><span class="sd">                URL paramenters to make the post requests.</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a><span class="sd">            n_parallel (int): Number of simultaneus get requests, if not set</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a><span class="sd">            auth_header:</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a><span class="sd">        Returns:</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a><span class="sd">            list: List of the get request reponses.</span>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a><span class="sd">        Raises:</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a><span class="sd">            No particular raises.</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a><span class="sd">        Example:</span>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a><span class="sd">            No example yet.</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a>        <span class="c1"># Create URL parameters if not set as parameter with</span>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a>        <span class="c1"># empty dicionaries</span>
</span><span id="L-1657"><a href="#L-1657"><span class="linenos">1657</span></a>        <span class="n">n_urls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span>
</span><span id="L-1658"><a href="#L-1658"><span class="linenos">1658</span></a>        <span class="n">parameters_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1659"><a href="#L-1659"><span class="linenos">1659</span></a>        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1660"><a href="#L-1660"><span class="linenos">1660</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="L-1661"><a href="#L-1661"><span class="linenos">1661</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="L-1662"><a href="#L-1662"><span class="linenos">1662</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{</span><span class="n">parameters</span><span class="p">}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="L-1663"><a href="#L-1663"><span class="linenos">1663</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-1664"><a href="#L-1664"><span class="linenos">1664</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_urls</span><span class="p">:</span>
</span><span id="L-1665"><a href="#L-1665"><span class="linenos">1665</span></a>                <span class="n">parameters_list</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="L-1666"><a href="#L-1666"><span class="linenos">1666</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-1667"><a href="#L-1667"><span class="linenos">1667</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1668"><a href="#L-1668"><span class="linenos">1668</span></a>                    <span class="s1">&#39;lenght of urls_list[</span><span class="si">{}</span><span class="s1">] is different of &#39;</span> <span class="o">+</span>
</span><span id="L-1669"><a href="#L-1669"><span class="linenos">1669</span></a>                    <span class="s1">&#39;parameters[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1670"><a href="#L-1670"><span class="linenos">1670</span></a>                        <span class="n">n_urls</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
</span><span id="L-1671"><a href="#L-1671"><span class="linenos">1671</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1672"><a href="#L-1672"><span class="linenos">1672</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1673"><a href="#L-1673"><span class="linenos">1673</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;paraemters type[</span><span class="si">{}</span><span class="s1">] is not implemented&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1674"><a href="#L-1674"><span class="linenos">1674</span></a>                <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)))</span>
</span><span id="L-1675"><a href="#L-1675"><span class="linenos">1675</span></a>            <span class="k">raise</span> <span class="n">PumpWoodNotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1676"><a href="#L-1676"><span class="linenos">1676</span></a>
</span><span id="L-1677"><a href="#L-1677"><span class="linenos">1677</span></a>        <span class="c1"># Create Pool arguments to run in parallel</span>
</span><span id="L-1678"><a href="#L-1678"><span class="linenos">1678</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1679"><a href="#L-1679"><span class="linenos">1679</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)):</span>
</span><span id="L-1680"><a href="#L-1680"><span class="linenos">1680</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="L-1681"><a href="#L-1681"><span class="linenos">1681</span></a>                <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">urls_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;auth_header&#39;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="L-1682"><a href="#L-1682"><span class="linenos">1682</span></a>                <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="n">parameters_list</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
</span><span id="L-1683"><a href="#L-1683"><span class="linenos">1683</span></a>
</span><span id="L-1684"><a href="#L-1684"><span class="linenos">1684</span></a>        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="L-1685"><a href="#L-1685"><span class="linenos">1685</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_request_delete_wrapper</span><span class="p">,</span> <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="L-1686"><a href="#L-1686"><span class="linenos">1686</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="L-1687"><a href="#L-1687"><span class="linenos">1687</span></a>        <span class="k">return</span> <span class="n">results</span>
</span><span id="L-1688"><a href="#L-1688"><span class="linenos">1688</span></a>
</span><span id="L-1689"><a href="#L-1689"><span class="linenos">1689</span></a>    <span class="c1">######################</span>
</span><span id="L-1690"><a href="#L-1690"><span class="linenos">1690</span></a>    <span class="c1"># Parallel functions #</span>
</span><span id="L-1691"><a href="#L-1691"><span class="linenos">1691</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_retrieve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="L-1692"><a href="#L-1692"><span class="linenos">1692</span></a>                          <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1693"><a href="#L-1693"><span class="linenos">1693</span></a>                          <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1694"><a href="#L-1694"><span class="linenos">1694</span></a>                          <span class="n">related_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-1695"><a href="#L-1695"><span class="linenos">1695</span></a>                          <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1696"><a href="#L-1696"><span class="linenos">1696</span></a>                          <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-1697"><a href="#L-1697"><span class="linenos">1697</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel retrieve request.</span>
</span><span id="L-1698"><a href="#L-1698"><span class="linenos">1698</span></a>
</span><span id="L-1699"><a href="#L-1699"><span class="linenos">1699</span></a><span class="sd">        Args:</span>
</span><span id="L-1700"><a href="#L-1700"><span class="linenos">1700</span></a><span class="sd">            model_class:</span>
</span><span id="L-1701"><a href="#L-1701"><span class="linenos">1701</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="L-1702"><a href="#L-1702"><span class="linenos">1702</span></a><span class="sd">            list_pk:</span>
</span><span id="L-1703"><a href="#L-1703"><span class="linenos">1703</span></a><span class="sd">                List of the pks to retrieve.</span>
</span><span id="L-1704"><a href="#L-1704"><span class="linenos">1704</span></a><span class="sd">            fields:</span>
</span><span id="L-1705"><a href="#L-1705"><span class="linenos">1705</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="L-1706"><a href="#L-1706"><span class="linenos">1706</span></a><span class="sd">            default_fields:</span>
</span><span id="L-1707"><a href="#L-1707"><span class="linenos">1707</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="L-1708"><a href="#L-1708"><span class="linenos">1708</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="L-1709"><a href="#L-1709"><span class="linenos">1709</span></a><span class="sd">            foreign_key_fields:</span>
</span><span id="L-1710"><a href="#L-1710"><span class="linenos">1710</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="L-1711"><a href="#L-1711"><span class="linenos">1711</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="L-1712"><a href="#L-1712"><span class="linenos">1712</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="L-1713"><a href="#L-1713"><span class="linenos">1713</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="L-1714"><a href="#L-1714"><span class="linenos">1714</span></a><span class="sd">            related_fields:</span>
</span><span id="L-1715"><a href="#L-1715"><span class="linenos">1715</span></a><span class="sd">                Return related fields objects. Related field objects are</span>
</span><span id="L-1716"><a href="#L-1716"><span class="linenos">1716</span></a><span class="sd">                objects that have a forenging key associated with this</span>
</span><span id="L-1717"><a href="#L-1717"><span class="linenos">1717</span></a><span class="sd">                model_class, results will be returned as a list of</span>
</span><span id="L-1718"><a href="#L-1718"><span class="linenos">1718</span></a><span class="sd">                dictionaries usually in a field with `_set` at end.</span>
</span><span id="L-1719"><a href="#L-1719"><span class="linenos">1719</span></a><span class="sd">                Returning related_fields consume backend resorces, use</span>
</span><span id="L-1720"><a href="#L-1720"><span class="linenos">1720</span></a><span class="sd">                carefully.</span>
</span><span id="L-1721"><a href="#L-1721"><span class="linenos">1721</span></a><span class="sd">            n_parallel (int): Number of simultaneus get requests, if not set</span>
</span><span id="L-1722"><a href="#L-1722"><span class="linenos">1722</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-1723"><a href="#L-1723"><span class="linenos">1723</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-1724"><a href="#L-1724"><span class="linenos">1724</span></a><span class="sd">            auth_header:</span>
</span><span id="L-1725"><a href="#L-1725"><span class="linenos">1725</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-1726"><a href="#L-1726"><span class="linenos">1726</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-1727"><a href="#L-1727"><span class="linenos">1727</span></a>
</span><span id="L-1728"><a href="#L-1728"><span class="linenos">1728</span></a><span class="sd">        Returns:</span>
</span><span id="L-1729"><a href="#L-1729"><span class="linenos">1729</span></a><span class="sd">            List of the retrieve request data.</span>
</span><span id="L-1730"><a href="#L-1730"><span class="linenos">1730</span></a>
</span><span id="L-1731"><a href="#L-1731"><span class="linenos">1731</span></a><span class="sd">        Raises:</span>
</span><span id="L-1732"><a href="#L-1732"><span class="linenos">1732</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1733"><a href="#L-1733"><span class="linenos">1733</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_pk)[{}]&#39;. Indicates that</span>
</span><span id="L-1734"><a href="#L-1734"><span class="linenos">1734</span></a><span class="sd">                the lenght of the arguments model_class and list_pk are</span>
</span><span id="L-1735"><a href="#L-1735"><span class="linenos">1735</span></a><span class="sd">                incompatible.</span>
</span><span id="L-1736"><a href="#L-1736"><span class="linenos">1736</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1737"><a href="#L-1737"><span class="linenos">1737</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1738"><a href="#L-1738"><span class="linenos">1738</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-1739"><a href="#L-1739"><span class="linenos">1739</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-1740"><a href="#L-1740"><span class="linenos">1740</span></a>
</span><span id="L-1741"><a href="#L-1741"><span class="linenos">1741</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1742"><a href="#L-1742"><span class="linenos">1742</span></a>            <span class="n">model_class</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)</span>
</span><span id="L-1743"><a href="#L-1743"><span class="linenos">1743</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-1744"><a href="#L-1744"><span class="linenos">1744</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="L-1745"><a href="#L-1745"><span class="linenos">1745</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-1746"><a href="#L-1746"><span class="linenos">1746</span></a>                    <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_pk)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1747"><a href="#L-1747"><span class="linenos">1747</span></a>                        <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">))</span>
</span><span id="L-1748"><a href="#L-1748"><span class="linenos">1748</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1749"><a href="#L-1749"><span class="linenos">1749</span></a>
</span><span id="L-1750"><a href="#L-1750"><span class="linenos">1750</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1751"><a href="#L-1751"><span class="linenos">1751</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_retrieve_url</span><span class="p">(</span>
</span><span id="L-1752"><a href="#L-1752"><span class="linenos">1752</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pk</span><span class="o">=</span><span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-1753"><a href="#L-1753"><span class="linenos">1753</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">))]</span>
</span><span id="L-1754"><a href="#L-1754"><span class="linenos">1754</span></a>
</span><span id="L-1755"><a href="#L-1755"><span class="linenos">1755</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_request_get</span><span class="p">(</span>
</span><span id="L-1756"><a href="#L-1756"><span class="linenos">1756</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span>
</span><span id="L-1757"><a href="#L-1757"><span class="linenos">1757</span></a>            <span class="n">parameters</span><span class="o">=</span><span class="p">{</span>
</span><span id="L-1758"><a href="#L-1758"><span class="linenos">1758</span></a>                <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span> <span class="s2">&quot;default_fields&quot;</span><span class="p">:</span> <span class="n">default_fields</span><span class="p">,</span>
</span><span id="L-1759"><a href="#L-1759"><span class="linenos">1759</span></a>                <span class="s2">&quot;foreign_key_fields&quot;</span><span class="p">:</span> <span class="n">foreign_key_fields</span><span class="p">,</span>
</span><span id="L-1760"><a href="#L-1760"><span class="linenos">1760</span></a>                <span class="s2">&quot;related_fields&quot;</span><span class="p">:</span> <span class="n">related_fields</span><span class="p">},</span>
</span><span id="L-1761"><a href="#L-1761"><span class="linenos">1761</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-1762"><a href="#L-1762"><span class="linenos">1762</span></a>
</span><span id="L-1763"><a href="#L-1763"><span class="linenos">1763</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_request_retrieve_file_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
</span><span id="L-1764"><a href="#L-1764"><span class="linenos">1764</span></a>        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="L-1765"><a href="#L-1765"><span class="linenos">1765</span></a>        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="L-1766"><a href="#L-1766"><span class="linenos">1766</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1767"><a href="#L-1767"><span class="linenos">1767</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_file</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-1768"><a href="#L-1768"><span class="linenos">1768</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1769"><a href="#L-1769"><span class="linenos">1769</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error in parallel retrieve_file: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-1770"><a href="#L-1770"><span class="linenos">1770</span></a>
</span><span id="L-1771"><a href="#L-1771"><span class="linenos">1771</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_retrieve_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-1772"><a href="#L-1772"><span class="linenos">1772</span></a>                               <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">file_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1773"><a href="#L-1773"><span class="linenos">1773</span></a>                               <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">,</span> <span class="n">save_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="L-1774"><a href="#L-1774"><span class="linenos">1774</span></a>                               <span class="n">list_file_name</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1775"><a href="#L-1775"><span class="linenos">1775</span></a>                               <span class="n">if_exists</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fail&quot;</span><span class="p">,</span>
</span><span id="L-1776"><a href="#L-1776"><span class="linenos">1776</span></a>                               <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1777"><a href="#L-1777"><span class="linenos">1777</span></a>                               <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-1778"><a href="#L-1778"><span class="linenos">1778</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make many [n_parallel] retrieve request.</span>
</span><span id="L-1779"><a href="#L-1779"><span class="linenos">1779</span></a>
</span><span id="L-1780"><a href="#L-1780"><span class="linenos">1780</span></a><span class="sd">        Args:</span>
</span><span id="L-1781"><a href="#L-1781"><span class="linenos">1781</span></a><span class="sd">            model_class:</span>
</span><span id="L-1782"><a href="#L-1782"><span class="linenos">1782</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="L-1783"><a href="#L-1783"><span class="linenos">1783</span></a><span class="sd">            list_pk:</span>
</span><span id="L-1784"><a href="#L-1784"><span class="linenos">1784</span></a><span class="sd">                List of the pks to retrieve.</span>
</span><span id="L-1785"><a href="#L-1785"><span class="linenos">1785</span></a><span class="sd">            file_field:</span>
</span><span id="L-1786"><a href="#L-1786"><span class="linenos">1786</span></a><span class="sd">                Indicates the file field to download from.</span>
</span><span id="L-1787"><a href="#L-1787"><span class="linenos">1787</span></a><span class="sd">            n_parallel:</span>
</span><span id="L-1788"><a href="#L-1788"><span class="linenos">1788</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="L-1789"><a href="#L-1789"><span class="linenos">1789</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-1790"><a href="#L-1790"><span class="linenos">1790</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-1791"><a href="#L-1791"><span class="linenos">1791</span></a><span class="sd">            save_path:</span>
</span><span id="L-1792"><a href="#L-1792"><span class="linenos">1792</span></a><span class="sd">                Path to be used to save files.</span>
</span><span id="L-1793"><a href="#L-1793"><span class="linenos">1793</span></a><span class="sd">            save_file:</span>
</span><span id="L-1794"><a href="#L-1794"><span class="linenos">1794</span></a><span class="sd">                True save file locally, False return file content as bites.</span>
</span><span id="L-1795"><a href="#L-1795"><span class="linenos">1795</span></a><span class="sd">            list_file_name:</span>
</span><span id="L-1796"><a href="#L-1796"><span class="linenos">1796</span></a><span class="sd">                Set a file name for each file download.</span>
</span><span id="L-1797"><a href="#L-1797"><span class="linenos">1797</span></a><span class="sd">            if_exists:</span>
</span><span id="L-1798"><a href="#L-1798"><span class="linenos">1798</span></a><span class="sd">                Set how treat when a file will be saved</span>
</span><span id="L-1799"><a href="#L-1799"><span class="linenos">1799</span></a><span class="sd">                and there is another at same path. &quot;fail&quot; will raise an error;</span>
</span><span id="L-1800"><a href="#L-1800"><span class="linenos">1800</span></a><span class="sd">                &quot;overwrite&quot; will overwrite the file with the new one; &quot;skip&quot;</span>
</span><span id="L-1801"><a href="#L-1801"><span class="linenos">1801</span></a><span class="sd">                when list_file_name is set, check before downloaded it file</span>
</span><span id="L-1802"><a href="#L-1802"><span class="linenos">1802</span></a><span class="sd">                already exists, if so skip the download.</span>
</span><span id="L-1803"><a href="#L-1803"><span class="linenos">1803</span></a><span class="sd">            auth_header:</span>
</span><span id="L-1804"><a href="#L-1804"><span class="linenos">1804</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-1805"><a href="#L-1805"><span class="linenos">1805</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-1806"><a href="#L-1806"><span class="linenos">1806</span></a>
</span><span id="L-1807"><a href="#L-1807"><span class="linenos">1807</span></a><span class="sd">        Returns:</span>
</span><span id="L-1808"><a href="#L-1808"><span class="linenos">1808</span></a><span class="sd">            List of the retrieve file request data.</span>
</span><span id="L-1809"><a href="#L-1809"><span class="linenos">1809</span></a>
</span><span id="L-1810"><a href="#L-1810"><span class="linenos">1810</span></a><span class="sd">        Raises:</span>
</span><span id="L-1811"><a href="#L-1811"><span class="linenos">1811</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1812"><a href="#L-1812"><span class="linenos">1812</span></a><span class="sd">                &#39;Lenght of list_file_name and list_pk are not equal:</span>
</span><span id="L-1813"><a href="#L-1813"><span class="linenos">1813</span></a><span class="sd">                len(list_file_name)={list_file_name}; len(list_pk)={list_pk}&#39;.</span>
</span><span id="L-1814"><a href="#L-1814"><span class="linenos">1814</span></a><span class="sd">                Indicates that len(list_file_name) and len(list_pk) function</span>
</span><span id="L-1815"><a href="#L-1815"><span class="linenos">1815</span></a><span class="sd">                arguments are not equal.</span>
</span><span id="L-1816"><a href="#L-1816"><span class="linenos">1816</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1817"><a href="#L-1817"><span class="linenos">1817</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1818"><a href="#L-1818"><span class="linenos">1818</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-1819"><a href="#L-1819"><span class="linenos">1819</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-1820"><a href="#L-1820"><span class="linenos">1820</span></a>
</span><span id="L-1821"><a href="#L-1821"><span class="linenos">1821</span></a>        <span class="k">if</span> <span class="n">list_file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1822"><a href="#L-1822"><span class="linenos">1822</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_file_name</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="L-1823"><a href="#L-1823"><span class="linenos">1823</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">((</span>
</span><span id="L-1824"><a href="#L-1824"><span class="linenos">1824</span></a>                    <span class="s2">&quot;Lenght of list_file_name and list_pk are not equal:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
</span><span id="L-1825"><a href="#L-1825"><span class="linenos">1825</span></a>                    <span class="s2">&quot;len(list_file_name)=</span><span class="si">{list_file_name}</span><span class="s2">; &quot;</span> <span class="o">+</span>
</span><span id="L-1826"><a href="#L-1826"><span class="linenos">1826</span></a>                    <span class="s2">&quot;len(list_pk)=</span><span class="si">{list_pk}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1827"><a href="#L-1827"><span class="linenos">1827</span></a>                        <span class="n">list_file_name</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">list_file_name</span><span class="p">),</span>
</span><span id="L-1828"><a href="#L-1828"><span class="linenos">1828</span></a>                        <span class="n">list_pk</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)))</span>
</span><span id="L-1829"><a href="#L-1829"><span class="linenos">1829</span></a>
</span><span id="L-1830"><a href="#L-1830"><span class="linenos">1830</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1831"><a href="#L-1831"><span class="linenos">1831</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)):</span>
</span><span id="L-1832"><a href="#L-1832"><span class="linenos">1832</span></a>            <span class="n">pk</span> <span class="o">=</span> <span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-1833"><a href="#L-1833"><span class="linenos">1833</span></a>            <span class="n">file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1834"><a href="#L-1834"><span class="linenos">1834</span></a>            <span class="k">if</span> <span class="n">list_file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1835"><a href="#L-1835"><span class="linenos">1835</span></a>                <span class="n">file_name</span> <span class="o">=</span> <span class="n">list_file_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="L-1836"><a href="#L-1836"><span class="linenos">1836</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="L-1837"><a href="#L-1837"><span class="linenos">1837</span></a>                <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span> <span class="s2">&quot;pk&quot;</span><span class="p">:</span> <span class="n">pk</span><span class="p">,</span>
</span><span id="L-1838"><a href="#L-1838"><span class="linenos">1838</span></a>                <span class="s2">&quot;file_field&quot;</span><span class="p">:</span> <span class="n">file_field</span><span class="p">,</span> <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="L-1839"><a href="#L-1839"><span class="linenos">1839</span></a>                <span class="s2">&quot;save_file&quot;</span><span class="p">:</span> <span class="n">save_file</span><span class="p">,</span> <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="n">file_name</span><span class="p">,</span>
</span><span id="L-1840"><a href="#L-1840"><span class="linenos">1840</span></a>                <span class="s2">&quot;save_path&quot;</span><span class="p">:</span> <span class="n">save_path</span><span class="p">,</span> <span class="s2">&quot;if_exists&quot;</span><span class="p">:</span> <span class="n">if_exists</span><span class="p">})</span>
</span><span id="L-1841"><a href="#L-1841"><span class="linenos">1841</span></a>
</span><span id="L-1842"><a href="#L-1842"><span class="linenos">1842</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-1843"><a href="#L-1843"><span class="linenos">1843</span></a>            <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="L-1844"><a href="#L-1844"><span class="linenos">1844</span></a>                <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
</span><span id="L-1845"><a href="#L-1845"><span class="linenos">1845</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_request_retrieve_file_wrapper</span><span class="p">,</span>
</span><span id="L-1846"><a href="#L-1846"><span class="linenos">1846</span></a>                    <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="L-1847"><a href="#L-1847"><span class="linenos">1847</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="L-1848"><a href="#L-1848"><span class="linenos">1848</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-1849"><a href="#L-1849"><span class="linenos">1849</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="L-1850"><a href="#L-1850"><span class="linenos">1850</span></a>
</span><span id="L-1851"><a href="#L-1851"><span class="linenos">1851</span></a>        <span class="k">return</span> <span class="n">results</span>
</span><span id="L-1852"><a href="#L-1852"><span class="linenos">1852</span></a>
</span><span id="L-1853"><a href="#L-1853"><span class="linenos">1853</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="L-1854"><a href="#L-1854"><span class="linenos">1854</span></a>                      <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1855"><a href="#L-1855"><span class="linenos">1855</span></a>                      <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1856"><a href="#L-1856"><span class="linenos">1856</span></a>                      <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1857"><a href="#L-1857"><span class="linenos">1857</span></a>                      <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="L-1858"><a href="#L-1858"><span class="linenos">1858</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel list request.</span>
</span><span id="L-1859"><a href="#L-1859"><span class="linenos">1859</span></a>
</span><span id="L-1860"><a href="#L-1860"><span class="linenos">1860</span></a><span class="sd">        Args:</span>
</span><span id="L-1861"><a href="#L-1861"><span class="linenos">1861</span></a><span class="sd">            model_class (str):</span>
</span><span id="L-1862"><a href="#L-1862"><span class="linenos">1862</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="L-1863"><a href="#L-1863"><span class="linenos">1863</span></a><span class="sd">            list_args (List[dict]):</span>
</span><span id="L-1864"><a href="#L-1864"><span class="linenos">1864</span></a><span class="sd">                A list of list request args (filter_dict,</span>
</span><span id="L-1865"><a href="#L-1865"><span class="linenos">1865</span></a><span class="sd">                exclude_dict, order_by, fields, default_fields, limit,</span>
</span><span id="L-1866"><a href="#L-1866"><span class="linenos">1866</span></a><span class="sd">                foreign_key_fields).</span>
</span><span id="L-1867"><a href="#L-1867"><span class="linenos">1867</span></a><span class="sd">            n_parallel (int): Number of simultaneus get requests, if not set</span>
</span><span id="L-1868"><a href="#L-1868"><span class="linenos">1868</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-1869"><a href="#L-1869"><span class="linenos">1869</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-1870"><a href="#L-1870"><span class="linenos">1870</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="L-1871"><a href="#L-1871"><span class="linenos">1871</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-1872"><a href="#L-1872"><span class="linenos">1872</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-1873"><a href="#L-1873"><span class="linenos">1873</span></a><span class="sd">            fields (List[str]):</span>
</span><span id="L-1874"><a href="#L-1874"><span class="linenos">1874</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="L-1875"><a href="#L-1875"><span class="linenos">1875</span></a><span class="sd">            default_fields (bool):</span>
</span><span id="L-1876"><a href="#L-1876"><span class="linenos">1876</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="L-1877"><a href="#L-1877"><span class="linenos">1877</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="L-1878"><a href="#L-1878"><span class="linenos">1878</span></a><span class="sd">            limit (int):</span>
</span><span id="L-1879"><a href="#L-1879"><span class="linenos">1879</span></a><span class="sd">                Set the limit of elements of the returned query. By default,</span>
</span><span id="L-1880"><a href="#L-1880"><span class="linenos">1880</span></a><span class="sd">                backend usually return 50 elements.</span>
</span><span id="L-1881"><a href="#L-1881"><span class="linenos">1881</span></a><span class="sd">            foreign_key_fields (bool):</span>
</span><span id="L-1882"><a href="#L-1882"><span class="linenos">1882</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="L-1883"><a href="#L-1883"><span class="linenos">1883</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="L-1884"><a href="#L-1884"><span class="linenos">1884</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="L-1885"><a href="#L-1885"><span class="linenos">1885</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="L-1886"><a href="#L-1886"><span class="linenos">1886</span></a>
</span><span id="L-1887"><a href="#L-1887"><span class="linenos">1887</span></a><span class="sd">        Returns:</span>
</span><span id="L-1888"><a href="#L-1888"><span class="linenos">1888</span></a><span class="sd">            Flatten List of the list request reponses.</span>
</span><span id="L-1889"><a href="#L-1889"><span class="linenos">1889</span></a>
</span><span id="L-1890"><a href="#L-1890"><span class="linenos">1890</span></a><span class="sd">        Raises:</span>
</span><span id="L-1891"><a href="#L-1891"><span class="linenos">1891</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1892"><a href="#L-1892"><span class="linenos">1892</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates that</span>
</span><span id="L-1893"><a href="#L-1893"><span class="linenos">1893</span></a><span class="sd">                lenght of model_class and list_args arguments are not equal.</span>
</span><span id="L-1894"><a href="#L-1894"><span class="linenos">1894</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1895"><a href="#L-1895"><span class="linenos">1895</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1896"><a href="#L-1896"><span class="linenos">1896</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-1897"><a href="#L-1897"><span class="linenos">1897</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-1898"><a href="#L-1898"><span class="linenos">1898</span></a>
</span><span id="L-1899"><a href="#L-1899"><span class="linenos">1899</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1900"><a href="#L-1900"><span class="linenos">1900</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1901"><a href="#L-1901"><span class="linenos">1901</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_list_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="L-1902"><a href="#L-1902"><span class="linenos">1902</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1903"><a href="#L-1903"><span class="linenos">1903</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">):</span>
</span><span id="L-1904"><a href="#L-1904"><span class="linenos">1904</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1905"><a href="#L-1905"><span class="linenos">1905</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">))</span>
</span><span id="L-1906"><a href="#L-1906"><span class="linenos">1906</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1907"><a href="#L-1907"><span class="linenos">1907</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_list_url</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model_class</span><span class="p">]</span>
</span><span id="L-1908"><a href="#L-1908"><span class="linenos">1908</span></a>
</span><span id="L-1909"><a href="#L-1909"><span class="linenos">1909</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_list: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="L-1910"><a href="#L-1910"><span class="linenos">1910</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="L-1911"><a href="#L-1911"><span class="linenos">1911</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="L-1912"><a href="#L-1912"><span class="linenos">1912</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-1913"><a href="#L-1913"><span class="linenos">1913</span></a>
</span><span id="L-1914"><a href="#L-1914"><span class="linenos">1914</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_list_without_pag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="L-1915"><a href="#L-1915"><span class="linenos">1915</span></a>                                  <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="L-1916"><a href="#L-1916"><span class="linenos">1916</span></a>                                  <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1917"><a href="#L-1917"><span class="linenos">1917</span></a>                                  <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-1918"><a href="#L-1918"><span class="linenos">1918</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel list_without_pag request.</span>
</span><span id="L-1919"><a href="#L-1919"><span class="linenos">1919</span></a>
</span><span id="L-1920"><a href="#L-1920"><span class="linenos">1920</span></a><span class="sd">        Args:</span>
</span><span id="L-1921"><a href="#L-1921"><span class="linenos">1921</span></a><span class="sd">            model_class:</span>
</span><span id="L-1922"><a href="#L-1922"><span class="linenos">1922</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="L-1923"><a href="#L-1923"><span class="linenos">1923</span></a><span class="sd">            list_args:</span>
</span><span id="L-1924"><a href="#L-1924"><span class="linenos">1924</span></a><span class="sd">                A list of list request args (filter_dict,</span>
</span><span id="L-1925"><a href="#L-1925"><span class="linenos">1925</span></a><span class="sd">                exclude_dict, order_by, fields, default_fields, limit,</span>
</span><span id="L-1926"><a href="#L-1926"><span class="linenos">1926</span></a><span class="sd">                foreign_key_fields).</span>
</span><span id="L-1927"><a href="#L-1927"><span class="linenos">1927</span></a><span class="sd">            n_parallel (int):</span>
</span><span id="L-1928"><a href="#L-1928"><span class="linenos">1928</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="L-1929"><a href="#L-1929"><span class="linenos">1929</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-1930"><a href="#L-1930"><span class="linenos">1930</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-1931"><a href="#L-1931"><span class="linenos">1931</span></a><span class="sd">            auth_header:</span>
</span><span id="L-1932"><a href="#L-1932"><span class="linenos">1932</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-1933"><a href="#L-1933"><span class="linenos">1933</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-1934"><a href="#L-1934"><span class="linenos">1934</span></a>
</span><span id="L-1935"><a href="#L-1935"><span class="linenos">1935</span></a><span class="sd">        Returns:</span>
</span><span id="L-1936"><a href="#L-1936"><span class="linenos">1936</span></a><span class="sd">            Flatten List of the list request reponses.</span>
</span><span id="L-1937"><a href="#L-1937"><span class="linenos">1937</span></a>
</span><span id="L-1938"><a href="#L-1938"><span class="linenos">1938</span></a><span class="sd">        Raises:</span>
</span><span id="L-1939"><a href="#L-1939"><span class="linenos">1939</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1940"><a href="#L-1940"><span class="linenos">1940</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates that</span>
</span><span id="L-1941"><a href="#L-1941"><span class="linenos">1941</span></a><span class="sd">                lenght of model_class and list_args arguments are not equal.</span>
</span><span id="L-1942"><a href="#L-1942"><span class="linenos">1942</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1943"><a href="#L-1943"><span class="linenos">1943</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1944"><a href="#L-1944"><span class="linenos">1944</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-1945"><a href="#L-1945"><span class="linenos">1945</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-1946"><a href="#L-1946"><span class="linenos">1946</span></a>
</span><span id="L-1947"><a href="#L-1947"><span class="linenos">1947</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-1948"><a href="#L-1948"><span class="linenos">1948</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-1949"><a href="#L-1949"><span class="linenos">1949</span></a>            <span class="n">url_temp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span>
</span><span id="L-1950"><a href="#L-1950"><span class="linenos">1950</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="n">url_temp</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="L-1951"><a href="#L-1951"><span class="linenos">1951</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-1952"><a href="#L-1952"><span class="linenos">1952</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">):</span>
</span><span id="L-1953"><a href="#L-1953"><span class="linenos">1953</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-1954"><a href="#L-1954"><span class="linenos">1954</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">))</span>
</span><span id="L-1955"><a href="#L-1955"><span class="linenos">1955</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-1956"><a href="#L-1956"><span class="linenos">1956</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-1957"><a href="#L-1957"><span class="linenos">1957</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model_class</span><span class="p">]</span>
</span><span id="L-1958"><a href="#L-1958"><span class="linenos">1958</span></a>
</span><span id="L-1959"><a href="#L-1959"><span class="linenos">1959</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_list_without_pag: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="L-1960"><a href="#L-1960"><span class="linenos">1960</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="L-1961"><a href="#L-1961"><span class="linenos">1961</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="L-1962"><a href="#L-1962"><span class="linenos">1962</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-1963"><a href="#L-1963"><span class="linenos">1963</span></a>
</span><span id="L-1964"><a href="#L-1964"><span class="linenos">1964</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_list_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="L-1965"><a href="#L-1965"><span class="linenos">1965</span></a>                          <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-1966"><a href="#L-1966"><span class="linenos">1966</span></a>                          <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-1967"><a href="#L-1967"><span class="linenos">1967</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel list_one request.</span>
</span><span id="L-1968"><a href="#L-1968"><span class="linenos">1968</span></a>
</span><span id="L-1969"><a href="#L-1969"><span class="linenos">1969</span></a><span class="sd">        DEPRECTED user retrieve call with default_fields=True.</span>
</span><span id="L-1970"><a href="#L-1970"><span class="linenos">1970</span></a>
</span><span id="L-1971"><a href="#L-1971"><span class="linenos">1971</span></a><span class="sd">        Args:</span>
</span><span id="L-1972"><a href="#L-1972"><span class="linenos">1972</span></a><span class="sd">            model_class:</span>
</span><span id="L-1973"><a href="#L-1973"><span class="linenos">1973</span></a><span class="sd">                Model Class to list one.</span>
</span><span id="L-1974"><a href="#L-1974"><span class="linenos">1974</span></a><span class="sd">            list_pk:</span>
</span><span id="L-1975"><a href="#L-1975"><span class="linenos">1975</span></a><span class="sd">                List of the pks to list one.</span>
</span><span id="L-1976"><a href="#L-1976"><span class="linenos">1976</span></a><span class="sd">            n_parallel:</span>
</span><span id="L-1977"><a href="#L-1977"><span class="linenos">1977</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="L-1978"><a href="#L-1978"><span class="linenos">1978</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-1979"><a href="#L-1979"><span class="linenos">1979</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-1980"><a href="#L-1980"><span class="linenos">1980</span></a><span class="sd">            auth_header:</span>
</span><span id="L-1981"><a href="#L-1981"><span class="linenos">1981</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-1982"><a href="#L-1982"><span class="linenos">1982</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-1983"><a href="#L-1983"><span class="linenos">1983</span></a>
</span><span id="L-1984"><a href="#L-1984"><span class="linenos">1984</span></a><span class="sd">        Returns:</span>
</span><span id="L-1985"><a href="#L-1985"><span class="linenos">1985</span></a><span class="sd">            List of the list_one request data.</span>
</span><span id="L-1986"><a href="#L-1986"><span class="linenos">1986</span></a>
</span><span id="L-1987"><a href="#L-1987"><span class="linenos">1987</span></a><span class="sd">        Raises:</span>
</span><span id="L-1988"><a href="#L-1988"><span class="linenos">1988</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-1989"><a href="#L-1989"><span class="linenos">1989</span></a><span class="sd">                &#39;len(model_class) != len(list_pk)&#39;. Indicates that lenght</span>
</span><span id="L-1990"><a href="#L-1990"><span class="linenos">1990</span></a><span class="sd">                of model_class and list_pk arguments are not equal.</span>
</span><span id="L-1991"><a href="#L-1991"><span class="linenos">1991</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-1992"><a href="#L-1992"><span class="linenos">1992</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1993"><a href="#L-1993"><span class="linenos">1993</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-1994"><a href="#L-1994"><span class="linenos">1994</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-1995"><a href="#L-1995"><span class="linenos">1995</span></a>
</span><span id="L-1996"><a href="#L-1996"><span class="linenos">1996</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-1997"><a href="#L-1997"><span class="linenos">1997</span></a>            <span class="n">model_class</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)</span>
</span><span id="L-1998"><a href="#L-1998"><span class="linenos">1998</span></a>
</span><span id="L-1999"><a href="#L-1999"><span class="linenos">1999</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="L-2000"><a href="#L-2000"><span class="linenos">2000</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="s1">&#39;len(model_class) != len(list_pk)&#39;</span><span class="p">)</span>
</span><span id="L-2001"><a href="#L-2001"><span class="linenos">2001</span></a>
</span><span id="L-2002"><a href="#L-2002"><span class="linenos">2002</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-2003"><a href="#L-2003"><span class="linenos">2003</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_one_url</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="L-2004"><a href="#L-2004"><span class="linenos">2004</span></a>                                     <span class="n">pk</span><span class="o">=</span><span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-2005"><a href="#L-2005"><span class="linenos">2005</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">))]</span>
</span><span id="L-2006"><a href="#L-2006"><span class="linenos">2006</span></a>
</span><span id="L-2007"><a href="#L-2007"><span class="linenos">2007</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_list_one: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="L-2008"><a href="#L-2008"><span class="linenos">2008</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_request_get</span><span class="p">(</span>
</span><span id="L-2009"><a href="#L-2009"><span class="linenos">2009</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span>
</span><span id="L-2010"><a href="#L-2010"><span class="linenos">2010</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-2011"><a href="#L-2011"><span class="linenos">2011</span></a>
</span><span id="L-2012"><a href="#L-2012"><span class="linenos">2012</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_obj_dict</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="L-2013"><a href="#L-2013"><span class="linenos">2013</span></a>                      <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-2014"><a href="#L-2014"><span class="linenos">2014</span></a>                      <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="L-2015"><a href="#L-2015"><span class="linenos">2015</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel save requests.</span>
</span><span id="L-2016"><a href="#L-2016"><span class="linenos">2016</span></a>
</span><span id="L-2017"><a href="#L-2017"><span class="linenos">2017</span></a><span class="sd">        Args:</span>
</span><span id="L-2018"><a href="#L-2018"><span class="linenos">2018</span></a><span class="sd">            list_obj_dict:</span>
</span><span id="L-2019"><a href="#L-2019"><span class="linenos">2019</span></a><span class="sd">                List of dictionaries containing PumpWood objects</span>
</span><span id="L-2020"><a href="#L-2020"><span class="linenos">2020</span></a><span class="sd">                (must have at least &#39;model_class&#39; key).</span>
</span><span id="L-2021"><a href="#L-2021"><span class="linenos">2021</span></a><span class="sd">            n_parallel:</span>
</span><span id="L-2022"><a href="#L-2022"><span class="linenos">2022</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="L-2023"><a href="#L-2023"><span class="linenos">2023</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-2024"><a href="#L-2024"><span class="linenos">2024</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-2025"><a href="#L-2025"><span class="linenos">2025</span></a><span class="sd">            auth_header:</span>
</span><span id="L-2026"><a href="#L-2026"><span class="linenos">2026</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-2027"><a href="#L-2027"><span class="linenos">2027</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-2028"><a href="#L-2028"><span class="linenos">2028</span></a>
</span><span id="L-2029"><a href="#L-2029"><span class="linenos">2029</span></a><span class="sd">        Returns:</span>
</span><span id="L-2030"><a href="#L-2030"><span class="linenos">2030</span></a><span class="sd">            List of the save request data.</span>
</span><span id="L-2031"><a href="#L-2031"><span class="linenos">2031</span></a>
</span><span id="L-2032"><a href="#L-2032"><span class="linenos">2032</span></a><span class="sd">        Raises:</span>
</span><span id="L-2033"><a href="#L-2033"><span class="linenos">2033</span></a><span class="sd">            No particular raises</span>
</span><span id="L-2034"><a href="#L-2034"><span class="linenos">2034</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2035"><a href="#L-2035"><span class="linenos">2035</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2036"><a href="#L-2036"><span class="linenos">2036</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-2037"><a href="#L-2037"><span class="linenos">2037</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-2038"><a href="#L-2038"><span class="linenos">2038</span></a>
</span><span id="L-2039"><a href="#L-2039"><span class="linenos">2039</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-2040"><a href="#L-2040"><span class="linenos">2040</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_save_url</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;model_class&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">list_obj_dict</span><span class="p">]</span>
</span><span id="L-2041"><a href="#L-2041"><span class="linenos">2041</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_save: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="L-2042"><a href="#L-2042"><span class="linenos">2042</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="L-2043"><a href="#L-2043"><span class="linenos">2043</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_obj_dict</span><span class="p">,</span>
</span><span id="L-2044"><a href="#L-2044"><span class="linenos">2044</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-2045"><a href="#L-2045"><span class="linenos">2045</span></a>
</span><span id="L-2046"><a href="#L-2046"><span class="linenos">2046</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="L-2047"><a href="#L-2047"><span class="linenos">2047</span></a>                        <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-2048"><a href="#L-2048"><span class="linenos">2048</span></a>                        <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-2049"><a href="#L-2049"><span class="linenos">2049</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make many [n_parallel] delete requests.</span>
</span><span id="L-2050"><a href="#L-2050"><span class="linenos">2050</span></a>
</span><span id="L-2051"><a href="#L-2051"><span class="linenos">2051</span></a><span class="sd">        Args:</span>
</span><span id="L-2052"><a href="#L-2052"><span class="linenos">2052</span></a><span class="sd">            model_class:</span>
</span><span id="L-2053"><a href="#L-2053"><span class="linenos">2053</span></a><span class="sd">                Model Class to list one.</span>
</span><span id="L-2054"><a href="#L-2054"><span class="linenos">2054</span></a><span class="sd">            list_pk:</span>
</span><span id="L-2055"><a href="#L-2055"><span class="linenos">2055</span></a><span class="sd">                List of the pks to list one.</span>
</span><span id="L-2056"><a href="#L-2056"><span class="linenos">2056</span></a><span class="sd">            n_parallel:</span>
</span><span id="L-2057"><a href="#L-2057"><span class="linenos">2057</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="L-2058"><a href="#L-2058"><span class="linenos">2058</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-2059"><a href="#L-2059"><span class="linenos">2059</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-2060"><a href="#L-2060"><span class="linenos">2060</span></a><span class="sd">            auth_header:</span>
</span><span id="L-2061"><a href="#L-2061"><span class="linenos">2061</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-2062"><a href="#L-2062"><span class="linenos">2062</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-2063"><a href="#L-2063"><span class="linenos">2063</span></a>
</span><span id="L-2064"><a href="#L-2064"><span class="linenos">2064</span></a><span class="sd">        Returns:</span>
</span><span id="L-2065"><a href="#L-2065"><span class="linenos">2065</span></a><span class="sd">            List of the delete request data.</span>
</span><span id="L-2066"><a href="#L-2066"><span class="linenos">2066</span></a>
</span><span id="L-2067"><a href="#L-2067"><span class="linenos">2067</span></a><span class="sd">        Raises:</span>
</span><span id="L-2068"><a href="#L-2068"><span class="linenos">2068</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-2069"><a href="#L-2069"><span class="linenos">2069</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates</span>
</span><span id="L-2070"><a href="#L-2070"><span class="linenos">2070</span></a><span class="sd">                that length of model_class and list_args arguments are not</span>
</span><span id="L-2071"><a href="#L-2071"><span class="linenos">2071</span></a><span class="sd">                equal.</span>
</span><span id="L-2072"><a href="#L-2072"><span class="linenos">2072</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2073"><a href="#L-2073"><span class="linenos">2073</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2074"><a href="#L-2074"><span class="linenos">2074</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-2075"><a href="#L-2075"><span class="linenos">2075</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-2076"><a href="#L-2076"><span class="linenos">2076</span></a>
</span><span id="L-2077"><a href="#L-2077"><span class="linenos">2077</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-2078"><a href="#L-2078"><span class="linenos">2078</span></a>            <span class="n">model_class</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)</span>
</span><span id="L-2079"><a href="#L-2079"><span class="linenos">2079</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="L-2080"><a href="#L-2080"><span class="linenos">2080</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-2081"><a href="#L-2081"><span class="linenos">2081</span></a>                <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">))</span>
</span><span id="L-2082"><a href="#L-2082"><span class="linenos">2082</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-2083"><a href="#L-2083"><span class="linenos">2083</span></a>
</span><span id="L-2084"><a href="#L-2084"><span class="linenos">2084</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-2085"><a href="#L-2085"><span class="linenos">2085</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_delete_request_url</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="L-2086"><a href="#L-2086"><span class="linenos">2086</span></a>                                           <span class="n">pk</span><span class="o">=</span><span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-2087"><a href="#L-2087"><span class="linenos">2087</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">))]</span>
</span><span id="L-2088"><a href="#L-2088"><span class="linenos">2088</span></a>
</span><span id="L-2089"><a href="#L-2089"><span class="linenos">2089</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_delete: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="L-2090"><a href="#L-2090"><span class="linenos">2090</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_request_get</span><span class="p">(</span>
</span><span id="L-2091"><a href="#L-2091"><span class="linenos">2091</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span>
</span><span id="L-2092"><a href="#L-2092"><span class="linenos">2092</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-2093"><a href="#L-2093"><span class="linenos">2093</span></a>
</span><span id="L-2094"><a href="#L-2094"><span class="linenos">2094</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_delete_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="L-2095"><a href="#L-2095"><span class="linenos">2095</span></a>                             <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-2096"><a href="#L-2096"><span class="linenos">2096</span></a>                             <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="L-2097"><a href="#L-2097"><span class="linenos">2097</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel delete_many request.</span>
</span><span id="L-2098"><a href="#L-2098"><span class="linenos">2098</span></a>
</span><span id="L-2099"><a href="#L-2099"><span class="linenos">2099</span></a><span class="sd">        Args:</span>
</span><span id="L-2100"><a href="#L-2100"><span class="linenos">2100</span></a><span class="sd">            model_class (str):</span>
</span><span id="L-2101"><a href="#L-2101"><span class="linenos">2101</span></a><span class="sd">                Model Class to delete many.</span>
</span><span id="L-2102"><a href="#L-2102"><span class="linenos">2102</span></a><span class="sd">            list_args (list):</span>
</span><span id="L-2103"><a href="#L-2103"><span class="linenos">2103</span></a><span class="sd">                A list of list request args (filter_dict, exclude_dict).</span>
</span><span id="L-2104"><a href="#L-2104"><span class="linenos">2104</span></a><span class="sd">            n_parallel:</span>
</span><span id="L-2105"><a href="#L-2105"><span class="linenos">2105</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="L-2106"><a href="#L-2106"><span class="linenos">2106</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-2107"><a href="#L-2107"><span class="linenos">2107</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-2108"><a href="#L-2108"><span class="linenos">2108</span></a><span class="sd">            auth_header:</span>
</span><span id="L-2109"><a href="#L-2109"><span class="linenos">2109</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-2110"><a href="#L-2110"><span class="linenos">2110</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-2111"><a href="#L-2111"><span class="linenos">2111</span></a>
</span><span id="L-2112"><a href="#L-2112"><span class="linenos">2112</span></a><span class="sd">        Returns:</span>
</span><span id="L-2113"><a href="#L-2113"><span class="linenos">2113</span></a><span class="sd">            List of the delete many request reponses.</span>
</span><span id="L-2114"><a href="#L-2114"><span class="linenos">2114</span></a>
</span><span id="L-2115"><a href="#L-2115"><span class="linenos">2115</span></a><span class="sd">        Raises:</span>
</span><span id="L-2116"><a href="#L-2116"><span class="linenos">2116</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-2117"><a href="#L-2117"><span class="linenos">2117</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates</span>
</span><span id="L-2118"><a href="#L-2118"><span class="linenos">2118</span></a><span class="sd">                that length of model_class and list_args arguments</span>
</span><span id="L-2119"><a href="#L-2119"><span class="linenos">2119</span></a><span class="sd">                are not equal.</span>
</span><span id="L-2120"><a href="#L-2120"><span class="linenos">2120</span></a>
</span><span id="L-2121"><a href="#L-2121"><span class="linenos">2121</span></a><span class="sd">        Example:</span>
</span><span id="L-2122"><a href="#L-2122"><span class="linenos">2122</span></a><span class="sd">            No example yet.</span>
</span><span id="L-2123"><a href="#L-2123"><span class="linenos">2123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2124"><a href="#L-2124"><span class="linenos">2124</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2125"><a href="#L-2125"><span class="linenos">2125</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-2126"><a href="#L-2126"><span class="linenos">2126</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-2127"><a href="#L-2127"><span class="linenos">2127</span></a>
</span><span id="L-2128"><a href="#L-2128"><span class="linenos">2128</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2129"><a href="#L-2129"><span class="linenos">2129</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-2130"><a href="#L-2130"><span class="linenos">2130</span></a>            <span class="n">url_temp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_delete_many_request_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span>
</span><span id="L-2131"><a href="#L-2131"><span class="linenos">2131</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="n">url_temp</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="L-2132"><a href="#L-2132"><span class="linenos">2132</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2133"><a href="#L-2133"><span class="linenos">2133</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">):</span>
</span><span id="L-2134"><a href="#L-2134"><span class="linenos">2134</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="L-2135"><a href="#L-2135"><span class="linenos">2135</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">))</span>
</span><span id="L-2136"><a href="#L-2136"><span class="linenos">2136</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="L-2137"><a href="#L-2137"><span class="linenos">2137</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-2138"><a href="#L-2138"><span class="linenos">2138</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model_class</span><span class="p">]</span>
</span><span id="L-2139"><a href="#L-2139"><span class="linenos">2139</span></a>
</span><span id="L-2140"><a href="#L-2140"><span class="linenos">2140</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_delete_many: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="L-2141"><a href="#L-2141"><span class="linenos">2141</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="L-2142"><a href="#L-2142"><span class="linenos">2142</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="L-2143"><a href="#L-2143"><span class="linenos">2143</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-2144"><a href="#L-2144"><span class="linenos">2144</span></a>
</span><span id="L-2145"><a href="#L-2145"><span class="linenos">2145</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_execute_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="L-2146"><a href="#L-2146"><span class="linenos">2146</span></a>                                <span class="n">pk</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
</span><span id="L-2147"><a href="#L-2147"><span class="linenos">2147</span></a>                                <span class="n">action</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="L-2148"><a href="#L-2148"><span class="linenos">2148</span></a>                                <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="L-2149"><a href="#L-2149"><span class="linenos">2149</span></a>                                <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-2150"><a href="#L-2150"><span class="linenos">2150</span></a>                                <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="L-2151"><a href="#L-2151"><span class="linenos">2151</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel execute_action requests.</span>
</span><span id="L-2152"><a href="#L-2152"><span class="linenos">2152</span></a>
</span><span id="L-2153"><a href="#L-2153"><span class="linenos">2153</span></a><span class="sd">        Args:</span>
</span><span id="L-2154"><a href="#L-2154"><span class="linenos">2154</span></a><span class="sd">            model_class:</span>
</span><span id="L-2155"><a href="#L-2155"><span class="linenos">2155</span></a><span class="sd">                Model Class to perform action over,</span>
</span><span id="L-2156"><a href="#L-2156"><span class="linenos">2156</span></a><span class="sd">                or a list of model class o make diferent actions.</span>
</span><span id="L-2157"><a href="#L-2157"><span class="linenos">2157</span></a><span class="sd">            pk:</span>
</span><span id="L-2158"><a href="#L-2158"><span class="linenos">2158</span></a><span class="sd">                A list of the pks to perform action or a</span>
</span><span id="L-2159"><a href="#L-2159"><span class="linenos">2159</span></a><span class="sd">                single pk to perform action with different paraemters.</span>
</span><span id="L-2160"><a href="#L-2160"><span class="linenos">2160</span></a><span class="sd">            action:</span>
</span><span id="L-2161"><a href="#L-2161"><span class="linenos">2161</span></a><span class="sd">                A list of actions to perform or a single</span>
</span><span id="L-2162"><a href="#L-2162"><span class="linenos">2162</span></a><span class="sd">                action to perform over all pks and parameters.</span>
</span><span id="L-2163"><a href="#L-2163"><span class="linenos">2163</span></a><span class="sd">            parameters:</span>
</span><span id="L-2164"><a href="#L-2164"><span class="linenos">2164</span></a><span class="sd">                Parameters used to perform actions</span>
</span><span id="L-2165"><a href="#L-2165"><span class="linenos">2165</span></a><span class="sd">                or a single dict to be used in all actions.</span>
</span><span id="L-2166"><a href="#L-2166"><span class="linenos">2166</span></a><span class="sd">            n_parallel:</span>
</span><span id="L-2167"><a href="#L-2167"><span class="linenos">2167</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="L-2168"><a href="#L-2168"><span class="linenos">2168</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-2169"><a href="#L-2169"><span class="linenos">2169</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-2170"><a href="#L-2170"><span class="linenos">2170</span></a><span class="sd">            auth_header:</span>
</span><span id="L-2171"><a href="#L-2171"><span class="linenos">2171</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-2172"><a href="#L-2172"><span class="linenos">2172</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-2173"><a href="#L-2173"><span class="linenos">2173</span></a>
</span><span id="L-2174"><a href="#L-2174"><span class="linenos">2174</span></a><span class="sd">        Returns:</span>
</span><span id="L-2175"><a href="#L-2175"><span class="linenos">2175</span></a><span class="sd">            List of the execute_action request data.</span>
</span><span id="L-2176"><a href="#L-2176"><span class="linenos">2176</span></a>
</span><span id="L-2177"><a href="#L-2177"><span class="linenos">2177</span></a><span class="sd">        Raises:</span>
</span><span id="L-2178"><a href="#L-2178"><span class="linenos">2178</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="L-2179"><a href="#L-2179"><span class="linenos">2179</span></a><span class="sd">                &#39;parallel_length != len([argument])&#39;. Indicates that function</span>
</span><span id="L-2180"><a href="#L-2180"><span class="linenos">2180</span></a><span class="sd">                arguments does not have all the same lenght.</span>
</span><span id="L-2181"><a href="#L-2181"><span class="linenos">2181</span></a>
</span><span id="L-2182"><a href="#L-2182"><span class="linenos">2182</span></a><span class="sd">        Example:</span>
</span><span id="L-2183"><a href="#L-2183"><span class="linenos">2183</span></a><span class="sd">            No example yet.</span>
</span><span id="L-2184"><a href="#L-2184"><span class="linenos">2184</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2185"><a href="#L-2185"><span class="linenos">2185</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2186"><a href="#L-2186"><span class="linenos">2186</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-2187"><a href="#L-2187"><span class="linenos">2187</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-2188"><a href="#L-2188"><span class="linenos">2188</span></a>
</span><span id="L-2189"><a href="#L-2189"><span class="linenos">2189</span></a>        <span class="n">parallel_length</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-2190"><a href="#L-2190"><span class="linenos">2190</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-2191"><a href="#L-2191"><span class="linenos">2191</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2192"><a href="#L-2192"><span class="linenos">2192</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">):</span>
</span><span id="L-2193"><a href="#L-2193"><span class="linenos">2193</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="L-2194"><a href="#L-2194"><span class="linenos">2194</span></a>                        <span class="s1">&#39;parallel_length != len(model_class)&#39;</span><span class="p">)</span>
</span><span id="L-2195"><a href="#L-2195"><span class="linenos">2195</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2196"><a href="#L-2196"><span class="linenos">2196</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="L-2197"><a href="#L-2197"><span class="linenos">2197</span></a>
</span><span id="L-2198"><a href="#L-2198"><span class="linenos">2198</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-2199"><a href="#L-2199"><span class="linenos">2199</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2200"><a href="#L-2200"><span class="linenos">2200</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pk</span><span class="p">):</span>
</span><span id="L-2201"><a href="#L-2201"><span class="linenos">2201</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="L-2202"><a href="#L-2202"><span class="linenos">2202</span></a>                        <span class="s1">&#39;parallel_length != len(pk)&#39;</span><span class="p">)</span>
</span><span id="L-2203"><a href="#L-2203"><span class="linenos">2203</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2204"><a href="#L-2204"><span class="linenos">2204</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span>
</span><span id="L-2205"><a href="#L-2205"><span class="linenos">2205</span></a>
</span><span id="L-2206"><a href="#L-2206"><span class="linenos">2206</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-2207"><a href="#L-2207"><span class="linenos">2207</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2208"><a href="#L-2208"><span class="linenos">2208</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">action</span><span class="p">):</span>
</span><span id="L-2209"><a href="#L-2209"><span class="linenos">2209</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="L-2210"><a href="#L-2210"><span class="linenos">2210</span></a>                        <span class="s1">&#39;parallel_length != len(action)&#39;</span><span class="p">)</span>
</span><span id="L-2211"><a href="#L-2211"><span class="linenos">2211</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2212"><a href="#L-2212"><span class="linenos">2212</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</span><span id="L-2213"><a href="#L-2213"><span class="linenos">2213</span></a>
</span><span id="L-2214"><a href="#L-2214"><span class="linenos">2214</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-2215"><a href="#L-2215"><span class="linenos">2215</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2216"><a href="#L-2216"><span class="linenos">2216</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">):</span>
</span><span id="L-2217"><a href="#L-2217"><span class="linenos">2217</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="L-2218"><a href="#L-2218"><span class="linenos">2218</span></a>                        <span class="s1">&#39;parallel_length != len(parameters)&#39;</span><span class="p">)</span>
</span><span id="L-2219"><a href="#L-2219"><span class="linenos">2219</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-2220"><a href="#L-2220"><span class="linenos">2220</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
</span><span id="L-2221"><a href="#L-2221"><span class="linenos">2221</span></a>
</span><span id="L-2222"><a href="#L-2222"><span class="linenos">2222</span></a>        <span class="n">model_class</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-2223"><a href="#L-2223"><span class="linenos">2223</span></a>            <span class="n">model_class</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="L-2224"><a href="#L-2224"><span class="linenos">2224</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="L-2225"><a href="#L-2225"><span class="linenos">2225</span></a>        <span class="n">pk</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-2226"><a href="#L-2226"><span class="linenos">2226</span></a>            <span class="n">pk</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="L-2227"><a href="#L-2227"><span class="linenos">2227</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">pk</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="L-2228"><a href="#L-2228"><span class="linenos">2228</span></a>        <span class="n">action</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-2229"><a href="#L-2229"><span class="linenos">2229</span></a>            <span class="n">action</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="L-2230"><a href="#L-2230"><span class="linenos">2230</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">action</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="L-2231"><a href="#L-2231"><span class="linenos">2231</span></a>        <span class="n">parameters</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="L-2232"><a href="#L-2232"><span class="linenos">2232</span></a>            <span class="n">parameters</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="L-2233"><a href="#L-2233"><span class="linenos">2233</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">parameters</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="L-2234"><a href="#L-2234"><span class="linenos">2234</span></a>
</span><span id="L-2235"><a href="#L-2235"><span class="linenos">2235</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-2236"><a href="#L-2236"><span class="linenos">2236</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_execute_action_url</span><span class="p">(</span>
</span><span id="L-2237"><a href="#L-2237"><span class="linenos">2237</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="L-2238"><a href="#L-2238"><span class="linenos">2238</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">parallel_length</span><span class="p">)]</span>
</span><span id="L-2239"><a href="#L-2239"><span class="linenos">2239</span></a>
</span><span id="L-2240"><a href="#L-2240"><span class="linenos">2240</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_execute_action: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="L-2241"><a href="#L-2241"><span class="linenos">2241</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="L-2242"><a href="#L-2242"><span class="linenos">2242</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
</span><span id="L-2243"><a href="#L-2243"><span class="linenos">2243</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-2244"><a href="#L-2244"><span class="linenos">2244</span></a>
</span><span id="L-2245"><a href="#L-2245"><span class="linenos">2245</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_bulk_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-2246"><a href="#L-2246"><span class="linenos">2246</span></a>                           <span class="n">data_to_save</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]],</span>
</span><span id="L-2247"><a href="#L-2247"><span class="linenos">2247</span></a>                           <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
</span><span id="L-2248"><a href="#L-2248"><span class="linenos">2248</span></a>                           <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-2249"><a href="#L-2249"><span class="linenos">2249</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Break data_to_save in many parallel bulk_save requests.</span>
</span><span id="L-2250"><a href="#L-2250"><span class="linenos">2250</span></a>
</span><span id="L-2251"><a href="#L-2251"><span class="linenos">2251</span></a><span class="sd">        Args:</span>
</span><span id="L-2252"><a href="#L-2252"><span class="linenos">2252</span></a><span class="sd">            model_class:</span>
</span><span id="L-2253"><a href="#L-2253"><span class="linenos">2253</span></a><span class="sd">                Model class of the data that will be saved.</span>
</span><span id="L-2254"><a href="#L-2254"><span class="linenos">2254</span></a><span class="sd">            data_to_save:</span>
</span><span id="L-2255"><a href="#L-2255"><span class="linenos">2255</span></a><span class="sd">                Data that will be saved</span>
</span><span id="L-2256"><a href="#L-2256"><span class="linenos">2256</span></a><span class="sd">            chunksize:</span>
</span><span id="L-2257"><a href="#L-2257"><span class="linenos">2257</span></a><span class="sd">                Length of each parallel bulk save chunk.</span>
</span><span id="L-2258"><a href="#L-2258"><span class="linenos">2258</span></a><span class="sd">            n_parallel:</span>
</span><span id="L-2259"><a href="#L-2259"><span class="linenos">2259</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="L-2260"><a href="#L-2260"><span class="linenos">2260</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-2261"><a href="#L-2261"><span class="linenos">2261</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-2262"><a href="#L-2262"><span class="linenos">2262</span></a><span class="sd">            auth_header:</span>
</span><span id="L-2263"><a href="#L-2263"><span class="linenos">2263</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-2264"><a href="#L-2264"><span class="linenos">2264</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-2265"><a href="#L-2265"><span class="linenos">2265</span></a>
</span><span id="L-2266"><a href="#L-2266"><span class="linenos">2266</span></a><span class="sd">        Returns:</span>
</span><span id="L-2267"><a href="#L-2267"><span class="linenos">2267</span></a><span class="sd">            List of the responses of bulk_save.</span>
</span><span id="L-2268"><a href="#L-2268"><span class="linenos">2268</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2269"><a href="#L-2269"><span class="linenos">2269</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2270"><a href="#L-2270"><span class="linenos">2270</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-2271"><a href="#L-2271"><span class="linenos">2271</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-2272"><a href="#L-2272"><span class="linenos">2272</span></a>
</span><span id="L-2273"><a href="#L-2273"><span class="linenos">2273</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data_to_save</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="L-2274"><a href="#L-2274"><span class="linenos">2274</span></a>            <span class="n">data_to_save</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_to_save</span><span class="p">)</span>
</span><span id="L-2275"><a href="#L-2275"><span class="linenos">2275</span></a>
</span><span id="L-2276"><a href="#L-2276"><span class="linenos">2276</span></a>        <span class="n">chunks</span> <span class="o">=</span> <span class="n">break_in_chunks</span><span class="p">(</span><span class="n">df_to_break</span><span class="o">=</span><span class="n">data_to_save</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">)</span>
</span><span id="L-2277"><a href="#L-2277"><span class="linenos">2277</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_bulk_save_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="L-2278"><a href="#L-2278"><span class="linenos">2278</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">url</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>
</span><span id="L-2279"><a href="#L-2279"><span class="linenos">2279</span></a>
</span><span id="L-2280"><a href="#L-2280"><span class="linenos">2280</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_bulk_save: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="L-2281"><a href="#L-2281"><span class="linenos">2281</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="L-2282"><a href="#L-2282"><span class="linenos">2282</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
</span><span id="L-2283"><a href="#L-2283"><span class="linenos">2283</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-2284"><a href="#L-2284"><span class="linenos">2284</span></a>
</span><span id="L-2285"><a href="#L-2285"><span class="linenos">2285</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_pivot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="L-2286"><a href="#L-2286"><span class="linenos">2286</span></a>                       <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-2287"><a href="#L-2287"><span class="linenos">2287</span></a>                       <span class="n">variables</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-2288"><a href="#L-2288"><span class="linenos">2288</span></a>                       <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="L-2289"><a href="#L-2289"><span class="linenos">2289</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel pivot request.</span>
</span><span id="L-2290"><a href="#L-2290"><span class="linenos">2290</span></a>
</span><span id="L-2291"><a href="#L-2291"><span class="linenos">2291</span></a><span class="sd">        Args:</span>
</span><span id="L-2292"><a href="#L-2292"><span class="linenos">2292</span></a><span class="sd">            model_class:</span>
</span><span id="L-2293"><a href="#L-2293"><span class="linenos">2293</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="L-2294"><a href="#L-2294"><span class="linenos">2294</span></a><span class="sd">            list_args:</span>
</span><span id="L-2295"><a href="#L-2295"><span class="linenos">2295</span></a><span class="sd">                A list of list request args (filter_dict,exclude_dict,</span>
</span><span id="L-2296"><a href="#L-2296"><span class="linenos">2296</span></a><span class="sd">                order_by).</span>
</span><span id="L-2297"><a href="#L-2297"><span class="linenos">2297</span></a><span class="sd">            columns:</span>
</span><span id="L-2298"><a href="#L-2298"><span class="linenos">2298</span></a><span class="sd">                List of columns at the pivoted table.</span>
</span><span id="L-2299"><a href="#L-2299"><span class="linenos">2299</span></a><span class="sd">            format:</span>
</span><span id="L-2300"><a href="#L-2300"><span class="linenos">2300</span></a><span class="sd">                Format of returned table. See pandas.DataFrame</span>
</span><span id="L-2301"><a href="#L-2301"><span class="linenos">2301</span></a><span class="sd">                to_dict args.</span>
</span><span id="L-2302"><a href="#L-2302"><span class="linenos">2302</span></a><span class="sd">            n_parallel:</span>
</span><span id="L-2303"><a href="#L-2303"><span class="linenos">2303</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="L-2304"><a href="#L-2304"><span class="linenos">2304</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="L-2305"><a href="#L-2305"><span class="linenos">2305</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="L-2306"><a href="#L-2306"><span class="linenos">2306</span></a><span class="sd">            variables:</span>
</span><span id="L-2307"><a href="#L-2307"><span class="linenos">2307</span></a><span class="sd">                Restrict the fields that will be returned at the query.</span>
</span><span id="L-2308"><a href="#L-2308"><span class="linenos">2308</span></a><span class="sd">            show_deleted:</span>
</span><span id="L-2309"><a href="#L-2309"><span class="linenos">2309</span></a><span class="sd">                If results should include data with deleted=True. This will</span>
</span><span id="L-2310"><a href="#L-2310"><span class="linenos">2310</span></a><span class="sd">                be ignored if model class does not have deleted field.</span>
</span><span id="L-2311"><a href="#L-2311"><span class="linenos">2311</span></a><span class="sd">            auth_header:</span>
</span><span id="L-2312"><a href="#L-2312"><span class="linenos">2312</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="L-2313"><a href="#L-2313"><span class="linenos">2313</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="L-2314"><a href="#L-2314"><span class="linenos">2314</span></a>
</span><span id="L-2315"><a href="#L-2315"><span class="linenos">2315</span></a><span class="sd">        Returns:</span>
</span><span id="L-2316"><a href="#L-2316"><span class="linenos">2316</span></a><span class="sd">            List of the pivot request reponses.</span>
</span><span id="L-2317"><a href="#L-2317"><span class="linenos">2317</span></a>
</span><span id="L-2318"><a href="#L-2318"><span class="linenos">2318</span></a><span class="sd">        Raises:</span>
</span><span id="L-2319"><a href="#L-2319"><span class="linenos">2319</span></a><span class="sd">            No particular raises.</span>
</span><span id="L-2320"><a href="#L-2320"><span class="linenos">2320</span></a>
</span><span id="L-2321"><a href="#L-2321"><span class="linenos">2321</span></a><span class="sd">        Example:</span>
</span><span id="L-2322"><a href="#L-2322"><span class="linenos">2322</span></a><span class="sd">            No example yet.</span>
</span><span id="L-2323"><a href="#L-2323"><span class="linenos">2323</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-2324"><a href="#L-2324"><span class="linenos">2324</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2325"><a href="#L-2325"><span class="linenos">2325</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="L-2326"><a href="#L-2326"><span class="linenos">2326</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="L-2327"><a href="#L-2327"><span class="linenos">2327</span></a>
</span><span id="L-2328"><a href="#L-2328"><span class="linenos">2328</span></a>        <span class="n">url_temp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_pivot_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span>
</span><span id="L-2329"><a href="#L-2329"><span class="linenos">2329</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="n">url_temp</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="L-2330"><a href="#L-2330"><span class="linenos">2330</span></a>        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">list_args</span><span class="p">:</span>
</span><span id="L-2331"><a href="#L-2331"><span class="linenos">2331</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">variables</span>
</span><span id="L-2332"><a href="#L-2332"><span class="linenos">2332</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;show_deleted&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">show_deleted</span>
</span><span id="L-2333"><a href="#L-2333"><span class="linenos">2333</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">columns</span>
</span><span id="L-2334"><a href="#L-2334"><span class="linenos">2334</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">format</span>
</span><span id="L-2335"><a href="#L-2335"><span class="linenos">2335</span></a>
</span><span id="L-2336"><a href="#L-2336"><span class="linenos">2336</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_pivot: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="L-2337"><a href="#L-2337"><span class="linenos">2337</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="L-2338"><a href="#L-2338"><span class="linenos">2338</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="L-2339"><a href="#L-2339"><span class="linenos">2339</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="L-2340"><a href="#L-2340"><span class="linenos">2340</span></a>
</span><span id="L-2341"><a href="#L-2341"><span class="linenos">2341</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_queue_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queue_pk</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-2342"><a href="#L-2342"><span class="linenos">2342</span></a>                         <span class="n">save_as_excel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-2343"><a href="#L-2343"><span class="linenos">2343</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Download model queue estimation matrix. In development...&quot;&quot;&quot;</span>
</span><span id="L-2344"><a href="#L-2344"><span class="linenos">2344</span></a>        <span class="n">file_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_file</span><span class="p">(</span>
</span><span id="L-2345"><a href="#L-2345"><span class="linenos">2345</span></a>            <span class="n">model_class</span><span class="o">=</span><span class="s2">&quot;ModelQueue&quot;</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">queue_pk</span><span class="p">,</span>
</span><span id="L-2346"><a href="#L-2346"><span class="linenos">2346</span></a>            <span class="n">file_field</span><span class="o">=</span><span class="s2">&quot;model_matrix_file&quot;</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">,</span>
</span><span id="L-2347"><a href="#L-2347"><span class="linenos">2347</span></a>            <span class="n">save_file</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-2348"><a href="#L-2348"><span class="linenos">2348</span></a>        <span class="n">content</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">GzipFile</span><span class="p">(</span>
</span><span id="L-2349"><a href="#L-2349"><span class="linenos">2349</span></a>            <span class="n">fileobj</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">file_content</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="L-2350"><a href="#L-2350"><span class="linenos">2350</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="L-2351"><a href="#L-2351"><span class="linenos">2351</span></a>        <span class="n">columns_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;columns_info&quot;</span><span class="p">])</span>
</span><span id="L-2352"><a href="#L-2352"><span class="linenos">2352</span></a>        <span class="n">model_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;model_matrix&quot;</span><span class="p">])</span>
</span><span id="L-2353"><a href="#L-2353"><span class="linenos">2353</span></a>
</span><span id="L-2354"><a href="#L-2354"><span class="linenos">2354</span></a>        <span class="k">if</span> <span class="n">save_as_excel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-2355"><a href="#L-2355"><span class="linenos">2355</span></a>            <span class="n">writer</span> <span class="o">=</span> <span class="n">ExcelWriter</span><span class="p">(</span><span class="n">save_as_excel</span><span class="p">)</span>
</span><span id="L-2356"><a href="#L-2356"><span class="linenos">2356</span></a>            <span class="n">columns_info</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="s1">&#39;columns_info&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-2357"><a href="#L-2357"><span class="linenos">2357</span></a>            <span class="n">model_matrix</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="s1">&#39;model_matrix&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-2358"><a href="#L-2358"><span class="linenos">2358</span></a>            <span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="L-2359"><a href="#L-2359"><span class="linenos">2359</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-2360"><a href="#L-2360"><span class="linenos">2360</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="L-2361"><a href="#L-2361"><span class="linenos">2361</span></a>                <span class="s2">&quot;columns_info&quot;</span><span class="p">:</span> <span class="n">columns_info</span><span class="p">,</span>
</span><span id="L-2362"><a href="#L-2362"><span class="linenos">2362</span></a>                <span class="s2">&quot;model_matrix&quot;</span><span class="p">:</span> <span class="n">model_matrix</span><span class="p">}</span>
</span></pre></div>


            </section>
                <section id="break_in_chunks">
                            <input id="break_in_chunks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">break_in_chunks</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">df_to_break</span><span class="p">:</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>,</span><span class="param">	<span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="break_in_chunks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#break_in_chunks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="break_in_chunks-40"><a href="#break_in_chunks-40"><span class="linenos">40</span></a><span class="k">def</span><span class="w"> </span><span class="nf">break_in_chunks</span><span class="p">(</span><span class="n">df_to_break</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
</span><span id="break_in_chunks-41"><a href="#break_in_chunks-41"><span class="linenos">41</span></a>                    <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="break_in_chunks-42"><a href="#break_in_chunks-42"><span class="linenos">42</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Break a dataframe in chunks of chunksize.</span>
</span><span id="break_in_chunks-43"><a href="#break_in_chunks-43"><span class="linenos">43</span></a>
</span><span id="break_in_chunks-44"><a href="#break_in_chunks-44"><span class="linenos">44</span></a><span class="sd">    Args:</span>
</span><span id="break_in_chunks-45"><a href="#break_in_chunks-45"><span class="linenos">45</span></a><span class="sd">        df_to_break: Dataframe to be break in chunks of `chunksize` size.</span>
</span><span id="break_in_chunks-46"><a href="#break_in_chunks-46"><span class="linenos">46</span></a><span class="sd">        chunksize: Length of each chuck of the breaks of `df_to_break`.</span>
</span><span id="break_in_chunks-47"><a href="#break_in_chunks-47"><span class="linenos">47</span></a>
</span><span id="break_in_chunks-48"><a href="#break_in_chunks-48"><span class="linenos">48</span></a><span class="sd">    Returns:</span>
</span><span id="break_in_chunks-49"><a href="#break_in_chunks-49"><span class="linenos">49</span></a><span class="sd">        Return a list dataframes with lenght chunksize of data from</span>
</span><span id="break_in_chunks-50"><a href="#break_in_chunks-50"><span class="linenos">50</span></a><span class="sd">        `df_to_break`.</span>
</span><span id="break_in_chunks-51"><a href="#break_in_chunks-51"><span class="linenos">51</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="break_in_chunks-52"><a href="#break_in_chunks-52"><span class="linenos">52</span></a>    <span class="n">to_return</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
</span><span id="break_in_chunks-53"><a href="#break_in_chunks-53"><span class="linenos">53</span></a>    <span class="k">for</span> <span class="n">g</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">df_to_break</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_to_break</span><span class="p">))</span> <span class="o">//</span> <span class="n">chunksize</span><span class="p">):</span>
</span><span id="break_in_chunks-54"><a href="#break_in_chunks-54"><span class="linenos">54</span></a>        <span class="n">to_return</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="break_in_chunks-55"><a href="#break_in_chunks-55"><span class="linenos">55</span></a>    <span class="k">return</span> <span class="n">to_return</span>
</span></pre></div>


            <div class="docstring"><p>Break a dataframe in chunks of chunksize.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>df_to_break:</strong>  Dataframe to be break in chunks of <code>chunksize</code> size.</li>
<li><strong>chunksize:</strong>  Length of each chuck of the breaks of <code>df_to_break</code>.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Return a list dataframes with lenght chunksize of data from
  <code>df_to_break</code>.</p>
</blockquote>
</div>


                </section>
                <section id="PumpWoodMicroService">
                            <input id="PumpWoodMicroService-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PumpWoodMicroService</span><wbr>(<span class="base">pumpwood_communication.microservice_abc.simple.permission.ABCPermissionMicroservice</span>, <span class="base">pumpwood_communication.microservice_abc.simple.batch.ABCSimpleBatchMicroservice</span>, <span class="base">pumpwood_communication.microservice_abc.simple.retrieve.ABCSimpleRetriveMicroservice</span>, <span class="base">pumpwood_communication.microservice_abc.simple.delete.ABCSimpleDeleteMicroservice</span>, <span class="base">pumpwood_communication.microservice_abc.simple.save.ABCSimpleSaveMicroservice</span>):

                <label class="view-source-button" for="PumpWoodMicroService-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService-58"><a href="#PumpWoodMicroService-58"><span class="linenos">  58</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PumpWoodMicroService</span><span class="p">(</span><span class="n">ABCPermissionMicroservice</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-59"><a href="#PumpWoodMicroService-59"><span class="linenos">  59</span></a>                           <span class="n">ABCSimpleBatchMicroservice</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-60"><a href="#PumpWoodMicroService-60"><span class="linenos">  60</span></a>                           <span class="n">ABCSimpleRetriveMicroservice</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-61"><a href="#PumpWoodMicroService-61"><span class="linenos">  61</span></a>                           <span class="n">ABCSimpleDeleteMicroservice</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-62"><a href="#PumpWoodMicroService-62"><span class="linenos">  62</span></a>                           <span class="n">ABCSimpleSaveMicroservice</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-63"><a href="#PumpWoodMicroService-63"><span class="linenos">  63</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Class to define an inter-pumpwood MicroService.</span>
</span><span id="PumpWoodMicroService-64"><a href="#PumpWoodMicroService-64"><span class="linenos">  64</span></a>
</span><span id="PumpWoodMicroService-65"><a href="#PumpWoodMicroService-65"><span class="linenos">  65</span></a><span class="sd">    Create an object ot help communication with Pumpwood based backends. It</span>
</span><span id="PumpWoodMicroService-66"><a href="#PumpWoodMicroService-66"><span class="linenos">  66</span></a><span class="sd">    manage login and token refresh if necessary.</span>
</span><span id="PumpWoodMicroService-67"><a href="#PumpWoodMicroService-67"><span class="linenos">  67</span></a>
</span><span id="PumpWoodMicroService-68"><a href="#PumpWoodMicroService-68"><span class="linenos">  68</span></a><span class="sd">    It also implements parallel functions that split requests in parallel</span>
</span><span id="PumpWoodMicroService-69"><a href="#PumpWoodMicroService-69"><span class="linenos">  69</span></a><span class="sd">    process to reduce processing time.</span>
</span><span id="PumpWoodMicroService-70"><a href="#PumpWoodMicroService-70"><span class="linenos">  70</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-71"><a href="#PumpWoodMicroService-71"><span class="linenos">  71</span></a>
</span><span id="PumpWoodMicroService-72"><a href="#PumpWoodMicroService-72"><span class="linenos">  72</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_registered_routes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-73"><a href="#PumpWoodMicroService-73"><span class="linenos">  73</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List routes that have been registed at Kong.&quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-74"><a href="#PumpWoodMicroService-74"><span class="linenos">  74</span></a>        <span class="n">list_url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/routes/&#39;</span>
</span><span id="PumpWoodMicroService-75"><a href="#PumpWoodMicroService-75"><span class="linenos">  75</span></a>        <span class="n">routes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-76"><a href="#PumpWoodMicroService-76"><span class="linenos">  76</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-77"><a href="#PumpWoodMicroService-77"><span class="linenos">  77</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">routes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="PumpWoodMicroService-78"><a href="#PumpWoodMicroService-78"><span class="linenos">  78</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-79"><a href="#PumpWoodMicroService-79"><span class="linenos">  79</span></a>        <span class="k">return</span> <span class="n">routes</span>
</span><span id="PumpWoodMicroService-80"><a href="#PumpWoodMicroService-80"><span class="linenos">  80</span></a>
</span><span id="PumpWoodMicroService-81"><a href="#PumpWoodMicroService-81"><span class="linenos">  81</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_microservice_registered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">microservice</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-82"><a href="#PumpWoodMicroService-82"><span class="linenos">  82</span></a>                                   <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-83"><a href="#PumpWoodMicroService-83"><span class="linenos">  83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a microservice (kong service) is registered at Kong.</span>
</span><span id="PumpWoodMicroService-84"><a href="#PumpWoodMicroService-84"><span class="linenos">  84</span></a>
</span><span id="PumpWoodMicroService-85"><a href="#PumpWoodMicroService-85"><span class="linenos">  85</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-86"><a href="#PumpWoodMicroService-86"><span class="linenos">  86</span></a><span class="sd">            microservice (str):</span>
</span><span id="PumpWoodMicroService-87"><a href="#PumpWoodMicroService-87"><span class="linenos">  87</span></a><span class="sd">                Service associated with microservice registered on</span>
</span><span id="PumpWoodMicroService-88"><a href="#PumpWoodMicroService-88"><span class="linenos">  88</span></a><span class="sd">                Pumpwood Kong.</span>
</span><span id="PumpWoodMicroService-89"><a href="#PumpWoodMicroService-89"><span class="linenos">  89</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="PumpWoodMicroService-90"><a href="#PumpWoodMicroService-90"><span class="linenos">  90</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-91"><a href="#PumpWoodMicroService-91"><span class="linenos">  91</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-92"><a href="#PumpWoodMicroService-92"><span class="linenos">  92</span></a>
</span><span id="PumpWoodMicroService-93"><a href="#PumpWoodMicroService-93"><span class="linenos">  93</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-94"><a href="#PumpWoodMicroService-94"><span class="linenos">  94</span></a><span class="sd">            Return true if microservice is registered.</span>
</span><span id="PumpWoodMicroService-95"><a href="#PumpWoodMicroService-95"><span class="linenos">  95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-96"><a href="#PumpWoodMicroService-96"><span class="linenos">  96</span></a>        <span class="n">routes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_registered_routes</span><span class="p">(</span><span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-97"><a href="#PumpWoodMicroService-97"><span class="linenos">  97</span></a>        <span class="k">return</span> <span class="n">microservice</span> <span class="ow">in</span> <span class="n">routes</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-98"><a href="#PumpWoodMicroService-98"><span class="linenos">  98</span></a>
</span><span id="PumpWoodMicroService-99"><a href="#PumpWoodMicroService-99"><span class="linenos">  99</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_registered_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-100"><a href="#PumpWoodMicroService-100"><span class="linenos"> 100</span></a>                                  <span class="n">availability</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;front_avaiable&#39;</span>
</span><span id="PumpWoodMicroService-101"><a href="#PumpWoodMicroService-101"><span class="linenos"> 101</span></a>                                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-102"><a href="#PumpWoodMicroService-102"><span class="linenos"> 102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List all routes and services that have been registed at Kong.</span>
</span><span id="PumpWoodMicroService-103"><a href="#PumpWoodMicroService-103"><span class="linenos"> 103</span></a>
</span><span id="PumpWoodMicroService-104"><a href="#PumpWoodMicroService-104"><span class="linenos"> 104</span></a><span class="sd">        It is possible to restrict the return to end-points that should be</span>
</span><span id="PumpWoodMicroService-105"><a href="#PumpWoodMicroService-105"><span class="linenos"> 105</span></a><span class="sd">        avaiable at the frontend. Using this feature it is possibel to &#39;hide&#39;</span>
</span><span id="PumpWoodMicroService-106"><a href="#PumpWoodMicroService-106"><span class="linenos"> 106</span></a><span class="sd">        services from GUI keeping them avaiable for programatic calls.</span>
</span><span id="PumpWoodMicroService-107"><a href="#PumpWoodMicroService-107"><span class="linenos"> 107</span></a>
</span><span id="PumpWoodMicroService-108"><a href="#PumpWoodMicroService-108"><span class="linenos"> 108</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-109"><a href="#PumpWoodMicroService-109"><span class="linenos"> 109</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-110"><a href="#PumpWoodMicroService-110"><span class="linenos"> 110</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-111"><a href="#PumpWoodMicroService-111"><span class="linenos"> 111</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-112"><a href="#PumpWoodMicroService-112"><span class="linenos"> 112</span></a><span class="sd">            availability:</span>
</span><span id="PumpWoodMicroService-113"><a href="#PumpWoodMicroService-113"><span class="linenos"> 113</span></a><span class="sd">                Set the availability that is associated with the service.</span>
</span><span id="PumpWoodMicroService-114"><a href="#PumpWoodMicroService-114"><span class="linenos"> 114</span></a><span class="sd">                So far it is implemented &#39;front_avaiable&#39; and &#39;all&#39;.</span>
</span><span id="PumpWoodMicroService-115"><a href="#PumpWoodMicroService-115"><span class="linenos"> 115</span></a>
</span><span id="PumpWoodMicroService-116"><a href="#PumpWoodMicroService-116"><span class="linenos"> 116</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-117"><a href="#PumpWoodMicroService-117"><span class="linenos"> 117</span></a><span class="sd">            Return a list of serialized services objects containing the</span>
</span><span id="PumpWoodMicroService-118"><a href="#PumpWoodMicroService-118"><span class="linenos"> 118</span></a><span class="sd">            routes associated with at `route_set`.</span>
</span><span id="PumpWoodMicroService-119"><a href="#PumpWoodMicroService-119"><span class="linenos"> 119</span></a>
</span><span id="PumpWoodMicroService-120"><a href="#PumpWoodMicroService-120"><span class="linenos"> 120</span></a><span class="sd">            Service and routes have `notes__verbose` and `description__verbose`</span>
</span><span id="PumpWoodMicroService-121"><a href="#PumpWoodMicroService-121"><span class="linenos"> 121</span></a><span class="sd">            that are  the repective strings associated with note and</span>
</span><span id="PumpWoodMicroService-122"><a href="#PumpWoodMicroService-122"><span class="linenos"> 122</span></a><span class="sd">            description but translated using Pumpwood&#39;s I8s,</span>
</span><span id="PumpWoodMicroService-123"><a href="#PumpWoodMicroService-123"><span class="linenos"> 123</span></a>
</span><span id="PumpWoodMicroService-124"><a href="#PumpWoodMicroService-124"><span class="linenos"> 124</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-125"><a href="#PumpWoodMicroService-125"><span class="linenos"> 125</span></a><span class="sd">            PumpWoodWrongParameters:</span>
</span><span id="PumpWoodMicroService-126"><a href="#PumpWoodMicroService-126"><span class="linenos"> 126</span></a><span class="sd">                Raise PumpWoodWrongParameters if availability passed as</span>
</span><span id="PumpWoodMicroService-127"><a href="#PumpWoodMicroService-127"><span class="linenos"> 127</span></a><span class="sd">                paraemter is not implemented.</span>
</span><span id="PumpWoodMicroService-128"><a href="#PumpWoodMicroService-128"><span class="linenos"> 128</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-129"><a href="#PumpWoodMicroService-129"><span class="linenos"> 129</span></a>        <span class="n">list_url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/endpoints/&#39;</span>
</span><span id="PumpWoodMicroService-130"><a href="#PumpWoodMicroService-130"><span class="linenos"> 130</span></a>        <span class="n">routes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-131"><a href="#PumpWoodMicroService-131"><span class="linenos"> 131</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;availability&#39;</span><span class="p">:</span> <span class="n">availability</span><span class="p">},</span>
</span><span id="PumpWoodMicroService-132"><a href="#PumpWoodMicroService-132"><span class="linenos"> 132</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-133"><a href="#PumpWoodMicroService-133"><span class="linenos"> 133</span></a>        <span class="k">return</span> <span class="n">routes</span>
</span><span id="PumpWoodMicroService-134"><a href="#PumpWoodMicroService-134"><span class="linenos"> 134</span></a>
</span><span id="PumpWoodMicroService-135"><a href="#PumpWoodMicroService-135"><span class="linenos"> 135</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dummy_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-136"><a href="#PumpWoodMicroService-136"><span class="linenos"> 136</span></a>                   <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-137"><a href="#PumpWoodMicroService-137"><span class="linenos"> 137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dummy call to ensure headers and payload reaching app.</span>
</span><span id="PumpWoodMicroService-138"><a href="#PumpWoodMicroService-138"><span class="linenos"> 138</span></a>
</span><span id="PumpWoodMicroService-139"><a href="#PumpWoodMicroService-139"><span class="linenos"> 139</span></a><span class="sd">        The request just bounce on the server and return the headers and</span>
</span><span id="PumpWoodMicroService-140"><a href="#PumpWoodMicroService-140"><span class="linenos"> 140</span></a><span class="sd">        payload that reached the application. It is usefull for probing</span>
</span><span id="PumpWoodMicroService-141"><a href="#PumpWoodMicroService-141"><span class="linenos"> 141</span></a><span class="sd">        proxy servers, API gateways and other security and load balance</span>
</span><span id="PumpWoodMicroService-142"><a href="#PumpWoodMicroService-142"><span class="linenos"> 142</span></a><span class="sd">        tools.</span>
</span><span id="PumpWoodMicroService-143"><a href="#PumpWoodMicroService-143"><span class="linenos"> 143</span></a>
</span><span id="PumpWoodMicroService-144"><a href="#PumpWoodMicroService-144"><span class="linenos"> 144</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-145"><a href="#PumpWoodMicroService-145"><span class="linenos"> 145</span></a><span class="sd">            payload:</span>
</span><span id="PumpWoodMicroService-146"><a href="#PumpWoodMicroService-146"><span class="linenos"> 146</span></a><span class="sd">                Payload to be returned by the dummy call end-point.</span>
</span><span id="PumpWoodMicroService-147"><a href="#PumpWoodMicroService-147"><span class="linenos"> 147</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-148"><a href="#PumpWoodMicroService-148"><span class="linenos"> 148</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-149"><a href="#PumpWoodMicroService-149"><span class="linenos"> 149</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-150"><a href="#PumpWoodMicroService-150"><span class="linenos"> 150</span></a>
</span><span id="PumpWoodMicroService-151"><a href="#PumpWoodMicroService-151"><span class="linenos"> 151</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-152"><a href="#PumpWoodMicroService-152"><span class="linenos"> 152</span></a><span class="sd">            Return a dictonary with:</span>
</span><span id="PumpWoodMicroService-153"><a href="#PumpWoodMicroService-153"><span class="linenos"> 153</span></a><span class="sd">            - **full_path**: Full path of the request.</span>
</span><span id="PumpWoodMicroService-154"><a href="#PumpWoodMicroService-154"><span class="linenos"> 154</span></a><span class="sd">            - **method**: Method used at the call</span>
</span><span id="PumpWoodMicroService-155"><a href="#PumpWoodMicroService-155"><span class="linenos"> 155</span></a><span class="sd">            - **headers**: Headers at the request.</span>
</span><span id="PumpWoodMicroService-156"><a href="#PumpWoodMicroService-156"><span class="linenos"> 156</span></a><span class="sd">            - **data**: Post payload sent at the request.</span>
</span><span id="PumpWoodMicroService-157"><a href="#PumpWoodMicroService-157"><span class="linenos"> 157</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-158"><a href="#PumpWoodMicroService-158"><span class="linenos"> 158</span></a>        <span class="n">list_url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/dummy-call/&#39;</span>
</span><span id="PumpWoodMicroService-159"><a href="#PumpWoodMicroService-159"><span class="linenos"> 159</span></a>        <span class="k">if</span> <span class="n">payload</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-160"><a href="#PumpWoodMicroService-160"><span class="linenos"> 160</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-161"><a href="#PumpWoodMicroService-161"><span class="linenos"> 161</span></a>                <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-162"><a href="#PumpWoodMicroService-162"><span class="linenos"> 162</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-163"><a href="#PumpWoodMicroService-163"><span class="linenos"> 163</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-164"><a href="#PumpWoodMicroService-164"><span class="linenos"> 164</span></a>                <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-165"><a href="#PumpWoodMicroService-165"><span class="linenos"> 165</span></a>                <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-166"><a href="#PumpWoodMicroService-166"><span class="linenos"> 166</span></a>
</span><span id="PumpWoodMicroService-167"><a href="#PumpWoodMicroService-167"><span class="linenos"> 167</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dummy_raise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">exception_deep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-168"><a href="#PumpWoodMicroService-168"><span class="linenos"> 168</span></a>                    <span class="n">payload</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-169"><a href="#PumpWoodMicroService-169"><span class="linenos"> 169</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Raise an Pumpwood error with the payload.</span>
</span><span id="PumpWoodMicroService-170"><a href="#PumpWoodMicroService-170"><span class="linenos"> 170</span></a>
</span><span id="PumpWoodMicroService-171"><a href="#PumpWoodMicroService-171"><span class="linenos"> 171</span></a><span class="sd">        This and point raises an Arbitrary PumpWoodException error, it can be</span>
</span><span id="PumpWoodMicroService-172"><a href="#PumpWoodMicroService-172"><span class="linenos"> 172</span></a><span class="sd">        used for debuging error treatment.</span>
</span><span id="PumpWoodMicroService-173"><a href="#PumpWoodMicroService-173"><span class="linenos"> 173</span></a>
</span><span id="PumpWoodMicroService-174"><a href="#PumpWoodMicroService-174"><span class="linenos"> 174</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-175"><a href="#PumpWoodMicroService-175"><span class="linenos"> 175</span></a><span class="sd">            exception_class:</span>
</span><span id="PumpWoodMicroService-176"><a href="#PumpWoodMicroService-176"><span class="linenos"> 176</span></a><span class="sd">                Class of the exception to be raised.</span>
</span><span id="PumpWoodMicroService-177"><a href="#PumpWoodMicroService-177"><span class="linenos"> 177</span></a><span class="sd">            exception_deep:</span>
</span><span id="PumpWoodMicroService-178"><a href="#PumpWoodMicroService-178"><span class="linenos"> 178</span></a><span class="sd">                Deep of the exception in microservice calls. This arg will</span>
</span><span id="PumpWoodMicroService-179"><a href="#PumpWoodMicroService-179"><span class="linenos"> 179</span></a><span class="sd">                make error recusive, calling the end-point it self for</span>
</span><span id="PumpWoodMicroService-180"><a href="#PumpWoodMicroService-180"><span class="linenos"> 180</span></a><span class="sd">                `exception_deep` time before raising the error.</span>
</span><span id="PumpWoodMicroService-181"><a href="#PumpWoodMicroService-181"><span class="linenos"> 181</span></a><span class="sd">            payload:</span>
</span><span id="PumpWoodMicroService-182"><a href="#PumpWoodMicroService-182"><span class="linenos"> 182</span></a><span class="sd">                Payload that will be returned with error.</span>
</span><span id="PumpWoodMicroService-183"><a href="#PumpWoodMicroService-183"><span class="linenos"> 183</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-184"><a href="#PumpWoodMicroService-184"><span class="linenos"> 184</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-185"><a href="#PumpWoodMicroService-185"><span class="linenos"> 185</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-186"><a href="#PumpWoodMicroService-186"><span class="linenos"> 186</span></a>
</span><span id="PumpWoodMicroService-187"><a href="#PumpWoodMicroService-187"><span class="linenos"> 187</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-188"><a href="#PumpWoodMicroService-188"><span class="linenos"> 188</span></a><span class="sd">            Should not return any results, all possible call should result</span>
</span><span id="PumpWoodMicroService-189"><a href="#PumpWoodMicroService-189"><span class="linenos"> 189</span></a><span class="sd">            in raising the correspondent error.</span>
</span><span id="PumpWoodMicroService-190"><a href="#PumpWoodMicroService-190"><span class="linenos"> 190</span></a>
</span><span id="PumpWoodMicroService-191"><a href="#PumpWoodMicroService-191"><span class="linenos"> 191</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-192"><a href="#PumpWoodMicroService-192"><span class="linenos"> 192</span></a><span class="sd">            Should raise the correspondent error passed on exception_class</span>
</span><span id="PumpWoodMicroService-193"><a href="#PumpWoodMicroService-193"><span class="linenos"> 193</span></a><span class="sd">            arg, with payload.</span>
</span><span id="PumpWoodMicroService-194"><a href="#PumpWoodMicroService-194"><span class="linenos"> 194</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-195"><a href="#PumpWoodMicroService-195"><span class="linenos"> 195</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/dummy-raise/&#39;</span>
</span><span id="PumpWoodMicroService-196"><a href="#PumpWoodMicroService-196"><span class="linenos"> 196</span></a>        <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;exception_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exception_class</span>
</span><span id="PumpWoodMicroService-197"><a href="#PumpWoodMicroService-197"><span class="linenos"> 197</span></a>        <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;exception_deep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exception_deep</span>
</span><span id="PumpWoodMicroService-198"><a href="#PumpWoodMicroService-198"><span class="linenos"> 198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-199"><a href="#PumpWoodMicroService-199"><span class="linenos"> 199</span></a>
</span><span id="PumpWoodMicroService-200"><a href="#PumpWoodMicroService-200"><span class="linenos"> 200</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_pks_from_unique_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-201"><a href="#PumpWoodMicroService-201"><span class="linenos"> 201</span></a>                                  <span class="n">values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-202"><a href="#PumpWoodMicroService-202"><span class="linenos"> 202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get pk using unique fields values.</span>
</span><span id="PumpWoodMicroService-203"><a href="#PumpWoodMicroService-203"><span class="linenos"> 203</span></a>
</span><span id="PumpWoodMicroService-204"><a href="#PumpWoodMicroService-204"><span class="linenos"> 204</span></a><span class="sd">        Use unique field values to retrieve pk of the objects. This end-point</span>
</span><span id="PumpWoodMicroService-205"><a href="#PumpWoodMicroService-205"><span class="linenos"> 205</span></a><span class="sd">        is usefull for retrieving pks of the objects associated with unique</span>
</span><span id="PumpWoodMicroService-206"><a href="#PumpWoodMicroService-206"><span class="linenos"> 206</span></a><span class="sd">        fields such as `description` (unique on most model of pumpwood).</span>
</span><span id="PumpWoodMicroService-207"><a href="#PumpWoodMicroService-207"><span class="linenos"> 207</span></a>
</span><span id="PumpWoodMicroService-208"><a href="#PumpWoodMicroService-208"><span class="linenos"> 208</span></a><span class="sd">        ```python</span>
</span><span id="PumpWoodMicroService-209"><a href="#PumpWoodMicroService-209"><span class="linenos"> 209</span></a><span class="sd">        # Using description to fetch pks from objects</span>
</span><span id="PumpWoodMicroService-210"><a href="#PumpWoodMicroService-210"><span class="linenos"> 210</span></a><span class="sd">        data: pd.DataFrame = [data with unique description but without pk]</span>
</span><span id="PumpWoodMicroService-211"><a href="#PumpWoodMicroService-211"><span class="linenos"> 211</span></a><span class="sd">        data[&#39;attribute_id&#39;] = microservice.get_pks_from_unique_field(</span>
</span><span id="PumpWoodMicroService-212"><a href="#PumpWoodMicroService-212"><span class="linenos"> 212</span></a><span class="sd">            model_class=&quot;DescriptionAttribute&quot;,</span>
</span><span id="PumpWoodMicroService-213"><a href="#PumpWoodMicroService-213"><span class="linenos"> 213</span></a><span class="sd">            field=&quot;description&quot;, values=data[&#39;attribute&#39;])[&#39;pk&#39;]</span>
</span><span id="PumpWoodMicroService-214"><a href="#PumpWoodMicroService-214"><span class="linenos"> 214</span></a>
</span><span id="PumpWoodMicroService-215"><a href="#PumpWoodMicroService-215"><span class="linenos"> 215</span></a><span class="sd">        # Using a dimension key to fetch pk of the objects, dimension</span>
</span><span id="PumpWoodMicroService-216"><a href="#PumpWoodMicroService-216"><span class="linenos"> 216</span></a><span class="sd">        # key must be unique</span>
</span><span id="PumpWoodMicroService-217"><a href="#PumpWoodMicroService-217"><span class="linenos"> 217</span></a><span class="sd">        data[&#39;georea_id&#39;] = microservice.get_pks_from_unique_field(</span>
</span><span id="PumpWoodMicroService-218"><a href="#PumpWoodMicroService-218"><span class="linenos"> 218</span></a><span class="sd">            model_class=&quot;DescriptionGeoarea&quot;, field=&quot;dimension-&gt;city&quot;,</span>
</span><span id="PumpWoodMicroService-219"><a href="#PumpWoodMicroService-219"><span class="linenos"> 219</span></a><span class="sd">            values=data[&#39;city&#39;])[&#39;pk&#39;]</span>
</span><span id="PumpWoodMicroService-220"><a href="#PumpWoodMicroService-220"><span class="linenos"> 220</span></a><span class="sd">        ```</span>
</span><span id="PumpWoodMicroService-221"><a href="#PumpWoodMicroService-221"><span class="linenos"> 221</span></a>
</span><span id="PumpWoodMicroService-222"><a href="#PumpWoodMicroService-222"><span class="linenos"> 222</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-223"><a href="#PumpWoodMicroService-223"><span class="linenos"> 223</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-224"><a href="#PumpWoodMicroService-224"><span class="linenos"> 224</span></a><span class="sd">                Model class of the objects.</span>
</span><span id="PumpWoodMicroService-225"><a href="#PumpWoodMicroService-225"><span class="linenos"> 225</span></a><span class="sd">            field:</span>
</span><span id="PumpWoodMicroService-226"><a href="#PumpWoodMicroService-226"><span class="linenos"> 226</span></a><span class="sd">                Unique field to fetch pk. It is possible to use dimension keys</span>
</span><span id="PumpWoodMicroService-227"><a href="#PumpWoodMicroService-227"><span class="linenos"> 227</span></a><span class="sd">                as unique field, for that use `dimension-&gt;[key]` notation.</span>
</span><span id="PumpWoodMicroService-228"><a href="#PumpWoodMicroService-228"><span class="linenos"> 228</span></a><span class="sd">            values:</span>
</span><span id="PumpWoodMicroService-229"><a href="#PumpWoodMicroService-229"><span class="linenos"> 229</span></a><span class="sd">                List of the unique fields used to fetch primary keys.</span>
</span><span id="PumpWoodMicroService-230"><a href="#PumpWoodMicroService-230"><span class="linenos"> 230</span></a>
</span><span id="PumpWoodMicroService-231"><a href="#PumpWoodMicroService-231"><span class="linenos"> 231</span></a><span class="sd">        Return:</span>
</span><span id="PumpWoodMicroService-232"><a href="#PumpWoodMicroService-232"><span class="linenos"> 232</span></a><span class="sd">            Return a dataframe in same order as values with columns:</span>
</span><span id="PumpWoodMicroService-233"><a href="#PumpWoodMicroService-233"><span class="linenos"> 233</span></a><span class="sd">            - **pk**: Correspondent primary key of the unique value.</span>
</span><span id="PumpWoodMicroService-234"><a href="#PumpWoodMicroService-234"><span class="linenos"> 234</span></a><span class="sd">            - **[field]**: Column with same name of field argument,</span>
</span><span id="PumpWoodMicroService-235"><a href="#PumpWoodMicroService-235"><span class="linenos"> 235</span></a><span class="sd">                correspondent to pk.</span>
</span><span id="PumpWoodMicroService-236"><a href="#PumpWoodMicroService-236"><span class="linenos"> 236</span></a>
</span><span id="PumpWoodMicroService-237"><a href="#PumpWoodMicroService-237"><span class="linenos"> 237</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-238"><a href="#PumpWoodMicroService-238"><span class="linenos"> 238</span></a><span class="sd">            PumpWoodQueryException:</span>
</span><span id="PumpWoodMicroService-239"><a href="#PumpWoodMicroService-239"><span class="linenos"> 239</span></a><span class="sd">                Raises if field is not found on the model and it is note</span>
</span><span id="PumpWoodMicroService-240"><a href="#PumpWoodMicroService-240"><span class="linenos"> 240</span></a><span class="sd">                associated with a dimension tag.</span>
</span><span id="PumpWoodMicroService-241"><a href="#PumpWoodMicroService-241"><span class="linenos"> 241</span></a><span class="sd">            PumpWoodQueryException:</span>
</span><span id="PumpWoodMicroService-242"><a href="#PumpWoodMicroService-242"><span class="linenos"> 242</span></a><span class="sd">                Raises if `field` does not have a unique restriction on</span>
</span><span id="PumpWoodMicroService-243"><a href="#PumpWoodMicroService-243"><span class="linenos"> 243</span></a><span class="sd">                database. Dimension keys does not check for uniqueness on</span>
</span><span id="PumpWoodMicroService-244"><a href="#PumpWoodMicroService-244"><span class="linenos"> 244</span></a><span class="sd">                database, be carefull not to duplicate the lines.</span>
</span><span id="PumpWoodMicroService-245"><a href="#PumpWoodMicroService-245"><span class="linenos"> 245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-246"><a href="#PumpWoodMicroService-246"><span class="linenos"> 246</span></a>        <span class="n">is_dimension_tag</span> <span class="o">=</span> <span class="s1">&#39;dimensions-&gt;&#39;</span> <span class="ow">in</span> <span class="n">field</span>
</span><span id="PumpWoodMicroService-247"><a href="#PumpWoodMicroService-247"><span class="linenos"> 247</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_dimension_tag</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-248"><a href="#PumpWoodMicroService-248"><span class="linenos"> 248</span></a>            <span class="n">fill_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_options</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-249"><a href="#PumpWoodMicroService-249"><span class="linenos"> 249</span></a>            <span class="n">field_details</span> <span class="o">=</span> <span class="n">fill_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-250"><a href="#PumpWoodMicroService-250"><span class="linenos"> 250</span></a>            <span class="k">if</span> <span class="n">field_details</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-251"><a href="#PumpWoodMicroService-251"><span class="linenos"> 251</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-252"><a href="#PumpWoodMicroService-252"><span class="linenos"> 252</span></a>                    <span class="s2">&quot;Field is not a dimension tag and not found on model &quot;</span>
</span><span id="PumpWoodMicroService-253"><a href="#PumpWoodMicroService-253"><span class="linenos"> 253</span></a>                    <span class="s2">&quot;fields. Field [</span><span class="si">{field}</span><span class="s2">]&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-254"><a href="#PumpWoodMicroService-254"><span class="linenos"> 254</span></a>                <span class="k">raise</span> <span class="n">PumpWoodQueryException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-255"><a href="#PumpWoodMicroService-255"><span class="linenos"> 255</span></a>                    <span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">field</span><span class="p">})</span>
</span><span id="PumpWoodMicroService-256"><a href="#PumpWoodMicroService-256"><span class="linenos"> 256</span></a>
</span><span id="PumpWoodMicroService-257"><a href="#PumpWoodMicroService-257"><span class="linenos"> 257</span></a>            <span class="n">is_unique_field</span> <span class="o">=</span> <span class="n">field_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unique&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-258"><a href="#PumpWoodMicroService-258"><span class="linenos"> 258</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_unique_field</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-259"><a href="#PumpWoodMicroService-259"><span class="linenos"> 259</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Field [</span><span class="si">{}</span><span class="s2">] to get pk from is not unique&quot;</span>
</span><span id="PumpWoodMicroService-260"><a href="#PumpWoodMicroService-260"><span class="linenos"> 260</span></a>                <span class="k">raise</span> <span class="n">PumpWoodQueryException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-261"><a href="#PumpWoodMicroService-261"><span class="linenos"> 261</span></a>                    <span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">field</span><span class="p">})</span>
</span><span id="PumpWoodMicroService-262"><a href="#PumpWoodMicroService-262"><span class="linenos"> 262</span></a>
</span><span id="PumpWoodMicroService-263"><a href="#PumpWoodMicroService-263"><span class="linenos"> 263</span></a>        <span class="n">filter_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span> <span class="o">+</span> <span class="s2">&quot;__in&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">values</span><span class="p">))}</span>
</span><span id="PumpWoodMicroService-264"><a href="#PumpWoodMicroService-264"><span class="linenos"> 264</span></a>        <span class="n">pk_map</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-265"><a href="#PumpWoodMicroService-265"><span class="linenos"> 265</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_dimension_tag</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-266"><a href="#PumpWoodMicroService-266"><span class="linenos"> 266</span></a>            <span class="n">list_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_without_pag</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-267"><a href="#PumpWoodMicroService-267"><span class="linenos"> 267</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">filter_dict</span><span class="o">=</span><span class="n">filter_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-268"><a href="#PumpWoodMicroService-268"><span class="linenos"> 268</span></a>                <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="n">field</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="n">field</span><span class="p">])</span>
</span><span id="PumpWoodMicroService-269"><a href="#PumpWoodMicroService-269"><span class="linenos"> 269</span></a>            <span class="n">pk_map</span> <span class="o">=</span> <span class="n">list_results</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">field</span><span class="p">)[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-270"><a href="#PumpWoodMicroService-270"><span class="linenos"> 270</span></a>
</span><span id="PumpWoodMicroService-271"><a href="#PumpWoodMicroService-271"><span class="linenos"> 271</span></a>        <span class="c1"># If is dimension tag, fetch dimension and unpack it</span>
</span><span id="PumpWoodMicroService-272"><a href="#PumpWoodMicroService-272"><span class="linenos"> 272</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-273"><a href="#PumpWoodMicroService-273"><span class="linenos"> 273</span></a>            <span class="n">dimension_tag</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-274"><a href="#PumpWoodMicroService-274"><span class="linenos"> 274</span></a>            <span class="n">list_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_without_pag</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-275"><a href="#PumpWoodMicroService-275"><span class="linenos"> 275</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">filter_dict</span><span class="o">=</span><span class="n">filter_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-276"><a href="#PumpWoodMicroService-276"><span class="linenos"> 276</span></a>                <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="s2">&quot;dimensions&quot;</span><span class="p">]))</span>
</span><span id="PumpWoodMicroService-277"><a href="#PumpWoodMicroService-277"><span class="linenos"> 277</span></a>            <span class="n">pk_map</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="PumpWoodMicroService-278"><a href="#PumpWoodMicroService-278"><span class="linenos"> 278</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_results</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-279"><a href="#PumpWoodMicroService-279"><span class="linenos"> 279</span></a>                <span class="n">pk_map</span> <span class="o">=</span> <span class="n">list_results</span>\
</span><span id="PumpWoodMicroService-280"><a href="#PumpWoodMicroService-280"><span class="linenos"> 280</span></a>                    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">unpack_dict_columns</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dimensions&quot;</span><span class="p">])</span>\
</span><span id="PumpWoodMicroService-281"><a href="#PumpWoodMicroService-281"><span class="linenos"> 281</span></a>                    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">dimension_tag</span><span class="p">)[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-282"><a href="#PumpWoodMicroService-282"><span class="linenos"> 282</span></a>
</span><span id="PumpWoodMicroService-283"><a href="#PumpWoodMicroService-283"><span class="linenos"> 283</span></a>        <span class="n">values_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-284"><a href="#PumpWoodMicroService-284"><span class="linenos"> 284</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="PumpWoodMicroService-285"><a href="#PumpWoodMicroService-285"><span class="linenos"> 285</span></a>            <span class="s2">&quot;pk&quot;</span><span class="p">:</span> <span class="n">values_series</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">pk_map</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
</span><span id="PumpWoodMicroService-286"><a href="#PumpWoodMicroService-286"><span class="linenos"> 286</span></a>            <span class="n">field</span><span class="p">:</span> <span class="n">values_series</span>
</span><span id="PumpWoodMicroService-287"><a href="#PumpWoodMicroService-287"><span class="linenos"> 287</span></a>        <span class="p">})</span>
</span><span id="PumpWoodMicroService-288"><a href="#PumpWoodMicroService-288"><span class="linenos"> 288</span></a>
</span><span id="PumpWoodMicroService-289"><a href="#PumpWoodMicroService-289"><span class="linenos"> 289</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PumpWoodMicroService-290"><a href="#PumpWoodMicroService-290"><span class="linenos"> 290</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_list_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-291"><a href="#PumpWoodMicroService-291"><span class="linenos"> 291</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/list/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),)</span>
</span><span id="PumpWoodMicroService-292"><a href="#PumpWoodMicroService-292"><span class="linenos"> 292</span></a>
</span><span id="PumpWoodMicroService-293"><a href="#PumpWoodMicroService-293"><span class="linenos"> 293</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService-294"><a href="#PumpWoodMicroService-294"><span class="linenos"> 294</span></a>             <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">order_by</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="PumpWoodMicroService-295"><a href="#PumpWoodMicroService-295"><span class="linenos"> 295</span></a>             <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-296"><a href="#PumpWoodMicroService-296"><span class="linenos"> 296</span></a>             <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-297"><a href="#PumpWoodMicroService-297"><span class="linenos"> 297</span></a>             <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-298"><a href="#PumpWoodMicroService-298"><span class="linenos"> 298</span></a>             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-299"><a href="#PumpWoodMicroService-299"><span class="linenos"> 299</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List objects with pagination.</span>
</span><span id="PumpWoodMicroService-300"><a href="#PumpWoodMicroService-300"><span class="linenos"> 300</span></a>
</span><span id="PumpWoodMicroService-301"><a href="#PumpWoodMicroService-301"><span class="linenos"> 301</span></a><span class="sd">        List end-point (resumed data) of PumpWood like systems,</span>
</span><span id="PumpWoodMicroService-302"><a href="#PumpWoodMicroService-302"><span class="linenos"> 302</span></a><span class="sd">        results will be paginated. To get next pag, send all recived pk at</span>
</span><span id="PumpWoodMicroService-303"><a href="#PumpWoodMicroService-303"><span class="linenos"> 303</span></a><span class="sd">        exclude dict (ex.: `exclude_dict={pk__in: [1,2,...,30]}`).</span>
</span><span id="PumpWoodMicroService-304"><a href="#PumpWoodMicroService-304"><span class="linenos"> 304</span></a>
</span><span id="PumpWoodMicroService-305"><a href="#PumpWoodMicroService-305"><span class="linenos"> 305</span></a><span class="sd">        It is possible to return foreign keys objects associated with</span>
</span><span id="PumpWoodMicroService-306"><a href="#PumpWoodMicroService-306"><span class="linenos"> 306</span></a><span class="sd">        `model_class`. Use this with carefull since increase the backend</span>
</span><span id="PumpWoodMicroService-307"><a href="#PumpWoodMicroService-307"><span class="linenos"> 307</span></a><span class="sd">        infrastructure consumption, each object is a retrieve call per</span>
</span><span id="PumpWoodMicroService-308"><a href="#PumpWoodMicroService-308"><span class="linenos"> 308</span></a><span class="sd">        foreign key (otimization in progress).</span>
</span><span id="PumpWoodMicroService-309"><a href="#PumpWoodMicroService-309"><span class="linenos"> 309</span></a>
</span><span id="PumpWoodMicroService-310"><a href="#PumpWoodMicroService-310"><span class="linenos"> 310</span></a><span class="sd">        It is possible to use diferent operators using `__` after the name</span>
</span><span id="PumpWoodMicroService-311"><a href="#PumpWoodMicroService-311"><span class="linenos"> 311</span></a><span class="sd">        of the field, some of the operators avaiable:</span>
</span><span id="PumpWoodMicroService-312"><a href="#PumpWoodMicroService-312"><span class="linenos"> 312</span></a>
</span><span id="PumpWoodMicroService-313"><a href="#PumpWoodMicroService-313"><span class="linenos"> 313</span></a><span class="sd">        ### General operators</span>
</span><span id="PumpWoodMicroService-314"><a href="#PumpWoodMicroService-314"><span class="linenos"> 314</span></a><span class="sd">        - **__eq:** Check if the value is the same, same results if no</span>
</span><span id="PumpWoodMicroService-315"><a href="#PumpWoodMicroService-315"><span class="linenos"> 315</span></a><span class="sd">            operator is passed.</span>
</span><span id="PumpWoodMicroService-316"><a href="#PumpWoodMicroService-316"><span class="linenos"> 316</span></a><span class="sd">        - **__gt:** Check if value is greter then argument.</span>
</span><span id="PumpWoodMicroService-317"><a href="#PumpWoodMicroService-317"><span class="linenos"> 317</span></a><span class="sd">        - **__lt:** Check if value is less then argument.</span>
</span><span id="PumpWoodMicroService-318"><a href="#PumpWoodMicroService-318"><span class="linenos"> 318</span></a><span class="sd">        - **__gte:** Check if value is greter or equal then argument.</span>
</span><span id="PumpWoodMicroService-319"><a href="#PumpWoodMicroService-319"><span class="linenos"> 319</span></a><span class="sd">        - **__lte:** Check if value is less or equal then argument.</span>
</span><span id="PumpWoodMicroService-320"><a href="#PumpWoodMicroService-320"><span class="linenos"> 320</span></a><span class="sd">        - **__in:** Check if value is at a list, the argument of this operator</span>
</span><span id="PumpWoodMicroService-321"><a href="#PumpWoodMicroService-321"><span class="linenos"> 321</span></a><span class="sd">            must be a list.</span>
</span><span id="PumpWoodMicroService-322"><a href="#PumpWoodMicroService-322"><span class="linenos"> 322</span></a>
</span><span id="PumpWoodMicroService-323"><a href="#PumpWoodMicroService-323"><span class="linenos"> 323</span></a><span class="sd">        ### Text field operators</span>
</span><span id="PumpWoodMicroService-324"><a href="#PumpWoodMicroService-324"><span class="linenos"> 324</span></a><span class="sd">        - **__contains:** Check if value contains a string. It is case and</span>
</span><span id="PumpWoodMicroService-325"><a href="#PumpWoodMicroService-325"><span class="linenos"> 325</span></a><span class="sd">            accent sensitive.</span>
</span><span id="PumpWoodMicroService-326"><a href="#PumpWoodMicroService-326"><span class="linenos"> 326</span></a><span class="sd">        - **__icontains:** Check if a values contains a string, It is case</span>
</span><span id="PumpWoodMicroService-327"><a href="#PumpWoodMicroService-327"><span class="linenos"> 327</span></a><span class="sd">            insensitive and accent sensitive.</span>
</span><span id="PumpWoodMicroService-328"><a href="#PumpWoodMicroService-328"><span class="linenos"> 328</span></a><span class="sd">        - **__unaccent_icontains:** Check if a values contains a string, It is</span>
</span><span id="PumpWoodMicroService-329"><a href="#PumpWoodMicroService-329"><span class="linenos"> 329</span></a><span class="sd">            case insensitive and accent insensitive (consider a, à, á, ã, ...</span>
</span><span id="PumpWoodMicroService-330"><a href="#PumpWoodMicroService-330"><span class="linenos"> 330</span></a><span class="sd">            the same).</span>
</span><span id="PumpWoodMicroService-331"><a href="#PumpWoodMicroService-331"><span class="linenos"> 331</span></a><span class="sd">        - **__exact:** Same as __eq or not setting operator.</span>
</span><span id="PumpWoodMicroService-332"><a href="#PumpWoodMicroService-332"><span class="linenos"> 332</span></a><span class="sd">        - **__iexact:** Same as __eq, but case insensitive and</span>
</span><span id="PumpWoodMicroService-333"><a href="#PumpWoodMicroService-333"><span class="linenos"> 333</span></a><span class="sd">            accent sensitive.</span>
</span><span id="PumpWoodMicroService-334"><a href="#PumpWoodMicroService-334"><span class="linenos"> 334</span></a><span class="sd">        - **__unaccent_iexact:** Same as __eq, but case insensitive and</span>
</span><span id="PumpWoodMicroService-335"><a href="#PumpWoodMicroService-335"><span class="linenos"> 335</span></a><span class="sd">            accent insensitive.</span>
</span><span id="PumpWoodMicroService-336"><a href="#PumpWoodMicroService-336"><span class="linenos"> 336</span></a><span class="sd">        - **__startswith:** Check if the value stats with a sub-string.</span>
</span><span id="PumpWoodMicroService-337"><a href="#PumpWoodMicroService-337"><span class="linenos"> 337</span></a><span class="sd">            Case sensitive and accent sensitive.</span>
</span><span id="PumpWoodMicroService-338"><a href="#PumpWoodMicroService-338"><span class="linenos"> 338</span></a><span class="sd">        - **__istartswith:** Check if the value stats with a sub-string.</span>
</span><span id="PumpWoodMicroService-339"><a href="#PumpWoodMicroService-339"><span class="linenos"> 339</span></a><span class="sd">            Case insensitive and accent sensitive.</span>
</span><span id="PumpWoodMicroService-340"><a href="#PumpWoodMicroService-340"><span class="linenos"> 340</span></a><span class="sd">        - **__unaccent_istartswith:** Check if the value stats with a</span>
</span><span id="PumpWoodMicroService-341"><a href="#PumpWoodMicroService-341"><span class="linenos"> 341</span></a><span class="sd">            sub-string. Case insensitive and accent insensitive.</span>
</span><span id="PumpWoodMicroService-342"><a href="#PumpWoodMicroService-342"><span class="linenos"> 342</span></a><span class="sd">        - **__endswith:** Check if the value ends with a sub-string. Case</span>
</span><span id="PumpWoodMicroService-343"><a href="#PumpWoodMicroService-343"><span class="linenos"> 343</span></a><span class="sd">            sensitive and accent sensitive.</span>
</span><span id="PumpWoodMicroService-344"><a href="#PumpWoodMicroService-344"><span class="linenos"> 344</span></a><span class="sd">        - **__iendswith:** Check if the value ends with a sub-string. Case</span>
</span><span id="PumpWoodMicroService-345"><a href="#PumpWoodMicroService-345"><span class="linenos"> 345</span></a><span class="sd">            insensitive and accent sensitive.</span>
</span><span id="PumpWoodMicroService-346"><a href="#PumpWoodMicroService-346"><span class="linenos"> 346</span></a><span class="sd">        - **__unaccent_iendswith:** Check if the value ends with a sub-string.</span>
</span><span id="PumpWoodMicroService-347"><a href="#PumpWoodMicroService-347"><span class="linenos"> 347</span></a><span class="sd">            Case insensitive and accent insensitive.</span>
</span><span id="PumpWoodMicroService-348"><a href="#PumpWoodMicroService-348"><span class="linenos"> 348</span></a>
</span><span id="PumpWoodMicroService-349"><a href="#PumpWoodMicroService-349"><span class="linenos"> 349</span></a><span class="sd">        ### Null operators</span>
</span><span id="PumpWoodMicroService-350"><a href="#PumpWoodMicroService-350"><span class="linenos"> 350</span></a><span class="sd">        - **__isnull:** Check if field is null, it uses as argument a `boolean`</span>
</span><span id="PumpWoodMicroService-351"><a href="#PumpWoodMicroService-351"><span class="linenos"> 351</span></a><span class="sd">            value false will return all non NULL values and true will return</span>
</span><span id="PumpWoodMicroService-352"><a href="#PumpWoodMicroService-352"><span class="linenos"> 352</span></a><span class="sd">            NULL values.</span>
</span><span id="PumpWoodMicroService-353"><a href="#PumpWoodMicroService-353"><span class="linenos"> 353</span></a>
</span><span id="PumpWoodMicroService-354"><a href="#PumpWoodMicroService-354"><span class="linenos"> 354</span></a><span class="sd">        ### Date and datetime operators:</span>
</span><span id="PumpWoodMicroService-355"><a href="#PumpWoodMicroService-355"><span class="linenos"> 355</span></a><span class="sd">        - **__range:** Receive as argument a list of two elements and return</span>
</span><span id="PumpWoodMicroService-356"><a href="#PumpWoodMicroService-356"><span class="linenos"> 356</span></a><span class="sd">            objects that field dates are between those values.</span>
</span><span id="PumpWoodMicroService-357"><a href="#PumpWoodMicroService-357"><span class="linenos"> 357</span></a><span class="sd">        - **__year:** Return object that date field value year is equal to</span>
</span><span id="PumpWoodMicroService-358"><a href="#PumpWoodMicroService-358"><span class="linenos"> 358</span></a><span class="sd">            argument.</span>
</span><span id="PumpWoodMicroService-359"><a href="#PumpWoodMicroService-359"><span class="linenos"> 359</span></a><span class="sd">        - **__month:** Return object that date field value month is equal to</span>
</span><span id="PumpWoodMicroService-360"><a href="#PumpWoodMicroService-360"><span class="linenos"> 360</span></a><span class="sd">            argument.</span>
</span><span id="PumpWoodMicroService-361"><a href="#PumpWoodMicroService-361"><span class="linenos"> 361</span></a><span class="sd">        - **__day:** Return object that date field value day is equal to</span>
</span><span id="PumpWoodMicroService-362"><a href="#PumpWoodMicroService-362"><span class="linenos"> 362</span></a><span class="sd">            argument.</span>
</span><span id="PumpWoodMicroService-363"><a href="#PumpWoodMicroService-363"><span class="linenos"> 363</span></a>
</span><span id="PumpWoodMicroService-364"><a href="#PumpWoodMicroService-364"><span class="linenos"> 364</span></a><span class="sd">        ### Dictionary fields operators:</span>
</span><span id="PumpWoodMicroService-365"><a href="#PumpWoodMicroService-365"><span class="linenos"> 365</span></a><span class="sd">        - **__json_contained_by:**</span>
</span><span id="PumpWoodMicroService-366"><a href="#PumpWoodMicroService-366"><span class="linenos"> 366</span></a><span class="sd">            Uses the function [contained_by](https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.contained_by)</span>
</span><span id="PumpWoodMicroService-367"><a href="#PumpWoodMicroService-367"><span class="linenos"> 367</span></a><span class="sd">            from SQLAlchemy to test if keys are a proper subset of the keys of</span>
</span><span id="PumpWoodMicroService-368"><a href="#PumpWoodMicroService-368"><span class="linenos"> 368</span></a><span class="sd">            the argument jsonb expression (extracted from SQLAlchemy). The</span>
</span><span id="PumpWoodMicroService-369"><a href="#PumpWoodMicroService-369"><span class="linenos"> 369</span></a><span class="sd">            argument is a list.</span>
</span><span id="PumpWoodMicroService-370"><a href="#PumpWoodMicroService-370"><span class="linenos"> 370</span></a><span class="sd">        - **__json_has_any:**</span>
</span><span id="PumpWoodMicroService-371"><a href="#PumpWoodMicroService-371"><span class="linenos"> 371</span></a><span class="sd">            Uses the function [has_any](https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.has_any)</span>
</span><span id="PumpWoodMicroService-372"><a href="#PumpWoodMicroService-372"><span class="linenos"> 372</span></a><span class="sd">            from SQLAlchemy to test for presence of a key. Note that the key</span>
</span><span id="PumpWoodMicroService-373"><a href="#PumpWoodMicroService-373"><span class="linenos"> 373</span></a><span class="sd">            may be a SQLA expression. (extracted from SQLAlchemy). The</span>
</span><span id="PumpWoodMicroService-374"><a href="#PumpWoodMicroService-374"><span class="linenos"> 374</span></a><span class="sd">            argument is a list.</span>
</span><span id="PumpWoodMicroService-375"><a href="#PumpWoodMicroService-375"><span class="linenos"> 375</span></a><span class="sd">        - **__json_has_key:**</span>
</span><span id="PumpWoodMicroService-376"><a href="#PumpWoodMicroService-376"><span class="linenos"> 376</span></a><span class="sd">            Uses the function [has_key](https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.has_key)</span>
</span><span id="PumpWoodMicroService-377"><a href="#PumpWoodMicroService-377"><span class="linenos"> 377</span></a><span class="sd">            from SQLAlchemy to Test for presence of a key. Note that the key</span>
</span><span id="PumpWoodMicroService-378"><a href="#PumpWoodMicroService-378"><span class="linenos"> 378</span></a><span class="sd">            may be a SQLA expression. The argument is a str.</span>
</span><span id="PumpWoodMicroService-379"><a href="#PumpWoodMicroService-379"><span class="linenos"> 379</span></a>
</span><span id="PumpWoodMicroService-380"><a href="#PumpWoodMicroService-380"><span class="linenos"> 380</span></a><span class="sd">        ### Text similarity operators</span>
</span><span id="PumpWoodMicroService-381"><a href="#PumpWoodMicroService-381"><span class="linenos"> 381</span></a><span class="sd">        To use similariry querys on Postgres it is necessary to `pg_trgm` be</span>
</span><span id="PumpWoodMicroService-382"><a href="#PumpWoodMicroService-382"><span class="linenos"> 382</span></a><span class="sd">        instaled on server. Check [oficial documentation]</span>
</span><span id="PumpWoodMicroService-383"><a href="#PumpWoodMicroService-383"><span class="linenos"> 383</span></a><span class="sd">        (https://www.postgresql.org/docs/current/pgtrgm.html).</span>
</span><span id="PumpWoodMicroService-384"><a href="#PumpWoodMicroService-384"><span class="linenos"> 384</span></a>
</span><span id="PumpWoodMicroService-385"><a href="#PumpWoodMicroService-385"><span class="linenos"> 385</span></a><span class="sd">        - **__similarity:** Check if two strings are similar uses the `%`</span>
</span><span id="PumpWoodMicroService-386"><a href="#PumpWoodMicroService-386"><span class="linenos"> 386</span></a><span class="sd">            operador.</span>
</span><span id="PumpWoodMicroService-387"><a href="#PumpWoodMicroService-387"><span class="linenos"> 387</span></a><span class="sd">        - **__word_similar_left:** Check if two strings are similar uses the</span>
</span><span id="PumpWoodMicroService-388"><a href="#PumpWoodMicroService-388"><span class="linenos"> 388</span></a><span class="sd">            `&lt;%` operador.</span>
</span><span id="PumpWoodMicroService-389"><a href="#PumpWoodMicroService-389"><span class="linenos"> 389</span></a><span class="sd">        - **__word_similar_right:** Check if two strings are similar uses the</span>
</span><span id="PumpWoodMicroService-390"><a href="#PumpWoodMicroService-390"><span class="linenos"> 390</span></a><span class="sd">            `%&gt;` operador.</span>
</span><span id="PumpWoodMicroService-391"><a href="#PumpWoodMicroService-391"><span class="linenos"> 391</span></a><span class="sd">        - **__strict_word__similar_left:** Check if two strings are similar</span>
</span><span id="PumpWoodMicroService-392"><a href="#PumpWoodMicroService-392"><span class="linenos"> 392</span></a><span class="sd">            uses the `&lt;&lt;%` operador.</span>
</span><span id="PumpWoodMicroService-393"><a href="#PumpWoodMicroService-393"><span class="linenos"> 393</span></a><span class="sd">        - **__strict_word__similar_right:** Check if two strings are similar</span>
</span><span id="PumpWoodMicroService-394"><a href="#PumpWoodMicroService-394"><span class="linenos"> 394</span></a><span class="sd">            uses the `%&gt;&gt;` operador.</span>
</span><span id="PumpWoodMicroService-395"><a href="#PumpWoodMicroService-395"><span class="linenos"> 395</span></a>
</span><span id="PumpWoodMicroService-396"><a href="#PumpWoodMicroService-396"><span class="linenos"> 396</span></a><span class="sd">        Some usage examples:</span>
</span><span id="PumpWoodMicroService-397"><a href="#PumpWoodMicroService-397"><span class="linenos"> 397</span></a><span class="sd">        ```python</span>
</span><span id="PumpWoodMicroService-398"><a href="#PumpWoodMicroService-398"><span class="linenos"> 398</span></a><span class="sd">        # Return the first 3 results ordered decreasing acording to `time` and</span>
</span><span id="PumpWoodMicroService-399"><a href="#PumpWoodMicroService-399"><span class="linenos"> 399</span></a><span class="sd">        # them ordered by `modeling_unit_id`. Results must have time greater</span>
</span><span id="PumpWoodMicroService-400"><a href="#PumpWoodMicroService-400"><span class="linenos"> 400</span></a><span class="sd">        # or equal to 2017-01-01 and less or equal to 2017-06-01. It also</span>
</span><span id="PumpWoodMicroService-401"><a href="#PumpWoodMicroService-401"><span class="linenos"> 401</span></a><span class="sd">        # must have attribute_id equal to 6 and not contains modeling_unit_id</span>
</span><span id="PumpWoodMicroService-402"><a href="#PumpWoodMicroService-402"><span class="linenos"> 402</span></a><span class="sd">        # 3 or 4.</span>
</span><span id="PumpWoodMicroService-403"><a href="#PumpWoodMicroService-403"><span class="linenos"> 403</span></a><span class="sd">        microservice.list(</span>
</span><span id="PumpWoodMicroService-404"><a href="#PumpWoodMicroService-404"><span class="linenos"> 404</span></a><span class="sd">            model_class=&quot;DatabaseVariable&quot;,</span>
</span><span id="PumpWoodMicroService-405"><a href="#PumpWoodMicroService-405"><span class="linenos"> 405</span></a><span class="sd">            filter_dict={</span>
</span><span id="PumpWoodMicroService-406"><a href="#PumpWoodMicroService-406"><span class="linenos"> 406</span></a><span class="sd">                &quot;time__gte&quot;: &quot;2017-01-01 00:00:00&quot;,</span>
</span><span id="PumpWoodMicroService-407"><a href="#PumpWoodMicroService-407"><span class="linenos"> 407</span></a><span class="sd">                &quot;time__lte&quot;: &quot;2017-06-01 00:00:00&quot;,</span>
</span><span id="PumpWoodMicroService-408"><a href="#PumpWoodMicroService-408"><span class="linenos"> 408</span></a><span class="sd">                &quot;attribute_id&quot;: 6},</span>
</span><span id="PumpWoodMicroService-409"><a href="#PumpWoodMicroService-409"><span class="linenos"> 409</span></a><span class="sd">            exclude_dict={</span>
</span><span id="PumpWoodMicroService-410"><a href="#PumpWoodMicroService-410"><span class="linenos"> 410</span></a><span class="sd">                &quot;modeling_unit_id__in&quot;: [3, 4]},</span>
</span><span id="PumpWoodMicroService-411"><a href="#PumpWoodMicroService-411"><span class="linenos"> 411</span></a><span class="sd">            order_by=[&quot;-time&quot;, &quot;modeling_unit_id&quot;],</span>
</span><span id="PumpWoodMicroService-412"><a href="#PumpWoodMicroService-412"><span class="linenos"> 412</span></a><span class="sd">            limit=3,</span>
</span><span id="PumpWoodMicroService-413"><a href="#PumpWoodMicroService-413"><span class="linenos"> 413</span></a><span class="sd">            fields=[&quot;pk&quot;, &quot;model_class&quot;, &quot;time&quot;, &quot;modeling_unit_id&quot;, &quot;value&quot;])</span>
</span><span id="PumpWoodMicroService-414"><a href="#PumpWoodMicroService-414"><span class="linenos"> 414</span></a>
</span><span id="PumpWoodMicroService-415"><a href="#PumpWoodMicroService-415"><span class="linenos"> 415</span></a><span class="sd">        # Return all elements that dimensions field has a key type with</span>
</span><span id="PumpWoodMicroService-416"><a href="#PumpWoodMicroService-416"><span class="linenos"> 416</span></a><span class="sd">        # value contains `selling` insensitive to case and accent.</span>
</span><span id="PumpWoodMicroService-417"><a href="#PumpWoodMicroService-417"><span class="linenos"> 417</span></a><span class="sd">        microservice.list(</span>
</span><span id="PumpWoodMicroService-418"><a href="#PumpWoodMicroService-418"><span class="linenos"> 418</span></a><span class="sd">            model_class=&quot;DatabaseAttribute&quot;,</span>
</span><span id="PumpWoodMicroService-419"><a href="#PumpWoodMicroService-419"><span class="linenos"> 419</span></a><span class="sd">            filter_dict={</span>
</span><span id="PumpWoodMicroService-420"><a href="#PumpWoodMicroService-420"><span class="linenos"> 420</span></a><span class="sd">                &quot;dimensions-&gt;type__unaccent_icontains&quot;: &quot;selling&quot;})</span>
</span><span id="PumpWoodMicroService-421"><a href="#PumpWoodMicroService-421"><span class="linenos"> 421</span></a><span class="sd">        ```</span>
</span><span id="PumpWoodMicroService-422"><a href="#PumpWoodMicroService-422"><span class="linenos"> 422</span></a>
</span><span id="PumpWoodMicroService-423"><a href="#PumpWoodMicroService-423"><span class="linenos"> 423</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-424"><a href="#PumpWoodMicroService-424"><span class="linenos"> 424</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-425"><a href="#PumpWoodMicroService-425"><span class="linenos"> 425</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="PumpWoodMicroService-426"><a href="#PumpWoodMicroService-426"><span class="linenos"> 426</span></a><span class="sd">            filter_dict:</span>
</span><span id="PumpWoodMicroService-427"><a href="#PumpWoodMicroService-427"><span class="linenos"> 427</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="PumpWoodMicroService-428"><a href="#PumpWoodMicroService-428"><span class="linenos"> 428</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService-429"><a href="#PumpWoodMicroService-429"><span class="linenos"> 429</span></a><span class="sd">            exclude_dict:</span>
</span><span id="PumpWoodMicroService-430"><a href="#PumpWoodMicroService-430"><span class="linenos"> 430</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="PumpWoodMicroService-431"><a href="#PumpWoodMicroService-431"><span class="linenos"> 431</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService-432"><a href="#PumpWoodMicroService-432"><span class="linenos"> 432</span></a><span class="sd">            order_by: Order results acording to list of strings</span>
</span><span id="PumpWoodMicroService-433"><a href="#PumpWoodMicroService-433"><span class="linenos"> 433</span></a><span class="sd">                correspondent to fields. It is possible to use &#39;-&#39; at the</span>
</span><span id="PumpWoodMicroService-434"><a href="#PumpWoodMicroService-434"><span class="linenos"> 434</span></a><span class="sd">                begginng of the field name for reverse ordering. Ex.:</span>
</span><span id="PumpWoodMicroService-435"><a href="#PumpWoodMicroService-435"><span class="linenos"> 435</span></a><span class="sd">                [&#39;description&#39;] for accendent ordering and [&#39;-description&#39;]</span>
</span><span id="PumpWoodMicroService-436"><a href="#PumpWoodMicroService-436"><span class="linenos"> 436</span></a><span class="sd">                for descendent ordering.</span>
</span><span id="PumpWoodMicroService-437"><a href="#PumpWoodMicroService-437"><span class="linenos"> 437</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-438"><a href="#PumpWoodMicroService-438"><span class="linenos"> 438</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-439"><a href="#PumpWoodMicroService-439"><span class="linenos"> 439</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-440"><a href="#PumpWoodMicroService-440"><span class="linenos"> 440</span></a><span class="sd">            fields (list):</span>
</span><span id="PumpWoodMicroService-441"><a href="#PumpWoodMicroService-441"><span class="linenos"> 441</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="PumpWoodMicroService-442"><a href="#PumpWoodMicroService-442"><span class="linenos"> 442</span></a><span class="sd">            default_fields (bool):</span>
</span><span id="PumpWoodMicroService-443"><a href="#PumpWoodMicroService-443"><span class="linenos"> 443</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="PumpWoodMicroService-444"><a href="#PumpWoodMicroService-444"><span class="linenos"> 444</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="PumpWoodMicroService-445"><a href="#PumpWoodMicroService-445"><span class="linenos"> 445</span></a><span class="sd">            limit (int):</span>
</span><span id="PumpWoodMicroService-446"><a href="#PumpWoodMicroService-446"><span class="linenos"> 446</span></a><span class="sd">                Set the limit of elements of the returned query. By default,</span>
</span><span id="PumpWoodMicroService-447"><a href="#PumpWoodMicroService-447"><span class="linenos"> 447</span></a><span class="sd">                backend usually return 50 elements.</span>
</span><span id="PumpWoodMicroService-448"><a href="#PumpWoodMicroService-448"><span class="linenos"> 448</span></a><span class="sd">            foreign_key_fields (bool):</span>
</span><span id="PumpWoodMicroService-449"><a href="#PumpWoodMicroService-449"><span class="linenos"> 449</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="PumpWoodMicroService-450"><a href="#PumpWoodMicroService-450"><span class="linenos"> 450</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="PumpWoodMicroService-451"><a href="#PumpWoodMicroService-451"><span class="linenos"> 451</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="PumpWoodMicroService-452"><a href="#PumpWoodMicroService-452"><span class="linenos"> 452</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="PumpWoodMicroService-453"><a href="#PumpWoodMicroService-453"><span class="linenos"> 453</span></a><span class="sd">            **kwargs:</span>
</span><span id="PumpWoodMicroService-454"><a href="#PumpWoodMicroService-454"><span class="linenos"> 454</span></a><span class="sd">                Other parameters for compatibility.</span>
</span><span id="PumpWoodMicroService-455"><a href="#PumpWoodMicroService-455"><span class="linenos"> 455</span></a>
</span><span id="PumpWoodMicroService-456"><a href="#PumpWoodMicroService-456"><span class="linenos"> 456</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-457"><a href="#PumpWoodMicroService-457"><span class="linenos"> 457</span></a><span class="sd">          Containing objects serialized by list Serializer.</span>
</span><span id="PumpWoodMicroService-458"><a href="#PumpWoodMicroService-458"><span class="linenos"> 458</span></a>
</span><span id="PumpWoodMicroService-459"><a href="#PumpWoodMicroService-459"><span class="linenos"> 459</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-460"><a href="#PumpWoodMicroService-460"><span class="linenos"> 460</span></a><span class="sd">          No especific raises.</span>
</span><span id="PumpWoodMicroService-461"><a href="#PumpWoodMicroService-461"><span class="linenos"> 461</span></a><span class="sd">        &quot;&quot;&quot;</span> <span class="c1"># NOQA</span>
</span><span id="PumpWoodMicroService-462"><a href="#PumpWoodMicroService-462"><span class="linenos"> 462</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-463"><a href="#PumpWoodMicroService-463"><span class="linenos"> 463</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PumpWoodMicroService-464"><a href="#PumpWoodMicroService-464"><span class="linenos"> 464</span></a>            <span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-465"><a href="#PumpWoodMicroService-465"><span class="linenos"> 465</span></a>            <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="n">order_by</span><span class="p">,</span> <span class="s1">&#39;default_fields&#39;</span><span class="p">:</span> <span class="n">default_fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-466"><a href="#PumpWoodMicroService-466"><span class="linenos"> 466</span></a>            <span class="s1">&#39;limit&#39;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> <span class="s1">&#39;foreign_key_fields&#39;</span><span class="p">:</span> <span class="n">foreign_key_fields</span><span class="p">}</span>
</span><span id="PumpWoodMicroService-467"><a href="#PumpWoodMicroService-467"><span class="linenos"> 467</span></a>        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-468"><a href="#PumpWoodMicroService-468"><span class="linenos"> 468</span></a>            <span class="n">post_data</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>
</span><span id="PumpWoodMicroService-469"><a href="#PumpWoodMicroService-469"><span class="linenos"> 469</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-470"><a href="#PumpWoodMicroService-470"><span class="linenos"> 470</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-471"><a href="#PumpWoodMicroService-471"><span class="linenos"> 471</span></a>
</span><span id="PumpWoodMicroService-472"><a href="#PumpWoodMicroService-472"><span class="linenos"> 472</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_by_chunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService-473"><a href="#PumpWoodMicroService-473"><span class="linenos"> 473</span></a>                       <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-474"><a href="#PumpWoodMicroService-474"><span class="linenos"> 474</span></a>                       <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-475"><a href="#PumpWoodMicroService-475"><span class="linenos"> 475</span></a>                       <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50000</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-476"><a href="#PumpWoodMicroService-476"><span class="linenos"> 476</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List object fetching them by chucks using pk to paginate.</span>
</span><span id="PumpWoodMicroService-477"><a href="#PumpWoodMicroService-477"><span class="linenos"> 477</span></a>
</span><span id="PumpWoodMicroService-478"><a href="#PumpWoodMicroService-478"><span class="linenos"> 478</span></a><span class="sd">        List data by chunck to load by datasets without breaking the backend</span>
</span><span id="PumpWoodMicroService-479"><a href="#PumpWoodMicroService-479"><span class="linenos"> 479</span></a><span class="sd">        or receive server timeout. It load chunks orderring the results using</span>
</span><span id="PumpWoodMicroService-480"><a href="#PumpWoodMicroService-480"><span class="linenos"> 480</span></a><span class="sd">        id of the tables, it can be changed but it should be unique otherwise</span>
</span><span id="PumpWoodMicroService-481"><a href="#PumpWoodMicroService-481"><span class="linenos"> 481</span></a><span class="sd">        unexpected results may occur.</span>
</span><span id="PumpWoodMicroService-482"><a href="#PumpWoodMicroService-482"><span class="linenos"> 482</span></a>
</span><span id="PumpWoodMicroService-483"><a href="#PumpWoodMicroService-483"><span class="linenos"> 483</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-484"><a href="#PumpWoodMicroService-484"><span class="linenos"> 484</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-485"><a href="#PumpWoodMicroService-485"><span class="linenos"> 485</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="PumpWoodMicroService-486"><a href="#PumpWoodMicroService-486"><span class="linenos"> 486</span></a><span class="sd">            filter_dict:</span>
</span><span id="PumpWoodMicroService-487"><a href="#PumpWoodMicroService-487"><span class="linenos"> 487</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="PumpWoodMicroService-488"><a href="#PumpWoodMicroService-488"><span class="linenos"> 488</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService-489"><a href="#PumpWoodMicroService-489"><span class="linenos"> 489</span></a><span class="sd">            exclude_dict:</span>
</span><span id="PumpWoodMicroService-490"><a href="#PumpWoodMicroService-490"><span class="linenos"> 490</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="PumpWoodMicroService-491"><a href="#PumpWoodMicroService-491"><span class="linenos"> 491</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService-492"><a href="#PumpWoodMicroService-492"><span class="linenos"> 492</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-493"><a href="#PumpWoodMicroService-493"><span class="linenos"> 493</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-494"><a href="#PumpWoodMicroService-494"><span class="linenos"> 494</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-495"><a href="#PumpWoodMicroService-495"><span class="linenos"> 495</span></a><span class="sd">            fields:</span>
</span><span id="PumpWoodMicroService-496"><a href="#PumpWoodMicroService-496"><span class="linenos"> 496</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="PumpWoodMicroService-497"><a href="#PumpWoodMicroService-497"><span class="linenos"> 497</span></a><span class="sd">            default_fields:</span>
</span><span id="PumpWoodMicroService-498"><a href="#PumpWoodMicroService-498"><span class="linenos"> 498</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="PumpWoodMicroService-499"><a href="#PumpWoodMicroService-499"><span class="linenos"> 499</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="PumpWoodMicroService-500"><a href="#PumpWoodMicroService-500"><span class="linenos"> 500</span></a><span class="sd">            chunk_size:</span>
</span><span id="PumpWoodMicroService-501"><a href="#PumpWoodMicroService-501"><span class="linenos"> 501</span></a><span class="sd">                Number of objects to be fetched each query.</span>
</span><span id="PumpWoodMicroService-502"><a href="#PumpWoodMicroService-502"><span class="linenos"> 502</span></a><span class="sd">            **kwargs:</span>
</span><span id="PumpWoodMicroService-503"><a href="#PumpWoodMicroService-503"><span class="linenos"> 503</span></a><span class="sd">                Other parameters for compatibility.</span>
</span><span id="PumpWoodMicroService-504"><a href="#PumpWoodMicroService-504"><span class="linenos"> 504</span></a>
</span><span id="PumpWoodMicroService-505"><a href="#PumpWoodMicroService-505"><span class="linenos"> 505</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-506"><a href="#PumpWoodMicroService-506"><span class="linenos"> 506</span></a><span class="sd">          Containing objects serialized by list Serializer.</span>
</span><span id="PumpWoodMicroService-507"><a href="#PumpWoodMicroService-507"><span class="linenos"> 507</span></a>
</span><span id="PumpWoodMicroService-508"><a href="#PumpWoodMicroService-508"><span class="linenos"> 508</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-509"><a href="#PumpWoodMicroService-509"><span class="linenos"> 509</span></a><span class="sd">          No especific raises.</span>
</span><span id="PumpWoodMicroService-510"><a href="#PumpWoodMicroService-510"><span class="linenos"> 510</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-511"><a href="#PumpWoodMicroService-511"><span class="linenos"> 511</span></a>        <span class="n">copy_filter_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">filter_dict</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-512"><a href="#PumpWoodMicroService-512"><span class="linenos"> 512</span></a>
</span><span id="PumpWoodMicroService-513"><a href="#PumpWoodMicroService-513"><span class="linenos"> 513</span></a>        <span class="n">list_all_results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService-514"><a href="#PumpWoodMicroService-514"><span class="linenos"> 514</span></a>        <span class="n">max_order_col</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PumpWoodMicroService-515"><a href="#PumpWoodMicroService-515"><span class="linenos"> 515</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-516"><a href="#PumpWoodMicroService-516"><span class="linenos"> 516</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- fetching chunk [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_order_col</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-517"><a href="#PumpWoodMicroService-517"><span class="linenos"> 517</span></a>            <span class="n">copy_filter_dict</span><span class="p">[</span><span class="s2">&quot;pk__gt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_order_col</span>
</span><span id="PumpWoodMicroService-518"><a href="#PumpWoodMicroService-518"><span class="linenos"> 518</span></a>            <span class="n">temp_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-519"><a href="#PumpWoodMicroService-519"><span class="linenos"> 519</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">filter_dict</span><span class="o">=</span><span class="n">copy_filter_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-520"><a href="#PumpWoodMicroService-520"><span class="linenos"> 520</span></a>                <span class="n">exclude_dict</span><span class="o">=</span><span class="n">exclude_dict</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-521"><a href="#PumpWoodMicroService-521"><span class="linenos"> 521</span></a>                <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-522"><a href="#PumpWoodMicroService-522"><span class="linenos"> 522</span></a>                <span class="n">default_fields</span><span class="o">=</span><span class="n">default_fields</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-523"><a href="#PumpWoodMicroService-523"><span class="linenos"> 523</span></a>
</span><span id="PumpWoodMicroService-524"><a href="#PumpWoodMicroService-524"><span class="linenos"> 524</span></a>            <span class="c1"># Break if results is empty</span>
</span><span id="PumpWoodMicroService-525"><a href="#PumpWoodMicroService-525"><span class="linenos"> 525</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-526"><a href="#PumpWoodMicroService-526"><span class="linenos"> 526</span></a>                <span class="k">break</span>
</span><span id="PumpWoodMicroService-527"><a href="#PumpWoodMicroService-527"><span class="linenos"> 527</span></a>
</span><span id="PumpWoodMicroService-528"><a href="#PumpWoodMicroService-528"><span class="linenos"> 528</span></a>            <span class="n">max_order_col</span> <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-529"><a href="#PumpWoodMicroService-529"><span class="linenos"> 529</span></a>            <span class="n">list_all_results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">temp_results</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-530"><a href="#PumpWoodMicroService-530"><span class="linenos"> 530</span></a>
</span><span id="PumpWoodMicroService-531"><a href="#PumpWoodMicroService-531"><span class="linenos"> 531</span></a>        <span class="k">return</span> <span class="n">list_all_results</span>
</span><span id="PumpWoodMicroService-532"><a href="#PumpWoodMicroService-532"><span class="linenos"> 532</span></a>
</span><span id="PumpWoodMicroService-533"><a href="#PumpWoodMicroService-533"><span class="linenos"> 533</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PumpWoodMicroService-534"><a href="#PumpWoodMicroService-534"><span class="linenos"> 534</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_list_without_pag_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-535"><a href="#PumpWoodMicroService-535"><span class="linenos"> 535</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/list-without-pag/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),)</span>
</span><span id="PumpWoodMicroService-536"><a href="#PumpWoodMicroService-536"><span class="linenos"> 536</span></a>
</span><span id="PumpWoodMicroService-537"><a href="#PumpWoodMicroService-537"><span class="linenos"> 537</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_without_pag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService-538"><a href="#PumpWoodMicroService-538"><span class="linenos"> 538</span></a>                         <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">order_by</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="PumpWoodMicroService-539"><a href="#PumpWoodMicroService-539"><span class="linenos"> 539</span></a>                         <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-540"><a href="#PumpWoodMicroService-540"><span class="linenos"> 540</span></a>                         <span class="n">convert_geometry</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-541"><a href="#PumpWoodMicroService-541"><span class="linenos"> 541</span></a>                         <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-542"><a href="#PumpWoodMicroService-542"><span class="linenos"> 542</span></a>                         <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-543"><a href="#PumpWoodMicroService-543"><span class="linenos"> 543</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List object without pagination.</span>
</span><span id="PumpWoodMicroService-544"><a href="#PumpWoodMicroService-544"><span class="linenos"> 544</span></a>
</span><span id="PumpWoodMicroService-545"><a href="#PumpWoodMicroService-545"><span class="linenos"> 545</span></a><span class="sd">        Function to post at list end-point (resumed data) of PumpWood like</span>
</span><span id="PumpWoodMicroService-546"><a href="#PumpWoodMicroService-546"><span class="linenos"> 546</span></a><span class="sd">        systems, results won&#39;t be paginated.</span>
</span><span id="PumpWoodMicroService-547"><a href="#PumpWoodMicroService-547"><span class="linenos"> 547</span></a><span class="sd">        **Be carefull with large returns.**</span>
</span><span id="PumpWoodMicroService-548"><a href="#PumpWoodMicroService-548"><span class="linenos"> 548</span></a>
</span><span id="PumpWoodMicroService-549"><a href="#PumpWoodMicroService-549"><span class="linenos"> 549</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-550"><a href="#PumpWoodMicroService-550"><span class="linenos"> 550</span></a><span class="sd">            model_class (str):</span>
</span><span id="PumpWoodMicroService-551"><a href="#PumpWoodMicroService-551"><span class="linenos"> 551</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="PumpWoodMicroService-552"><a href="#PumpWoodMicroService-552"><span class="linenos"> 552</span></a><span class="sd">            filter_dict (dict):</span>
</span><span id="PumpWoodMicroService-553"><a href="#PumpWoodMicroService-553"><span class="linenos"> 553</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="PumpWoodMicroService-554"><a href="#PumpWoodMicroService-554"><span class="linenos"> 554</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService-555"><a href="#PumpWoodMicroService-555"><span class="linenos"> 555</span></a><span class="sd">            exclude_dict (dict):</span>
</span><span id="PumpWoodMicroService-556"><a href="#PumpWoodMicroService-556"><span class="linenos"> 556</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="PumpWoodMicroService-557"><a href="#PumpWoodMicroService-557"><span class="linenos"> 557</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService-558"><a href="#PumpWoodMicroService-558"><span class="linenos"> 558</span></a><span class="sd">            order_by (bool):</span>
</span><span id="PumpWoodMicroService-559"><a href="#PumpWoodMicroService-559"><span class="linenos"> 559</span></a><span class="sd">                Order results acording to list of strings</span>
</span><span id="PumpWoodMicroService-560"><a href="#PumpWoodMicroService-560"><span class="linenos"> 560</span></a><span class="sd">                correspondent to fields. It is possible to use &#39;-&#39; at the</span>
</span><span id="PumpWoodMicroService-561"><a href="#PumpWoodMicroService-561"><span class="linenos"> 561</span></a><span class="sd">                begginng of the field name for reverse ordering. Ex.:</span>
</span><span id="PumpWoodMicroService-562"><a href="#PumpWoodMicroService-562"><span class="linenos"> 562</span></a><span class="sd">                [&#39;description&#39;] for accendent ordering and [&#39;-description&#39;]</span>
</span><span id="PumpWoodMicroService-563"><a href="#PumpWoodMicroService-563"><span class="linenos"> 563</span></a><span class="sd">                for descendent ordering.</span>
</span><span id="PumpWoodMicroService-564"><a href="#PumpWoodMicroService-564"><span class="linenos"> 564</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="PumpWoodMicroService-565"><a href="#PumpWoodMicroService-565"><span class="linenos"> 565</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-566"><a href="#PumpWoodMicroService-566"><span class="linenos"> 566</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-567"><a href="#PumpWoodMicroService-567"><span class="linenos"> 567</span></a><span class="sd">            fields (List[str]):</span>
</span><span id="PumpWoodMicroService-568"><a href="#PumpWoodMicroService-568"><span class="linenos"> 568</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="PumpWoodMicroService-569"><a href="#PumpWoodMicroService-569"><span class="linenos"> 569</span></a><span class="sd">            default_fields (bool):</span>
</span><span id="PumpWoodMicroService-570"><a href="#PumpWoodMicroService-570"><span class="linenos"> 570</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="PumpWoodMicroService-571"><a href="#PumpWoodMicroService-571"><span class="linenos"> 571</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="PumpWoodMicroService-572"><a href="#PumpWoodMicroService-572"><span class="linenos"> 572</span></a><span class="sd">            limit (int):</span>
</span><span id="PumpWoodMicroService-573"><a href="#PumpWoodMicroService-573"><span class="linenos"> 573</span></a><span class="sd">                Set the limit of elements of the returned query. By default,</span>
</span><span id="PumpWoodMicroService-574"><a href="#PumpWoodMicroService-574"><span class="linenos"> 574</span></a><span class="sd">                backend usually return 50 elements.</span>
</span><span id="PumpWoodMicroService-575"><a href="#PumpWoodMicroService-575"><span class="linenos"> 575</span></a><span class="sd">            foreign_key_fields (bool):</span>
</span><span id="PumpWoodMicroService-576"><a href="#PumpWoodMicroService-576"><span class="linenos"> 576</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="PumpWoodMicroService-577"><a href="#PumpWoodMicroService-577"><span class="linenos"> 577</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="PumpWoodMicroService-578"><a href="#PumpWoodMicroService-578"><span class="linenos"> 578</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="PumpWoodMicroService-579"><a href="#PumpWoodMicroService-579"><span class="linenos"> 579</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="PumpWoodMicroService-580"><a href="#PumpWoodMicroService-580"><span class="linenos"> 580</span></a><span class="sd">            convert_geometry (bool):</span>
</span><span id="PumpWoodMicroService-581"><a href="#PumpWoodMicroService-581"><span class="linenos"> 581</span></a><span class="sd">                If geometry columns should be convert to shapely geometry.</span>
</span><span id="PumpWoodMicroService-582"><a href="#PumpWoodMicroService-582"><span class="linenos"> 582</span></a><span class="sd">                Fields with key &#39;geometry&#39; will be considered geometry.</span>
</span><span id="PumpWoodMicroService-583"><a href="#PumpWoodMicroService-583"><span class="linenos"> 583</span></a><span class="sd">            return_type (str):</span>
</span><span id="PumpWoodMicroService-584"><a href="#PumpWoodMicroService-584"><span class="linenos"> 584</span></a><span class="sd">                Set return type to list of dictinary `list` or to a pandas</span>
</span><span id="PumpWoodMicroService-585"><a href="#PumpWoodMicroService-585"><span class="linenos"> 585</span></a><span class="sd">                dataframe `dataframe`.</span>
</span><span id="PumpWoodMicroService-586"><a href="#PumpWoodMicroService-586"><span class="linenos"> 586</span></a><span class="sd">            **kwargs:</span>
</span><span id="PumpWoodMicroService-587"><a href="#PumpWoodMicroService-587"><span class="linenos"> 587</span></a><span class="sd">                Other unused arguments for compatibility.</span>
</span><span id="PumpWoodMicroService-588"><a href="#PumpWoodMicroService-588"><span class="linenos"> 588</span></a>
</span><span id="PumpWoodMicroService-589"><a href="#PumpWoodMicroService-589"><span class="linenos"> 589</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-590"><a href="#PumpWoodMicroService-590"><span class="linenos"> 590</span></a><span class="sd">          Containing objects serialized by list Serializer.</span>
</span><span id="PumpWoodMicroService-591"><a href="#PumpWoodMicroService-591"><span class="linenos"> 591</span></a>
</span><span id="PumpWoodMicroService-592"><a href="#PumpWoodMicroService-592"><span class="linenos"> 592</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-593"><a href="#PumpWoodMicroService-593"><span class="linenos"> 593</span></a><span class="sd">          No especific raises.</span>
</span><span id="PumpWoodMicroService-594"><a href="#PumpWoodMicroService-594"><span class="linenos"> 594</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-595"><a href="#PumpWoodMicroService-595"><span class="linenos"> 595</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-596"><a href="#PumpWoodMicroService-596"><span class="linenos"> 596</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PumpWoodMicroService-597"><a href="#PumpWoodMicroService-597"><span class="linenos"> 597</span></a>            <span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-598"><a href="#PumpWoodMicroService-598"><span class="linenos"> 598</span></a>            <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="n">order_by</span><span class="p">,</span> <span class="s1">&#39;default_fields&#39;</span><span class="p">:</span> <span class="n">default_fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-599"><a href="#PumpWoodMicroService-599"><span class="linenos"> 599</span></a>            <span class="s1">&#39;foreign_key_fields&#39;</span><span class="p">:</span> <span class="n">foreign_key_fields</span><span class="p">}</span>
</span><span id="PumpWoodMicroService-600"><a href="#PumpWoodMicroService-600"><span class="linenos"> 600</span></a>
</span><span id="PumpWoodMicroService-601"><a href="#PumpWoodMicroService-601"><span class="linenos"> 601</span></a>        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-602"><a href="#PumpWoodMicroService-602"><span class="linenos"> 602</span></a>            <span class="n">post_data</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>
</span><span id="PumpWoodMicroService-603"><a href="#PumpWoodMicroService-603"><span class="linenos"> 603</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-604"><a href="#PumpWoodMicroService-604"><span class="linenos"> 604</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-605"><a href="#PumpWoodMicroService-605"><span class="linenos"> 605</span></a>
</span><span id="PumpWoodMicroService-606"><a href="#PumpWoodMicroService-606"><span class="linenos"> 606</span></a>        <span class="c1">##################################################</span>
</span><span id="PumpWoodMicroService-607"><a href="#PumpWoodMicroService-607"><span class="linenos"> 607</span></a>        <span class="c1"># Converting geometry to Shapely objects in Python</span>
</span><span id="PumpWoodMicroService-608"><a href="#PumpWoodMicroService-608"><span class="linenos"> 608</span></a>        <span class="n">geometry_in_results</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PumpWoodMicroService-609"><a href="#PumpWoodMicroService-609"><span class="linenos"> 609</span></a>        <span class="k">if</span> <span class="n">convert_geometry</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-610"><a href="#PumpWoodMicroService-610"><span class="linenos"> 610</span></a>            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-611"><a href="#PumpWoodMicroService-611"><span class="linenos"> 611</span></a>                <span class="n">geometry_value</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-612"><a href="#PumpWoodMicroService-612"><span class="linenos"> 612</span></a>                <span class="k">if</span> <span class="n">geometry_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-613"><a href="#PumpWoodMicroService-613"><span class="linenos"> 613</span></a>                    <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">geometry_value</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-614"><a href="#PumpWoodMicroService-614"><span class="linenos"> 614</span></a>                    <span class="n">geometry_in_results</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PumpWoodMicroService-615"><a href="#PumpWoodMicroService-615"><span class="linenos"> 615</span></a>        <span class="c1">##################################################</span>
</span><span id="PumpWoodMicroService-616"><a href="#PumpWoodMicroService-616"><span class="linenos"> 616</span></a>
</span><span id="PumpWoodMicroService-617"><a href="#PumpWoodMicroService-617"><span class="linenos"> 617</span></a>        <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-618"><a href="#PumpWoodMicroService-618"><span class="linenos"> 618</span></a>            <span class="k">return</span> <span class="n">results</span>
</span><span id="PumpWoodMicroService-619"><a href="#PumpWoodMicroService-619"><span class="linenos"> 619</span></a>        <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s1">&#39;dataframe&#39;</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-620"><a href="#PumpWoodMicroService-620"><span class="linenos"> 620</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;descriptiongeoarea&quot;</span><span class="p">)</span> <span class="ow">and</span> \
</span><span id="PumpWoodMicroService-621"><a href="#PumpWoodMicroService-621"><span class="linenos"> 621</span></a>                    <span class="n">geometry_in_results</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-622"><a href="#PumpWoodMicroService-622"><span class="linenos"> 622</span></a>                <span class="k">return</span> <span class="n">geopd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="s1">&#39;geometry&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-623"><a href="#PumpWoodMicroService-623"><span class="linenos"> 623</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-624"><a href="#PumpWoodMicroService-624"><span class="linenos"> 624</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-625"><a href="#PumpWoodMicroService-625"><span class="linenos"> 625</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-626"><a href="#PumpWoodMicroService-626"><span class="linenos"> 626</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;return_type must be &#39;list&#39; or &#39;dataframe&#39;&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-627"><a href="#PumpWoodMicroService-627"><span class="linenos"> 627</span></a>
</span><span id="PumpWoodMicroService-628"><a href="#PumpWoodMicroService-628"><span class="linenos"> 628</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PumpWoodMicroService-629"><a href="#PumpWoodMicroService-629"><span class="linenos"> 629</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_list_dimensions</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-630"><a href="#PumpWoodMicroService-630"><span class="linenos"> 630</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/list-dimensions/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),)</span>
</span><span id="PumpWoodMicroService-631"><a href="#PumpWoodMicroService-631"><span class="linenos"> 631</span></a>
</span><span id="PumpWoodMicroService-632"><a href="#PumpWoodMicroService-632"><span class="linenos"> 632</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService-633"><a href="#PumpWoodMicroService-633"><span class="linenos"> 633</span></a>                        <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-634"><a href="#PumpWoodMicroService-634"><span class="linenos"> 634</span></a>                        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-635"><a href="#PumpWoodMicroService-635"><span class="linenos"> 635</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List dimensions avaiable for model_class.</span>
</span><span id="PumpWoodMicroService-636"><a href="#PumpWoodMicroService-636"><span class="linenos"> 636</span></a>
</span><span id="PumpWoodMicroService-637"><a href="#PumpWoodMicroService-637"><span class="linenos"> 637</span></a><span class="sd">        It list all keys avaiable at dimension retricting the results with</span>
</span><span id="PumpWoodMicroService-638"><a href="#PumpWoodMicroService-638"><span class="linenos"> 638</span></a><span class="sd">        query parameters `filter_dict` and `exclude_dict`.</span>
</span><span id="PumpWoodMicroService-639"><a href="#PumpWoodMicroService-639"><span class="linenos"> 639</span></a>
</span><span id="PumpWoodMicroService-640"><a href="#PumpWoodMicroService-640"><span class="linenos"> 640</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-641"><a href="#PumpWoodMicroService-641"><span class="linenos"> 641</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-642"><a href="#PumpWoodMicroService-642"><span class="linenos"> 642</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="PumpWoodMicroService-643"><a href="#PumpWoodMicroService-643"><span class="linenos"> 643</span></a><span class="sd">            filter_dict:</span>
</span><span id="PumpWoodMicroService-644"><a href="#PumpWoodMicroService-644"><span class="linenos"> 644</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="PumpWoodMicroService-645"><a href="#PumpWoodMicroService-645"><span class="linenos"> 645</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService-646"><a href="#PumpWoodMicroService-646"><span class="linenos"> 646</span></a><span class="sd">            exclude_dict:</span>
</span><span id="PumpWoodMicroService-647"><a href="#PumpWoodMicroService-647"><span class="linenos"> 647</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="PumpWoodMicroService-648"><a href="#PumpWoodMicroService-648"><span class="linenos"> 648</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService-649"><a href="#PumpWoodMicroService-649"><span class="linenos"> 649</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-650"><a href="#PumpWoodMicroService-650"><span class="linenos"> 650</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-651"><a href="#PumpWoodMicroService-651"><span class="linenos"> 651</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-652"><a href="#PumpWoodMicroService-652"><span class="linenos"> 652</span></a>
</span><span id="PumpWoodMicroService-653"><a href="#PumpWoodMicroService-653"><span class="linenos"> 653</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-654"><a href="#PumpWoodMicroService-654"><span class="linenos"> 654</span></a><span class="sd">            List of keys avaiable in results from the query dict.</span>
</span><span id="PumpWoodMicroService-655"><a href="#PumpWoodMicroService-655"><span class="linenos"> 655</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-656"><a href="#PumpWoodMicroService-656"><span class="linenos"> 656</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_dimensions</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-657"><a href="#PumpWoodMicroService-657"><span class="linenos"> 657</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">}</span>
</span><span id="PumpWoodMicroService-658"><a href="#PumpWoodMicroService-658"><span class="linenos"> 658</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-659"><a href="#PumpWoodMicroService-659"><span class="linenos"> 659</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-660"><a href="#PumpWoodMicroService-660"><span class="linenos"> 660</span></a>
</span><span id="PumpWoodMicroService-661"><a href="#PumpWoodMicroService-661"><span class="linenos"> 661</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PumpWoodMicroService-662"><a href="#PumpWoodMicroService-662"><span class="linenos"> 662</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_list_dimension_values</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-663"><a href="#PumpWoodMicroService-663"><span class="linenos"> 663</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/list-dimension-values/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="p">)</span>
</span><span id="PumpWoodMicroService-664"><a href="#PumpWoodMicroService-664"><span class="linenos"> 664</span></a>
</span><span id="PumpWoodMicroService-665"><a href="#PumpWoodMicroService-665"><span class="linenos"> 665</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_dimension_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-666"><a href="#PumpWoodMicroService-666"><span class="linenos"> 666</span></a>                              <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService-667"><a href="#PumpWoodMicroService-667"><span class="linenos"> 667</span></a>                              <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">any</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-668"><a href="#PumpWoodMicroService-668"><span class="linenos"> 668</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List values associated with dimensions key.</span>
</span><span id="PumpWoodMicroService-669"><a href="#PumpWoodMicroService-669"><span class="linenos"> 669</span></a>
</span><span id="PumpWoodMicroService-670"><a href="#PumpWoodMicroService-670"><span class="linenos"> 670</span></a><span class="sd">        It list all keys avaiable at dimension retricting the results with</span>
</span><span id="PumpWoodMicroService-671"><a href="#PumpWoodMicroService-671"><span class="linenos"> 671</span></a><span class="sd">        query parameters `filter_dict` and `exclude_dict`.</span>
</span><span id="PumpWoodMicroService-672"><a href="#PumpWoodMicroService-672"><span class="linenos"> 672</span></a>
</span><span id="PumpWoodMicroService-673"><a href="#PumpWoodMicroService-673"><span class="linenos"> 673</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-674"><a href="#PumpWoodMicroService-674"><span class="linenos"> 674</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-675"><a href="#PumpWoodMicroService-675"><span class="linenos"> 675</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="PumpWoodMicroService-676"><a href="#PumpWoodMicroService-676"><span class="linenos"> 676</span></a><span class="sd">            filter_dict:</span>
</span><span id="PumpWoodMicroService-677"><a href="#PumpWoodMicroService-677"><span class="linenos"> 677</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="PumpWoodMicroService-678"><a href="#PumpWoodMicroService-678"><span class="linenos"> 678</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService-679"><a href="#PumpWoodMicroService-679"><span class="linenos"> 679</span></a><span class="sd">            exclude_dict:</span>
</span><span id="PumpWoodMicroService-680"><a href="#PumpWoodMicroService-680"><span class="linenos"> 680</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="PumpWoodMicroService-681"><a href="#PumpWoodMicroService-681"><span class="linenos"> 681</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService-682"><a href="#PumpWoodMicroService-682"><span class="linenos"> 682</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-683"><a href="#PumpWoodMicroService-683"><span class="linenos"> 683</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-684"><a href="#PumpWoodMicroService-684"><span class="linenos"> 684</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-685"><a href="#PumpWoodMicroService-685"><span class="linenos"> 685</span></a><span class="sd">            key:</span>
</span><span id="PumpWoodMicroService-686"><a href="#PumpWoodMicroService-686"><span class="linenos"> 686</span></a><span class="sd">                Key to list the avaiable values using the query filter</span>
</span><span id="PumpWoodMicroService-687"><a href="#PumpWoodMicroService-687"><span class="linenos"> 687</span></a><span class="sd">                and exclude.</span>
</span><span id="PumpWoodMicroService-688"><a href="#PumpWoodMicroService-688"><span class="linenos"> 688</span></a>
</span><span id="PumpWoodMicroService-689"><a href="#PumpWoodMicroService-689"><span class="linenos"> 689</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-690"><a href="#PumpWoodMicroService-690"><span class="linenos"> 690</span></a><span class="sd">            List of values associated with dimensions key at the objects that</span>
</span><span id="PumpWoodMicroService-691"><a href="#PumpWoodMicroService-691"><span class="linenos"> 691</span></a><span class="sd">            are returned with `filter_dict` and `exclude_dict`.</span>
</span><span id="PumpWoodMicroService-692"><a href="#PumpWoodMicroService-692"><span class="linenos"> 692</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-693"><a href="#PumpWoodMicroService-693"><span class="linenos"> 693</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_dimension_values</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-694"><a href="#PumpWoodMicroService-694"><span class="linenos"> 694</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-695"><a href="#PumpWoodMicroService-695"><span class="linenos"> 695</span></a>                     <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
</span><span id="PumpWoodMicroService-696"><a href="#PumpWoodMicroService-696"><span class="linenos"> 696</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-697"><a href="#PumpWoodMicroService-697"><span class="linenos"> 697</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-698"><a href="#PumpWoodMicroService-698"><span class="linenos"> 698</span></a>
</span><span id="PumpWoodMicroService-699"><a href="#PumpWoodMicroService-699"><span class="linenos"> 699</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-700"><a href="#PumpWoodMicroService-700"><span class="linenos"> 700</span></a>                     <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-701"><a href="#PumpWoodMicroService-701"><span class="linenos"> 701</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of all actions avaiable at this model class.</span>
</span><span id="PumpWoodMicroService-702"><a href="#PumpWoodMicroService-702"><span class="linenos"> 702</span></a>
</span><span id="PumpWoodMicroService-703"><a href="#PumpWoodMicroService-703"><span class="linenos"> 703</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-704"><a href="#PumpWoodMicroService-704"><span class="linenos"> 704</span></a><span class="sd">          model_class:</span>
</span><span id="PumpWoodMicroService-705"><a href="#PumpWoodMicroService-705"><span class="linenos"> 705</span></a><span class="sd">              Model class to list possible actions.</span>
</span><span id="PumpWoodMicroService-706"><a href="#PumpWoodMicroService-706"><span class="linenos"> 706</span></a><span class="sd">          auth_header:</span>
</span><span id="PumpWoodMicroService-707"><a href="#PumpWoodMicroService-707"><span class="linenos"> 707</span></a><span class="sd">              Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-708"><a href="#PumpWoodMicroService-708"><span class="linenos"> 708</span></a><span class="sd">              at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-709"><a href="#PumpWoodMicroService-709"><span class="linenos"> 709</span></a>
</span><span id="PumpWoodMicroService-710"><a href="#PumpWoodMicroService-710"><span class="linenos"> 710</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-711"><a href="#PumpWoodMicroService-711"><span class="linenos"> 711</span></a><span class="sd">          List of possible actions and its descriptions.</span>
</span><span id="PumpWoodMicroService-712"><a href="#PumpWoodMicroService-712"><span class="linenos"> 712</span></a>
</span><span id="PumpWoodMicroService-713"><a href="#PumpWoodMicroService-713"><span class="linenos"> 713</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-714"><a href="#PumpWoodMicroService-714"><span class="linenos"> 714</span></a><span class="sd">            No particular errors.</span>
</span><span id="PumpWoodMicroService-715"><a href="#PumpWoodMicroService-715"><span class="linenos"> 715</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-716"><a href="#PumpWoodMicroService-716"><span class="linenos"> 716</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/actions/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="PumpWoodMicroService-717"><a href="#PumpWoodMicroService-717"><span class="linenos"> 717</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-718"><a href="#PumpWoodMicroService-718"><span class="linenos"> 718</span></a>
</span><span id="PumpWoodMicroService-719"><a href="#PumpWoodMicroService-719"><span class="linenos"> 719</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PumpWoodMicroService-720"><a href="#PumpWoodMicroService-720"><span class="linenos"> 720</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_execute_action_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-721"><a href="#PumpWoodMicroService-721"><span class="linenos"> 721</span></a>                                  <span class="n">pk</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-722"><a href="#PumpWoodMicroService-722"><span class="linenos"> 722</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/actions/</span><span class="si">%s</span><span class="s2">/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">action</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-723"><a href="#PumpWoodMicroService-723"><span class="linenos"> 723</span></a>        <span class="k">if</span> <span class="n">pk</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-724"><a href="#PumpWoodMicroService-724"><span class="linenos"> 724</span></a>            <span class="n">url_str</span> <span class="o">=</span> <span class="n">url_str</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
</span><span id="PumpWoodMicroService-725"><a href="#PumpWoodMicroService-725"><span class="linenos"> 725</span></a>        <span class="k">return</span> <span class="n">url_str</span>
</span><span id="PumpWoodMicroService-726"><a href="#PumpWoodMicroService-726"><span class="linenos"> 726</span></a>
</span><span id="PumpWoodMicroService-727"><a href="#PumpWoodMicroService-727"><span class="linenos"> 727</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">execute_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pk</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-728"><a href="#PumpWoodMicroService-728"><span class="linenos"> 728</span></a>                       <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">files</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-729"><a href="#PumpWoodMicroService-729"><span class="linenos"> 729</span></a>                       <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-730"><a href="#PumpWoodMicroService-730"><span class="linenos"> 730</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute action associated with a model class.</span>
</span><span id="PumpWoodMicroService-731"><a href="#PumpWoodMicroService-731"><span class="linenos"> 731</span></a>
</span><span id="PumpWoodMicroService-732"><a href="#PumpWoodMicroService-732"><span class="linenos"> 732</span></a><span class="sd">        If action is static or classfunction no pk is necessary.</span>
</span><span id="PumpWoodMicroService-733"><a href="#PumpWoodMicroService-733"><span class="linenos"> 733</span></a>
</span><span id="PumpWoodMicroService-734"><a href="#PumpWoodMicroService-734"><span class="linenos"> 734</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-735"><a href="#PumpWoodMicroService-735"><span class="linenos"> 735</span></a><span class="sd">            pk (int):</span>
</span><span id="PumpWoodMicroService-736"><a href="#PumpWoodMicroService-736"><span class="linenos"> 736</span></a><span class="sd">                PK of the object to run action at. If not set action will be</span>
</span><span id="PumpWoodMicroService-737"><a href="#PumpWoodMicroService-737"><span class="linenos"> 737</span></a><span class="sd">                considered a classmethod and will run over the class.</span>
</span><span id="PumpWoodMicroService-738"><a href="#PumpWoodMicroService-738"><span class="linenos"> 738</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-739"><a href="#PumpWoodMicroService-739"><span class="linenos"> 739</span></a><span class="sd">                Model class to run action the object</span>
</span><span id="PumpWoodMicroService-740"><a href="#PumpWoodMicroService-740"><span class="linenos"> 740</span></a><span class="sd">            action:</span>
</span><span id="PumpWoodMicroService-741"><a href="#PumpWoodMicroService-741"><span class="linenos"> 741</span></a><span class="sd">                Action that will be performed.</span>
</span><span id="PumpWoodMicroService-742"><a href="#PumpWoodMicroService-742"><span class="linenos"> 742</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-743"><a href="#PumpWoodMicroService-743"><span class="linenos"> 743</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-744"><a href="#PumpWoodMicroService-744"><span class="linenos"> 744</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-745"><a href="#PumpWoodMicroService-745"><span class="linenos"> 745</span></a><span class="sd">            parameters:</span>
</span><span id="PumpWoodMicroService-746"><a href="#PumpWoodMicroService-746"><span class="linenos"> 746</span></a><span class="sd">                Dictionary with the function parameters.</span>
</span><span id="PumpWoodMicroService-747"><a href="#PumpWoodMicroService-747"><span class="linenos"> 747</span></a><span class="sd">            files:</span>
</span><span id="PumpWoodMicroService-748"><a href="#PumpWoodMicroService-748"><span class="linenos"> 748</span></a><span class="sd">                A dictionary of files to be added to as a multi-part</span>
</span><span id="PumpWoodMicroService-749"><a href="#PumpWoodMicroService-749"><span class="linenos"> 749</span></a><span class="sd">                post request. File must be passed as a file object with read</span>
</span><span id="PumpWoodMicroService-750"><a href="#PumpWoodMicroService-750"><span class="linenos"> 750</span></a><span class="sd">                bytes.</span>
</span><span id="PumpWoodMicroService-751"><a href="#PumpWoodMicroService-751"><span class="linenos"> 751</span></a>
</span><span id="PumpWoodMicroService-752"><a href="#PumpWoodMicroService-752"><span class="linenos"> 752</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-753"><a href="#PumpWoodMicroService-753"><span class="linenos"> 753</span></a><span class="sd">            Return a dictonary with keys:</span>
</span><span id="PumpWoodMicroService-754"><a href="#PumpWoodMicroService-754"><span class="linenos"> 754</span></a><span class="sd">            - **result:**: Result of the action that was performed.</span>
</span><span id="PumpWoodMicroService-755"><a href="#PumpWoodMicroService-755"><span class="linenos"> 755</span></a><span class="sd">            - **action:**: Information of the action that was performed.</span>
</span><span id="PumpWoodMicroService-756"><a href="#PumpWoodMicroService-756"><span class="linenos"> 756</span></a><span class="sd">            - **parameters:** Parameters that were passed to perform the</span>
</span><span id="PumpWoodMicroService-757"><a href="#PumpWoodMicroService-757"><span class="linenos"> 757</span></a><span class="sd">                action.</span>
</span><span id="PumpWoodMicroService-758"><a href="#PumpWoodMicroService-758"><span class="linenos"> 758</span></a><span class="sd">            - **object:** If a pk was passed to execute and action (not</span>
</span><span id="PumpWoodMicroService-759"><a href="#PumpWoodMicroService-759"><span class="linenos"> 759</span></a><span class="sd">                classmethod or staticmethod), the object with the correspondent</span>
</span><span id="PumpWoodMicroService-760"><a href="#PumpWoodMicroService-760"><span class="linenos"> 760</span></a><span class="sd">                pk is returned.</span>
</span><span id="PumpWoodMicroService-761"><a href="#PumpWoodMicroService-761"><span class="linenos"> 761</span></a>
</span><span id="PumpWoodMicroService-762"><a href="#PumpWoodMicroService-762"><span class="linenos"> 762</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-763"><a href="#PumpWoodMicroService-763"><span class="linenos"> 763</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-764"><a href="#PumpWoodMicroService-764"><span class="linenos"> 764</span></a><span class="sd">                &#39;There is no method {action} in rest actions for {class_name}&#39;.</span>
</span><span id="PumpWoodMicroService-765"><a href="#PumpWoodMicroService-765"><span class="linenos"> 765</span></a><span class="sd">                This indicates that action requested is not associated with</span>
</span><span id="PumpWoodMicroService-766"><a href="#PumpWoodMicroService-766"><span class="linenos"> 766</span></a><span class="sd">                the model_class.</span>
</span><span id="PumpWoodMicroService-767"><a href="#PumpWoodMicroService-767"><span class="linenos"> 767</span></a><span class="sd">            PumpWoodActionArgsException:</span>
</span><span id="PumpWoodMicroService-768"><a href="#PumpWoodMicroService-768"><span class="linenos"> 768</span></a><span class="sd">                &#39;Function is not static and pk is Null&#39;. This indicate that</span>
</span><span id="PumpWoodMicroService-769"><a href="#PumpWoodMicroService-769"><span class="linenos"> 769</span></a><span class="sd">                the action solicitated is not static/class method and a pk</span>
</span><span id="PumpWoodMicroService-770"><a href="#PumpWoodMicroService-770"><span class="linenos"> 770</span></a><span class="sd">                was not passed as argument.</span>
</span><span id="PumpWoodMicroService-771"><a href="#PumpWoodMicroService-771"><span class="linenos"> 771</span></a><span class="sd">            PumpWoodActionArgsException:</span>
</span><span id="PumpWoodMicroService-772"><a href="#PumpWoodMicroService-772"><span class="linenos"> 772</span></a><span class="sd">                &#39;Function is static and pk is not Null&#39;. This indicate that</span>
</span><span id="PumpWoodMicroService-773"><a href="#PumpWoodMicroService-773"><span class="linenos"> 773</span></a><span class="sd">                the action solicitated is static/class method and a pk</span>
</span><span id="PumpWoodMicroService-774"><a href="#PumpWoodMicroService-774"><span class="linenos"> 774</span></a><span class="sd">                was passed as argument.</span>
</span><span id="PumpWoodMicroService-775"><a href="#PumpWoodMicroService-775"><span class="linenos"> 775</span></a><span class="sd">            PumpWoodObjectDoesNotExist:</span>
</span><span id="PumpWoodMicroService-776"><a href="#PumpWoodMicroService-776"><span class="linenos"> 776</span></a><span class="sd">                &#39;Requested object {model_class}[{pk}] not found.&#39;. This</span>
</span><span id="PumpWoodMicroService-777"><a href="#PumpWoodMicroService-777"><span class="linenos"> 777</span></a><span class="sd">                indicate that pk associated with model class was not found</span>
</span><span id="PumpWoodMicroService-778"><a href="#PumpWoodMicroService-778"><span class="linenos"> 778</span></a><span class="sd">                on database.</span>
</span><span id="PumpWoodMicroService-779"><a href="#PumpWoodMicroService-779"><span class="linenos"> 779</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-780"><a href="#PumpWoodMicroService-780"><span class="linenos"> 780</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_execute_action_url</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-781"><a href="#PumpWoodMicroService-781"><span class="linenos"> 781</span></a>            <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-782"><a href="#PumpWoodMicroService-782"><span class="linenos"> 782</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-783"><a href="#PumpWoodMicroService-783"><span class="linenos"> 783</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-784"><a href="#PumpWoodMicroService-784"><span class="linenos"> 784</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-785"><a href="#PumpWoodMicroService-785"><span class="linenos"> 785</span></a>
</span><span id="PumpWoodMicroService-786"><a href="#PumpWoodMicroService-786"><span class="linenos"> 786</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">search_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-787"><a href="#PumpWoodMicroService-787"><span class="linenos"> 787</span></a>                       <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-788"><a href="#PumpWoodMicroService-788"><span class="linenos"> 788</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return search options.</span>
</span><span id="PumpWoodMicroService-789"><a href="#PumpWoodMicroService-789"><span class="linenos"> 789</span></a>
</span><span id="PumpWoodMicroService-790"><a href="#PumpWoodMicroService-790"><span class="linenos"> 790</span></a><span class="sd">        DEPRECTED Use `list_options` function instead.</span>
</span><span id="PumpWoodMicroService-791"><a href="#PumpWoodMicroService-791"><span class="linenos"> 791</span></a>
</span><span id="PumpWoodMicroService-792"><a href="#PumpWoodMicroService-792"><span class="linenos"> 792</span></a><span class="sd">        Return information of the fields including avaiable options for</span>
</span><span id="PumpWoodMicroService-793"><a href="#PumpWoodMicroService-793"><span class="linenos"> 793</span></a><span class="sd">        options fields and model associated with the foreign key.</span>
</span><span id="PumpWoodMicroService-794"><a href="#PumpWoodMicroService-794"><span class="linenos"> 794</span></a>
</span><span id="PumpWoodMicroService-795"><a href="#PumpWoodMicroService-795"><span class="linenos"> 795</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-796"><a href="#PumpWoodMicroService-796"><span class="linenos"> 796</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-797"><a href="#PumpWoodMicroService-797"><span class="linenos"> 797</span></a><span class="sd">                Model class to check search parameters</span>
</span><span id="PumpWoodMicroService-798"><a href="#PumpWoodMicroService-798"><span class="linenos"> 798</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-799"><a href="#PumpWoodMicroService-799"><span class="linenos"> 799</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-800"><a href="#PumpWoodMicroService-800"><span class="linenos"> 800</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-801"><a href="#PumpWoodMicroService-801"><span class="linenos"> 801</span></a>
</span><span id="PumpWoodMicroService-802"><a href="#PumpWoodMicroService-802"><span class="linenos"> 802</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-803"><a href="#PumpWoodMicroService-803"><span class="linenos"> 803</span></a><span class="sd">            Return a dictonary with field names as keys and information of</span>
</span><span id="PumpWoodMicroService-804"><a href="#PumpWoodMicroService-804"><span class="linenos"> 804</span></a><span class="sd">            them as values. Information at values:</span>
</span><span id="PumpWoodMicroService-805"><a href="#PumpWoodMicroService-805"><span class="linenos"> 805</span></a><span class="sd">            - **primary_key [bool]:**: Boolean indicating if field is part</span>
</span><span id="PumpWoodMicroService-806"><a href="#PumpWoodMicroService-806"><span class="linenos"> 806</span></a><span class="sd">                of model_class primary key.</span>
</span><span id="PumpWoodMicroService-807"><a href="#PumpWoodMicroService-807"><span class="linenos"> 807</span></a><span class="sd">            - **column [str]:**: Name of the column.</span>
</span><span id="PumpWoodMicroService-808"><a href="#PumpWoodMicroService-808"><span class="linenos"> 808</span></a><span class="sd">            - **column__verbose [str]:** Name of the column translated using</span>
</span><span id="PumpWoodMicroService-809"><a href="#PumpWoodMicroService-809"><span class="linenos"> 809</span></a><span class="sd">                Pumpwood I8s.</span>
</span><span id="PumpWoodMicroService-810"><a href="#PumpWoodMicroService-810"><span class="linenos"> 810</span></a><span class="sd">            - **help_text [str]:** Help text associated with column.</span>
</span><span id="PumpWoodMicroService-811"><a href="#PumpWoodMicroService-811"><span class="linenos"> 811</span></a><span class="sd">            - **help_text__verbose [str]:** Help text associated with column</span>
</span><span id="PumpWoodMicroService-812"><a href="#PumpWoodMicroService-812"><span class="linenos"> 812</span></a><span class="sd">                translated using Pumpwood I8s.</span>
</span><span id="PumpWoodMicroService-813"><a href="#PumpWoodMicroService-813"><span class="linenos"> 813</span></a><span class="sd">            - **type [str]:** Python type associated with the column.</span>
</span><span id="PumpWoodMicroService-814"><a href="#PumpWoodMicroService-814"><span class="linenos"> 814</span></a><span class="sd">            - **nullable [bool]:** If field can be set as null (None).</span>
</span><span id="PumpWoodMicroService-815"><a href="#PumpWoodMicroService-815"><span class="linenos"> 815</span></a><span class="sd">            - **read_only [bool]:** If field is marked as read-only. Passsing</span>
</span><span id="PumpWoodMicroService-816"><a href="#PumpWoodMicroService-816"><span class="linenos"> 816</span></a><span class="sd">                information for this field will not be used in save end-point.</span>
</span><span id="PumpWoodMicroService-817"><a href="#PumpWoodMicroService-817"><span class="linenos"> 817</span></a><span class="sd">            - **default [any]:** Default value of the field if not set using</span>
</span><span id="PumpWoodMicroService-818"><a href="#PumpWoodMicroService-818"><span class="linenos"> 818</span></a><span class="sd">                save end-poin.</span>
</span><span id="PumpWoodMicroService-819"><a href="#PumpWoodMicroService-819"><span class="linenos"> 819</span></a><span class="sd">            - **unique [bool]:** If the there is a constrain in database</span>
</span><span id="PumpWoodMicroService-820"><a href="#PumpWoodMicroService-820"><span class="linenos"> 820</span></a><span class="sd">                setting this field to be unique.</span>
</span><span id="PumpWoodMicroService-821"><a href="#PumpWoodMicroService-821"><span class="linenos"> 821</span></a><span class="sd">            - **extra_info:** Some extra infomations used to pass associated</span>
</span><span id="PumpWoodMicroService-822"><a href="#PumpWoodMicroService-822"><span class="linenos"> 822</span></a><span class="sd">                model class for forenging key and related fields.</span>
</span><span id="PumpWoodMicroService-823"><a href="#PumpWoodMicroService-823"><span class="linenos"> 823</span></a><span class="sd">            - **in [dict]:** At options fields, have their options listed in</span>
</span><span id="PumpWoodMicroService-824"><a href="#PumpWoodMicroService-824"><span class="linenos"> 824</span></a><span class="sd">                `in` keys. It will return the values as key and de description</span>
</span><span id="PumpWoodMicroService-825"><a href="#PumpWoodMicroService-825"><span class="linenos"> 825</span></a><span class="sd">                and description__verbose (translated by Pumpwood I8s)</span>
</span><span id="PumpWoodMicroService-826"><a href="#PumpWoodMicroService-826"><span class="linenos"> 826</span></a><span class="sd">                as values.</span>
</span><span id="PumpWoodMicroService-827"><a href="#PumpWoodMicroService-827"><span class="linenos"> 827</span></a><span class="sd">            - **partition:** At pk field, this key indicates if the database</span>
</span><span id="PumpWoodMicroService-828"><a href="#PumpWoodMicroService-828"><span class="linenos"> 828</span></a><span class="sd">                if partitioned. Partitioned will perform better in queries if</span>
</span><span id="PumpWoodMicroService-829"><a href="#PumpWoodMicroService-829"><span class="linenos"> 829</span></a><span class="sd">                partition is used on filter or exclude clauses. If table has</span>
</span><span id="PumpWoodMicroService-830"><a href="#PumpWoodMicroService-830"><span class="linenos"> 830</span></a><span class="sd">                more than one level o partition, at least the first one must</span>
</span><span id="PumpWoodMicroService-831"><a href="#PumpWoodMicroService-831"><span class="linenos"> 831</span></a><span class="sd">                be used when retrieving data.</span>
</span><span id="PumpWoodMicroService-832"><a href="#PumpWoodMicroService-832"><span class="linenos"> 832</span></a>
</span><span id="PumpWoodMicroService-833"><a href="#PumpWoodMicroService-833"><span class="linenos"> 833</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-834"><a href="#PumpWoodMicroService-834"><span class="linenos"> 834</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService-835"><a href="#PumpWoodMicroService-835"><span class="linenos"> 835</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-836"><a href="#PumpWoodMicroService-836"><span class="linenos"> 836</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/options/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="p">)</span>
</span><span id="PumpWoodMicroService-837"><a href="#PumpWoodMicroService-837"><span class="linenos"> 837</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-838"><a href="#PumpWoodMicroService-838"><span class="linenos"> 838</span></a>
</span><span id="PumpWoodMicroService-839"><a href="#PumpWoodMicroService-839"><span class="linenos"> 839</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fill_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">,</span> <span class="n">parcial_obj_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService-840"><a href="#PumpWoodMicroService-840"><span class="linenos"> 840</span></a>                     <span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-841"><a href="#PumpWoodMicroService-841"><span class="linenos"> 841</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options for object fields.</span>
</span><span id="PumpWoodMicroService-842"><a href="#PumpWoodMicroService-842"><span class="linenos"> 842</span></a>
</span><span id="PumpWoodMicroService-843"><a href="#PumpWoodMicroService-843"><span class="linenos"> 843</span></a><span class="sd">        DEPRECTED Use `fill_validation` function instead.</span>
</span><span id="PumpWoodMicroService-844"><a href="#PumpWoodMicroService-844"><span class="linenos"> 844</span></a>
</span><span id="PumpWoodMicroService-845"><a href="#PumpWoodMicroService-845"><span class="linenos"> 845</span></a><span class="sd">        This function send partial object data and return options to finish</span>
</span><span id="PumpWoodMicroService-846"><a href="#PumpWoodMicroService-846"><span class="linenos"> 846</span></a><span class="sd">        object fillment.</span>
</span><span id="PumpWoodMicroService-847"><a href="#PumpWoodMicroService-847"><span class="linenos"> 847</span></a>
</span><span id="PumpWoodMicroService-848"><a href="#PumpWoodMicroService-848"><span class="linenos"> 848</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-849"><a href="#PumpWoodMicroService-849"><span class="linenos"> 849</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-850"><a href="#PumpWoodMicroService-850"><span class="linenos"> 850</span></a><span class="sd">                Model class to check search parameters</span>
</span><span id="PumpWoodMicroService-851"><a href="#PumpWoodMicroService-851"><span class="linenos"> 851</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-852"><a href="#PumpWoodMicroService-852"><span class="linenos"> 852</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-853"><a href="#PumpWoodMicroService-853"><span class="linenos"> 853</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-854"><a href="#PumpWoodMicroService-854"><span class="linenos"> 854</span></a><span class="sd">            parcial_obj_dict:</span>
</span><span id="PumpWoodMicroService-855"><a href="#PumpWoodMicroService-855"><span class="linenos"> 855</span></a><span class="sd">                Partial object that is sent to backend for validation and</span>
</span><span id="PumpWoodMicroService-856"><a href="#PumpWoodMicroService-856"><span class="linenos"> 856</span></a><span class="sd">                update fill options acording to values passed for each field.</span>
</span><span id="PumpWoodMicroService-857"><a href="#PumpWoodMicroService-857"><span class="linenos"> 857</span></a><span class="sd">            field:</span>
</span><span id="PumpWoodMicroService-858"><a href="#PumpWoodMicroService-858"><span class="linenos"> 858</span></a><span class="sd">                Retrict validation for an especific field if implemented.</span>
</span><span id="PumpWoodMicroService-859"><a href="#PumpWoodMicroService-859"><span class="linenos"> 859</span></a>
</span><span id="PumpWoodMicroService-860"><a href="#PumpWoodMicroService-860"><span class="linenos"> 860</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-861"><a href="#PumpWoodMicroService-861"><span class="linenos"> 861</span></a><span class="sd">            Return a dictonary with field names as keys and information of</span>
</span><span id="PumpWoodMicroService-862"><a href="#PumpWoodMicroService-862"><span class="linenos"> 862</span></a><span class="sd">            them as values. Information at values:</span>
</span><span id="PumpWoodMicroService-863"><a href="#PumpWoodMicroService-863"><span class="linenos"> 863</span></a><span class="sd">            - **primary_key [bool]:**: Boolean indicating if field is part</span>
</span><span id="PumpWoodMicroService-864"><a href="#PumpWoodMicroService-864"><span class="linenos"> 864</span></a><span class="sd">                of model_class primary key.</span>
</span><span id="PumpWoodMicroService-865"><a href="#PumpWoodMicroService-865"><span class="linenos"> 865</span></a><span class="sd">            - **column [str]:**: Name of the column.</span>
</span><span id="PumpWoodMicroService-866"><a href="#PumpWoodMicroService-866"><span class="linenos"> 866</span></a><span class="sd">            - **column__verbose [str]:** Name of the column translated using</span>
</span><span id="PumpWoodMicroService-867"><a href="#PumpWoodMicroService-867"><span class="linenos"> 867</span></a><span class="sd">                Pumpwood I8s.</span>
</span><span id="PumpWoodMicroService-868"><a href="#PumpWoodMicroService-868"><span class="linenos"> 868</span></a><span class="sd">            - **help_text [str]:** Help text associated with column.</span>
</span><span id="PumpWoodMicroService-869"><a href="#PumpWoodMicroService-869"><span class="linenos"> 869</span></a><span class="sd">            - **help_text__verbose [str]:** Help text associated with column</span>
</span><span id="PumpWoodMicroService-870"><a href="#PumpWoodMicroService-870"><span class="linenos"> 870</span></a><span class="sd">                translated using Pumpwood I8s.</span>
</span><span id="PumpWoodMicroService-871"><a href="#PumpWoodMicroService-871"><span class="linenos"> 871</span></a><span class="sd">            - **type [str]:** Python type associated with the column.</span>
</span><span id="PumpWoodMicroService-872"><a href="#PumpWoodMicroService-872"><span class="linenos"> 872</span></a><span class="sd">            - **nullable [bool]:** If field can be set as null (None).</span>
</span><span id="PumpWoodMicroService-873"><a href="#PumpWoodMicroService-873"><span class="linenos"> 873</span></a><span class="sd">            - **read_only [bool]:** If field is marked as read-only. Passsing</span>
</span><span id="PumpWoodMicroService-874"><a href="#PumpWoodMicroService-874"><span class="linenos"> 874</span></a><span class="sd">                information for this field will not be used in save end-point.</span>
</span><span id="PumpWoodMicroService-875"><a href="#PumpWoodMicroService-875"><span class="linenos"> 875</span></a><span class="sd">            - **default [any]:** Default value of the field if not set using</span>
</span><span id="PumpWoodMicroService-876"><a href="#PumpWoodMicroService-876"><span class="linenos"> 876</span></a><span class="sd">                save end-poin.</span>
</span><span id="PumpWoodMicroService-877"><a href="#PumpWoodMicroService-877"><span class="linenos"> 877</span></a><span class="sd">            - **unique [bool]:** If the there is a constrain in database</span>
</span><span id="PumpWoodMicroService-878"><a href="#PumpWoodMicroService-878"><span class="linenos"> 878</span></a><span class="sd">                setting this field to be unique.</span>
</span><span id="PumpWoodMicroService-879"><a href="#PumpWoodMicroService-879"><span class="linenos"> 879</span></a><span class="sd">            - **extra_info:** Some extra infomations used to pass associated</span>
</span><span id="PumpWoodMicroService-880"><a href="#PumpWoodMicroService-880"><span class="linenos"> 880</span></a><span class="sd">                model class for forenging key and related fields.</span>
</span><span id="PumpWoodMicroService-881"><a href="#PumpWoodMicroService-881"><span class="linenos"> 881</span></a><span class="sd">            - **in [dict]:** At options fields, have their options listed in</span>
</span><span id="PumpWoodMicroService-882"><a href="#PumpWoodMicroService-882"><span class="linenos"> 882</span></a><span class="sd">                `in` keys. It will return the values as key and de description</span>
</span><span id="PumpWoodMicroService-883"><a href="#PumpWoodMicroService-883"><span class="linenos"> 883</span></a><span class="sd">                and description__verbose (translated by Pumpwood I8s)</span>
</span><span id="PumpWoodMicroService-884"><a href="#PumpWoodMicroService-884"><span class="linenos"> 884</span></a><span class="sd">                as values.</span>
</span><span id="PumpWoodMicroService-885"><a href="#PumpWoodMicroService-885"><span class="linenos"> 885</span></a><span class="sd">            - **partition:** At pk field, this key indicates if the database</span>
</span><span id="PumpWoodMicroService-886"><a href="#PumpWoodMicroService-886"><span class="linenos"> 886</span></a><span class="sd">                if partitioned. Partitioned will perform better in queries if</span>
</span><span id="PumpWoodMicroService-887"><a href="#PumpWoodMicroService-887"><span class="linenos"> 887</span></a><span class="sd">                partition is used on filter or exclude clauses. If table has</span>
</span><span id="PumpWoodMicroService-888"><a href="#PumpWoodMicroService-888"><span class="linenos"> 888</span></a><span class="sd">                more than one level o partition, at least the first one must</span>
</span><span id="PumpWoodMicroService-889"><a href="#PumpWoodMicroService-889"><span class="linenos"> 889</span></a><span class="sd">                be used when retrieving data.</span>
</span><span id="PumpWoodMicroService-890"><a href="#PumpWoodMicroService-890"><span class="linenos"> 890</span></a>
</span><span id="PumpWoodMicroService-891"><a href="#PumpWoodMicroService-891"><span class="linenos"> 891</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-892"><a href="#PumpWoodMicroService-892"><span class="linenos"> 892</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService-893"><a href="#PumpWoodMicroService-893"><span class="linenos"> 893</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-894"><a href="#PumpWoodMicroService-894"><span class="linenos"> 894</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/options/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="p">)</span>
</span><span id="PumpWoodMicroService-895"><a href="#PumpWoodMicroService-895"><span class="linenos"> 895</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-896"><a href="#PumpWoodMicroService-896"><span class="linenos"> 896</span></a>            <span class="n">url_str</span> <span class="o">=</span> <span class="n">url_str</span> <span class="o">+</span> <span class="n">field</span>
</span><span id="PumpWoodMicroService-897"><a href="#PumpWoodMicroService-897"><span class="linenos"> 897</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-898"><a href="#PumpWoodMicroService-898"><span class="linenos"> 898</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parcial_obj_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-899"><a href="#PumpWoodMicroService-899"><span class="linenos"> 899</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-900"><a href="#PumpWoodMicroService-900"><span class="linenos"> 900</span></a>
</span><span id="PumpWoodMicroService-901"><a href="#PumpWoodMicroService-901"><span class="linenos"> 901</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-902"><a href="#PumpWoodMicroService-902"><span class="linenos"> 902</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options to render list views.</span>
</span><span id="PumpWoodMicroService-903"><a href="#PumpWoodMicroService-903"><span class="linenos"> 903</span></a>
</span><span id="PumpWoodMicroService-904"><a href="#PumpWoodMicroService-904"><span class="linenos"> 904</span></a><span class="sd">        This function send partial object data and return options to finish</span>
</span><span id="PumpWoodMicroService-905"><a href="#PumpWoodMicroService-905"><span class="linenos"> 905</span></a><span class="sd">        object fillment.</span>
</span><span id="PumpWoodMicroService-906"><a href="#PumpWoodMicroService-906"><span class="linenos"> 906</span></a>
</span><span id="PumpWoodMicroService-907"><a href="#PumpWoodMicroService-907"><span class="linenos"> 907</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-908"><a href="#PumpWoodMicroService-908"><span class="linenos"> 908</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-909"><a href="#PumpWoodMicroService-909"><span class="linenos"> 909</span></a><span class="sd">                Model class to check search parameters.</span>
</span><span id="PumpWoodMicroService-910"><a href="#PumpWoodMicroService-910"><span class="linenos"> 910</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-911"><a href="#PumpWoodMicroService-911"><span class="linenos"> 911</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-912"><a href="#PumpWoodMicroService-912"><span class="linenos"> 912</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-913"><a href="#PumpWoodMicroService-913"><span class="linenos"> 913</span></a>
</span><span id="PumpWoodMicroService-914"><a href="#PumpWoodMicroService-914"><span class="linenos"> 914</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-915"><a href="#PumpWoodMicroService-915"><span class="linenos"> 915</span></a><span class="sd">            Dictionary with keys:</span>
</span><span id="PumpWoodMicroService-916"><a href="#PumpWoodMicroService-916"><span class="linenos"> 916</span></a><span class="sd">            - **default_list_fields:** Default list field defined on the</span>
</span><span id="PumpWoodMicroService-917"><a href="#PumpWoodMicroService-917"><span class="linenos"> 917</span></a><span class="sd">                application backend.</span>
</span><span id="PumpWoodMicroService-918"><a href="#PumpWoodMicroService-918"><span class="linenos"> 918</span></a><span class="sd">            - **field_descriptions:** Description of the fields associated</span>
</span><span id="PumpWoodMicroService-919"><a href="#PumpWoodMicroService-919"><span class="linenos"> 919</span></a><span class="sd">                with the model class.</span>
</span><span id="PumpWoodMicroService-920"><a href="#PumpWoodMicroService-920"><span class="linenos"> 920</span></a>
</span><span id="PumpWoodMicroService-921"><a href="#PumpWoodMicroService-921"><span class="linenos"> 921</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-922"><a href="#PumpWoodMicroService-922"><span class="linenos"> 922</span></a><span class="sd">          No particular raise.</span>
</span><span id="PumpWoodMicroService-923"><a href="#PumpWoodMicroService-923"><span class="linenos"> 923</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-924"><a href="#PumpWoodMicroService-924"><span class="linenos"> 924</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">{basename}</span><span class="s2">/list-options/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-925"><a href="#PumpWoodMicroService-925"><span class="linenos"> 925</span></a>            <span class="n">basename</span><span class="o">=</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="PumpWoodMicroService-926"><a href="#PumpWoodMicroService-926"><span class="linenos"> 926</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-927"><a href="#PumpWoodMicroService-927"><span class="linenos"> 927</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-928"><a href="#PumpWoodMicroService-928"><span class="linenos"> 928</span></a>
</span><span id="PumpWoodMicroService-929"><a href="#PumpWoodMicroService-929"><span class="linenos"> 929</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">retrieve_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-930"><a href="#PumpWoodMicroService-930"><span class="linenos"> 930</span></a>                         <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-931"><a href="#PumpWoodMicroService-931"><span class="linenos"> 931</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options to render retrieve views.</span>
</span><span id="PumpWoodMicroService-932"><a href="#PumpWoodMicroService-932"><span class="linenos"> 932</span></a>
</span><span id="PumpWoodMicroService-933"><a href="#PumpWoodMicroService-933"><span class="linenos"> 933</span></a><span class="sd">        Return information of the field sets that can be used to create</span>
</span><span id="PumpWoodMicroService-934"><a href="#PumpWoodMicroService-934"><span class="linenos"> 934</span></a><span class="sd">        frontend site. It also return a `verbose_field` which can be used</span>
</span><span id="PumpWoodMicroService-935"><a href="#PumpWoodMicroService-935"><span class="linenos"> 935</span></a><span class="sd">        to create the tittle of the page substituing the values with</span>
</span><span id="PumpWoodMicroService-936"><a href="#PumpWoodMicroService-936"><span class="linenos"> 936</span></a><span class="sd">        information of the object.</span>
</span><span id="PumpWoodMicroService-937"><a href="#PumpWoodMicroService-937"><span class="linenos"> 937</span></a>
</span><span id="PumpWoodMicroService-938"><a href="#PumpWoodMicroService-938"><span class="linenos"> 938</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-939"><a href="#PumpWoodMicroService-939"><span class="linenos"> 939</span></a><span class="sd">          model_class:</span>
</span><span id="PumpWoodMicroService-940"><a href="#PumpWoodMicroService-940"><span class="linenos"> 940</span></a><span class="sd">              Model class to check search parameters.</span>
</span><span id="PumpWoodMicroService-941"><a href="#PumpWoodMicroService-941"><span class="linenos"> 941</span></a><span class="sd">          auth_header:</span>
</span><span id="PumpWoodMicroService-942"><a href="#PumpWoodMicroService-942"><span class="linenos"> 942</span></a><span class="sd">              Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-943"><a href="#PumpWoodMicroService-943"><span class="linenos"> 943</span></a><span class="sd">              at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-944"><a href="#PumpWoodMicroService-944"><span class="linenos"> 944</span></a>
</span><span id="PumpWoodMicroService-945"><a href="#PumpWoodMicroService-945"><span class="linenos"> 945</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-946"><a href="#PumpWoodMicroService-946"><span class="linenos"> 946</span></a><span class="sd">            Return a dictinary with keys:</span>
</span><span id="PumpWoodMicroService-947"><a href="#PumpWoodMicroService-947"><span class="linenos"> 947</span></a><span class="sd">            - **verbose_field:** String sugesting how the tittle of the</span>
</span><span id="PumpWoodMicroService-948"><a href="#PumpWoodMicroService-948"><span class="linenos"> 948</span></a><span class="sd">                retrieve might be created. It will use Python format</span>
</span><span id="PumpWoodMicroService-949"><a href="#PumpWoodMicroService-949"><span class="linenos"> 949</span></a><span class="sd">                information ex.: `&#39;{pk} | {description}&#39;`.</span>
</span><span id="PumpWoodMicroService-950"><a href="#PumpWoodMicroService-950"><span class="linenos"> 950</span></a><span class="sd">            - **fieldset:** An dictinary with organization of data,</span>
</span><span id="PumpWoodMicroService-951"><a href="#PumpWoodMicroService-951"><span class="linenos"> 951</span></a><span class="sd">                setting field sets that could be grouped toguether in</span>
</span><span id="PumpWoodMicroService-952"><a href="#PumpWoodMicroService-952"><span class="linenos"> 952</span></a><span class="sd">                tabs.</span>
</span><span id="PumpWoodMicroService-953"><a href="#PumpWoodMicroService-953"><span class="linenos"> 953</span></a>
</span><span id="PumpWoodMicroService-954"><a href="#PumpWoodMicroService-954"><span class="linenos"> 954</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-955"><a href="#PumpWoodMicroService-955"><span class="linenos"> 955</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService-956"><a href="#PumpWoodMicroService-956"><span class="linenos"> 956</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-957"><a href="#PumpWoodMicroService-957"><span class="linenos"> 957</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">{basename}</span><span class="s2">/retrieve-options/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-958"><a href="#PumpWoodMicroService-958"><span class="linenos"> 958</span></a>            <span class="n">basename</span><span class="o">=</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="PumpWoodMicroService-959"><a href="#PumpWoodMicroService-959"><span class="linenos"> 959</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-960"><a href="#PumpWoodMicroService-960"><span class="linenos"> 960</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-961"><a href="#PumpWoodMicroService-961"><span class="linenos"> 961</span></a>
</span><span id="PumpWoodMicroService-962"><a href="#PumpWoodMicroService-962"><span class="linenos"> 962</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fill_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parcial_obj_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService-963"><a href="#PumpWoodMicroService-963"><span class="linenos"> 963</span></a>                        <span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-964"><a href="#PumpWoodMicroService-964"><span class="linenos"> 964</span></a>                        <span class="n">user_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;api&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-965"><a href="#PumpWoodMicroService-965"><span class="linenos"> 965</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options for object fields.</span>
</span><span id="PumpWoodMicroService-966"><a href="#PumpWoodMicroService-966"><span class="linenos"> 966</span></a>
</span><span id="PumpWoodMicroService-967"><a href="#PumpWoodMicroService-967"><span class="linenos"> 967</span></a><span class="sd">        This function send partial object data and return options to finish</span>
</span><span id="PumpWoodMicroService-968"><a href="#PumpWoodMicroService-968"><span class="linenos"> 968</span></a><span class="sd">        object fillment.</span>
</span><span id="PumpWoodMicroService-969"><a href="#PumpWoodMicroService-969"><span class="linenos"> 969</span></a>
</span><span id="PumpWoodMicroService-970"><a href="#PumpWoodMicroService-970"><span class="linenos"> 970</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-971"><a href="#PumpWoodMicroService-971"><span class="linenos"> 971</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-972"><a href="#PumpWoodMicroService-972"><span class="linenos"> 972</span></a><span class="sd">                Model class to check search parameters.</span>
</span><span id="PumpWoodMicroService-973"><a href="#PumpWoodMicroService-973"><span class="linenos"> 973</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-974"><a href="#PumpWoodMicroService-974"><span class="linenos"> 974</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-975"><a href="#PumpWoodMicroService-975"><span class="linenos"> 975</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-976"><a href="#PumpWoodMicroService-976"><span class="linenos"> 976</span></a><span class="sd">            parcial_obj_dict:</span>
</span><span id="PumpWoodMicroService-977"><a href="#PumpWoodMicroService-977"><span class="linenos"> 977</span></a><span class="sd">                Partial object data to be validated by the backend.</span>
</span><span id="PumpWoodMicroService-978"><a href="#PumpWoodMicroService-978"><span class="linenos"> 978</span></a><span class="sd">            field:</span>
</span><span id="PumpWoodMicroService-979"><a href="#PumpWoodMicroService-979"><span class="linenos"> 979</span></a><span class="sd">                Set an especific field to be validated if implemented.</span>
</span><span id="PumpWoodMicroService-980"><a href="#PumpWoodMicroService-980"><span class="linenos"> 980</span></a><span class="sd">            user_type:</span>
</span><span id="PumpWoodMicroService-981"><a href="#PumpWoodMicroService-981"><span class="linenos"> 981</span></a><span class="sd">                Set the type of user is requesting fill validation. It is</span>
</span><span id="PumpWoodMicroService-982"><a href="#PumpWoodMicroService-982"><span class="linenos"> 982</span></a><span class="sd">                possible to set `api` and `gui`. Gui user_type will return</span>
</span><span id="PumpWoodMicroService-983"><a href="#PumpWoodMicroService-983"><span class="linenos"> 983</span></a><span class="sd">                fields listed in gui_readonly as read-only fields to</span>
</span><span id="PumpWoodMicroService-984"><a href="#PumpWoodMicroService-984"><span class="linenos"> 984</span></a><span class="sd">                facilitate navegation.</span>
</span><span id="PumpWoodMicroService-985"><a href="#PumpWoodMicroService-985"><span class="linenos"> 985</span></a>
</span><span id="PumpWoodMicroService-986"><a href="#PumpWoodMicroService-986"><span class="linenos"> 986</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-987"><a href="#PumpWoodMicroService-987"><span class="linenos"> 987</span></a><span class="sd">            Return a dictinary with keys:</span>
</span><span id="PumpWoodMicroService-988"><a href="#PumpWoodMicroService-988"><span class="linenos"> 988</span></a><span class="sd">            - **field_descriptions:** Same of fill_options, but setting as</span>
</span><span id="PumpWoodMicroService-989"><a href="#PumpWoodMicroService-989"><span class="linenos"> 989</span></a><span class="sd">                read_only=True fields listed on gui_readonly if</span>
</span><span id="PumpWoodMicroService-990"><a href="#PumpWoodMicroService-990"><span class="linenos"> 990</span></a><span class="sd">                user_type=&#39;gui&#39;.</span>
</span><span id="PumpWoodMicroService-991"><a href="#PumpWoodMicroService-991"><span class="linenos"> 991</span></a><span class="sd">            - **gui_readonly:** Return a list of fields that will be</span>
</span><span id="PumpWoodMicroService-992"><a href="#PumpWoodMicroService-992"><span class="linenos"> 992</span></a><span class="sd">                considered as read-only if user_type=&#39;gui&#39; is requested.</span>
</span><span id="PumpWoodMicroService-993"><a href="#PumpWoodMicroService-993"><span class="linenos"> 993</span></a>
</span><span id="PumpWoodMicroService-994"><a href="#PumpWoodMicroService-994"><span class="linenos"> 994</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-995"><a href="#PumpWoodMicroService-995"><span class="linenos"> 995</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService-996"><a href="#PumpWoodMicroService-996"><span class="linenos"> 996</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-997"><a href="#PumpWoodMicroService-997"><span class="linenos"> 997</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">{basename}</span><span class="s2">/retrieve-options/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-998"><a href="#PumpWoodMicroService-998"><span class="linenos"> 998</span></a>            <span class="n">basename</span><span class="o">=</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="PumpWoodMicroService-999"><a href="#PumpWoodMicroService-999"><span class="linenos"> 999</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;user_type&quot;</span><span class="p">:</span> <span class="n">user_type</span><span class="p">}</span>
</span><span id="PumpWoodMicroService-1000"><a href="#PumpWoodMicroService-1000"><span class="linenos">1000</span></a>        <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1001"><a href="#PumpWoodMicroService-1001"><span class="linenos">1001</span></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span>
</span><span id="PumpWoodMicroService-1002"><a href="#PumpWoodMicroService-1002"><span class="linenos">1002</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1003"><a href="#PumpWoodMicroService-1003"><span class="linenos">1003</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parcial_obj_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1004"><a href="#PumpWoodMicroService-1004"><span class="linenos">1004</span></a>            <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1005"><a href="#PumpWoodMicroService-1005"><span class="linenos">1005</span></a>
</span><span id="PumpWoodMicroService-1006"><a href="#PumpWoodMicroService-1006"><span class="linenos">1006</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PumpWoodMicroService-1007"><a href="#PumpWoodMicroService-1007"><span class="linenos">1007</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_pivot_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1008"><a href="#PumpWoodMicroService-1008"><span class="linenos">1008</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/pivot/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="p">)</span>
</span><span id="PumpWoodMicroService-1009"><a href="#PumpWoodMicroService-1009"><span class="linenos">1009</span></a>
</span><span id="PumpWoodMicroService-1010"><a href="#PumpWoodMicroService-1010"><span class="linenos">1010</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pivot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="PumpWoodMicroService-1011"><a href="#PumpWoodMicroService-1011"><span class="linenos">1011</span></a>              <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService-1012"><a href="#PumpWoodMicroService-1012"><span class="linenos">1012</span></a>              <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">order_by</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="PumpWoodMicroService-1013"><a href="#PumpWoodMicroService-1013"><span class="linenos">1013</span></a>              <span class="n">variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1014"><a href="#PumpWoodMicroService-1014"><span class="linenos">1014</span></a>              <span class="n">add_pk_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1015"><a href="#PumpWoodMicroService-1015"><span class="linenos">1015</span></a>              <span class="n">as_dataframe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PumpWoodMicroService-1016"><a href="#PumpWoodMicroService-1016"><span class="linenos">1016</span></a>              <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-1017"><a href="#PumpWoodMicroService-1017"><span class="linenos">1017</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Pivot object data acording to columns specified.</span>
</span><span id="PumpWoodMicroService-1018"><a href="#PumpWoodMicroService-1018"><span class="linenos">1018</span></a>
</span><span id="PumpWoodMicroService-1019"><a href="#PumpWoodMicroService-1019"><span class="linenos">1019</span></a><span class="sd">        Pivoting per-se is not usually used, beeing the name of the function</span>
</span><span id="PumpWoodMicroService-1020"><a href="#PumpWoodMicroService-1020"><span class="linenos">1020</span></a><span class="sd">        a legacy. Normality data transformation is done at the client level.</span>
</span><span id="PumpWoodMicroService-1021"><a href="#PumpWoodMicroService-1021"><span class="linenos">1021</span></a>
</span><span id="PumpWoodMicroService-1022"><a href="#PumpWoodMicroService-1022"><span class="linenos">1022</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1023"><a href="#PumpWoodMicroService-1023"><span class="linenos">1023</span></a><span class="sd">            model_class (str):</span>
</span><span id="PumpWoodMicroService-1024"><a href="#PumpWoodMicroService-1024"><span class="linenos">1024</span></a><span class="sd">                Model class to check search parameters.</span>
</span><span id="PumpWoodMicroService-1025"><a href="#PumpWoodMicroService-1025"><span class="linenos">1025</span></a><span class="sd">            columns (List[str]):</span>
</span><span id="PumpWoodMicroService-1026"><a href="#PumpWoodMicroService-1026"><span class="linenos">1026</span></a><span class="sd">                List of fields to be used as columns when pivoting the data.</span>
</span><span id="PumpWoodMicroService-1027"><a href="#PumpWoodMicroService-1027"><span class="linenos">1027</span></a><span class="sd">            format (str):</span>
</span><span id="PumpWoodMicroService-1028"><a href="#PumpWoodMicroService-1028"><span class="linenos">1028</span></a><span class="sd">                Format to be used to convert pandas.DataFrame to</span>
</span><span id="PumpWoodMicroService-1029"><a href="#PumpWoodMicroService-1029"><span class="linenos">1029</span></a><span class="sd">                dictionary, must be in [&#39;dict&#39;,&#39;list&#39;,&#39;series&#39;,</span>
</span><span id="PumpWoodMicroService-1030"><a href="#PumpWoodMicroService-1030"><span class="linenos">1030</span></a><span class="sd">                &#39;split&#39;, &#39;records&#39;,&#39;index&#39;].</span>
</span><span id="PumpWoodMicroService-1031"><a href="#PumpWoodMicroService-1031"><span class="linenos">1031</span></a><span class="sd">            filter_dict (dict):</span>
</span><span id="PumpWoodMicroService-1032"><a href="#PumpWoodMicroService-1032"><span class="linenos">1032</span></a><span class="sd">                Same as list function.</span>
</span><span id="PumpWoodMicroService-1033"><a href="#PumpWoodMicroService-1033"><span class="linenos">1033</span></a><span class="sd">            exclude_dict (dict):</span>
</span><span id="PumpWoodMicroService-1034"><a href="#PumpWoodMicroService-1034"><span class="linenos">1034</span></a><span class="sd">                Same as list function.</span>
</span><span id="PumpWoodMicroService-1035"><a href="#PumpWoodMicroService-1035"><span class="linenos">1035</span></a><span class="sd">            order_by (List[str]):</span>
</span><span id="PumpWoodMicroService-1036"><a href="#PumpWoodMicroService-1036"><span class="linenos">1036</span></a><span class="sd">                 Same as list function.</span>
</span><span id="PumpWoodMicroService-1037"><a href="#PumpWoodMicroService-1037"><span class="linenos">1037</span></a><span class="sd">            variables (List[str]):</span>
</span><span id="PumpWoodMicroService-1038"><a href="#PumpWoodMicroService-1038"><span class="linenos">1038</span></a><span class="sd">                List of the fields to be returned, if None, the default</span>
</span><span id="PumpWoodMicroService-1039"><a href="#PumpWoodMicroService-1039"><span class="linenos">1039</span></a><span class="sd">                variables will be returned. Same as fields on list functions.</span>
</span><span id="PumpWoodMicroService-1040"><a href="#PumpWoodMicroService-1040"><span class="linenos">1040</span></a><span class="sd">            show_deleted (bool):</span>
</span><span id="PumpWoodMicroService-1041"><a href="#PumpWoodMicroService-1041"><span class="linenos">1041</span></a><span class="sd">                Fields with deleted column will have objects with deleted=True</span>
</span><span id="PumpWoodMicroService-1042"><a href="#PumpWoodMicroService-1042"><span class="linenos">1042</span></a><span class="sd">                omited from results. show_deleted=True will return this</span>
</span><span id="PumpWoodMicroService-1043"><a href="#PumpWoodMicroService-1043"><span class="linenos">1043</span></a><span class="sd">                information.</span>
</span><span id="PumpWoodMicroService-1044"><a href="#PumpWoodMicroService-1044"><span class="linenos">1044</span></a><span class="sd">            add_pk_column (bool):</span>
</span><span id="PumpWoodMicroService-1045"><a href="#PumpWoodMicroService-1045"><span class="linenos">1045</span></a><span class="sd">                If add pk values of the objects at pivot results. Adding</span>
</span><span id="PumpWoodMicroService-1046"><a href="#PumpWoodMicroService-1046"><span class="linenos">1046</span></a><span class="sd">                pk key on pivot end-points won&#39;t be possible to pivot since</span>
</span><span id="PumpWoodMicroService-1047"><a href="#PumpWoodMicroService-1047"><span class="linenos">1047</span></a><span class="sd">                pk is unique for each entry.</span>
</span><span id="PumpWoodMicroService-1048"><a href="#PumpWoodMicroService-1048"><span class="linenos">1048</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="PumpWoodMicroService-1049"><a href="#PumpWoodMicroService-1049"><span class="linenos">1049</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-1050"><a href="#PumpWoodMicroService-1050"><span class="linenos">1050</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-1051"><a href="#PumpWoodMicroService-1051"><span class="linenos">1051</span></a><span class="sd">            as_dataframe (bool):</span>
</span><span id="PumpWoodMicroService-1052"><a href="#PumpWoodMicroService-1052"><span class="linenos">1052</span></a><span class="sd">                If results should be returned as a dataframe.</span>
</span><span id="PumpWoodMicroService-1053"><a href="#PumpWoodMicroService-1053"><span class="linenos">1053</span></a>
</span><span id="PumpWoodMicroService-1054"><a href="#PumpWoodMicroService-1054"><span class="linenos">1054</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1055"><a href="#PumpWoodMicroService-1055"><span class="linenos">1055</span></a><span class="sd">            Return a list or a dictinary depending on the format set on</span>
</span><span id="PumpWoodMicroService-1056"><a href="#PumpWoodMicroService-1056"><span class="linenos">1056</span></a><span class="sd">            format parameter.</span>
</span><span id="PumpWoodMicroService-1057"><a href="#PumpWoodMicroService-1057"><span class="linenos">1057</span></a>
</span><span id="PumpWoodMicroService-1058"><a href="#PumpWoodMicroService-1058"><span class="linenos">1058</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-1059"><a href="#PumpWoodMicroService-1059"><span class="linenos">1059</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1060"><a href="#PumpWoodMicroService-1060"><span class="linenos">1060</span></a><span class="sd">                &#39;Columns must be a list of elements.&#39;. Indicates that the list</span>
</span><span id="PumpWoodMicroService-1061"><a href="#PumpWoodMicroService-1061"><span class="linenos">1061</span></a><span class="sd">                argument was not a list.</span>
</span><span id="PumpWoodMicroService-1062"><a href="#PumpWoodMicroService-1062"><span class="linenos">1062</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1063"><a href="#PumpWoodMicroService-1063"><span class="linenos">1063</span></a><span class="sd">                &#39;Column chosen as pivot is not at model variables&#39;. Indicates</span>
</span><span id="PumpWoodMicroService-1064"><a href="#PumpWoodMicroService-1064"><span class="linenos">1064</span></a><span class="sd">                that columns that were set to pivot are not present on model</span>
</span><span id="PumpWoodMicroService-1065"><a href="#PumpWoodMicroService-1065"><span class="linenos">1065</span></a><span class="sd">                variables.</span>
</span><span id="PumpWoodMicroService-1066"><a href="#PumpWoodMicroService-1066"><span class="linenos">1066</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1067"><a href="#PumpWoodMicroService-1067"><span class="linenos">1067</span></a><span class="sd">                &quot;Format must be in [&#39;dict&#39;,&#39;list&#39;,&#39;series&#39;,&#39;split&#39;,</span>
</span><span id="PumpWoodMicroService-1068"><a href="#PumpWoodMicroService-1068"><span class="linenos">1068</span></a><span class="sd">                &#39;records&#39;,&#39;index&#39;]&quot;. Indicates that format set as paramenter</span>
</span><span id="PumpWoodMicroService-1069"><a href="#PumpWoodMicroService-1069"><span class="linenos">1069</span></a><span class="sd">                is not implemented.</span>
</span><span id="PumpWoodMicroService-1070"><a href="#PumpWoodMicroService-1070"><span class="linenos">1070</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1071"><a href="#PumpWoodMicroService-1071"><span class="linenos">1071</span></a><span class="sd">                &quot;Can not add pk column and pivot information&quot;. If</span>
</span><span id="PumpWoodMicroService-1072"><a href="#PumpWoodMicroService-1072"><span class="linenos">1072</span></a><span class="sd">                add_pk_column is True (results will have the pk column), it is</span>
</span><span id="PumpWoodMicroService-1073"><a href="#PumpWoodMicroService-1073"><span class="linenos">1073</span></a><span class="sd">                not possible to pivot the information (pk is an unique value</span>
</span><span id="PumpWoodMicroService-1074"><a href="#PumpWoodMicroService-1074"><span class="linenos">1074</span></a><span class="sd">                for each object, there is no reason to pivot it).</span>
</span><span id="PumpWoodMicroService-1075"><a href="#PumpWoodMicroService-1075"><span class="linenos">1075</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1076"><a href="#PumpWoodMicroService-1076"><span class="linenos">1076</span></a><span class="sd">                &quot;&#39;value&#39; column not at melted data, it is not possible</span>
</span><span id="PumpWoodMicroService-1077"><a href="#PumpWoodMicroService-1077"><span class="linenos">1077</span></a><span class="sd">                to pivot dataframe.&quot;. Indicates that data does not have a value</span>
</span><span id="PumpWoodMicroService-1078"><a href="#PumpWoodMicroService-1078"><span class="linenos">1078</span></a><span class="sd">                column, it must have it to populate pivoted table.</span>
</span><span id="PumpWoodMicroService-1079"><a href="#PumpWoodMicroService-1079"><span class="linenos">1079</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1080"><a href="#PumpWoodMicroService-1080"><span class="linenos">1080</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_pivot_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1081"><a href="#PumpWoodMicroService-1081"><span class="linenos">1081</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PumpWoodMicroService-1082"><a href="#PumpWoodMicroService-1082"><span class="linenos">1082</span></a>            <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1083"><a href="#PumpWoodMicroService-1083"><span class="linenos">1083</span></a>            <span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1084"><a href="#PumpWoodMicroService-1084"><span class="linenos">1084</span></a>            <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="n">order_by</span><span class="p">,</span> <span class="s2">&quot;variables&quot;</span><span class="p">:</span> <span class="n">variables</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1085"><a href="#PumpWoodMicroService-1085"><span class="linenos">1085</span></a>            <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span> <span class="s2">&quot;add_pk_column&quot;</span><span class="p">:</span> <span class="n">add_pk_column</span><span class="p">}</span>
</span><span id="PumpWoodMicroService-1086"><a href="#PumpWoodMicroService-1086"><span class="linenos">1086</span></a>        <span class="n">pivot_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1087"><a href="#PumpWoodMicroService-1087"><span class="linenos">1087</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1088"><a href="#PumpWoodMicroService-1088"><span class="linenos">1088</span></a>
</span><span id="PumpWoodMicroService-1089"><a href="#PumpWoodMicroService-1089"><span class="linenos">1089</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">add_pk_column</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1090"><a href="#PumpWoodMicroService-1090"><span class="linenos">1090</span></a>            <span class="k">if</span> <span class="n">as_dataframe</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1091"><a href="#PumpWoodMicroService-1091"><span class="linenos">1091</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pivot_results</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1092"><a href="#PumpWoodMicroService-1092"><span class="linenos">1092</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1093"><a href="#PumpWoodMicroService-1093"><span class="linenos">1093</span></a>                <span class="k">return</span> <span class="n">pivot_results</span>
</span><span id="PumpWoodMicroService-1094"><a href="#PumpWoodMicroService-1094"><span class="linenos">1094</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1095"><a href="#PumpWoodMicroService-1095"><span class="linenos">1095</span></a>            <span class="n">pd_pivot_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pivot_results</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1096"><a href="#PumpWoodMicroService-1096"><span class="linenos">1096</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd_pivot_results</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1097"><a href="#PumpWoodMicroService-1097"><span class="linenos">1097</span></a>                <span class="n">fill_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_options</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1098"><a href="#PumpWoodMicroService-1098"><span class="linenos">1098</span></a>                    <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1099"><a href="#PumpWoodMicroService-1099"><span class="linenos">1099</span></a>                <span class="n">primary_keys</span> <span class="o">=</span> <span class="n">fill_options</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">][</span><span class="s2">&quot;column&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1100"><a href="#PumpWoodMicroService-1100"><span class="linenos">1100</span></a>                <span class="n">pd_pivot_results</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_pivot_results</span><span class="p">[</span><span class="n">primary_keys</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1101"><a href="#PumpWoodMicroService-1101"><span class="linenos">1101</span></a>                    <span class="n">CompositePkBase64Converter</span><span class="o">.</span><span class="n">dump</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1102"><a href="#PumpWoodMicroService-1102"><span class="linenos">1102</span></a>                    <span class="n">primary_keys</span><span class="o">=</span><span class="n">primary_keys</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1103"><a href="#PumpWoodMicroService-1103"><span class="linenos">1103</span></a>            <span class="k">if</span> <span class="n">as_dataframe</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1104"><a href="#PumpWoodMicroService-1104"><span class="linenos">1104</span></a>                <span class="k">return</span> <span class="n">pd_pivot_results</span>
</span><span id="PumpWoodMicroService-1105"><a href="#PumpWoodMicroService-1105"><span class="linenos">1105</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1106"><a href="#PumpWoodMicroService-1106"><span class="linenos">1106</span></a>                <span class="k">return</span> <span class="n">pd_pivot_results</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1107"><a href="#PumpWoodMicroService-1107"><span class="linenos">1107</span></a>
</span><span id="PumpWoodMicroService-1108"><a href="#PumpWoodMicroService-1108"><span class="linenos">1108</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_flat_list_by_chunks_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1109"><a href="#PumpWoodMicroService-1109"><span class="linenos">1109</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1110"><a href="#PumpWoodMicroService-1110"><span class="linenos">1110</span></a>            <span class="c1"># Unpacking arguments</span>
</span><span id="PumpWoodMicroService-1111"><a href="#PumpWoodMicroService-1111"><span class="linenos">1111</span></a>            <span class="n">model_class</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;model_class&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1112"><a href="#PumpWoodMicroService-1112"><span class="linenos">1112</span></a>            <span class="n">filter_dict</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;filter_dict&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1113"><a href="#PumpWoodMicroService-1113"><span class="linenos">1113</span></a>            <span class="n">exclude_dict</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;exclude_dict&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1114"><a href="#PumpWoodMicroService-1114"><span class="linenos">1114</span></a>            <span class="n">fields</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1115"><a href="#PumpWoodMicroService-1115"><span class="linenos">1115</span></a>            <span class="n">show_deleted</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;show_deleted&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1116"><a href="#PumpWoodMicroService-1116"><span class="linenos">1116</span></a>            <span class="n">auth_header</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;auth_header&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1117"><a href="#PumpWoodMicroService-1117"><span class="linenos">1117</span></a>            <span class="n">chunk_size</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;chunk_size&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1118"><a href="#PumpWoodMicroService-1118"><span class="linenos">1118</span></a>
</span><span id="PumpWoodMicroService-1119"><a href="#PumpWoodMicroService-1119"><span class="linenos">1119</span></a>            <span class="n">temp_filter_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">filter_dict</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1120"><a href="#PumpWoodMicroService-1120"><span class="linenos">1120</span></a>            <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_pivot_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1121"><a href="#PumpWoodMicroService-1121"><span class="linenos">1121</span></a>            <span class="n">max_pk</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PumpWoodMicroService-1122"><a href="#PumpWoodMicroService-1122"><span class="linenos">1122</span></a>
</span><span id="PumpWoodMicroService-1123"><a href="#PumpWoodMicroService-1123"><span class="linenos">1123</span></a>            <span class="c1"># Fetch data until an empty result is returned</span>
</span><span id="PumpWoodMicroService-1124"><a href="#PumpWoodMicroService-1124"><span class="linenos">1124</span></a>            <span class="n">list_dataframes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService-1125"><a href="#PumpWoodMicroService-1125"><span class="linenos">1125</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1126"><a href="#PumpWoodMicroService-1126"><span class="linenos">1126</span></a>                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1127"><a href="#PumpWoodMicroService-1127"><span class="linenos">1127</span></a>                <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-1128"><a href="#PumpWoodMicroService-1128"><span class="linenos">1128</span></a>                <span class="n">temp_filter_dict</span><span class="p">[</span><span class="s2">&quot;id__gt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_pk</span>
</span><span id="PumpWoodMicroService-1129"><a href="#PumpWoodMicroService-1129"><span class="linenos">1129</span></a>                <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PumpWoodMicroService-1130"><a href="#PumpWoodMicroService-1130"><span class="linenos">1130</span></a>                    <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1131"><a href="#PumpWoodMicroService-1131"><span class="linenos">1131</span></a>                    <span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">temp_filter_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1132"><a href="#PumpWoodMicroService-1132"><span class="linenos">1132</span></a>                    <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1133"><a href="#PumpWoodMicroService-1133"><span class="linenos">1133</span></a>                    <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">],</span> <span class="s2">&quot;variables&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1134"><a href="#PumpWoodMicroService-1134"><span class="linenos">1134</span></a>                    <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1135"><a href="#PumpWoodMicroService-1135"><span class="linenos">1135</span></a>                    <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1136"><a href="#PumpWoodMicroService-1136"><span class="linenos">1136</span></a>                    <span class="s2">&quot;add_pk_column&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</span><span id="PumpWoodMicroService-1137"><a href="#PumpWoodMicroService-1137"><span class="linenos">1137</span></a>                <span class="n">temp_dateframe</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1138"><a href="#PumpWoodMicroService-1138"><span class="linenos">1138</span></a>                    <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1139"><a href="#PumpWoodMicroService-1139"><span class="linenos">1139</span></a>
</span><span id="PumpWoodMicroService-1140"><a href="#PumpWoodMicroService-1140"><span class="linenos">1140</span></a>                <span class="c1"># Break if results are less than chunk size, so no more results</span>
</span><span id="PumpWoodMicroService-1141"><a href="#PumpWoodMicroService-1141"><span class="linenos">1141</span></a>                <span class="c1"># are avaiable</span>
</span><span id="PumpWoodMicroService-1142"><a href="#PumpWoodMicroService-1142"><span class="linenos">1142</span></a>                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_dateframe</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">chunk_size</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1143"><a href="#PumpWoodMicroService-1143"><span class="linenos">1143</span></a>                    <span class="n">list_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_dateframe</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1144"><a href="#PumpWoodMicroService-1144"><span class="linenos">1144</span></a>                    <span class="k">break</span>
</span><span id="PumpWoodMicroService-1145"><a href="#PumpWoodMicroService-1145"><span class="linenos">1145</span></a>
</span><span id="PumpWoodMicroService-1146"><a href="#PumpWoodMicroService-1146"><span class="linenos">1146</span></a>                <span class="n">max_pk</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">temp_dateframe</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</span><span id="PumpWoodMicroService-1147"><a href="#PumpWoodMicroService-1147"><span class="linenos">1147</span></a>                <span class="n">list_dataframes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp_dateframe</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1148"><a href="#PumpWoodMicroService-1148"><span class="linenos">1148</span></a>
</span><span id="PumpWoodMicroService-1149"><a href="#PumpWoodMicroService-1149"><span class="linenos">1149</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_dataframes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1150"><a href="#PumpWoodMicroService-1150"><span class="linenos">1150</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-1151"><a href="#PumpWoodMicroService-1151"><span class="linenos">1151</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1152"><a href="#PumpWoodMicroService-1152"><span class="linenos">1152</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">list_dataframes</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1153"><a href="#PumpWoodMicroService-1153"><span class="linenos">1153</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1154"><a href="#PumpWoodMicroService-1154"><span class="linenos">1154</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Exception at flat_list_by_chunks:&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1155"><a href="#PumpWoodMicroService-1155"><span class="linenos">1155</span></a>
</span><span id="PumpWoodMicroService-1156"><a href="#PumpWoodMicroService-1156"><span class="linenos">1156</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">flat_list_by_chunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService-1157"><a href="#PumpWoodMicroService-1157"><span class="linenos">1157</span></a>                            <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1158"><a href="#PumpWoodMicroService-1158"><span class="linenos">1158</span></a>                            <span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1159"><a href="#PumpWoodMicroService-1159"><span class="linenos">1159</span></a>                            <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1160"><a href="#PumpWoodMicroService-1160"><span class="linenos">1160</span></a>                            <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000000</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1161"><a href="#PumpWoodMicroService-1161"><span class="linenos">1161</span></a>                            <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1162"><a href="#PumpWoodMicroService-1162"><span class="linenos">1162</span></a>                            <span class="n">create_composite_pk</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1163"><a href="#PumpWoodMicroService-1163"><span class="linenos">1163</span></a>                            <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1164"><a href="#PumpWoodMicroService-1164"><span class="linenos">1164</span></a>                            <span class="n">end_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1165"><a href="#PumpWoodMicroService-1165"><span class="linenos">1165</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Incrementally fetch data from pivot end-point.</span>
</span><span id="PumpWoodMicroService-1166"><a href="#PumpWoodMicroService-1166"><span class="linenos">1166</span></a>
</span><span id="PumpWoodMicroService-1167"><a href="#PumpWoodMicroService-1167"><span class="linenos">1167</span></a><span class="sd">        Fetch data from pivot end-point paginating by id of chunk_size lenght.</span>
</span><span id="PumpWoodMicroService-1168"><a href="#PumpWoodMicroService-1168"><span class="linenos">1168</span></a>
</span><span id="PumpWoodMicroService-1169"><a href="#PumpWoodMicroService-1169"><span class="linenos">1169</span></a><span class="sd">        If table is partitioned it will split the query acording to partition</span>
</span><span id="PumpWoodMicroService-1170"><a href="#PumpWoodMicroService-1170"><span class="linenos">1170</span></a><span class="sd">        to facilitate query at the database.</span>
</span><span id="PumpWoodMicroService-1171"><a href="#PumpWoodMicroService-1171"><span class="linenos">1171</span></a>
</span><span id="PumpWoodMicroService-1172"><a href="#PumpWoodMicroService-1172"><span class="linenos">1172</span></a><span class="sd">        If start_date and end_date are set, also breaks the query by month</span>
</span><span id="PumpWoodMicroService-1173"><a href="#PumpWoodMicroService-1173"><span class="linenos">1173</span></a><span class="sd">        retrieving each month data in parallel.</span>
</span><span id="PumpWoodMicroService-1174"><a href="#PumpWoodMicroService-1174"><span class="linenos">1174</span></a>
</span><span id="PumpWoodMicroService-1175"><a href="#PumpWoodMicroService-1175"><span class="linenos">1175</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1176"><a href="#PumpWoodMicroService-1176"><span class="linenos">1176</span></a><span class="sd">            model_class (str):</span>
</span><span id="PumpWoodMicroService-1177"><a href="#PumpWoodMicroService-1177"><span class="linenos">1177</span></a><span class="sd">                Model class to be pivoted.</span>
</span><span id="PumpWoodMicroService-1178"><a href="#PumpWoodMicroService-1178"><span class="linenos">1178</span></a><span class="sd">            filter_dict (dict):</span>
</span><span id="PumpWoodMicroService-1179"><a href="#PumpWoodMicroService-1179"><span class="linenos">1179</span></a><span class="sd">                Dictionary to to be used in objects.filter argument</span>
</span><span id="PumpWoodMicroService-1180"><a href="#PumpWoodMicroService-1180"><span class="linenos">1180</span></a><span class="sd">                (Same as list end-point).</span>
</span><span id="PumpWoodMicroService-1181"><a href="#PumpWoodMicroService-1181"><span class="linenos">1181</span></a><span class="sd">            exclude_dict (dict):</span>
</span><span id="PumpWoodMicroService-1182"><a href="#PumpWoodMicroService-1182"><span class="linenos">1182</span></a><span class="sd">                Dictionary to to be used in objects.exclude argument</span>
</span><span id="PumpWoodMicroService-1183"><a href="#PumpWoodMicroService-1183"><span class="linenos">1183</span></a><span class="sd">                (Same as list end-point).</span>
</span><span id="PumpWoodMicroService-1184"><a href="#PumpWoodMicroService-1184"><span class="linenos">1184</span></a><span class="sd">            fields (List[str] | None):</span>
</span><span id="PumpWoodMicroService-1185"><a href="#PumpWoodMicroService-1185"><span class="linenos">1185</span></a><span class="sd">                List of the variables to be returned,</span>
</span><span id="PumpWoodMicroService-1186"><a href="#PumpWoodMicroService-1186"><span class="linenos">1186</span></a><span class="sd">                if None, the default variables will be returned.</span>
</span><span id="PumpWoodMicroService-1187"><a href="#PumpWoodMicroService-1187"><span class="linenos">1187</span></a><span class="sd">                If fields is set, dataframe will return that columns</span>
</span><span id="PumpWoodMicroService-1188"><a href="#PumpWoodMicroService-1188"><span class="linenos">1188</span></a><span class="sd">                even if data is empty.</span>
</span><span id="PumpWoodMicroService-1189"><a href="#PumpWoodMicroService-1189"><span class="linenos">1189</span></a><span class="sd">            start_date (datetime | str):</span>
</span><span id="PumpWoodMicroService-1190"><a href="#PumpWoodMicroService-1190"><span class="linenos">1190</span></a><span class="sd">                Set a begin date for the query. If begin and end date are</span>
</span><span id="PumpWoodMicroService-1191"><a href="#PumpWoodMicroService-1191"><span class="linenos">1191</span></a><span class="sd">                set, query will be splited with chucks by month that will be</span>
</span><span id="PumpWoodMicroService-1192"><a href="#PumpWoodMicroService-1192"><span class="linenos">1192</span></a><span class="sd">                requested in parallel.</span>
</span><span id="PumpWoodMicroService-1193"><a href="#PumpWoodMicroService-1193"><span class="linenos">1193</span></a><span class="sd">            end_date (datetime | str):</span>
</span><span id="PumpWoodMicroService-1194"><a href="#PumpWoodMicroService-1194"><span class="linenos">1194</span></a><span class="sd">                Set a end date for the query. If begin and end date are</span>
</span><span id="PumpWoodMicroService-1195"><a href="#PumpWoodMicroService-1195"><span class="linenos">1195</span></a><span class="sd">                set, query will be splited with chucks by month that will be</span>
</span><span id="PumpWoodMicroService-1196"><a href="#PumpWoodMicroService-1196"><span class="linenos">1196</span></a><span class="sd">                requested in parallel.</span>
</span><span id="PumpWoodMicroService-1197"><a href="#PumpWoodMicroService-1197"><span class="linenos">1197</span></a><span class="sd">            show_deleted (bool):</span>
</span><span id="PumpWoodMicroService-1198"><a href="#PumpWoodMicroService-1198"><span class="linenos">1198</span></a><span class="sd">                If deleted data should be returned.</span>
</span><span id="PumpWoodMicroService-1199"><a href="#PumpWoodMicroService-1199"><span class="linenos">1199</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="PumpWoodMicroService-1200"><a href="#PumpWoodMicroService-1200"><span class="linenos">1200</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-1201"><a href="#PumpWoodMicroService-1201"><span class="linenos">1201</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-1202"><a href="#PumpWoodMicroService-1202"><span class="linenos">1202</span></a><span class="sd">            chunk_size (int):</span>
</span><span id="PumpWoodMicroService-1203"><a href="#PumpWoodMicroService-1203"><span class="linenos">1203</span></a><span class="sd">                Limit of data to fetch per call.</span>
</span><span id="PumpWoodMicroService-1204"><a href="#PumpWoodMicroService-1204"><span class="linenos">1204</span></a><span class="sd">            n_parallel (int):</span>
</span><span id="PumpWoodMicroService-1205"><a href="#PumpWoodMicroService-1205"><span class="linenos">1205</span></a><span class="sd">                Number of parallel process to perform.</span>
</span><span id="PumpWoodMicroService-1206"><a href="#PumpWoodMicroService-1206"><span class="linenos">1206</span></a><span class="sd">            create_composite_pk (bool):</span>
</span><span id="PumpWoodMicroService-1207"><a href="#PumpWoodMicroService-1207"><span class="linenos">1207</span></a><span class="sd">                If true and table has a composite pk, it will create pk</span>
</span><span id="PumpWoodMicroService-1208"><a href="#PumpWoodMicroService-1208"><span class="linenos">1208</span></a><span class="sd">                value based on the hash on the json serialized dictionary</span>
</span><span id="PumpWoodMicroService-1209"><a href="#PumpWoodMicroService-1209"><span class="linenos">1209</span></a><span class="sd">                of the components of the primary key.</span>
</span><span id="PumpWoodMicroService-1210"><a href="#PumpWoodMicroService-1210"><span class="linenos">1210</span></a>
</span><span id="PumpWoodMicroService-1211"><a href="#PumpWoodMicroService-1211"><span class="linenos">1211</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1212"><a href="#PumpWoodMicroService-1212"><span class="linenos">1212</span></a><span class="sd">            Returns a dataframe with all information fetched.</span>
</span><span id="PumpWoodMicroService-1213"><a href="#PumpWoodMicroService-1213"><span class="linenos">1213</span></a>
</span><span id="PumpWoodMicroService-1214"><a href="#PumpWoodMicroService-1214"><span class="linenos">1214</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-1215"><a href="#PumpWoodMicroService-1215"><span class="linenos">1215</span></a><span class="sd">            No particular raise.</span>
</span><span id="PumpWoodMicroService-1216"><a href="#PumpWoodMicroService-1216"><span class="linenos">1216</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1217"><a href="#PumpWoodMicroService-1217"><span class="linenos">1217</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1218"><a href="#PumpWoodMicroService-1218"><span class="linenos">1218</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1219"><a href="#PumpWoodMicroService-1219"><span class="linenos">1219</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1220"><a href="#PumpWoodMicroService-1220"><span class="linenos">1220</span></a>
</span><span id="PumpWoodMicroService-1221"><a href="#PumpWoodMicroService-1221"><span class="linenos">1221</span></a>        <span class="n">temp_filter_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">filter_dict</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1222"><a href="#PumpWoodMicroService-1222"><span class="linenos">1222</span></a>        <span class="n">fill_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_options</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1223"><a href="#PumpWoodMicroService-1223"><span class="linenos">1223</span></a>            <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1224"><a href="#PumpWoodMicroService-1224"><span class="linenos">1224</span></a>        <span class="n">primary_keys</span> <span class="o">=</span> <span class="n">fill_options</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">][</span><span class="s2">&quot;column&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1225"><a href="#PumpWoodMicroService-1225"><span class="linenos">1225</span></a>        <span class="n">partition</span> <span class="o">=</span> <span class="n">fill_options</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;partition&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="PumpWoodMicroService-1226"><a href="#PumpWoodMicroService-1226"><span class="linenos">1226</span></a>
</span><span id="PumpWoodMicroService-1227"><a href="#PumpWoodMicroService-1227"><span class="linenos">1227</span></a>        <span class="c1"># Create a list of month and include start and end dates if not at</span>
</span><span id="PumpWoodMicroService-1228"><a href="#PumpWoodMicroService-1228"><span class="linenos">1228</span></a>        <span class="c1"># the beginning of a month</span>
</span><span id="PumpWoodMicroService-1229"><a href="#PumpWoodMicroService-1229"><span class="linenos">1229</span></a>        <span class="n">month_sequence</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-1230"><a href="#PumpWoodMicroService-1230"><span class="linenos">1230</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">start_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1231"><a href="#PumpWoodMicroService-1231"><span class="linenos">1231</span></a>            <span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1232"><a href="#PumpWoodMicroService-1232"><span class="linenos">1232</span></a>            <span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1233"><a href="#PumpWoodMicroService-1233"><span class="linenos">1233</span></a>            <span class="n">list_month_sequence</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1234"><a href="#PumpWoodMicroService-1234"><span class="linenos">1234</span></a>                <span class="n">start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;MS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-1235"><a href="#PumpWoodMicroService-1235"><span class="linenos">1235</span></a>            <span class="n">month_sequence</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1236"><a href="#PumpWoodMicroService-1236"><span class="linenos">1236</span></a>                <span class="p">[</span><span class="n">start_date</span><span class="p">]</span> <span class="o">+</span> <span class="n">list_month_sequence</span> <span class="o">+</span> <span class="p">[</span><span class="n">end_date</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1237"><a href="#PumpWoodMicroService-1237"><span class="linenos">1237</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-1238"><a href="#PumpWoodMicroService-1238"><span class="linenos">1238</span></a>
</span><span id="PumpWoodMicroService-1239"><a href="#PumpWoodMicroService-1239"><span class="linenos">1239</span></a>            <span class="n">month_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="n">month_sequence</span><span class="p">})</span>
</span><span id="PumpWoodMicroService-1240"><a href="#PumpWoodMicroService-1240"><span class="linenos">1240</span></a>            <span class="n">month_df</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">month_df</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-1241"><a href="#PumpWoodMicroService-1241"><span class="linenos">1241</span></a>            <span class="n">month_df</span> <span class="o">=</span> <span class="n">month_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-1242"><a href="#PumpWoodMicroService-1242"><span class="linenos">1242</span></a>            <span class="n">month_sequence</span> <span class="o">=</span> <span class="n">month_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1243"><a href="#PumpWoodMicroService-1243"><span class="linenos">1243</span></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">start_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">end_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1244"><a href="#PumpWoodMicroService-1244"><span class="linenos">1244</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-1245"><a href="#PumpWoodMicroService-1245"><span class="linenos">1245</span></a>                <span class="s2">&quot;To break query in chunks using start_date and end_date &quot;</span>
</span><span id="PumpWoodMicroService-1246"><a href="#PumpWoodMicroService-1246"><span class="linenos">1246</span></a>                <span class="s2">&quot;both must be set.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="PumpWoodMicroService-1247"><a href="#PumpWoodMicroService-1247"><span class="linenos">1247</span></a>                <span class="s2">&quot;start_date: </span><span class="si">{start_date}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="PumpWoodMicroService-1248"><a href="#PumpWoodMicroService-1248"><span class="linenos">1248</span></a>                <span class="s2">&quot;end_date: </span><span class="si">{end_date}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1249"><a href="#PumpWoodMicroService-1249"><span class="linenos">1249</span></a>                    <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1250"><a href="#PumpWoodMicroService-1250"><span class="linenos">1250</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1251"><a href="#PumpWoodMicroService-1251"><span class="linenos">1251</span></a>                <span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span>
</span><span id="PumpWoodMicroService-1252"><a href="#PumpWoodMicroService-1252"><span class="linenos">1252</span></a>                    <span class="s2">&quot;start_date&quot;</span><span class="p">:</span> <span class="n">start_date</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1253"><a href="#PumpWoodMicroService-1253"><span class="linenos">1253</span></a>                    <span class="s2">&quot;end_date&quot;</span><span class="p">:</span> <span class="n">end_date</span><span class="p">})</span>
</span><span id="PumpWoodMicroService-1254"><a href="#PumpWoodMicroService-1254"><span class="linenos">1254</span></a>
</span><span id="PumpWoodMicroService-1255"><a href="#PumpWoodMicroService-1255"><span class="linenos">1255</span></a>        <span class="n">resp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-1256"><a href="#PumpWoodMicroService-1256"><span class="linenos">1256</span></a>
</span><span id="PumpWoodMicroService-1257"><a href="#PumpWoodMicroService-1257"><span class="linenos">1257</span></a>        <span class="c1">##########################################################</span>
</span><span id="PumpWoodMicroService-1258"><a href="#PumpWoodMicroService-1258"><span class="linenos">1258</span></a>        <span class="c1"># If table have more than one partition, run in parallel #</span>
</span><span id="PumpWoodMicroService-1259"><a href="#PumpWoodMicroService-1259"><span class="linenos">1259</span></a>        <span class="c1"># the {partition}__in elements along with dates          #</span>
</span><span id="PumpWoodMicroService-1260"><a href="#PumpWoodMicroService-1260"><span class="linenos">1260</span></a>        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1261"><a href="#PumpWoodMicroService-1261"><span class="linenos">1261</span></a>            <span class="n">partition_col_1st</span> <span class="o">=</span> <span class="n">partition</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1262"><a href="#PumpWoodMicroService-1262"><span class="linenos">1262</span></a>            <span class="n">filter_dict_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_filter_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="PumpWoodMicroService-1263"><a href="#PumpWoodMicroService-1263"><span class="linenos">1263</span></a>            <span class="n">partition_filter</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-1264"><a href="#PumpWoodMicroService-1264"><span class="linenos">1264</span></a>            <span class="n">count_partition_col_1st_filters</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PumpWoodMicroService-1265"><a href="#PumpWoodMicroService-1265"><span class="linenos">1265</span></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">filter_dict_keys</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1266"><a href="#PumpWoodMicroService-1266"><span class="linenos">1266</span></a>                <span class="k">if</span> <span class="n">partition_col_1st</span> <span class="o">+</span> <span class="s2">&quot;__in&quot;</span> <span class="o">==</span> <span class="n">col</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1267"><a href="#PumpWoodMicroService-1267"><span class="linenos">1267</span></a>                    <span class="n">partition_filter</span> <span class="o">=</span> <span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1268"><a href="#PumpWoodMicroService-1268"><span class="linenos">1268</span></a>                    <span class="k">del</span> <span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1269"><a href="#PumpWoodMicroService-1269"><span class="linenos">1269</span></a>                    <span class="n">count_partition_col_1st_filters</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService-1270"><a href="#PumpWoodMicroService-1270"><span class="linenos">1270</span></a>                        <span class="n">count_partition_col_1st_filters</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="PumpWoodMicroService-1271"><a href="#PumpWoodMicroService-1271"><span class="linenos">1271</span></a>                <span class="k">elif</span> <span class="n">partition_col_1st</span> <span class="o">==</span> <span class="n">col</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1272"><a href="#PumpWoodMicroService-1272"><span class="linenos">1272</span></a>                    <span class="n">partition_filter</span> <span class="o">=</span> <span class="p">[</span><span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]]</span>
</span><span id="PumpWoodMicroService-1273"><a href="#PumpWoodMicroService-1273"><span class="linenos">1273</span></a>                    <span class="k">del</span> <span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1274"><a href="#PumpWoodMicroService-1274"><span class="linenos">1274</span></a>                    <span class="n">count_partition_col_1st_filters</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService-1275"><a href="#PumpWoodMicroService-1275"><span class="linenos">1275</span></a>                        <span class="n">count_partition_col_1st_filters</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="PumpWoodMicroService-1276"><a href="#PumpWoodMicroService-1276"><span class="linenos">1276</span></a>
</span><span id="PumpWoodMicroService-1277"><a href="#PumpWoodMicroService-1277"><span class="linenos">1277</span></a>            <span class="c1"># Validating query for partitioned tables</span>
</span><span id="PumpWoodMicroService-1278"><a href="#PumpWoodMicroService-1278"><span class="linenos">1278</span></a>            <span class="k">if</span> <span class="n">partition_filter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1279"><a href="#PumpWoodMicroService-1279"><span class="linenos">1279</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-1280"><a href="#PumpWoodMicroService-1280"><span class="linenos">1280</span></a>                    <span class="s2">&quot;Table is partitioned with sub-partitions, running &quot;</span>
</span><span id="PumpWoodMicroService-1281"><a href="#PumpWoodMicroService-1281"><span class="linenos">1281</span></a>                    <span class="s2">&quot;queries without at least first level partition will &quot;</span>
</span><span id="PumpWoodMicroService-1282"><a href="#PumpWoodMicroService-1282"><span class="linenos">1282</span></a>                    <span class="s2">&quot;lead to long waiting times or hanging queries. Please &quot;</span>
</span><span id="PumpWoodMicroService-1283"><a href="#PumpWoodMicroService-1283"><span class="linenos">1283</span></a>                    <span class="s2">&quot;use first partition level in filter_dict with equal &quot;</span>
</span><span id="PumpWoodMicroService-1284"><a href="#PumpWoodMicroService-1284"><span class="linenos">1284</span></a>                    <span class="s2">&quot;or in operators. Table partitions: </span><span class="si">{}</span><span class="s2">&quot;</span>
</span><span id="PumpWoodMicroService-1285"><a href="#PumpWoodMicroService-1285"><span class="linenos">1285</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1286"><a href="#PumpWoodMicroService-1286"><span class="linenos">1286</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1287"><a href="#PumpWoodMicroService-1287"><span class="linenos">1287</span></a>
</span><span id="PumpWoodMicroService-1288"><a href="#PumpWoodMicroService-1288"><span class="linenos">1288</span></a>            <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">count_partition_col_1st_filters</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1289"><a href="#PumpWoodMicroService-1289"><span class="linenos">1289</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-1290"><a href="#PumpWoodMicroService-1290"><span class="linenos">1290</span></a>                    <span class="s2">&quot;Please give some help for the dev here, use just one &quot;</span>
</span><span id="PumpWoodMicroService-1291"><a href="#PumpWoodMicroService-1291"><span class="linenos">1291</span></a>                    <span class="s2">&quot;filter_dict entry for first partition...&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1292"><a href="#PumpWoodMicroService-1292"><span class="linenos">1292</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1293"><a href="#PumpWoodMicroService-1293"><span class="linenos">1293</span></a>
</span><span id="PumpWoodMicroService-1294"><a href="#PumpWoodMicroService-1294"><span class="linenos">1294</span></a>            <span class="c1"># Parallelizing query using partition columns</span>
</span><span id="PumpWoodMicroService-1295"><a href="#PumpWoodMicroService-1295"><span class="linenos">1295</span></a>            <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService-1296"><a href="#PumpWoodMicroService-1296"><span class="linenos">1296</span></a>            <span class="k">for</span> <span class="n">filter_key</span> <span class="ow">in</span> <span class="n">partition_filter</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1297"><a href="#PumpWoodMicroService-1297"><span class="linenos">1297</span></a>                <span class="n">request_filter_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">temp_filter_dict</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1298"><a href="#PumpWoodMicroService-1298"><span class="linenos">1298</span></a>                <span class="n">request_filter_dict</span><span class="p">[</span><span class="n">partition_col_1st</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_key</span>
</span><span id="PumpWoodMicroService-1299"><a href="#PumpWoodMicroService-1299"><span class="linenos">1299</span></a>                <span class="k">if</span> <span class="n">month_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1300"><a href="#PumpWoodMicroService-1300"><span class="linenos">1300</span></a>                    <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService-1301"><a href="#PumpWoodMicroService-1301"><span class="linenos">1301</span></a>                        <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1302"><a href="#PumpWoodMicroService-1302"><span class="linenos">1302</span></a>                        <span class="s2">&quot;filter_dict&quot;</span><span class="p">:</span> <span class="n">request_filter_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1303"><a href="#PumpWoodMicroService-1303"><span class="linenos">1303</span></a>                        <span class="s2">&quot;exclude_dict&quot;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1304"><a href="#PumpWoodMicroService-1304"><span class="linenos">1304</span></a>                        <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1305"><a href="#PumpWoodMicroService-1305"><span class="linenos">1305</span></a>                        <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1306"><a href="#PumpWoodMicroService-1306"><span class="linenos">1306</span></a>                        <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1307"><a href="#PumpWoodMicroService-1307"><span class="linenos">1307</span></a>                        <span class="s2">&quot;chunk_size&quot;</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">})</span>
</span><span id="PumpWoodMicroService-1308"><a href="#PumpWoodMicroService-1308"><span class="linenos">1308</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1309"><a href="#PumpWoodMicroService-1309"><span class="linenos">1309</span></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">month_sequence</span><span class="p">)):</span>
</span><span id="PumpWoodMicroService-1310"><a href="#PumpWoodMicroService-1310"><span class="linenos">1310</span></a>                        <span class="n">request_filter_dict_t</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1311"><a href="#PumpWoodMicroService-1311"><span class="linenos">1311</span></a>                            <span class="n">request_filter_dict</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1312"><a href="#PumpWoodMicroService-1312"><span class="linenos">1312</span></a>                        <span class="c1"># If is not the last interval, query using open</span>
</span><span id="PumpWoodMicroService-1313"><a href="#PumpWoodMicroService-1313"><span class="linenos">1313</span></a>                        <span class="c1"># right interval so subsequence queries does</span>
</span><span id="PumpWoodMicroService-1314"><a href="#PumpWoodMicroService-1314"><span class="linenos">1314</span></a>                        <span class="c1"># not overlap</span>
</span><span id="PumpWoodMicroService-1315"><a href="#PumpWoodMicroService-1315"><span class="linenos">1315</span></a>                        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">month_sequence</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1316"><a href="#PumpWoodMicroService-1316"><span class="linenos">1316</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__gte&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService-1317"><a href="#PumpWoodMicroService-1317"><span class="linenos">1317</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1318"><a href="#PumpWoodMicroService-1318"><span class="linenos">1318</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__lt&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService-1319"><a href="#PumpWoodMicroService-1319"><span class="linenos">1319</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1320"><a href="#PumpWoodMicroService-1320"><span class="linenos">1320</span></a>
</span><span id="PumpWoodMicroService-1321"><a href="#PumpWoodMicroService-1321"><span class="linenos">1321</span></a>                        <span class="c1"># At the last interval use closed right interval so</span>
</span><span id="PumpWoodMicroService-1322"><a href="#PumpWoodMicroService-1322"><span class="linenos">1322</span></a>                        <span class="c1"># last element is also included in the interval</span>
</span><span id="PumpWoodMicroService-1323"><a href="#PumpWoodMicroService-1323"><span class="linenos">1323</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1324"><a href="#PumpWoodMicroService-1324"><span class="linenos">1324</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__gte&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService-1325"><a href="#PumpWoodMicroService-1325"><span class="linenos">1325</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1326"><a href="#PumpWoodMicroService-1326"><span class="linenos">1326</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__lte&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService-1327"><a href="#PumpWoodMicroService-1327"><span class="linenos">1327</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1328"><a href="#PumpWoodMicroService-1328"><span class="linenos">1328</span></a>
</span><span id="PumpWoodMicroService-1329"><a href="#PumpWoodMicroService-1329"><span class="linenos">1329</span></a>                        <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService-1330"><a href="#PumpWoodMicroService-1330"><span class="linenos">1330</span></a>                            <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1331"><a href="#PumpWoodMicroService-1331"><span class="linenos">1331</span></a>                            <span class="s2">&quot;filter_dict&quot;</span><span class="p">:</span> <span class="n">request_filter_dict_t</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1332"><a href="#PumpWoodMicroService-1332"><span class="linenos">1332</span></a>                            <span class="s2">&quot;exclude_dict&quot;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1333"><a href="#PumpWoodMicroService-1333"><span class="linenos">1333</span></a>                            <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1334"><a href="#PumpWoodMicroService-1334"><span class="linenos">1334</span></a>                            <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1335"><a href="#PumpWoodMicroService-1335"><span class="linenos">1335</span></a>                            <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1336"><a href="#PumpWoodMicroService-1336"><span class="linenos">1336</span></a>                            <span class="s2">&quot;chunk_size&quot;</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">})</span>
</span><span id="PumpWoodMicroService-1337"><a href="#PumpWoodMicroService-1337"><span class="linenos">1337</span></a>
</span><span id="PumpWoodMicroService-1338"><a href="#PumpWoodMicroService-1338"><span class="linenos">1338</span></a>            <span class="c1"># Perform parallel calls to backend each chucked by chunk_size</span>
</span><span id="PumpWoodMicroService-1339"><a href="#PumpWoodMicroService-1339"><span class="linenos">1339</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel flat list: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">pool_arguments</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1340"><a href="#PumpWoodMicroService-1340"><span class="linenos">1340</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1341"><a href="#PumpWoodMicroService-1341"><span class="linenos">1341</span></a>                <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1342"><a href="#PumpWoodMicroService-1342"><span class="linenos">1342</span></a>                    <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1343"><a href="#PumpWoodMicroService-1343"><span class="linenos">1343</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_flat_list_by_chunks_helper</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1344"><a href="#PumpWoodMicroService-1344"><span class="linenos">1344</span></a>                        <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1345"><a href="#PumpWoodMicroService-1345"><span class="linenos">1345</span></a>                <span class="n">resp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1346"><a href="#PumpWoodMicroService-1346"><span class="linenos">1346</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1347"><a href="#PumpWoodMicroService-1347"><span class="linenos">1347</span></a>                <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1348"><a href="#PumpWoodMicroService-1348"><span class="linenos">1348</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">## Finished parallel flat list: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">pool_arguments</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1349"><a href="#PumpWoodMicroService-1349"><span class="linenos">1349</span></a>
</span><span id="PumpWoodMicroService-1350"><a href="#PumpWoodMicroService-1350"><span class="linenos">1350</span></a>        <span class="c1">############################################</span>
</span><span id="PumpWoodMicroService-1351"><a href="#PumpWoodMicroService-1351"><span class="linenos">1351</span></a>        <span class="c1"># If table have partition, run in parallel #</span>
</span><span id="PumpWoodMicroService-1352"><a href="#PumpWoodMicroService-1352"><span class="linenos">1352</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1353"><a href="#PumpWoodMicroService-1353"><span class="linenos">1353</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1354"><a href="#PumpWoodMicroService-1354"><span class="linenos">1354</span></a>                <span class="n">results_key_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flat_list_by_chunks_helper</span><span class="p">({</span>
</span><span id="PumpWoodMicroService-1355"><a href="#PumpWoodMicroService-1355"><span class="linenos">1355</span></a>                    <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1356"><a href="#PumpWoodMicroService-1356"><span class="linenos">1356</span></a>                    <span class="s2">&quot;filter_dict&quot;</span><span class="p">:</span> <span class="n">temp_filter_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1357"><a href="#PumpWoodMicroService-1357"><span class="linenos">1357</span></a>                    <span class="s2">&quot;exclude_dict&quot;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1358"><a href="#PumpWoodMicroService-1358"><span class="linenos">1358</span></a>                    <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1359"><a href="#PumpWoodMicroService-1359"><span class="linenos">1359</span></a>                    <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1360"><a href="#PumpWoodMicroService-1360"><span class="linenos">1360</span></a>                    <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1361"><a href="#PumpWoodMicroService-1361"><span class="linenos">1361</span></a>                    <span class="s2">&quot;chunk_size&quot;</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">})</span>
</span><span id="PumpWoodMicroService-1362"><a href="#PumpWoodMicroService-1362"><span class="linenos">1362</span></a>                <span class="n">resp_df</span> <span class="o">=</span> <span class="n">results_key_data</span>
</span><span id="PumpWoodMicroService-1363"><a href="#PumpWoodMicroService-1363"><span class="linenos">1363</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1364"><a href="#PumpWoodMicroService-1364"><span class="linenos">1364</span></a>                <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1365"><a href="#PumpWoodMicroService-1365"><span class="linenos">1365</span></a>
</span><span id="PumpWoodMicroService-1366"><a href="#PumpWoodMicroService-1366"><span class="linenos">1366</span></a>        <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">))</span> <span class="ow">and</span> <span class="n">create_composite_pk</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1367"><a href="#PumpWoodMicroService-1367"><span class="linenos">1367</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Creating composite pk&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1368"><a href="#PumpWoodMicroService-1368"><span class="linenos">1368</span></a>            <span class="n">resp_df</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resp_df</span><span class="p">[</span><span class="n">primary_keys</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1369"><a href="#PumpWoodMicroService-1369"><span class="linenos">1369</span></a>                <span class="n">CompositePkBase64Converter</span><span class="o">.</span><span class="n">dump</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1370"><a href="#PumpWoodMicroService-1370"><span class="linenos">1370</span></a>                <span class="n">primary_keys</span><span class="o">=</span><span class="n">primary_keys</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1371"><a href="#PumpWoodMicroService-1371"><span class="linenos">1371</span></a>            <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1372"><a href="#PumpWoodMicroService-1372"><span class="linenos">1372</span></a>                <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pk&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">fields</span>
</span><span id="PumpWoodMicroService-1373"><a href="#PumpWoodMicroService-1373"><span class="linenos">1373</span></a>
</span><span id="PumpWoodMicroService-1374"><a href="#PumpWoodMicroService-1374"><span class="linenos">1374</span></a>        <span class="c1"># Adjust columns to return the columns set at fields</span>
</span><span id="PumpWoodMicroService-1375"><a href="#PumpWoodMicroService-1375"><span class="linenos">1375</span></a>        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1376"><a href="#PumpWoodMicroService-1376"><span class="linenos">1376</span></a>            <span class="n">resp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resp_df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1377"><a href="#PumpWoodMicroService-1377"><span class="linenos">1377</span></a>        <span class="k">return</span> <span class="n">resp_df</span>
</span><span id="PumpWoodMicroService-1378"><a href="#PumpWoodMicroService-1378"><span class="linenos">1378</span></a>
</span><span id="PumpWoodMicroService-1379"><a href="#PumpWoodMicroService-1379"><span class="linenos">1379</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PumpWoodMicroService-1380"><a href="#PumpWoodMicroService-1380"><span class="linenos">1380</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_build_bulk_save_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1381"><a href="#PumpWoodMicroService-1381"><span class="linenos">1381</span></a>        <span class="k">return</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/bulk-save/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),)</span>
</span><span id="PumpWoodMicroService-1382"><a href="#PumpWoodMicroService-1382"><span class="linenos">1382</span></a>
</span><span id="PumpWoodMicroService-1383"><a href="#PumpWoodMicroService-1383"><span class="linenos">1383</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">bulk_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_to_save</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1384"><a href="#PumpWoodMicroService-1384"><span class="linenos">1384</span></a>                  <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1385"><a href="#PumpWoodMicroService-1385"><span class="linenos">1385</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Save a list of objects with one request.</span>
</span><span id="PumpWoodMicroService-1386"><a href="#PumpWoodMicroService-1386"><span class="linenos">1386</span></a>
</span><span id="PumpWoodMicroService-1387"><a href="#PumpWoodMicroService-1387"><span class="linenos">1387</span></a><span class="sd">        It is used with a unique call save many objects at the same time. It</span>
</span><span id="PumpWoodMicroService-1388"><a href="#PumpWoodMicroService-1388"><span class="linenos">1388</span></a><span class="sd">        is necessary that the end-point is able to receive bulk save requests</span>
</span><span id="PumpWoodMicroService-1389"><a href="#PumpWoodMicroService-1389"><span class="linenos">1389</span></a><span class="sd">        and all objects been of the same model class.</span>
</span><span id="PumpWoodMicroService-1390"><a href="#PumpWoodMicroService-1390"><span class="linenos">1390</span></a>
</span><span id="PumpWoodMicroService-1391"><a href="#PumpWoodMicroService-1391"><span class="linenos">1391</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1392"><a href="#PumpWoodMicroService-1392"><span class="linenos">1392</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-1393"><a href="#PumpWoodMicroService-1393"><span class="linenos">1393</span></a><span class="sd">                Data model class.</span>
</span><span id="PumpWoodMicroService-1394"><a href="#PumpWoodMicroService-1394"><span class="linenos">1394</span></a><span class="sd">            data_to_save:</span>
</span><span id="PumpWoodMicroService-1395"><a href="#PumpWoodMicroService-1395"><span class="linenos">1395</span></a><span class="sd">                A list of objects to be saved.</span>
</span><span id="PumpWoodMicroService-1396"><a href="#PumpWoodMicroService-1396"><span class="linenos">1396</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-1397"><a href="#PumpWoodMicroService-1397"><span class="linenos">1397</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-1398"><a href="#PumpWoodMicroService-1398"><span class="linenos">1398</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-1399"><a href="#PumpWoodMicroService-1399"><span class="linenos">1399</span></a>
</span><span id="PumpWoodMicroService-1400"><a href="#PumpWoodMicroService-1400"><span class="linenos">1400</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1401"><a href="#PumpWoodMicroService-1401"><span class="linenos">1401</span></a><span class="sd">            A dictinary with `saved_count` as key indicating the number of</span>
</span><span id="PumpWoodMicroService-1402"><a href="#PumpWoodMicroService-1402"><span class="linenos">1402</span></a><span class="sd">            objects that were saved in database.</span>
</span><span id="PumpWoodMicroService-1403"><a href="#PumpWoodMicroService-1403"><span class="linenos">1403</span></a>
</span><span id="PumpWoodMicroService-1404"><a href="#PumpWoodMicroService-1404"><span class="linenos">1404</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-1405"><a href="#PumpWoodMicroService-1405"><span class="linenos">1405</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1406"><a href="#PumpWoodMicroService-1406"><span class="linenos">1406</span></a><span class="sd">                &#39;Expected columns and data columns do not match: Expected</span>
</span><span id="PumpWoodMicroService-1407"><a href="#PumpWoodMicroService-1407"><span class="linenos">1407</span></a><span class="sd">                columns: {expected} Data columns: {data_cols}&#39;. Indicates</span>
</span><span id="PumpWoodMicroService-1408"><a href="#PumpWoodMicroService-1408"><span class="linenos">1408</span></a><span class="sd">                that the expected fields of the object were not met at the</span>
</span><span id="PumpWoodMicroService-1409"><a href="#PumpWoodMicroService-1409"><span class="linenos">1409</span></a><span class="sd">                objects passed to save.</span>
</span><span id="PumpWoodMicroService-1410"><a href="#PumpWoodMicroService-1410"><span class="linenos">1410</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1411"><a href="#PumpWoodMicroService-1411"><span class="linenos">1411</span></a><span class="sd">                Other sqlalchemy and psycopg2 errors not associated with</span>
</span><span id="PumpWoodMicroService-1412"><a href="#PumpWoodMicroService-1412"><span class="linenos">1412</span></a><span class="sd">                IntegrityError.</span>
</span><span id="PumpWoodMicroService-1413"><a href="#PumpWoodMicroService-1413"><span class="linenos">1413</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1414"><a href="#PumpWoodMicroService-1414"><span class="linenos">1414</span></a><span class="sd">                &#39;Bulk save not avaiable.&#39;. Indicates that Bulk save end-point</span>
</span><span id="PumpWoodMicroService-1415"><a href="#PumpWoodMicroService-1415"><span class="linenos">1415</span></a><span class="sd">                was not configured for this model_class.</span>
</span><span id="PumpWoodMicroService-1416"><a href="#PumpWoodMicroService-1416"><span class="linenos">1416</span></a><span class="sd">            PumpWoodIntegrityError:</span>
</span><span id="PumpWoodMicroService-1417"><a href="#PumpWoodMicroService-1417"><span class="linenos">1417</span></a><span class="sd">                Raise integrity errors from sqlalchemy and psycopg2. Usually</span>
</span><span id="PumpWoodMicroService-1418"><a href="#PumpWoodMicroService-1418"><span class="linenos">1418</span></a><span class="sd">                associated with uniqueness of some column.</span>
</span><span id="PumpWoodMicroService-1419"><a href="#PumpWoodMicroService-1419"><span class="linenos">1419</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1420"><a href="#PumpWoodMicroService-1420"><span class="linenos">1420</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_bulk_save_url</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1421"><a href="#PumpWoodMicroService-1421"><span class="linenos">1421</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1422"><a href="#PumpWoodMicroService-1422"><span class="linenos">1422</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_to_save</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1423"><a href="#PumpWoodMicroService-1423"><span class="linenos">1423</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1424"><a href="#PumpWoodMicroService-1424"><span class="linenos">1424</span></a>
</span><span id="PumpWoodMicroService-1425"><a href="#PumpWoodMicroService-1425"><span class="linenos">1425</span></a>    <span class="c1">########################</span>
</span><span id="PumpWoodMicroService-1426"><a href="#PumpWoodMicroService-1426"><span class="linenos">1426</span></a>    <span class="c1"># Parallel aux functions</span>
</span><span id="PumpWoodMicroService-1427"><a href="#PumpWoodMicroService-1427"><span class="linenos">1427</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PumpWoodMicroService-1428"><a href="#PumpWoodMicroService-1428"><span class="linenos">1428</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">flatten_parallel</span><span class="p">(</span><span class="n">parallel_result</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1429"><a href="#PumpWoodMicroService-1429"><span class="linenos">1429</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Concat all parallel return to one list.</span>
</span><span id="PumpWoodMicroService-1430"><a href="#PumpWoodMicroService-1430"><span class="linenos">1430</span></a>
</span><span id="PumpWoodMicroService-1431"><a href="#PumpWoodMicroService-1431"><span class="linenos">1431</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1432"><a href="#PumpWoodMicroService-1432"><span class="linenos">1432</span></a><span class="sd">            parallel_result:</span>
</span><span id="PumpWoodMicroService-1433"><a href="#PumpWoodMicroService-1433"><span class="linenos">1433</span></a><span class="sd">                A list of lists to be flated (concatenate</span>
</span><span id="PumpWoodMicroService-1434"><a href="#PumpWoodMicroService-1434"><span class="linenos">1434</span></a><span class="sd">                all lists into one).</span>
</span><span id="PumpWoodMicroService-1435"><a href="#PumpWoodMicroService-1435"><span class="linenos">1435</span></a>
</span><span id="PumpWoodMicroService-1436"><a href="#PumpWoodMicroService-1436"><span class="linenos">1436</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1437"><a href="#PumpWoodMicroService-1437"><span class="linenos">1437</span></a><span class="sd">            A list with all sub list itens.</span>
</span><span id="PumpWoodMicroService-1438"><a href="#PumpWoodMicroService-1438"><span class="linenos">1438</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1439"><a href="#PumpWoodMicroService-1439"><span class="linenos">1439</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService-1440"><a href="#PumpWoodMicroService-1440"><span class="linenos">1440</span></a>            <span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">parallel_result</span>
</span><span id="PumpWoodMicroService-1441"><a href="#PumpWoodMicroService-1441"><span class="linenos">1441</span></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1442"><a href="#PumpWoodMicroService-1442"><span class="linenos">1442</span></a>
</span><span id="PumpWoodMicroService-1443"><a href="#PumpWoodMicroService-1443"><span class="linenos">1443</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_request_get_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1444"><a href="#PumpWoodMicroService-1444"><span class="linenos">1444</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1445"><a href="#PumpWoodMicroService-1445"><span class="linenos">1445</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span><span class="o">**</span><span class="n">arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1446"><a href="#PumpWoodMicroService-1446"><span class="linenos">1446</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1447"><a href="#PumpWoodMicroService-1447"><span class="linenos">1447</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-1448"><a href="#PumpWoodMicroService-1448"><span class="linenos">1448</span></a>            <span class="k">return</span> <span class="n">results</span>
</span><span id="PumpWoodMicroService-1449"><a href="#PumpWoodMicroService-1449"><span class="linenos">1449</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1450"><a href="#PumpWoodMicroService-1450"><span class="linenos">1450</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error on parallel get: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1451"><a href="#PumpWoodMicroService-1451"><span class="linenos">1451</span></a>
</span><span id="PumpWoodMicroService-1452"><a href="#PumpWoodMicroService-1452"><span class="linenos">1452</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_request_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">urls_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1453"><a href="#PumpWoodMicroService-1453"><span class="linenos">1453</span></a>                             <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1454"><a href="#PumpWoodMicroService-1454"><span class="linenos">1454</span></a>                             <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">any</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-1455"><a href="#PumpWoodMicroService-1455"><span class="linenos">1455</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel get requests.</span>
</span><span id="PumpWoodMicroService-1456"><a href="#PumpWoodMicroService-1456"><span class="linenos">1456</span></a>
</span><span id="PumpWoodMicroService-1457"><a href="#PumpWoodMicroService-1457"><span class="linenos">1457</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1458"><a href="#PumpWoodMicroService-1458"><span class="linenos">1458</span></a><span class="sd">            urls_list:</span>
</span><span id="PumpWoodMicroService-1459"><a href="#PumpWoodMicroService-1459"><span class="linenos">1459</span></a><span class="sd">                List of urls to make get requests.</span>
</span><span id="PumpWoodMicroService-1460"><a href="#PumpWoodMicroService-1460"><span class="linenos">1460</span></a><span class="sd">            parameters:</span>
</span><span id="PumpWoodMicroService-1461"><a href="#PumpWoodMicroService-1461"><span class="linenos">1461</span></a><span class="sd">                A list of dictionary or a dictionary that will be replicated</span>
</span><span id="PumpWoodMicroService-1462"><a href="#PumpWoodMicroService-1462"><span class="linenos">1462</span></a><span class="sd">                len(urls_list) and passed to parallel request as url</span>
</span><span id="PumpWoodMicroService-1463"><a href="#PumpWoodMicroService-1463"><span class="linenos">1463</span></a><span class="sd">                parameter. If not set, empty dictionary will be passed to all</span>
</span><span id="PumpWoodMicroService-1464"><a href="#PumpWoodMicroService-1464"><span class="linenos">1464</span></a><span class="sd">                request as default.</span>
</span><span id="PumpWoodMicroService-1465"><a href="#PumpWoodMicroService-1465"><span class="linenos">1465</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService-1466"><a href="#PumpWoodMicroService-1466"><span class="linenos">1466</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-1467"><a href="#PumpWoodMicroService-1467"><span class="linenos">1467</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-1468"><a href="#PumpWoodMicroService-1468"><span class="linenos">1468</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-1469"><a href="#PumpWoodMicroService-1469"><span class="linenos">1469</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-1470"><a href="#PumpWoodMicroService-1470"><span class="linenos">1470</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-1471"><a href="#PumpWoodMicroService-1471"><span class="linenos">1471</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-1472"><a href="#PumpWoodMicroService-1472"><span class="linenos">1472</span></a>
</span><span id="PumpWoodMicroService-1473"><a href="#PumpWoodMicroService-1473"><span class="linenos">1473</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1474"><a href="#PumpWoodMicroService-1474"><span class="linenos">1474</span></a><span class="sd">            Return a list with all get request reponses. The results are</span>
</span><span id="PumpWoodMicroService-1475"><a href="#PumpWoodMicroService-1475"><span class="linenos">1475</span></a><span class="sd">            on the same order of argument list.</span>
</span><span id="PumpWoodMicroService-1476"><a href="#PumpWoodMicroService-1476"><span class="linenos">1476</span></a>
</span><span id="PumpWoodMicroService-1477"><a href="#PumpWoodMicroService-1477"><span class="linenos">1477</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-1478"><a href="#PumpWoodMicroService-1478"><span class="linenos">1478</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1479"><a href="#PumpWoodMicroService-1479"><span class="linenos">1479</span></a><span class="sd">                &#39;lenght of urls_list[{}] is different of parameters[{}]&#39;.</span>
</span><span id="PumpWoodMicroService-1480"><a href="#PumpWoodMicroService-1480"><span class="linenos">1480</span></a><span class="sd">                Indicates that the function arguments `urls_list` and</span>
</span><span id="PumpWoodMicroService-1481"><a href="#PumpWoodMicroService-1481"><span class="linenos">1481</span></a><span class="sd">                `parameters` (when passed as a list of dictionaries)</span>
</span><span id="PumpWoodMicroService-1482"><a href="#PumpWoodMicroService-1482"><span class="linenos">1482</span></a><span class="sd">                does not have de same lenght.</span>
</span><span id="PumpWoodMicroService-1483"><a href="#PumpWoodMicroService-1483"><span class="linenos">1483</span></a><span class="sd">            PumpWoodNotImplementedError:</span>
</span><span id="PumpWoodMicroService-1484"><a href="#PumpWoodMicroService-1484"><span class="linenos">1484</span></a><span class="sd">                &#39;paraemters type[{}] is not implemented&#39;. Indicates that</span>
</span><span id="PumpWoodMicroService-1485"><a href="#PumpWoodMicroService-1485"><span class="linenos">1485</span></a><span class="sd">                `parameters` passed as function argument is not a list of dict</span>
</span><span id="PumpWoodMicroService-1486"><a href="#PumpWoodMicroService-1486"><span class="linenos">1486</span></a><span class="sd">                or a dictinary, so not implemented.</span>
</span><span id="PumpWoodMicroService-1487"><a href="#PumpWoodMicroService-1487"><span class="linenos">1487</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1488"><a href="#PumpWoodMicroService-1488"><span class="linenos">1488</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1489"><a href="#PumpWoodMicroService-1489"><span class="linenos">1489</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1490"><a href="#PumpWoodMicroService-1490"><span class="linenos">1490</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1491"><a href="#PumpWoodMicroService-1491"><span class="linenos">1491</span></a>
</span><span id="PumpWoodMicroService-1492"><a href="#PumpWoodMicroService-1492"><span class="linenos">1492</span></a>        <span class="c1"># Create URL parameters if not set as parameter with</span>
</span><span id="PumpWoodMicroService-1493"><a href="#PumpWoodMicroService-1493"><span class="linenos">1493</span></a>        <span class="c1"># empty dicionaries</span>
</span><span id="PumpWoodMicroService-1494"><a href="#PumpWoodMicroService-1494"><span class="linenos">1494</span></a>        <span class="n">n_urls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1495"><a href="#PumpWoodMicroService-1495"><span class="linenos">1495</span></a>        <span class="n">parameters_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-1496"><a href="#PumpWoodMicroService-1496"><span class="linenos">1496</span></a>        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1497"><a href="#PumpWoodMicroService-1497"><span class="linenos">1497</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService-1498"><a href="#PumpWoodMicroService-1498"><span class="linenos">1498</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1499"><a href="#PumpWoodMicroService-1499"><span class="linenos">1499</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{</span><span class="n">parameters</span><span class="p">}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService-1500"><a href="#PumpWoodMicroService-1500"><span class="linenos">1500</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1501"><a href="#PumpWoodMicroService-1501"><span class="linenos">1501</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_urls</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1502"><a href="#PumpWoodMicroService-1502"><span class="linenos">1502</span></a>                <span class="n">parameters_list</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="PumpWoodMicroService-1503"><a href="#PumpWoodMicroService-1503"><span class="linenos">1503</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1504"><a href="#PumpWoodMicroService-1504"><span class="linenos">1504</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-1505"><a href="#PumpWoodMicroService-1505"><span class="linenos">1505</span></a>                    <span class="s1">&#39;lenght of urls_list[</span><span class="si">{}</span><span class="s1">] is different of &#39;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService-1506"><a href="#PumpWoodMicroService-1506"><span class="linenos">1506</span></a>                    <span class="s1">&#39;parameters[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1507"><a href="#PumpWoodMicroService-1507"><span class="linenos">1507</span></a>                        <span class="n">n_urls</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1508"><a href="#PumpWoodMicroService-1508"><span class="linenos">1508</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1509"><a href="#PumpWoodMicroService-1509"><span class="linenos">1509</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1510"><a href="#PumpWoodMicroService-1510"><span class="linenos">1510</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;paraemters type[</span><span class="si">{}</span><span class="s1">] is not implemented&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1511"><a href="#PumpWoodMicroService-1511"><span class="linenos">1511</span></a>                <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)))</span>
</span><span id="PumpWoodMicroService-1512"><a href="#PumpWoodMicroService-1512"><span class="linenos">1512</span></a>            <span class="k">raise</span> <span class="n">PumpWoodNotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1513"><a href="#PumpWoodMicroService-1513"><span class="linenos">1513</span></a>
</span><span id="PumpWoodMicroService-1514"><a href="#PumpWoodMicroService-1514"><span class="linenos">1514</span></a>        <span class="c1"># Create Pool arguments to run in parallel</span>
</span><span id="PumpWoodMicroService-1515"><a href="#PumpWoodMicroService-1515"><span class="linenos">1515</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService-1516"><a href="#PumpWoodMicroService-1516"><span class="linenos">1516</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)):</span>
</span><span id="PumpWoodMicroService-1517"><a href="#PumpWoodMicroService-1517"><span class="linenos">1517</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService-1518"><a href="#PumpWoodMicroService-1518"><span class="linenos">1518</span></a>                <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">urls_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;auth_header&#39;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1519"><a href="#PumpWoodMicroService-1519"><span class="linenos">1519</span></a>                <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="n">parameters_list</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
</span><span id="PumpWoodMicroService-1520"><a href="#PumpWoodMicroService-1520"><span class="linenos">1520</span></a>
</span><span id="PumpWoodMicroService-1521"><a href="#PumpWoodMicroService-1521"><span class="linenos">1521</span></a>        <span class="c1"># Run requests in parallel</span>
</span><span id="PumpWoodMicroService-1522"><a href="#PumpWoodMicroService-1522"><span class="linenos">1522</span></a>        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1523"><a href="#PumpWoodMicroService-1523"><span class="linenos">1523</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_request_get_wrapper</span><span class="p">,</span> <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1524"><a href="#PumpWoodMicroService-1524"><span class="linenos">1524</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1525"><a href="#PumpWoodMicroService-1525"><span class="linenos">1525</span></a>        <span class="k">return</span> <span class="n">results</span>
</span><span id="PumpWoodMicroService-1526"><a href="#PumpWoodMicroService-1526"><span class="linenos">1526</span></a>
</span><span id="PumpWoodMicroService-1527"><a href="#PumpWoodMicroService-1527"><span class="linenos">1527</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_request_post_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1528"><a href="#PumpWoodMicroService-1528"><span class="linenos">1528</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1529"><a href="#PumpWoodMicroService-1529"><span class="linenos">1529</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span><span class="o">**</span><span class="n">arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1530"><a href="#PumpWoodMicroService-1530"><span class="linenos">1530</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1531"><a href="#PumpWoodMicroService-1531"><span class="linenos">1531</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-1532"><a href="#PumpWoodMicroService-1532"><span class="linenos">1532</span></a>            <span class="k">return</span> <span class="n">result</span>
</span><span id="PumpWoodMicroService-1533"><a href="#PumpWoodMicroService-1533"><span class="linenos">1533</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1534"><a href="#PumpWoodMicroService-1534"><span class="linenos">1534</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error in parallel post: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1535"><a href="#PumpWoodMicroService-1535"><span class="linenos">1535</span></a>
</span><span id="PumpWoodMicroService-1536"><a href="#PumpWoodMicroService-1536"><span class="linenos">1536</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">paralell_request_post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">urls_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-1537"><a href="#PumpWoodMicroService-1537"><span class="linenos">1537</span></a>                              <span class="n">data_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-1538"><a href="#PumpWoodMicroService-1538"><span class="linenos">1538</span></a>                              <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1539"><a href="#PumpWoodMicroService-1539"><span class="linenos">1539</span></a>                              <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1540"><a href="#PumpWoodMicroService-1540"><span class="linenos">1540</span></a>                              <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">any</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-1541"><a href="#PumpWoodMicroService-1541"><span class="linenos">1541</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel post request.</span>
</span><span id="PumpWoodMicroService-1542"><a href="#PumpWoodMicroService-1542"><span class="linenos">1542</span></a>
</span><span id="PumpWoodMicroService-1543"><a href="#PumpWoodMicroService-1543"><span class="linenos">1543</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1544"><a href="#PumpWoodMicroService-1544"><span class="linenos">1544</span></a><span class="sd">            urls_list:</span>
</span><span id="PumpWoodMicroService-1545"><a href="#PumpWoodMicroService-1545"><span class="linenos">1545</span></a><span class="sd">                List of urls to make get requests.</span>
</span><span id="PumpWoodMicroService-1546"><a href="#PumpWoodMicroService-1546"><span class="linenos">1546</span></a><span class="sd">            data_list:</span>
</span><span id="PumpWoodMicroService-1547"><a href="#PumpWoodMicroService-1547"><span class="linenos">1547</span></a><span class="sd">                List of data to be used as post payloads.</span>
</span><span id="PumpWoodMicroService-1548"><a href="#PumpWoodMicroService-1548"><span class="linenos">1548</span></a><span class="sd">            parameters:</span>
</span><span id="PumpWoodMicroService-1549"><a href="#PumpWoodMicroService-1549"><span class="linenos">1549</span></a><span class="sd">                URL paramenters to make the post requests.</span>
</span><span id="PumpWoodMicroService-1550"><a href="#PumpWoodMicroService-1550"><span class="linenos">1550</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService-1551"><a href="#PumpWoodMicroService-1551"><span class="linenos">1551</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-1552"><a href="#PumpWoodMicroService-1552"><span class="linenos">1552</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-1553"><a href="#PumpWoodMicroService-1553"><span class="linenos">1553</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-1554"><a href="#PumpWoodMicroService-1554"><span class="linenos">1554</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-1555"><a href="#PumpWoodMicroService-1555"><span class="linenos">1555</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-1556"><a href="#PumpWoodMicroService-1556"><span class="linenos">1556</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-1557"><a href="#PumpWoodMicroService-1557"><span class="linenos">1557</span></a>
</span><span id="PumpWoodMicroService-1558"><a href="#PumpWoodMicroService-1558"><span class="linenos">1558</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1559"><a href="#PumpWoodMicroService-1559"><span class="linenos">1559</span></a><span class="sd">            List of the post request reponses.</span>
</span><span id="PumpWoodMicroService-1560"><a href="#PumpWoodMicroService-1560"><span class="linenos">1560</span></a>
</span><span id="PumpWoodMicroService-1561"><a href="#PumpWoodMicroService-1561"><span class="linenos">1561</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-1562"><a href="#PumpWoodMicroService-1562"><span class="linenos">1562</span></a><span class="sd">            No particular raises</span>
</span><span id="PumpWoodMicroService-1563"><a href="#PumpWoodMicroService-1563"><span class="linenos">1563</span></a>
</span><span id="PumpWoodMicroService-1564"><a href="#PumpWoodMicroService-1564"><span class="linenos">1564</span></a><span class="sd">        Example:</span>
</span><span id="PumpWoodMicroService-1565"><a href="#PumpWoodMicroService-1565"><span class="linenos">1565</span></a><span class="sd">            No example yet.</span>
</span><span id="PumpWoodMicroService-1566"><a href="#PumpWoodMicroService-1566"><span class="linenos">1566</span></a>
</span><span id="PumpWoodMicroService-1567"><a href="#PumpWoodMicroService-1567"><span class="linenos">1567</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1568"><a href="#PumpWoodMicroService-1568"><span class="linenos">1568</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1569"><a href="#PumpWoodMicroService-1569"><span class="linenos">1569</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1570"><a href="#PumpWoodMicroService-1570"><span class="linenos">1570</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1571"><a href="#PumpWoodMicroService-1571"><span class="linenos">1571</span></a>
</span><span id="PumpWoodMicroService-1572"><a href="#PumpWoodMicroService-1572"><span class="linenos">1572</span></a>        <span class="c1"># Create URL parameters if not set as parameter with</span>
</span><span id="PumpWoodMicroService-1573"><a href="#PumpWoodMicroService-1573"><span class="linenos">1573</span></a>        <span class="c1"># empty dicionaries</span>
</span><span id="PumpWoodMicroService-1574"><a href="#PumpWoodMicroService-1574"><span class="linenos">1574</span></a>        <span class="n">n_urls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1575"><a href="#PumpWoodMicroService-1575"><span class="linenos">1575</span></a>        <span class="n">parameters_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-1576"><a href="#PumpWoodMicroService-1576"><span class="linenos">1576</span></a>        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1577"><a href="#PumpWoodMicroService-1577"><span class="linenos">1577</span></a>            <span class="n">parameters_list</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService-1578"><a href="#PumpWoodMicroService-1578"><span class="linenos">1578</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1579"><a href="#PumpWoodMicroService-1579"><span class="linenos">1579</span></a>            <span class="n">parameters_list</span> <span class="o">=</span> <span class="p">[{</span><span class="n">parameters</span><span class="p">}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService-1580"><a href="#PumpWoodMicroService-1580"><span class="linenos">1580</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1581"><a href="#PumpWoodMicroService-1581"><span class="linenos">1581</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_urls</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1582"><a href="#PumpWoodMicroService-1582"><span class="linenos">1582</span></a>                <span class="n">parameters_list</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="PumpWoodMicroService-1583"><a href="#PumpWoodMicroService-1583"><span class="linenos">1583</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1584"><a href="#PumpWoodMicroService-1584"><span class="linenos">1584</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-1585"><a href="#PumpWoodMicroService-1585"><span class="linenos">1585</span></a>                    <span class="s1">&#39;lenght of urls_list[</span><span class="si">{}</span><span class="s1">] is different of &#39;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService-1586"><a href="#PumpWoodMicroService-1586"><span class="linenos">1586</span></a>                    <span class="s1">&#39;parameters[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1587"><a href="#PumpWoodMicroService-1587"><span class="linenos">1587</span></a>                        <span class="n">n_urls</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1588"><a href="#PumpWoodMicroService-1588"><span class="linenos">1588</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1589"><a href="#PumpWoodMicroService-1589"><span class="linenos">1589</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1590"><a href="#PumpWoodMicroService-1590"><span class="linenos">1590</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;paraemters type[</span><span class="si">{}</span><span class="s1">] is not implemented&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1591"><a href="#PumpWoodMicroService-1591"><span class="linenos">1591</span></a>                <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)))</span>
</span><span id="PumpWoodMicroService-1592"><a href="#PumpWoodMicroService-1592"><span class="linenos">1592</span></a>            <span class="k">raise</span> <span class="n">PumpWoodNotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1593"><a href="#PumpWoodMicroService-1593"><span class="linenos">1593</span></a>
</span><span id="PumpWoodMicroService-1594"><a href="#PumpWoodMicroService-1594"><span class="linenos">1594</span></a>        <span class="c1"># Validate if length of URL is the same of data_list</span>
</span><span id="PumpWoodMicroService-1595"><a href="#PumpWoodMicroService-1595"><span class="linenos">1595</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1596"><a href="#PumpWoodMicroService-1596"><span class="linenos">1596</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-1597"><a href="#PumpWoodMicroService-1597"><span class="linenos">1597</span></a>                <span class="s1">&#39;len(urls_list)[</span><span class="si">{}</span><span class="s1">] must be equal &#39;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService-1598"><a href="#PumpWoodMicroService-1598"><span class="linenos">1598</span></a>                <span class="s1">&#39;to len(data_list)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1599"><a href="#PumpWoodMicroService-1599"><span class="linenos">1599</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1600"><a href="#PumpWoodMicroService-1600"><span class="linenos">1600</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1601"><a href="#PumpWoodMicroService-1601"><span class="linenos">1601</span></a>
</span><span id="PumpWoodMicroService-1602"><a href="#PumpWoodMicroService-1602"><span class="linenos">1602</span></a>        <span class="c1"># Create the arguments for parallel requests</span>
</span><span id="PumpWoodMicroService-1603"><a href="#PumpWoodMicroService-1603"><span class="linenos">1603</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService-1604"><a href="#PumpWoodMicroService-1604"><span class="linenos">1604</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)):</span>
</span><span id="PumpWoodMicroService-1605"><a href="#PumpWoodMicroService-1605"><span class="linenos">1605</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService-1606"><a href="#PumpWoodMicroService-1606"><span class="linenos">1606</span></a>                <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">urls_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-1607"><a href="#PumpWoodMicroService-1607"><span class="linenos">1607</span></a>                <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-1608"><a href="#PumpWoodMicroService-1608"><span class="linenos">1608</span></a>                <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="n">parameters_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-1609"><a href="#PumpWoodMicroService-1609"><span class="linenos">1609</span></a>                <span class="s1">&#39;auth_header&#39;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">})</span>
</span><span id="PumpWoodMicroService-1610"><a href="#PumpWoodMicroService-1610"><span class="linenos">1610</span></a>
</span><span id="PumpWoodMicroService-1611"><a href="#PumpWoodMicroService-1611"><span class="linenos">1611</span></a>        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1612"><a href="#PumpWoodMicroService-1612"><span class="linenos">1612</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_request_post_wrapper</span><span class="p">,</span> <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1613"><a href="#PumpWoodMicroService-1613"><span class="linenos">1613</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1614"><a href="#PumpWoodMicroService-1614"><span class="linenos">1614</span></a>        <span class="k">return</span> <span class="n">results</span>
</span><span id="PumpWoodMicroService-1615"><a href="#PumpWoodMicroService-1615"><span class="linenos">1615</span></a>
</span><span id="PumpWoodMicroService-1616"><a href="#PumpWoodMicroService-1616"><span class="linenos">1616</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_request_delete_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1617"><a href="#PumpWoodMicroService-1617"><span class="linenos">1617</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1618"><a href="#PumpWoodMicroService-1618"><span class="linenos">1618</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_delete</span><span class="p">(</span><span class="o">**</span><span class="n">arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1619"><a href="#PumpWoodMicroService-1619"><span class="linenos">1619</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1620"><a href="#PumpWoodMicroService-1620"><span class="linenos">1620</span></a>            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-1621"><a href="#PumpWoodMicroService-1621"><span class="linenos">1621</span></a>            <span class="k">return</span> <span class="n">result</span>
</span><span id="PumpWoodMicroService-1622"><a href="#PumpWoodMicroService-1622"><span class="linenos">1622</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1623"><a href="#PumpWoodMicroService-1623"><span class="linenos">1623</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error in parallel delete: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1624"><a href="#PumpWoodMicroService-1624"><span class="linenos">1624</span></a>
</span><span id="PumpWoodMicroService-1625"><a href="#PumpWoodMicroService-1625"><span class="linenos">1625</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">paralell_request_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">urls_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-1626"><a href="#PumpWoodMicroService-1626"><span class="linenos">1626</span></a>                                <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1627"><a href="#PumpWoodMicroService-1627"><span class="linenos">1627</span></a>                                <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1628"><a href="#PumpWoodMicroService-1628"><span class="linenos">1628</span></a>                                <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1629"><a href="#PumpWoodMicroService-1629"><span class="linenos">1629</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel delete request.</span>
</span><span id="PumpWoodMicroService-1630"><a href="#PumpWoodMicroService-1630"><span class="linenos">1630</span></a>
</span><span id="PumpWoodMicroService-1631"><a href="#PumpWoodMicroService-1631"><span class="linenos">1631</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1632"><a href="#PumpWoodMicroService-1632"><span class="linenos">1632</span></a><span class="sd">            urls_list:</span>
</span><span id="PumpWoodMicroService-1633"><a href="#PumpWoodMicroService-1633"><span class="linenos">1633</span></a><span class="sd">                List of urls to make get requests.</span>
</span><span id="PumpWoodMicroService-1634"><a href="#PumpWoodMicroService-1634"><span class="linenos">1634</span></a><span class="sd">            parameters:</span>
</span><span id="PumpWoodMicroService-1635"><a href="#PumpWoodMicroService-1635"><span class="linenos">1635</span></a><span class="sd">                URL paramenters to make the post requests.</span>
</span><span id="PumpWoodMicroService-1636"><a href="#PumpWoodMicroService-1636"><span class="linenos">1636</span></a><span class="sd">            n_parallel (int): Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-1637"><a href="#PumpWoodMicroService-1637"><span class="linenos">1637</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-1638"><a href="#PumpWoodMicroService-1638"><span class="linenos">1638</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-1639"><a href="#PumpWoodMicroService-1639"><span class="linenos">1639</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-1640"><a href="#PumpWoodMicroService-1640"><span class="linenos">1640</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-1641"><a href="#PumpWoodMicroService-1641"><span class="linenos">1641</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-1642"><a href="#PumpWoodMicroService-1642"><span class="linenos">1642</span></a>
</span><span id="PumpWoodMicroService-1643"><a href="#PumpWoodMicroService-1643"><span class="linenos">1643</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1644"><a href="#PumpWoodMicroService-1644"><span class="linenos">1644</span></a><span class="sd">            list: List of the get request reponses.</span>
</span><span id="PumpWoodMicroService-1645"><a href="#PumpWoodMicroService-1645"><span class="linenos">1645</span></a>
</span><span id="PumpWoodMicroService-1646"><a href="#PumpWoodMicroService-1646"><span class="linenos">1646</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-1647"><a href="#PumpWoodMicroService-1647"><span class="linenos">1647</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService-1648"><a href="#PumpWoodMicroService-1648"><span class="linenos">1648</span></a>
</span><span id="PumpWoodMicroService-1649"><a href="#PumpWoodMicroService-1649"><span class="linenos">1649</span></a><span class="sd">        Example:</span>
</span><span id="PumpWoodMicroService-1650"><a href="#PumpWoodMicroService-1650"><span class="linenos">1650</span></a><span class="sd">            No example yet.</span>
</span><span id="PumpWoodMicroService-1651"><a href="#PumpWoodMicroService-1651"><span class="linenos">1651</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1652"><a href="#PumpWoodMicroService-1652"><span class="linenos">1652</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1653"><a href="#PumpWoodMicroService-1653"><span class="linenos">1653</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1654"><a href="#PumpWoodMicroService-1654"><span class="linenos">1654</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1655"><a href="#PumpWoodMicroService-1655"><span class="linenos">1655</span></a>
</span><span id="PumpWoodMicroService-1656"><a href="#PumpWoodMicroService-1656"><span class="linenos">1656</span></a>        <span class="c1"># Create URL parameters if not set as parameter with</span>
</span><span id="PumpWoodMicroService-1657"><a href="#PumpWoodMicroService-1657"><span class="linenos">1657</span></a>        <span class="c1"># empty dicionaries</span>
</span><span id="PumpWoodMicroService-1658"><a href="#PumpWoodMicroService-1658"><span class="linenos">1658</span></a>        <span class="n">n_urls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1659"><a href="#PumpWoodMicroService-1659"><span class="linenos">1659</span></a>        <span class="n">parameters_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-1660"><a href="#PumpWoodMicroService-1660"><span class="linenos">1660</span></a>        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1661"><a href="#PumpWoodMicroService-1661"><span class="linenos">1661</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService-1662"><a href="#PumpWoodMicroService-1662"><span class="linenos">1662</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1663"><a href="#PumpWoodMicroService-1663"><span class="linenos">1663</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{</span><span class="n">parameters</span><span class="p">}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService-1664"><a href="#PumpWoodMicroService-1664"><span class="linenos">1664</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1665"><a href="#PumpWoodMicroService-1665"><span class="linenos">1665</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_urls</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1666"><a href="#PumpWoodMicroService-1666"><span class="linenos">1666</span></a>                <span class="n">parameters_list</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="PumpWoodMicroService-1667"><a href="#PumpWoodMicroService-1667"><span class="linenos">1667</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1668"><a href="#PumpWoodMicroService-1668"><span class="linenos">1668</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-1669"><a href="#PumpWoodMicroService-1669"><span class="linenos">1669</span></a>                    <span class="s1">&#39;lenght of urls_list[</span><span class="si">{}</span><span class="s1">] is different of &#39;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService-1670"><a href="#PumpWoodMicroService-1670"><span class="linenos">1670</span></a>                    <span class="s1">&#39;parameters[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1671"><a href="#PumpWoodMicroService-1671"><span class="linenos">1671</span></a>                        <span class="n">n_urls</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1672"><a href="#PumpWoodMicroService-1672"><span class="linenos">1672</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1673"><a href="#PumpWoodMicroService-1673"><span class="linenos">1673</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1674"><a href="#PumpWoodMicroService-1674"><span class="linenos">1674</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;paraemters type[</span><span class="si">{}</span><span class="s1">] is not implemented&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1675"><a href="#PumpWoodMicroService-1675"><span class="linenos">1675</span></a>                <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)))</span>
</span><span id="PumpWoodMicroService-1676"><a href="#PumpWoodMicroService-1676"><span class="linenos">1676</span></a>            <span class="k">raise</span> <span class="n">PumpWoodNotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1677"><a href="#PumpWoodMicroService-1677"><span class="linenos">1677</span></a>
</span><span id="PumpWoodMicroService-1678"><a href="#PumpWoodMicroService-1678"><span class="linenos">1678</span></a>        <span class="c1"># Create Pool arguments to run in parallel</span>
</span><span id="PumpWoodMicroService-1679"><a href="#PumpWoodMicroService-1679"><span class="linenos">1679</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService-1680"><a href="#PumpWoodMicroService-1680"><span class="linenos">1680</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)):</span>
</span><span id="PumpWoodMicroService-1681"><a href="#PumpWoodMicroService-1681"><span class="linenos">1681</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService-1682"><a href="#PumpWoodMicroService-1682"><span class="linenos">1682</span></a>                <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">urls_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;auth_header&#39;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1683"><a href="#PumpWoodMicroService-1683"><span class="linenos">1683</span></a>                <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="n">parameters_list</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
</span><span id="PumpWoodMicroService-1684"><a href="#PumpWoodMicroService-1684"><span class="linenos">1684</span></a>
</span><span id="PumpWoodMicroService-1685"><a href="#PumpWoodMicroService-1685"><span class="linenos">1685</span></a>        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1686"><a href="#PumpWoodMicroService-1686"><span class="linenos">1686</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_request_delete_wrapper</span><span class="p">,</span> <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1687"><a href="#PumpWoodMicroService-1687"><span class="linenos">1687</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1688"><a href="#PumpWoodMicroService-1688"><span class="linenos">1688</span></a>        <span class="k">return</span> <span class="n">results</span>
</span><span id="PumpWoodMicroService-1689"><a href="#PumpWoodMicroService-1689"><span class="linenos">1689</span></a>
</span><span id="PumpWoodMicroService-1690"><a href="#PumpWoodMicroService-1690"><span class="linenos">1690</span></a>    <span class="c1">######################</span>
</span><span id="PumpWoodMicroService-1691"><a href="#PumpWoodMicroService-1691"><span class="linenos">1691</span></a>    <span class="c1"># Parallel functions #</span>
</span><span id="PumpWoodMicroService-1692"><a href="#PumpWoodMicroService-1692"><span class="linenos">1692</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_retrieve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService-1693"><a href="#PumpWoodMicroService-1693"><span class="linenos">1693</span></a>                          <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1694"><a href="#PumpWoodMicroService-1694"><span class="linenos">1694</span></a>                          <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1695"><a href="#PumpWoodMicroService-1695"><span class="linenos">1695</span></a>                          <span class="n">related_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1696"><a href="#PumpWoodMicroService-1696"><span class="linenos">1696</span></a>                          <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1697"><a href="#PumpWoodMicroService-1697"><span class="linenos">1697</span></a>                          <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1698"><a href="#PumpWoodMicroService-1698"><span class="linenos">1698</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel retrieve request.</span>
</span><span id="PumpWoodMicroService-1699"><a href="#PumpWoodMicroService-1699"><span class="linenos">1699</span></a>
</span><span id="PumpWoodMicroService-1700"><a href="#PumpWoodMicroService-1700"><span class="linenos">1700</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1701"><a href="#PumpWoodMicroService-1701"><span class="linenos">1701</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-1702"><a href="#PumpWoodMicroService-1702"><span class="linenos">1702</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="PumpWoodMicroService-1703"><a href="#PumpWoodMicroService-1703"><span class="linenos">1703</span></a><span class="sd">            list_pk:</span>
</span><span id="PumpWoodMicroService-1704"><a href="#PumpWoodMicroService-1704"><span class="linenos">1704</span></a><span class="sd">                List of the pks to retrieve.</span>
</span><span id="PumpWoodMicroService-1705"><a href="#PumpWoodMicroService-1705"><span class="linenos">1705</span></a><span class="sd">            fields:</span>
</span><span id="PumpWoodMicroService-1706"><a href="#PumpWoodMicroService-1706"><span class="linenos">1706</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="PumpWoodMicroService-1707"><a href="#PumpWoodMicroService-1707"><span class="linenos">1707</span></a><span class="sd">            default_fields:</span>
</span><span id="PumpWoodMicroService-1708"><a href="#PumpWoodMicroService-1708"><span class="linenos">1708</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="PumpWoodMicroService-1709"><a href="#PumpWoodMicroService-1709"><span class="linenos">1709</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="PumpWoodMicroService-1710"><a href="#PumpWoodMicroService-1710"><span class="linenos">1710</span></a><span class="sd">            foreign_key_fields:</span>
</span><span id="PumpWoodMicroService-1711"><a href="#PumpWoodMicroService-1711"><span class="linenos">1711</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="PumpWoodMicroService-1712"><a href="#PumpWoodMicroService-1712"><span class="linenos">1712</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="PumpWoodMicroService-1713"><a href="#PumpWoodMicroService-1713"><span class="linenos">1713</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="PumpWoodMicroService-1714"><a href="#PumpWoodMicroService-1714"><span class="linenos">1714</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="PumpWoodMicroService-1715"><a href="#PumpWoodMicroService-1715"><span class="linenos">1715</span></a><span class="sd">            related_fields:</span>
</span><span id="PumpWoodMicroService-1716"><a href="#PumpWoodMicroService-1716"><span class="linenos">1716</span></a><span class="sd">                Return related fields objects. Related field objects are</span>
</span><span id="PumpWoodMicroService-1717"><a href="#PumpWoodMicroService-1717"><span class="linenos">1717</span></a><span class="sd">                objects that have a forenging key associated with this</span>
</span><span id="PumpWoodMicroService-1718"><a href="#PumpWoodMicroService-1718"><span class="linenos">1718</span></a><span class="sd">                model_class, results will be returned as a list of</span>
</span><span id="PumpWoodMicroService-1719"><a href="#PumpWoodMicroService-1719"><span class="linenos">1719</span></a><span class="sd">                dictionaries usually in a field with `_set` at end.</span>
</span><span id="PumpWoodMicroService-1720"><a href="#PumpWoodMicroService-1720"><span class="linenos">1720</span></a><span class="sd">                Returning related_fields consume backend resorces, use</span>
</span><span id="PumpWoodMicroService-1721"><a href="#PumpWoodMicroService-1721"><span class="linenos">1721</span></a><span class="sd">                carefully.</span>
</span><span id="PumpWoodMicroService-1722"><a href="#PumpWoodMicroService-1722"><span class="linenos">1722</span></a><span class="sd">            n_parallel (int): Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-1723"><a href="#PumpWoodMicroService-1723"><span class="linenos">1723</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-1724"><a href="#PumpWoodMicroService-1724"><span class="linenos">1724</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-1725"><a href="#PumpWoodMicroService-1725"><span class="linenos">1725</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-1726"><a href="#PumpWoodMicroService-1726"><span class="linenos">1726</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-1727"><a href="#PumpWoodMicroService-1727"><span class="linenos">1727</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-1728"><a href="#PumpWoodMicroService-1728"><span class="linenos">1728</span></a>
</span><span id="PumpWoodMicroService-1729"><a href="#PumpWoodMicroService-1729"><span class="linenos">1729</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1730"><a href="#PumpWoodMicroService-1730"><span class="linenos">1730</span></a><span class="sd">            List of the retrieve request data.</span>
</span><span id="PumpWoodMicroService-1731"><a href="#PumpWoodMicroService-1731"><span class="linenos">1731</span></a>
</span><span id="PumpWoodMicroService-1732"><a href="#PumpWoodMicroService-1732"><span class="linenos">1732</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-1733"><a href="#PumpWoodMicroService-1733"><span class="linenos">1733</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1734"><a href="#PumpWoodMicroService-1734"><span class="linenos">1734</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_pk)[{}]&#39;. Indicates that</span>
</span><span id="PumpWoodMicroService-1735"><a href="#PumpWoodMicroService-1735"><span class="linenos">1735</span></a><span class="sd">                the lenght of the arguments model_class and list_pk are</span>
</span><span id="PumpWoodMicroService-1736"><a href="#PumpWoodMicroService-1736"><span class="linenos">1736</span></a><span class="sd">                incompatible.</span>
</span><span id="PumpWoodMicroService-1737"><a href="#PumpWoodMicroService-1737"><span class="linenos">1737</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1738"><a href="#PumpWoodMicroService-1738"><span class="linenos">1738</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1739"><a href="#PumpWoodMicroService-1739"><span class="linenos">1739</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1740"><a href="#PumpWoodMicroService-1740"><span class="linenos">1740</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1741"><a href="#PumpWoodMicroService-1741"><span class="linenos">1741</span></a>
</span><span id="PumpWoodMicroService-1742"><a href="#PumpWoodMicroService-1742"><span class="linenos">1742</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1743"><a href="#PumpWoodMicroService-1743"><span class="linenos">1743</span></a>            <span class="n">model_class</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1744"><a href="#PumpWoodMicroService-1744"><span class="linenos">1744</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1745"><a href="#PumpWoodMicroService-1745"><span class="linenos">1745</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1746"><a href="#PumpWoodMicroService-1746"><span class="linenos">1746</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-1747"><a href="#PumpWoodMicroService-1747"><span class="linenos">1747</span></a>                    <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_pk)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1748"><a href="#PumpWoodMicroService-1748"><span class="linenos">1748</span></a>                        <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1749"><a href="#PumpWoodMicroService-1749"><span class="linenos">1749</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1750"><a href="#PumpWoodMicroService-1750"><span class="linenos">1750</span></a>
</span><span id="PumpWoodMicroService-1751"><a href="#PumpWoodMicroService-1751"><span class="linenos">1751</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService-1752"><a href="#PumpWoodMicroService-1752"><span class="linenos">1752</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_retrieve_url</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1753"><a href="#PumpWoodMicroService-1753"><span class="linenos">1753</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pk</span><span class="o">=</span><span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="PumpWoodMicroService-1754"><a href="#PumpWoodMicroService-1754"><span class="linenos">1754</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">))]</span>
</span><span id="PumpWoodMicroService-1755"><a href="#PumpWoodMicroService-1755"><span class="linenos">1755</span></a>
</span><span id="PumpWoodMicroService-1756"><a href="#PumpWoodMicroService-1756"><span class="linenos">1756</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1757"><a href="#PumpWoodMicroService-1757"><span class="linenos">1757</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1758"><a href="#PumpWoodMicroService-1758"><span class="linenos">1758</span></a>            <span class="n">parameters</span><span class="o">=</span><span class="p">{</span>
</span><span id="PumpWoodMicroService-1759"><a href="#PumpWoodMicroService-1759"><span class="linenos">1759</span></a>                <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span> <span class="s2">&quot;default_fields&quot;</span><span class="p">:</span> <span class="n">default_fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1760"><a href="#PumpWoodMicroService-1760"><span class="linenos">1760</span></a>                <span class="s2">&quot;foreign_key_fields&quot;</span><span class="p">:</span> <span class="n">foreign_key_fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1761"><a href="#PumpWoodMicroService-1761"><span class="linenos">1761</span></a>                <span class="s2">&quot;related_fields&quot;</span><span class="p">:</span> <span class="n">related_fields</span><span class="p">},</span>
</span><span id="PumpWoodMicroService-1762"><a href="#PumpWoodMicroService-1762"><span class="linenos">1762</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1763"><a href="#PumpWoodMicroService-1763"><span class="linenos">1763</span></a>
</span><span id="PumpWoodMicroService-1764"><a href="#PumpWoodMicroService-1764"><span class="linenos">1764</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">_request_retrieve_file_wrapper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1765"><a href="#PumpWoodMicroService-1765"><span class="linenos">1765</span></a>        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1766"><a href="#PumpWoodMicroService-1766"><span class="linenos">1766</span></a>        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-1767"><a href="#PumpWoodMicroService-1767"><span class="linenos">1767</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1768"><a href="#PumpWoodMicroService-1768"><span class="linenos">1768</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_file</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1769"><a href="#PumpWoodMicroService-1769"><span class="linenos">1769</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1770"><a href="#PumpWoodMicroService-1770"><span class="linenos">1770</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Error in parallel retrieve_file: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1771"><a href="#PumpWoodMicroService-1771"><span class="linenos">1771</span></a>
</span><span id="PumpWoodMicroService-1772"><a href="#PumpWoodMicroService-1772"><span class="linenos">1772</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_retrieve_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1773"><a href="#PumpWoodMicroService-1773"><span class="linenos">1773</span></a>                               <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">file_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1774"><a href="#PumpWoodMicroService-1774"><span class="linenos">1774</span></a>                               <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">,</span> <span class="n">save_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1775"><a href="#PumpWoodMicroService-1775"><span class="linenos">1775</span></a>                               <span class="n">list_file_name</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1776"><a href="#PumpWoodMicroService-1776"><span class="linenos">1776</span></a>                               <span class="n">if_exists</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fail&quot;</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1777"><a href="#PumpWoodMicroService-1777"><span class="linenos">1777</span></a>                               <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1778"><a href="#PumpWoodMicroService-1778"><span class="linenos">1778</span></a>                               <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1779"><a href="#PumpWoodMicroService-1779"><span class="linenos">1779</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make many [n_parallel] retrieve request.</span>
</span><span id="PumpWoodMicroService-1780"><a href="#PumpWoodMicroService-1780"><span class="linenos">1780</span></a>
</span><span id="PumpWoodMicroService-1781"><a href="#PumpWoodMicroService-1781"><span class="linenos">1781</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1782"><a href="#PumpWoodMicroService-1782"><span class="linenos">1782</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-1783"><a href="#PumpWoodMicroService-1783"><span class="linenos">1783</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="PumpWoodMicroService-1784"><a href="#PumpWoodMicroService-1784"><span class="linenos">1784</span></a><span class="sd">            list_pk:</span>
</span><span id="PumpWoodMicroService-1785"><a href="#PumpWoodMicroService-1785"><span class="linenos">1785</span></a><span class="sd">                List of the pks to retrieve.</span>
</span><span id="PumpWoodMicroService-1786"><a href="#PumpWoodMicroService-1786"><span class="linenos">1786</span></a><span class="sd">            file_field:</span>
</span><span id="PumpWoodMicroService-1787"><a href="#PumpWoodMicroService-1787"><span class="linenos">1787</span></a><span class="sd">                Indicates the file field to download from.</span>
</span><span id="PumpWoodMicroService-1788"><a href="#PumpWoodMicroService-1788"><span class="linenos">1788</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService-1789"><a href="#PumpWoodMicroService-1789"><span class="linenos">1789</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-1790"><a href="#PumpWoodMicroService-1790"><span class="linenos">1790</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-1791"><a href="#PumpWoodMicroService-1791"><span class="linenos">1791</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-1792"><a href="#PumpWoodMicroService-1792"><span class="linenos">1792</span></a><span class="sd">            save_path:</span>
</span><span id="PumpWoodMicroService-1793"><a href="#PumpWoodMicroService-1793"><span class="linenos">1793</span></a><span class="sd">                Path to be used to save files.</span>
</span><span id="PumpWoodMicroService-1794"><a href="#PumpWoodMicroService-1794"><span class="linenos">1794</span></a><span class="sd">            save_file:</span>
</span><span id="PumpWoodMicroService-1795"><a href="#PumpWoodMicroService-1795"><span class="linenos">1795</span></a><span class="sd">                True save file locally, False return file content as bites.</span>
</span><span id="PumpWoodMicroService-1796"><a href="#PumpWoodMicroService-1796"><span class="linenos">1796</span></a><span class="sd">            list_file_name:</span>
</span><span id="PumpWoodMicroService-1797"><a href="#PumpWoodMicroService-1797"><span class="linenos">1797</span></a><span class="sd">                Set a file name for each file download.</span>
</span><span id="PumpWoodMicroService-1798"><a href="#PumpWoodMicroService-1798"><span class="linenos">1798</span></a><span class="sd">            if_exists:</span>
</span><span id="PumpWoodMicroService-1799"><a href="#PumpWoodMicroService-1799"><span class="linenos">1799</span></a><span class="sd">                Set how treat when a file will be saved</span>
</span><span id="PumpWoodMicroService-1800"><a href="#PumpWoodMicroService-1800"><span class="linenos">1800</span></a><span class="sd">                and there is another at same path. &quot;fail&quot; will raise an error;</span>
</span><span id="PumpWoodMicroService-1801"><a href="#PumpWoodMicroService-1801"><span class="linenos">1801</span></a><span class="sd">                &quot;overwrite&quot; will overwrite the file with the new one; &quot;skip&quot;</span>
</span><span id="PumpWoodMicroService-1802"><a href="#PumpWoodMicroService-1802"><span class="linenos">1802</span></a><span class="sd">                when list_file_name is set, check before downloaded it file</span>
</span><span id="PumpWoodMicroService-1803"><a href="#PumpWoodMicroService-1803"><span class="linenos">1803</span></a><span class="sd">                already exists, if so skip the download.</span>
</span><span id="PumpWoodMicroService-1804"><a href="#PumpWoodMicroService-1804"><span class="linenos">1804</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-1805"><a href="#PumpWoodMicroService-1805"><span class="linenos">1805</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-1806"><a href="#PumpWoodMicroService-1806"><span class="linenos">1806</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-1807"><a href="#PumpWoodMicroService-1807"><span class="linenos">1807</span></a>
</span><span id="PumpWoodMicroService-1808"><a href="#PumpWoodMicroService-1808"><span class="linenos">1808</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1809"><a href="#PumpWoodMicroService-1809"><span class="linenos">1809</span></a><span class="sd">            List of the retrieve file request data.</span>
</span><span id="PumpWoodMicroService-1810"><a href="#PumpWoodMicroService-1810"><span class="linenos">1810</span></a>
</span><span id="PumpWoodMicroService-1811"><a href="#PumpWoodMicroService-1811"><span class="linenos">1811</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-1812"><a href="#PumpWoodMicroService-1812"><span class="linenos">1812</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1813"><a href="#PumpWoodMicroService-1813"><span class="linenos">1813</span></a><span class="sd">                &#39;Lenght of list_file_name and list_pk are not equal:</span>
</span><span id="PumpWoodMicroService-1814"><a href="#PumpWoodMicroService-1814"><span class="linenos">1814</span></a><span class="sd">                len(list_file_name)={list_file_name}; len(list_pk)={list_pk}&#39;.</span>
</span><span id="PumpWoodMicroService-1815"><a href="#PumpWoodMicroService-1815"><span class="linenos">1815</span></a><span class="sd">                Indicates that len(list_file_name) and len(list_pk) function</span>
</span><span id="PumpWoodMicroService-1816"><a href="#PumpWoodMicroService-1816"><span class="linenos">1816</span></a><span class="sd">                arguments are not equal.</span>
</span><span id="PumpWoodMicroService-1817"><a href="#PumpWoodMicroService-1817"><span class="linenos">1817</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1818"><a href="#PumpWoodMicroService-1818"><span class="linenos">1818</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1819"><a href="#PumpWoodMicroService-1819"><span class="linenos">1819</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1820"><a href="#PumpWoodMicroService-1820"><span class="linenos">1820</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1821"><a href="#PumpWoodMicroService-1821"><span class="linenos">1821</span></a>
</span><span id="PumpWoodMicroService-1822"><a href="#PumpWoodMicroService-1822"><span class="linenos">1822</span></a>        <span class="k">if</span> <span class="n">list_file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1823"><a href="#PumpWoodMicroService-1823"><span class="linenos">1823</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_file_name</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1824"><a href="#PumpWoodMicroService-1824"><span class="linenos">1824</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">((</span>
</span><span id="PumpWoodMicroService-1825"><a href="#PumpWoodMicroService-1825"><span class="linenos">1825</span></a>                    <span class="s2">&quot;Lenght of list_file_name and list_pk are not equal:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService-1826"><a href="#PumpWoodMicroService-1826"><span class="linenos">1826</span></a>                    <span class="s2">&quot;len(list_file_name)=</span><span class="si">{list_file_name}</span><span class="s2">; &quot;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService-1827"><a href="#PumpWoodMicroService-1827"><span class="linenos">1827</span></a>                    <span class="s2">&quot;len(list_pk)=</span><span class="si">{list_pk}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1828"><a href="#PumpWoodMicroService-1828"><span class="linenos">1828</span></a>                        <span class="n">list_file_name</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">list_file_name</span><span class="p">),</span>
</span><span id="PumpWoodMicroService-1829"><a href="#PumpWoodMicroService-1829"><span class="linenos">1829</span></a>                        <span class="n">list_pk</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)))</span>
</span><span id="PumpWoodMicroService-1830"><a href="#PumpWoodMicroService-1830"><span class="linenos">1830</span></a>
</span><span id="PumpWoodMicroService-1831"><a href="#PumpWoodMicroService-1831"><span class="linenos">1831</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService-1832"><a href="#PumpWoodMicroService-1832"><span class="linenos">1832</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)):</span>
</span><span id="PumpWoodMicroService-1833"><a href="#PumpWoodMicroService-1833"><span class="linenos">1833</span></a>            <span class="n">pk</span> <span class="o">=</span> <span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1834"><a href="#PumpWoodMicroService-1834"><span class="linenos">1834</span></a>            <span class="n">file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-1835"><a href="#PumpWoodMicroService-1835"><span class="linenos">1835</span></a>            <span class="k">if</span> <span class="n">list_file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1836"><a href="#PumpWoodMicroService-1836"><span class="linenos">1836</span></a>                <span class="n">file_name</span> <span class="o">=</span> <span class="n">list_file_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1837"><a href="#PumpWoodMicroService-1837"><span class="linenos">1837</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService-1838"><a href="#PumpWoodMicroService-1838"><span class="linenos">1838</span></a>                <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span> <span class="s2">&quot;pk&quot;</span><span class="p">:</span> <span class="n">pk</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1839"><a href="#PumpWoodMicroService-1839"><span class="linenos">1839</span></a>                <span class="s2">&quot;file_field&quot;</span><span class="p">:</span> <span class="n">file_field</span><span class="p">,</span> <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1840"><a href="#PumpWoodMicroService-1840"><span class="linenos">1840</span></a>                <span class="s2">&quot;save_file&quot;</span><span class="p">:</span> <span class="n">save_file</span><span class="p">,</span> <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="n">file_name</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1841"><a href="#PumpWoodMicroService-1841"><span class="linenos">1841</span></a>                <span class="s2">&quot;save_path&quot;</span><span class="p">:</span> <span class="n">save_path</span><span class="p">,</span> <span class="s2">&quot;if_exists&quot;</span><span class="p">:</span> <span class="n">if_exists</span><span class="p">})</span>
</span><span id="PumpWoodMicroService-1842"><a href="#PumpWoodMicroService-1842"><span class="linenos">1842</span></a>
</span><span id="PumpWoodMicroService-1843"><a href="#PumpWoodMicroService-1843"><span class="linenos">1843</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1844"><a href="#PumpWoodMicroService-1844"><span class="linenos">1844</span></a>            <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1845"><a href="#PumpWoodMicroService-1845"><span class="linenos">1845</span></a>                <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1846"><a href="#PumpWoodMicroService-1846"><span class="linenos">1846</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_request_retrieve_file_wrapper</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1847"><a href="#PumpWoodMicroService-1847"><span class="linenos">1847</span></a>                    <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1848"><a href="#PumpWoodMicroService-1848"><span class="linenos">1848</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1849"><a href="#PumpWoodMicroService-1849"><span class="linenos">1849</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1850"><a href="#PumpWoodMicroService-1850"><span class="linenos">1850</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1851"><a href="#PumpWoodMicroService-1851"><span class="linenos">1851</span></a>
</span><span id="PumpWoodMicroService-1852"><a href="#PumpWoodMicroService-1852"><span class="linenos">1852</span></a>        <span class="k">return</span> <span class="n">results</span>
</span><span id="PumpWoodMicroService-1853"><a href="#PumpWoodMicroService-1853"><span class="linenos">1853</span></a>
</span><span id="PumpWoodMicroService-1854"><a href="#PumpWoodMicroService-1854"><span class="linenos">1854</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService-1855"><a href="#PumpWoodMicroService-1855"><span class="linenos">1855</span></a>                      <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1856"><a href="#PumpWoodMicroService-1856"><span class="linenos">1856</span></a>                      <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1857"><a href="#PumpWoodMicroService-1857"><span class="linenos">1857</span></a>                      <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1858"><a href="#PumpWoodMicroService-1858"><span class="linenos">1858</span></a>                      <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-1859"><a href="#PumpWoodMicroService-1859"><span class="linenos">1859</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel list request.</span>
</span><span id="PumpWoodMicroService-1860"><a href="#PumpWoodMicroService-1860"><span class="linenos">1860</span></a>
</span><span id="PumpWoodMicroService-1861"><a href="#PumpWoodMicroService-1861"><span class="linenos">1861</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1862"><a href="#PumpWoodMicroService-1862"><span class="linenos">1862</span></a><span class="sd">            model_class (str):</span>
</span><span id="PumpWoodMicroService-1863"><a href="#PumpWoodMicroService-1863"><span class="linenos">1863</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="PumpWoodMicroService-1864"><a href="#PumpWoodMicroService-1864"><span class="linenos">1864</span></a><span class="sd">            list_args (List[dict]):</span>
</span><span id="PumpWoodMicroService-1865"><a href="#PumpWoodMicroService-1865"><span class="linenos">1865</span></a><span class="sd">                A list of list request args (filter_dict,</span>
</span><span id="PumpWoodMicroService-1866"><a href="#PumpWoodMicroService-1866"><span class="linenos">1866</span></a><span class="sd">                exclude_dict, order_by, fields, default_fields, limit,</span>
</span><span id="PumpWoodMicroService-1867"><a href="#PumpWoodMicroService-1867"><span class="linenos">1867</span></a><span class="sd">                foreign_key_fields).</span>
</span><span id="PumpWoodMicroService-1868"><a href="#PumpWoodMicroService-1868"><span class="linenos">1868</span></a><span class="sd">            n_parallel (int): Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-1869"><a href="#PumpWoodMicroService-1869"><span class="linenos">1869</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-1870"><a href="#PumpWoodMicroService-1870"><span class="linenos">1870</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-1871"><a href="#PumpWoodMicroService-1871"><span class="linenos">1871</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="PumpWoodMicroService-1872"><a href="#PumpWoodMicroService-1872"><span class="linenos">1872</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-1873"><a href="#PumpWoodMicroService-1873"><span class="linenos">1873</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-1874"><a href="#PumpWoodMicroService-1874"><span class="linenos">1874</span></a><span class="sd">            fields (List[str]):</span>
</span><span id="PumpWoodMicroService-1875"><a href="#PumpWoodMicroService-1875"><span class="linenos">1875</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="PumpWoodMicroService-1876"><a href="#PumpWoodMicroService-1876"><span class="linenos">1876</span></a><span class="sd">            default_fields (bool):</span>
</span><span id="PumpWoodMicroService-1877"><a href="#PumpWoodMicroService-1877"><span class="linenos">1877</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="PumpWoodMicroService-1878"><a href="#PumpWoodMicroService-1878"><span class="linenos">1878</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="PumpWoodMicroService-1879"><a href="#PumpWoodMicroService-1879"><span class="linenos">1879</span></a><span class="sd">            limit (int):</span>
</span><span id="PumpWoodMicroService-1880"><a href="#PumpWoodMicroService-1880"><span class="linenos">1880</span></a><span class="sd">                Set the limit of elements of the returned query. By default,</span>
</span><span id="PumpWoodMicroService-1881"><a href="#PumpWoodMicroService-1881"><span class="linenos">1881</span></a><span class="sd">                backend usually return 50 elements.</span>
</span><span id="PumpWoodMicroService-1882"><a href="#PumpWoodMicroService-1882"><span class="linenos">1882</span></a><span class="sd">            foreign_key_fields (bool):</span>
</span><span id="PumpWoodMicroService-1883"><a href="#PumpWoodMicroService-1883"><span class="linenos">1883</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="PumpWoodMicroService-1884"><a href="#PumpWoodMicroService-1884"><span class="linenos">1884</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="PumpWoodMicroService-1885"><a href="#PumpWoodMicroService-1885"><span class="linenos">1885</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="PumpWoodMicroService-1886"><a href="#PumpWoodMicroService-1886"><span class="linenos">1886</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="PumpWoodMicroService-1887"><a href="#PumpWoodMicroService-1887"><span class="linenos">1887</span></a>
</span><span id="PumpWoodMicroService-1888"><a href="#PumpWoodMicroService-1888"><span class="linenos">1888</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1889"><a href="#PumpWoodMicroService-1889"><span class="linenos">1889</span></a><span class="sd">            Flatten List of the list request reponses.</span>
</span><span id="PumpWoodMicroService-1890"><a href="#PumpWoodMicroService-1890"><span class="linenos">1890</span></a>
</span><span id="PumpWoodMicroService-1891"><a href="#PumpWoodMicroService-1891"><span class="linenos">1891</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-1892"><a href="#PumpWoodMicroService-1892"><span class="linenos">1892</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1893"><a href="#PumpWoodMicroService-1893"><span class="linenos">1893</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates that</span>
</span><span id="PumpWoodMicroService-1894"><a href="#PumpWoodMicroService-1894"><span class="linenos">1894</span></a><span class="sd">                lenght of model_class and list_args arguments are not equal.</span>
</span><span id="PumpWoodMicroService-1895"><a href="#PumpWoodMicroService-1895"><span class="linenos">1895</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1896"><a href="#PumpWoodMicroService-1896"><span class="linenos">1896</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1897"><a href="#PumpWoodMicroService-1897"><span class="linenos">1897</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1898"><a href="#PumpWoodMicroService-1898"><span class="linenos">1898</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1899"><a href="#PumpWoodMicroService-1899"><span class="linenos">1899</span></a>
</span><span id="PumpWoodMicroService-1900"><a href="#PumpWoodMicroService-1900"><span class="linenos">1900</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-1901"><a href="#PumpWoodMicroService-1901"><span class="linenos">1901</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1902"><a href="#PumpWoodMicroService-1902"><span class="linenos">1902</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_list_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1903"><a href="#PumpWoodMicroService-1903"><span class="linenos">1903</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1904"><a href="#PumpWoodMicroService-1904"><span class="linenos">1904</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1905"><a href="#PumpWoodMicroService-1905"><span class="linenos">1905</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1906"><a href="#PumpWoodMicroService-1906"><span class="linenos">1906</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1907"><a href="#PumpWoodMicroService-1907"><span class="linenos">1907</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1908"><a href="#PumpWoodMicroService-1908"><span class="linenos">1908</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_list_url</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model_class</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1909"><a href="#PumpWoodMicroService-1909"><span class="linenos">1909</span></a>
</span><span id="PumpWoodMicroService-1910"><a href="#PumpWoodMicroService-1910"><span class="linenos">1910</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_list: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1911"><a href="#PumpWoodMicroService-1911"><span class="linenos">1911</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1912"><a href="#PumpWoodMicroService-1912"><span class="linenos">1912</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1913"><a href="#PumpWoodMicroService-1913"><span class="linenos">1913</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1914"><a href="#PumpWoodMicroService-1914"><span class="linenos">1914</span></a>
</span><span id="PumpWoodMicroService-1915"><a href="#PumpWoodMicroService-1915"><span class="linenos">1915</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_list_without_pag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService-1916"><a href="#PumpWoodMicroService-1916"><span class="linenos">1916</span></a>                                  <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-1917"><a href="#PumpWoodMicroService-1917"><span class="linenos">1917</span></a>                                  <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1918"><a href="#PumpWoodMicroService-1918"><span class="linenos">1918</span></a>                                  <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1919"><a href="#PumpWoodMicroService-1919"><span class="linenos">1919</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel list_without_pag request.</span>
</span><span id="PumpWoodMicroService-1920"><a href="#PumpWoodMicroService-1920"><span class="linenos">1920</span></a>
</span><span id="PumpWoodMicroService-1921"><a href="#PumpWoodMicroService-1921"><span class="linenos">1921</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1922"><a href="#PumpWoodMicroService-1922"><span class="linenos">1922</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-1923"><a href="#PumpWoodMicroService-1923"><span class="linenos">1923</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="PumpWoodMicroService-1924"><a href="#PumpWoodMicroService-1924"><span class="linenos">1924</span></a><span class="sd">            list_args:</span>
</span><span id="PumpWoodMicroService-1925"><a href="#PumpWoodMicroService-1925"><span class="linenos">1925</span></a><span class="sd">                A list of list request args (filter_dict,</span>
</span><span id="PumpWoodMicroService-1926"><a href="#PumpWoodMicroService-1926"><span class="linenos">1926</span></a><span class="sd">                exclude_dict, order_by, fields, default_fields, limit,</span>
</span><span id="PumpWoodMicroService-1927"><a href="#PumpWoodMicroService-1927"><span class="linenos">1927</span></a><span class="sd">                foreign_key_fields).</span>
</span><span id="PumpWoodMicroService-1928"><a href="#PumpWoodMicroService-1928"><span class="linenos">1928</span></a><span class="sd">            n_parallel (int):</span>
</span><span id="PumpWoodMicroService-1929"><a href="#PumpWoodMicroService-1929"><span class="linenos">1929</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-1930"><a href="#PumpWoodMicroService-1930"><span class="linenos">1930</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-1931"><a href="#PumpWoodMicroService-1931"><span class="linenos">1931</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-1932"><a href="#PumpWoodMicroService-1932"><span class="linenos">1932</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-1933"><a href="#PumpWoodMicroService-1933"><span class="linenos">1933</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-1934"><a href="#PumpWoodMicroService-1934"><span class="linenos">1934</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-1935"><a href="#PumpWoodMicroService-1935"><span class="linenos">1935</span></a>
</span><span id="PumpWoodMicroService-1936"><a href="#PumpWoodMicroService-1936"><span class="linenos">1936</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1937"><a href="#PumpWoodMicroService-1937"><span class="linenos">1937</span></a><span class="sd">            Flatten List of the list request reponses.</span>
</span><span id="PumpWoodMicroService-1938"><a href="#PumpWoodMicroService-1938"><span class="linenos">1938</span></a>
</span><span id="PumpWoodMicroService-1939"><a href="#PumpWoodMicroService-1939"><span class="linenos">1939</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-1940"><a href="#PumpWoodMicroService-1940"><span class="linenos">1940</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1941"><a href="#PumpWoodMicroService-1941"><span class="linenos">1941</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates that</span>
</span><span id="PumpWoodMicroService-1942"><a href="#PumpWoodMicroService-1942"><span class="linenos">1942</span></a><span class="sd">                lenght of model_class and list_args arguments are not equal.</span>
</span><span id="PumpWoodMicroService-1943"><a href="#PumpWoodMicroService-1943"><span class="linenos">1943</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1944"><a href="#PumpWoodMicroService-1944"><span class="linenos">1944</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1945"><a href="#PumpWoodMicroService-1945"><span class="linenos">1945</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1946"><a href="#PumpWoodMicroService-1946"><span class="linenos">1946</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1947"><a href="#PumpWoodMicroService-1947"><span class="linenos">1947</span></a>
</span><span id="PumpWoodMicroService-1948"><a href="#PumpWoodMicroService-1948"><span class="linenos">1948</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-1949"><a href="#PumpWoodMicroService-1949"><span class="linenos">1949</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1950"><a href="#PumpWoodMicroService-1950"><span class="linenos">1950</span></a>            <span class="n">url_temp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span>
</span><span id="PumpWoodMicroService-1951"><a href="#PumpWoodMicroService-1951"><span class="linenos">1951</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="n">url_temp</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1952"><a href="#PumpWoodMicroService-1952"><span class="linenos">1952</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1953"><a href="#PumpWoodMicroService-1953"><span class="linenos">1953</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1954"><a href="#PumpWoodMicroService-1954"><span class="linenos">1954</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1955"><a href="#PumpWoodMicroService-1955"><span class="linenos">1955</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1956"><a href="#PumpWoodMicroService-1956"><span class="linenos">1956</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1957"><a href="#PumpWoodMicroService-1957"><span class="linenos">1957</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService-1958"><a href="#PumpWoodMicroService-1958"><span class="linenos">1958</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model_class</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-1959"><a href="#PumpWoodMicroService-1959"><span class="linenos">1959</span></a>
</span><span id="PumpWoodMicroService-1960"><a href="#PumpWoodMicroService-1960"><span class="linenos">1960</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_list_without_pag: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1961"><a href="#PumpWoodMicroService-1961"><span class="linenos">1961</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1962"><a href="#PumpWoodMicroService-1962"><span class="linenos">1962</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1963"><a href="#PumpWoodMicroService-1963"><span class="linenos">1963</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1964"><a href="#PumpWoodMicroService-1964"><span class="linenos">1964</span></a>
</span><span id="PumpWoodMicroService-1965"><a href="#PumpWoodMicroService-1965"><span class="linenos">1965</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_list_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService-1966"><a href="#PumpWoodMicroService-1966"><span class="linenos">1966</span></a>                          <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-1967"><a href="#PumpWoodMicroService-1967"><span class="linenos">1967</span></a>                          <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-1968"><a href="#PumpWoodMicroService-1968"><span class="linenos">1968</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel list_one request.</span>
</span><span id="PumpWoodMicroService-1969"><a href="#PumpWoodMicroService-1969"><span class="linenos">1969</span></a>
</span><span id="PumpWoodMicroService-1970"><a href="#PumpWoodMicroService-1970"><span class="linenos">1970</span></a><span class="sd">        DEPRECTED user retrieve call with default_fields=True.</span>
</span><span id="PumpWoodMicroService-1971"><a href="#PumpWoodMicroService-1971"><span class="linenos">1971</span></a>
</span><span id="PumpWoodMicroService-1972"><a href="#PumpWoodMicroService-1972"><span class="linenos">1972</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-1973"><a href="#PumpWoodMicroService-1973"><span class="linenos">1973</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-1974"><a href="#PumpWoodMicroService-1974"><span class="linenos">1974</span></a><span class="sd">                Model Class to list one.</span>
</span><span id="PumpWoodMicroService-1975"><a href="#PumpWoodMicroService-1975"><span class="linenos">1975</span></a><span class="sd">            list_pk:</span>
</span><span id="PumpWoodMicroService-1976"><a href="#PumpWoodMicroService-1976"><span class="linenos">1976</span></a><span class="sd">                List of the pks to list one.</span>
</span><span id="PumpWoodMicroService-1977"><a href="#PumpWoodMicroService-1977"><span class="linenos">1977</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService-1978"><a href="#PumpWoodMicroService-1978"><span class="linenos">1978</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-1979"><a href="#PumpWoodMicroService-1979"><span class="linenos">1979</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-1980"><a href="#PumpWoodMicroService-1980"><span class="linenos">1980</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-1981"><a href="#PumpWoodMicroService-1981"><span class="linenos">1981</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-1982"><a href="#PumpWoodMicroService-1982"><span class="linenos">1982</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-1983"><a href="#PumpWoodMicroService-1983"><span class="linenos">1983</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-1984"><a href="#PumpWoodMicroService-1984"><span class="linenos">1984</span></a>
</span><span id="PumpWoodMicroService-1985"><a href="#PumpWoodMicroService-1985"><span class="linenos">1985</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-1986"><a href="#PumpWoodMicroService-1986"><span class="linenos">1986</span></a><span class="sd">            List of the list_one request data.</span>
</span><span id="PumpWoodMicroService-1987"><a href="#PumpWoodMicroService-1987"><span class="linenos">1987</span></a>
</span><span id="PumpWoodMicroService-1988"><a href="#PumpWoodMicroService-1988"><span class="linenos">1988</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-1989"><a href="#PumpWoodMicroService-1989"><span class="linenos">1989</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-1990"><a href="#PumpWoodMicroService-1990"><span class="linenos">1990</span></a><span class="sd">                &#39;len(model_class) != len(list_pk)&#39;. Indicates that lenght</span>
</span><span id="PumpWoodMicroService-1991"><a href="#PumpWoodMicroService-1991"><span class="linenos">1991</span></a><span class="sd">                of model_class and list_pk arguments are not equal.</span>
</span><span id="PumpWoodMicroService-1992"><a href="#PumpWoodMicroService-1992"><span class="linenos">1992</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-1993"><a href="#PumpWoodMicroService-1993"><span class="linenos">1993</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1994"><a href="#PumpWoodMicroService-1994"><span class="linenos">1994</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-1995"><a href="#PumpWoodMicroService-1995"><span class="linenos">1995</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-1996"><a href="#PumpWoodMicroService-1996"><span class="linenos">1996</span></a>
</span><span id="PumpWoodMicroService-1997"><a href="#PumpWoodMicroService-1997"><span class="linenos">1997</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-1998"><a href="#PumpWoodMicroService-1998"><span class="linenos">1998</span></a>            <span class="n">model_class</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-1999"><a href="#PumpWoodMicroService-1999"><span class="linenos">1999</span></a>
</span><span id="PumpWoodMicroService-2000"><a href="#PumpWoodMicroService-2000"><span class="linenos">2000</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-2001"><a href="#PumpWoodMicroService-2001"><span class="linenos">2001</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="s1">&#39;len(model_class) != len(list_pk)&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2002"><a href="#PumpWoodMicroService-2002"><span class="linenos">2002</span></a>
</span><span id="PumpWoodMicroService-2003"><a href="#PumpWoodMicroService-2003"><span class="linenos">2003</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService-2004"><a href="#PumpWoodMicroService-2004"><span class="linenos">2004</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_one_url</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-2005"><a href="#PumpWoodMicroService-2005"><span class="linenos">2005</span></a>                                     <span class="n">pk</span><span class="o">=</span><span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="PumpWoodMicroService-2006"><a href="#PumpWoodMicroService-2006"><span class="linenos">2006</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">))]</span>
</span><span id="PumpWoodMicroService-2007"><a href="#PumpWoodMicroService-2007"><span class="linenos">2007</span></a>
</span><span id="PumpWoodMicroService-2008"><a href="#PumpWoodMicroService-2008"><span class="linenos">2008</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_list_one: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2009"><a href="#PumpWoodMicroService-2009"><span class="linenos">2009</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2010"><a href="#PumpWoodMicroService-2010"><span class="linenos">2010</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2011"><a href="#PumpWoodMicroService-2011"><span class="linenos">2011</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2012"><a href="#PumpWoodMicroService-2012"><span class="linenos">2012</span></a>
</span><span id="PumpWoodMicroService-2013"><a href="#PumpWoodMicroService-2013"><span class="linenos">2013</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_obj_dict</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-2014"><a href="#PumpWoodMicroService-2014"><span class="linenos">2014</span></a>                      <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2015"><a href="#PumpWoodMicroService-2015"><span class="linenos">2015</span></a>                      <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-2016"><a href="#PumpWoodMicroService-2016"><span class="linenos">2016</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel save requests.</span>
</span><span id="PumpWoodMicroService-2017"><a href="#PumpWoodMicroService-2017"><span class="linenos">2017</span></a>
</span><span id="PumpWoodMicroService-2018"><a href="#PumpWoodMicroService-2018"><span class="linenos">2018</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-2019"><a href="#PumpWoodMicroService-2019"><span class="linenos">2019</span></a><span class="sd">            list_obj_dict:</span>
</span><span id="PumpWoodMicroService-2020"><a href="#PumpWoodMicroService-2020"><span class="linenos">2020</span></a><span class="sd">                List of dictionaries containing PumpWood objects</span>
</span><span id="PumpWoodMicroService-2021"><a href="#PumpWoodMicroService-2021"><span class="linenos">2021</span></a><span class="sd">                (must have at least &#39;model_class&#39; key).</span>
</span><span id="PumpWoodMicroService-2022"><a href="#PumpWoodMicroService-2022"><span class="linenos">2022</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService-2023"><a href="#PumpWoodMicroService-2023"><span class="linenos">2023</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-2024"><a href="#PumpWoodMicroService-2024"><span class="linenos">2024</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-2025"><a href="#PumpWoodMicroService-2025"><span class="linenos">2025</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-2026"><a href="#PumpWoodMicroService-2026"><span class="linenos">2026</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-2027"><a href="#PumpWoodMicroService-2027"><span class="linenos">2027</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-2028"><a href="#PumpWoodMicroService-2028"><span class="linenos">2028</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-2029"><a href="#PumpWoodMicroService-2029"><span class="linenos">2029</span></a>
</span><span id="PumpWoodMicroService-2030"><a href="#PumpWoodMicroService-2030"><span class="linenos">2030</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-2031"><a href="#PumpWoodMicroService-2031"><span class="linenos">2031</span></a><span class="sd">            List of the save request data.</span>
</span><span id="PumpWoodMicroService-2032"><a href="#PumpWoodMicroService-2032"><span class="linenos">2032</span></a>
</span><span id="PumpWoodMicroService-2033"><a href="#PumpWoodMicroService-2033"><span class="linenos">2033</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-2034"><a href="#PumpWoodMicroService-2034"><span class="linenos">2034</span></a><span class="sd">            No particular raises</span>
</span><span id="PumpWoodMicroService-2035"><a href="#PumpWoodMicroService-2035"><span class="linenos">2035</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-2036"><a href="#PumpWoodMicroService-2036"><span class="linenos">2036</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2037"><a href="#PumpWoodMicroService-2037"><span class="linenos">2037</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2038"><a href="#PumpWoodMicroService-2038"><span class="linenos">2038</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2039"><a href="#PumpWoodMicroService-2039"><span class="linenos">2039</span></a>
</span><span id="PumpWoodMicroService-2040"><a href="#PumpWoodMicroService-2040"><span class="linenos">2040</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService-2041"><a href="#PumpWoodMicroService-2041"><span class="linenos">2041</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_save_url</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;model_class&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">list_obj_dict</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-2042"><a href="#PumpWoodMicroService-2042"><span class="linenos">2042</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_save: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2043"><a href="#PumpWoodMicroService-2043"><span class="linenos">2043</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2044"><a href="#PumpWoodMicroService-2044"><span class="linenos">2044</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_obj_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2045"><a href="#PumpWoodMicroService-2045"><span class="linenos">2045</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2046"><a href="#PumpWoodMicroService-2046"><span class="linenos">2046</span></a>
</span><span id="PumpWoodMicroService-2047"><a href="#PumpWoodMicroService-2047"><span class="linenos">2047</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService-2048"><a href="#PumpWoodMicroService-2048"><span class="linenos">2048</span></a>                        <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2049"><a href="#PumpWoodMicroService-2049"><span class="linenos">2049</span></a>                        <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-2050"><a href="#PumpWoodMicroService-2050"><span class="linenos">2050</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make many [n_parallel] delete requests.</span>
</span><span id="PumpWoodMicroService-2051"><a href="#PumpWoodMicroService-2051"><span class="linenos">2051</span></a>
</span><span id="PumpWoodMicroService-2052"><a href="#PumpWoodMicroService-2052"><span class="linenos">2052</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-2053"><a href="#PumpWoodMicroService-2053"><span class="linenos">2053</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-2054"><a href="#PumpWoodMicroService-2054"><span class="linenos">2054</span></a><span class="sd">                Model Class to list one.</span>
</span><span id="PumpWoodMicroService-2055"><a href="#PumpWoodMicroService-2055"><span class="linenos">2055</span></a><span class="sd">            list_pk:</span>
</span><span id="PumpWoodMicroService-2056"><a href="#PumpWoodMicroService-2056"><span class="linenos">2056</span></a><span class="sd">                List of the pks to list one.</span>
</span><span id="PumpWoodMicroService-2057"><a href="#PumpWoodMicroService-2057"><span class="linenos">2057</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService-2058"><a href="#PumpWoodMicroService-2058"><span class="linenos">2058</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-2059"><a href="#PumpWoodMicroService-2059"><span class="linenos">2059</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-2060"><a href="#PumpWoodMicroService-2060"><span class="linenos">2060</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-2061"><a href="#PumpWoodMicroService-2061"><span class="linenos">2061</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-2062"><a href="#PumpWoodMicroService-2062"><span class="linenos">2062</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-2063"><a href="#PumpWoodMicroService-2063"><span class="linenos">2063</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-2064"><a href="#PumpWoodMicroService-2064"><span class="linenos">2064</span></a>
</span><span id="PumpWoodMicroService-2065"><a href="#PumpWoodMicroService-2065"><span class="linenos">2065</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-2066"><a href="#PumpWoodMicroService-2066"><span class="linenos">2066</span></a><span class="sd">            List of the delete request data.</span>
</span><span id="PumpWoodMicroService-2067"><a href="#PumpWoodMicroService-2067"><span class="linenos">2067</span></a>
</span><span id="PumpWoodMicroService-2068"><a href="#PumpWoodMicroService-2068"><span class="linenos">2068</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-2069"><a href="#PumpWoodMicroService-2069"><span class="linenos">2069</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-2070"><a href="#PumpWoodMicroService-2070"><span class="linenos">2070</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates</span>
</span><span id="PumpWoodMicroService-2071"><a href="#PumpWoodMicroService-2071"><span class="linenos">2071</span></a><span class="sd">                that length of model_class and list_args arguments are not</span>
</span><span id="PumpWoodMicroService-2072"><a href="#PumpWoodMicroService-2072"><span class="linenos">2072</span></a><span class="sd">                equal.</span>
</span><span id="PumpWoodMicroService-2073"><a href="#PumpWoodMicroService-2073"><span class="linenos">2073</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-2074"><a href="#PumpWoodMicroService-2074"><span class="linenos">2074</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2075"><a href="#PumpWoodMicroService-2075"><span class="linenos">2075</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2076"><a href="#PumpWoodMicroService-2076"><span class="linenos">2076</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2077"><a href="#PumpWoodMicroService-2077"><span class="linenos">2077</span></a>
</span><span id="PumpWoodMicroService-2078"><a href="#PumpWoodMicroService-2078"><span class="linenos">2078</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2079"><a href="#PumpWoodMicroService-2079"><span class="linenos">2079</span></a>            <span class="n">model_class</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2080"><a href="#PumpWoodMicroService-2080"><span class="linenos">2080</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-2081"><a href="#PumpWoodMicroService-2081"><span class="linenos">2081</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2082"><a href="#PumpWoodMicroService-2082"><span class="linenos">2082</span></a>                <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2083"><a href="#PumpWoodMicroService-2083"><span class="linenos">2083</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2084"><a href="#PumpWoodMicroService-2084"><span class="linenos">2084</span></a>
</span><span id="PumpWoodMicroService-2085"><a href="#PumpWoodMicroService-2085"><span class="linenos">2085</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService-2086"><a href="#PumpWoodMicroService-2086"><span class="linenos">2086</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_delete_request_url</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-2087"><a href="#PumpWoodMicroService-2087"><span class="linenos">2087</span></a>                                           <span class="n">pk</span><span class="o">=</span><span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="PumpWoodMicroService-2088"><a href="#PumpWoodMicroService-2088"><span class="linenos">2088</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">))]</span>
</span><span id="PumpWoodMicroService-2089"><a href="#PumpWoodMicroService-2089"><span class="linenos">2089</span></a>
</span><span id="PumpWoodMicroService-2090"><a href="#PumpWoodMicroService-2090"><span class="linenos">2090</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_delete: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2091"><a href="#PumpWoodMicroService-2091"><span class="linenos">2091</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2092"><a href="#PumpWoodMicroService-2092"><span class="linenos">2092</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2093"><a href="#PumpWoodMicroService-2093"><span class="linenos">2093</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2094"><a href="#PumpWoodMicroService-2094"><span class="linenos">2094</span></a>
</span><span id="PumpWoodMicroService-2095"><a href="#PumpWoodMicroService-2095"><span class="linenos">2095</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_delete_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService-2096"><a href="#PumpWoodMicroService-2096"><span class="linenos">2096</span></a>                             <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2097"><a href="#PumpWoodMicroService-2097"><span class="linenos">2097</span></a>                             <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-2098"><a href="#PumpWoodMicroService-2098"><span class="linenos">2098</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel delete_many request.</span>
</span><span id="PumpWoodMicroService-2099"><a href="#PumpWoodMicroService-2099"><span class="linenos">2099</span></a>
</span><span id="PumpWoodMicroService-2100"><a href="#PumpWoodMicroService-2100"><span class="linenos">2100</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-2101"><a href="#PumpWoodMicroService-2101"><span class="linenos">2101</span></a><span class="sd">            model_class (str):</span>
</span><span id="PumpWoodMicroService-2102"><a href="#PumpWoodMicroService-2102"><span class="linenos">2102</span></a><span class="sd">                Model Class to delete many.</span>
</span><span id="PumpWoodMicroService-2103"><a href="#PumpWoodMicroService-2103"><span class="linenos">2103</span></a><span class="sd">            list_args (list):</span>
</span><span id="PumpWoodMicroService-2104"><a href="#PumpWoodMicroService-2104"><span class="linenos">2104</span></a><span class="sd">                A list of list request args (filter_dict, exclude_dict).</span>
</span><span id="PumpWoodMicroService-2105"><a href="#PumpWoodMicroService-2105"><span class="linenos">2105</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService-2106"><a href="#PumpWoodMicroService-2106"><span class="linenos">2106</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-2107"><a href="#PumpWoodMicroService-2107"><span class="linenos">2107</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-2108"><a href="#PumpWoodMicroService-2108"><span class="linenos">2108</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-2109"><a href="#PumpWoodMicroService-2109"><span class="linenos">2109</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-2110"><a href="#PumpWoodMicroService-2110"><span class="linenos">2110</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-2111"><a href="#PumpWoodMicroService-2111"><span class="linenos">2111</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-2112"><a href="#PumpWoodMicroService-2112"><span class="linenos">2112</span></a>
</span><span id="PumpWoodMicroService-2113"><a href="#PumpWoodMicroService-2113"><span class="linenos">2113</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-2114"><a href="#PumpWoodMicroService-2114"><span class="linenos">2114</span></a><span class="sd">            List of the delete many request reponses.</span>
</span><span id="PumpWoodMicroService-2115"><a href="#PumpWoodMicroService-2115"><span class="linenos">2115</span></a>
</span><span id="PumpWoodMicroService-2116"><a href="#PumpWoodMicroService-2116"><span class="linenos">2116</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-2117"><a href="#PumpWoodMicroService-2117"><span class="linenos">2117</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-2118"><a href="#PumpWoodMicroService-2118"><span class="linenos">2118</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates</span>
</span><span id="PumpWoodMicroService-2119"><a href="#PumpWoodMicroService-2119"><span class="linenos">2119</span></a><span class="sd">                that length of model_class and list_args arguments</span>
</span><span id="PumpWoodMicroService-2120"><a href="#PumpWoodMicroService-2120"><span class="linenos">2120</span></a><span class="sd">                are not equal.</span>
</span><span id="PumpWoodMicroService-2121"><a href="#PumpWoodMicroService-2121"><span class="linenos">2121</span></a>
</span><span id="PumpWoodMicroService-2122"><a href="#PumpWoodMicroService-2122"><span class="linenos">2122</span></a><span class="sd">        Example:</span>
</span><span id="PumpWoodMicroService-2123"><a href="#PumpWoodMicroService-2123"><span class="linenos">2123</span></a><span class="sd">            No example yet.</span>
</span><span id="PumpWoodMicroService-2124"><a href="#PumpWoodMicroService-2124"><span class="linenos">2124</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-2125"><a href="#PumpWoodMicroService-2125"><span class="linenos">2125</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2126"><a href="#PumpWoodMicroService-2126"><span class="linenos">2126</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2127"><a href="#PumpWoodMicroService-2127"><span class="linenos">2127</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2128"><a href="#PumpWoodMicroService-2128"><span class="linenos">2128</span></a>
</span><span id="PumpWoodMicroService-2129"><a href="#PumpWoodMicroService-2129"><span class="linenos">2129</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-2130"><a href="#PumpWoodMicroService-2130"><span class="linenos">2130</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2131"><a href="#PumpWoodMicroService-2131"><span class="linenos">2131</span></a>            <span class="n">url_temp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_delete_many_request_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span>
</span><span id="PumpWoodMicroService-2132"><a href="#PumpWoodMicroService-2132"><span class="linenos">2132</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="n">url_temp</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2133"><a href="#PumpWoodMicroService-2133"><span class="linenos">2133</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2134"><a href="#PumpWoodMicroService-2134"><span class="linenos">2134</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-2135"><a href="#PumpWoodMicroService-2135"><span class="linenos">2135</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2136"><a href="#PumpWoodMicroService-2136"><span class="linenos">2136</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2137"><a href="#PumpWoodMicroService-2137"><span class="linenos">2137</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2138"><a href="#PumpWoodMicroService-2138"><span class="linenos">2138</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService-2139"><a href="#PumpWoodMicroService-2139"><span class="linenos">2139</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model_class</span><span class="p">]</span>
</span><span id="PumpWoodMicroService-2140"><a href="#PumpWoodMicroService-2140"><span class="linenos">2140</span></a>
</span><span id="PumpWoodMicroService-2141"><a href="#PumpWoodMicroService-2141"><span class="linenos">2141</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_delete_many: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2142"><a href="#PumpWoodMicroService-2142"><span class="linenos">2142</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2143"><a href="#PumpWoodMicroService-2143"><span class="linenos">2143</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2144"><a href="#PumpWoodMicroService-2144"><span class="linenos">2144</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2145"><a href="#PumpWoodMicroService-2145"><span class="linenos">2145</span></a>
</span><span id="PumpWoodMicroService-2146"><a href="#PumpWoodMicroService-2146"><span class="linenos">2146</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_execute_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService-2147"><a href="#PumpWoodMicroService-2147"><span class="linenos">2147</span></a>                                <span class="n">pk</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService-2148"><a href="#PumpWoodMicroService-2148"><span class="linenos">2148</span></a>                                <span class="n">action</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService-2149"><a href="#PumpWoodMicroService-2149"><span class="linenos">2149</span></a>                                <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService-2150"><a href="#PumpWoodMicroService-2150"><span class="linenos">2150</span></a>                                <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2151"><a href="#PumpWoodMicroService-2151"><span class="linenos">2151</span></a>                                <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-2152"><a href="#PumpWoodMicroService-2152"><span class="linenos">2152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel execute_action requests.</span>
</span><span id="PumpWoodMicroService-2153"><a href="#PumpWoodMicroService-2153"><span class="linenos">2153</span></a>
</span><span id="PumpWoodMicroService-2154"><a href="#PumpWoodMicroService-2154"><span class="linenos">2154</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-2155"><a href="#PumpWoodMicroService-2155"><span class="linenos">2155</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-2156"><a href="#PumpWoodMicroService-2156"><span class="linenos">2156</span></a><span class="sd">                Model Class to perform action over,</span>
</span><span id="PumpWoodMicroService-2157"><a href="#PumpWoodMicroService-2157"><span class="linenos">2157</span></a><span class="sd">                or a list of model class o make diferent actions.</span>
</span><span id="PumpWoodMicroService-2158"><a href="#PumpWoodMicroService-2158"><span class="linenos">2158</span></a><span class="sd">            pk:</span>
</span><span id="PumpWoodMicroService-2159"><a href="#PumpWoodMicroService-2159"><span class="linenos">2159</span></a><span class="sd">                A list of the pks to perform action or a</span>
</span><span id="PumpWoodMicroService-2160"><a href="#PumpWoodMicroService-2160"><span class="linenos">2160</span></a><span class="sd">                single pk to perform action with different paraemters.</span>
</span><span id="PumpWoodMicroService-2161"><a href="#PumpWoodMicroService-2161"><span class="linenos">2161</span></a><span class="sd">            action:</span>
</span><span id="PumpWoodMicroService-2162"><a href="#PumpWoodMicroService-2162"><span class="linenos">2162</span></a><span class="sd">                A list of actions to perform or a single</span>
</span><span id="PumpWoodMicroService-2163"><a href="#PumpWoodMicroService-2163"><span class="linenos">2163</span></a><span class="sd">                action to perform over all pks and parameters.</span>
</span><span id="PumpWoodMicroService-2164"><a href="#PumpWoodMicroService-2164"><span class="linenos">2164</span></a><span class="sd">            parameters:</span>
</span><span id="PumpWoodMicroService-2165"><a href="#PumpWoodMicroService-2165"><span class="linenos">2165</span></a><span class="sd">                Parameters used to perform actions</span>
</span><span id="PumpWoodMicroService-2166"><a href="#PumpWoodMicroService-2166"><span class="linenos">2166</span></a><span class="sd">                or a single dict to be used in all actions.</span>
</span><span id="PumpWoodMicroService-2167"><a href="#PumpWoodMicroService-2167"><span class="linenos">2167</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService-2168"><a href="#PumpWoodMicroService-2168"><span class="linenos">2168</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-2169"><a href="#PumpWoodMicroService-2169"><span class="linenos">2169</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-2170"><a href="#PumpWoodMicroService-2170"><span class="linenos">2170</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-2171"><a href="#PumpWoodMicroService-2171"><span class="linenos">2171</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-2172"><a href="#PumpWoodMicroService-2172"><span class="linenos">2172</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-2173"><a href="#PumpWoodMicroService-2173"><span class="linenos">2173</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-2174"><a href="#PumpWoodMicroService-2174"><span class="linenos">2174</span></a>
</span><span id="PumpWoodMicroService-2175"><a href="#PumpWoodMicroService-2175"><span class="linenos">2175</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-2176"><a href="#PumpWoodMicroService-2176"><span class="linenos">2176</span></a><span class="sd">            List of the execute_action request data.</span>
</span><span id="PumpWoodMicroService-2177"><a href="#PumpWoodMicroService-2177"><span class="linenos">2177</span></a>
</span><span id="PumpWoodMicroService-2178"><a href="#PumpWoodMicroService-2178"><span class="linenos">2178</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-2179"><a href="#PumpWoodMicroService-2179"><span class="linenos">2179</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService-2180"><a href="#PumpWoodMicroService-2180"><span class="linenos">2180</span></a><span class="sd">                &#39;parallel_length != len([argument])&#39;. Indicates that function</span>
</span><span id="PumpWoodMicroService-2181"><a href="#PumpWoodMicroService-2181"><span class="linenos">2181</span></a><span class="sd">                arguments does not have all the same lenght.</span>
</span><span id="PumpWoodMicroService-2182"><a href="#PumpWoodMicroService-2182"><span class="linenos">2182</span></a>
</span><span id="PumpWoodMicroService-2183"><a href="#PumpWoodMicroService-2183"><span class="linenos">2183</span></a><span class="sd">        Example:</span>
</span><span id="PumpWoodMicroService-2184"><a href="#PumpWoodMicroService-2184"><span class="linenos">2184</span></a><span class="sd">            No example yet.</span>
</span><span id="PumpWoodMicroService-2185"><a href="#PumpWoodMicroService-2185"><span class="linenos">2185</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-2186"><a href="#PumpWoodMicroService-2186"><span class="linenos">2186</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2187"><a href="#PumpWoodMicroService-2187"><span class="linenos">2187</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2188"><a href="#PumpWoodMicroService-2188"><span class="linenos">2188</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2189"><a href="#PumpWoodMicroService-2189"><span class="linenos">2189</span></a>
</span><span id="PumpWoodMicroService-2190"><a href="#PumpWoodMicroService-2190"><span class="linenos">2190</span></a>        <span class="n">parallel_length</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService-2191"><a href="#PumpWoodMicroService-2191"><span class="linenos">2191</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2192"><a href="#PumpWoodMicroService-2192"><span class="linenos">2192</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2193"><a href="#PumpWoodMicroService-2193"><span class="linenos">2193</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-2194"><a href="#PumpWoodMicroService-2194"><span class="linenos">2194</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2195"><a href="#PumpWoodMicroService-2195"><span class="linenos">2195</span></a>                        <span class="s1">&#39;parallel_length != len(model_class)&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2196"><a href="#PumpWoodMicroService-2196"><span class="linenos">2196</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2197"><a href="#PumpWoodMicroService-2197"><span class="linenos">2197</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2198"><a href="#PumpWoodMicroService-2198"><span class="linenos">2198</span></a>
</span><span id="PumpWoodMicroService-2199"><a href="#PumpWoodMicroService-2199"><span class="linenos">2199</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2200"><a href="#PumpWoodMicroService-2200"><span class="linenos">2200</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2201"><a href="#PumpWoodMicroService-2201"><span class="linenos">2201</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pk</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-2202"><a href="#PumpWoodMicroService-2202"><span class="linenos">2202</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2203"><a href="#PumpWoodMicroService-2203"><span class="linenos">2203</span></a>                        <span class="s1">&#39;parallel_length != len(pk)&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2204"><a href="#PumpWoodMicroService-2204"><span class="linenos">2204</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2205"><a href="#PumpWoodMicroService-2205"><span class="linenos">2205</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2206"><a href="#PumpWoodMicroService-2206"><span class="linenos">2206</span></a>
</span><span id="PumpWoodMicroService-2207"><a href="#PumpWoodMicroService-2207"><span class="linenos">2207</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2208"><a href="#PumpWoodMicroService-2208"><span class="linenos">2208</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2209"><a href="#PumpWoodMicroService-2209"><span class="linenos">2209</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">action</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-2210"><a href="#PumpWoodMicroService-2210"><span class="linenos">2210</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2211"><a href="#PumpWoodMicroService-2211"><span class="linenos">2211</span></a>                        <span class="s1">&#39;parallel_length != len(action)&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2212"><a href="#PumpWoodMicroService-2212"><span class="linenos">2212</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2213"><a href="#PumpWoodMicroService-2213"><span class="linenos">2213</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2214"><a href="#PumpWoodMicroService-2214"><span class="linenos">2214</span></a>
</span><span id="PumpWoodMicroService-2215"><a href="#PumpWoodMicroService-2215"><span class="linenos">2215</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2216"><a href="#PumpWoodMicroService-2216"><span class="linenos">2216</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2217"><a href="#PumpWoodMicroService-2217"><span class="linenos">2217</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-2218"><a href="#PumpWoodMicroService-2218"><span class="linenos">2218</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2219"><a href="#PumpWoodMicroService-2219"><span class="linenos">2219</span></a>                        <span class="s1">&#39;parallel_length != len(parameters)&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2220"><a href="#PumpWoodMicroService-2220"><span class="linenos">2220</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2221"><a href="#PumpWoodMicroService-2221"><span class="linenos">2221</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2222"><a href="#PumpWoodMicroService-2222"><span class="linenos">2222</span></a>
</span><span id="PumpWoodMicroService-2223"><a href="#PumpWoodMicroService-2223"><span class="linenos">2223</span></a>        <span class="n">model_class</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-2224"><a href="#PumpWoodMicroService-2224"><span class="linenos">2224</span></a>            <span class="n">model_class</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="PumpWoodMicroService-2225"><a href="#PumpWoodMicroService-2225"><span class="linenos">2225</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2226"><a href="#PumpWoodMicroService-2226"><span class="linenos">2226</span></a>        <span class="n">pk</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-2227"><a href="#PumpWoodMicroService-2227"><span class="linenos">2227</span></a>            <span class="n">pk</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="PumpWoodMicroService-2228"><a href="#PumpWoodMicroService-2228"><span class="linenos">2228</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">pk</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2229"><a href="#PumpWoodMicroService-2229"><span class="linenos">2229</span></a>        <span class="n">action</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-2230"><a href="#PumpWoodMicroService-2230"><span class="linenos">2230</span></a>            <span class="n">action</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="PumpWoodMicroService-2231"><a href="#PumpWoodMicroService-2231"><span class="linenos">2231</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">action</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2232"><a href="#PumpWoodMicroService-2232"><span class="linenos">2232</span></a>        <span class="n">parameters</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService-2233"><a href="#PumpWoodMicroService-2233"><span class="linenos">2233</span></a>            <span class="n">parameters</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="PumpWoodMicroService-2234"><a href="#PumpWoodMicroService-2234"><span class="linenos">2234</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">parameters</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2235"><a href="#PumpWoodMicroService-2235"><span class="linenos">2235</span></a>
</span><span id="PumpWoodMicroService-2236"><a href="#PumpWoodMicroService-2236"><span class="linenos">2236</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService-2237"><a href="#PumpWoodMicroService-2237"><span class="linenos">2237</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_execute_action_url</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2238"><a href="#PumpWoodMicroService-2238"><span class="linenos">2238</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="PumpWoodMicroService-2239"><a href="#PumpWoodMicroService-2239"><span class="linenos">2239</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">parallel_length</span><span class="p">)]</span>
</span><span id="PumpWoodMicroService-2240"><a href="#PumpWoodMicroService-2240"><span class="linenos">2240</span></a>
</span><span id="PumpWoodMicroService-2241"><a href="#PumpWoodMicroService-2241"><span class="linenos">2241</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_execute_action: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2242"><a href="#PumpWoodMicroService-2242"><span class="linenos">2242</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2243"><a href="#PumpWoodMicroService-2243"><span class="linenos">2243</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2244"><a href="#PumpWoodMicroService-2244"><span class="linenos">2244</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2245"><a href="#PumpWoodMicroService-2245"><span class="linenos">2245</span></a>
</span><span id="PumpWoodMicroService-2246"><a href="#PumpWoodMicroService-2246"><span class="linenos">2246</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_bulk_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2247"><a href="#PumpWoodMicroService-2247"><span class="linenos">2247</span></a>                           <span class="n">data_to_save</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService-2248"><a href="#PumpWoodMicroService-2248"><span class="linenos">2248</span></a>                           <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2249"><a href="#PumpWoodMicroService-2249"><span class="linenos">2249</span></a>                           <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-2250"><a href="#PumpWoodMicroService-2250"><span class="linenos">2250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Break data_to_save in many parallel bulk_save requests.</span>
</span><span id="PumpWoodMicroService-2251"><a href="#PumpWoodMicroService-2251"><span class="linenos">2251</span></a>
</span><span id="PumpWoodMicroService-2252"><a href="#PumpWoodMicroService-2252"><span class="linenos">2252</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-2253"><a href="#PumpWoodMicroService-2253"><span class="linenos">2253</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-2254"><a href="#PumpWoodMicroService-2254"><span class="linenos">2254</span></a><span class="sd">                Model class of the data that will be saved.</span>
</span><span id="PumpWoodMicroService-2255"><a href="#PumpWoodMicroService-2255"><span class="linenos">2255</span></a><span class="sd">            data_to_save:</span>
</span><span id="PumpWoodMicroService-2256"><a href="#PumpWoodMicroService-2256"><span class="linenos">2256</span></a><span class="sd">                Data that will be saved</span>
</span><span id="PumpWoodMicroService-2257"><a href="#PumpWoodMicroService-2257"><span class="linenos">2257</span></a><span class="sd">            chunksize:</span>
</span><span id="PumpWoodMicroService-2258"><a href="#PumpWoodMicroService-2258"><span class="linenos">2258</span></a><span class="sd">                Length of each parallel bulk save chunk.</span>
</span><span id="PumpWoodMicroService-2259"><a href="#PumpWoodMicroService-2259"><span class="linenos">2259</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService-2260"><a href="#PumpWoodMicroService-2260"><span class="linenos">2260</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-2261"><a href="#PumpWoodMicroService-2261"><span class="linenos">2261</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-2262"><a href="#PumpWoodMicroService-2262"><span class="linenos">2262</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-2263"><a href="#PumpWoodMicroService-2263"><span class="linenos">2263</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-2264"><a href="#PumpWoodMicroService-2264"><span class="linenos">2264</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-2265"><a href="#PumpWoodMicroService-2265"><span class="linenos">2265</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-2266"><a href="#PumpWoodMicroService-2266"><span class="linenos">2266</span></a>
</span><span id="PumpWoodMicroService-2267"><a href="#PumpWoodMicroService-2267"><span class="linenos">2267</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-2268"><a href="#PumpWoodMicroService-2268"><span class="linenos">2268</span></a><span class="sd">            List of the responses of bulk_save.</span>
</span><span id="PumpWoodMicroService-2269"><a href="#PumpWoodMicroService-2269"><span class="linenos">2269</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-2270"><a href="#PumpWoodMicroService-2270"><span class="linenos">2270</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2271"><a href="#PumpWoodMicroService-2271"><span class="linenos">2271</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2272"><a href="#PumpWoodMicroService-2272"><span class="linenos">2272</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2273"><a href="#PumpWoodMicroService-2273"><span class="linenos">2273</span></a>
</span><span id="PumpWoodMicroService-2274"><a href="#PumpWoodMicroService-2274"><span class="linenos">2274</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data_to_save</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2275"><a href="#PumpWoodMicroService-2275"><span class="linenos">2275</span></a>            <span class="n">data_to_save</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_to_save</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2276"><a href="#PumpWoodMicroService-2276"><span class="linenos">2276</span></a>
</span><span id="PumpWoodMicroService-2277"><a href="#PumpWoodMicroService-2277"><span class="linenos">2277</span></a>        <span class="n">chunks</span> <span class="o">=</span> <span class="n">break_in_chunks</span><span class="p">(</span><span class="n">df_to_break</span><span class="o">=</span><span class="n">data_to_save</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2278"><a href="#PumpWoodMicroService-2278"><span class="linenos">2278</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_bulk_save_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2279"><a href="#PumpWoodMicroService-2279"><span class="linenos">2279</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">url</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2280"><a href="#PumpWoodMicroService-2280"><span class="linenos">2280</span></a>
</span><span id="PumpWoodMicroService-2281"><a href="#PumpWoodMicroService-2281"><span class="linenos">2281</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_bulk_save: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2282"><a href="#PumpWoodMicroService-2282"><span class="linenos">2282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2283"><a href="#PumpWoodMicroService-2283"><span class="linenos">2283</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2284"><a href="#PumpWoodMicroService-2284"><span class="linenos">2284</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2285"><a href="#PumpWoodMicroService-2285"><span class="linenos">2285</span></a>
</span><span id="PumpWoodMicroService-2286"><a href="#PumpWoodMicroService-2286"><span class="linenos">2286</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_pivot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="PumpWoodMicroService-2287"><a href="#PumpWoodMicroService-2287"><span class="linenos">2287</span></a>                       <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2288"><a href="#PumpWoodMicroService-2288"><span class="linenos">2288</span></a>                       <span class="n">variables</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2289"><a href="#PumpWoodMicroService-2289"><span class="linenos">2289</span></a>                       <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService-2290"><a href="#PumpWoodMicroService-2290"><span class="linenos">2290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel pivot request.</span>
</span><span id="PumpWoodMicroService-2291"><a href="#PumpWoodMicroService-2291"><span class="linenos">2291</span></a>
</span><span id="PumpWoodMicroService-2292"><a href="#PumpWoodMicroService-2292"><span class="linenos">2292</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService-2293"><a href="#PumpWoodMicroService-2293"><span class="linenos">2293</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService-2294"><a href="#PumpWoodMicroService-2294"><span class="linenos">2294</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="PumpWoodMicroService-2295"><a href="#PumpWoodMicroService-2295"><span class="linenos">2295</span></a><span class="sd">            list_args:</span>
</span><span id="PumpWoodMicroService-2296"><a href="#PumpWoodMicroService-2296"><span class="linenos">2296</span></a><span class="sd">                A list of list request args (filter_dict,exclude_dict,</span>
</span><span id="PumpWoodMicroService-2297"><a href="#PumpWoodMicroService-2297"><span class="linenos">2297</span></a><span class="sd">                order_by).</span>
</span><span id="PumpWoodMicroService-2298"><a href="#PumpWoodMicroService-2298"><span class="linenos">2298</span></a><span class="sd">            columns:</span>
</span><span id="PumpWoodMicroService-2299"><a href="#PumpWoodMicroService-2299"><span class="linenos">2299</span></a><span class="sd">                List of columns at the pivoted table.</span>
</span><span id="PumpWoodMicroService-2300"><a href="#PumpWoodMicroService-2300"><span class="linenos">2300</span></a><span class="sd">            format:</span>
</span><span id="PumpWoodMicroService-2301"><a href="#PumpWoodMicroService-2301"><span class="linenos">2301</span></a><span class="sd">                Format of returned table. See pandas.DataFrame</span>
</span><span id="PumpWoodMicroService-2302"><a href="#PumpWoodMicroService-2302"><span class="linenos">2302</span></a><span class="sd">                to_dict args.</span>
</span><span id="PumpWoodMicroService-2303"><a href="#PumpWoodMicroService-2303"><span class="linenos">2303</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService-2304"><a href="#PumpWoodMicroService-2304"><span class="linenos">2304</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService-2305"><a href="#PumpWoodMicroService-2305"><span class="linenos">2305</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService-2306"><a href="#PumpWoodMicroService-2306"><span class="linenos">2306</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService-2307"><a href="#PumpWoodMicroService-2307"><span class="linenos">2307</span></a><span class="sd">            variables:</span>
</span><span id="PumpWoodMicroService-2308"><a href="#PumpWoodMicroService-2308"><span class="linenos">2308</span></a><span class="sd">                Restrict the fields that will be returned at the query.</span>
</span><span id="PumpWoodMicroService-2309"><a href="#PumpWoodMicroService-2309"><span class="linenos">2309</span></a><span class="sd">            show_deleted:</span>
</span><span id="PumpWoodMicroService-2310"><a href="#PumpWoodMicroService-2310"><span class="linenos">2310</span></a><span class="sd">                If results should include data with deleted=True. This will</span>
</span><span id="PumpWoodMicroService-2311"><a href="#PumpWoodMicroService-2311"><span class="linenos">2311</span></a><span class="sd">                be ignored if model class does not have deleted field.</span>
</span><span id="PumpWoodMicroService-2312"><a href="#PumpWoodMicroService-2312"><span class="linenos">2312</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService-2313"><a href="#PumpWoodMicroService-2313"><span class="linenos">2313</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService-2314"><a href="#PumpWoodMicroService-2314"><span class="linenos">2314</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService-2315"><a href="#PumpWoodMicroService-2315"><span class="linenos">2315</span></a>
</span><span id="PumpWoodMicroService-2316"><a href="#PumpWoodMicroService-2316"><span class="linenos">2316</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService-2317"><a href="#PumpWoodMicroService-2317"><span class="linenos">2317</span></a><span class="sd">            List of the pivot request reponses.</span>
</span><span id="PumpWoodMicroService-2318"><a href="#PumpWoodMicroService-2318"><span class="linenos">2318</span></a>
</span><span id="PumpWoodMicroService-2319"><a href="#PumpWoodMicroService-2319"><span class="linenos">2319</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService-2320"><a href="#PumpWoodMicroService-2320"><span class="linenos">2320</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService-2321"><a href="#PumpWoodMicroService-2321"><span class="linenos">2321</span></a>
</span><span id="PumpWoodMicroService-2322"><a href="#PumpWoodMicroService-2322"><span class="linenos">2322</span></a><span class="sd">        Example:</span>
</span><span id="PumpWoodMicroService-2323"><a href="#PumpWoodMicroService-2323"><span class="linenos">2323</span></a><span class="sd">            No example yet.</span>
</span><span id="PumpWoodMicroService-2324"><a href="#PumpWoodMicroService-2324"><span class="linenos">2324</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-2325"><a href="#PumpWoodMicroService-2325"><span class="linenos">2325</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2326"><a href="#PumpWoodMicroService-2326"><span class="linenos">2326</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2327"><a href="#PumpWoodMicroService-2327"><span class="linenos">2327</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2328"><a href="#PumpWoodMicroService-2328"><span class="linenos">2328</span></a>
</span><span id="PumpWoodMicroService-2329"><a href="#PumpWoodMicroService-2329"><span class="linenos">2329</span></a>        <span class="n">url_temp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_pivot_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span>
</span><span id="PumpWoodMicroService-2330"><a href="#PumpWoodMicroService-2330"><span class="linenos">2330</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="n">url_temp</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2331"><a href="#PumpWoodMicroService-2331"><span class="linenos">2331</span></a>        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">list_args</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2332"><a href="#PumpWoodMicroService-2332"><span class="linenos">2332</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">variables</span>
</span><span id="PumpWoodMicroService-2333"><a href="#PumpWoodMicroService-2333"><span class="linenos">2333</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;show_deleted&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">show_deleted</span>
</span><span id="PumpWoodMicroService-2334"><a href="#PumpWoodMicroService-2334"><span class="linenos">2334</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">columns</span>
</span><span id="PumpWoodMicroService-2335"><a href="#PumpWoodMicroService-2335"><span class="linenos">2335</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">format</span>
</span><span id="PumpWoodMicroService-2336"><a href="#PumpWoodMicroService-2336"><span class="linenos">2336</span></a>
</span><span id="PumpWoodMicroService-2337"><a href="#PumpWoodMicroService-2337"><span class="linenos">2337</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_pivot: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2338"><a href="#PumpWoodMicroService-2338"><span class="linenos">2338</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2339"><a href="#PumpWoodMicroService-2339"><span class="linenos">2339</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2340"><a href="#PumpWoodMicroService-2340"><span class="linenos">2340</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2341"><a href="#PumpWoodMicroService-2341"><span class="linenos">2341</span></a>
</span><span id="PumpWoodMicroService-2342"><a href="#PumpWoodMicroService-2342"><span class="linenos">2342</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_queue_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queue_pk</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2343"><a href="#PumpWoodMicroService-2343"><span class="linenos">2343</span></a>                         <span class="n">save_as_excel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService-2344"><a href="#PumpWoodMicroService-2344"><span class="linenos">2344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Download model queue estimation matrix. In development...&quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService-2345"><a href="#PumpWoodMicroService-2345"><span class="linenos">2345</span></a>        <span class="n">file_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_file</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2346"><a href="#PumpWoodMicroService-2346"><span class="linenos">2346</span></a>            <span class="n">model_class</span><span class="o">=</span><span class="s2">&quot;ModelQueue&quot;</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">queue_pk</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2347"><a href="#PumpWoodMicroService-2347"><span class="linenos">2347</span></a>            <span class="n">file_field</span><span class="o">=</span><span class="s2">&quot;model_matrix_file&quot;</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2348"><a href="#PumpWoodMicroService-2348"><span class="linenos">2348</span></a>            <span class="n">save_file</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2349"><a href="#PumpWoodMicroService-2349"><span class="linenos">2349</span></a>        <span class="n">content</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">GzipFile</span><span class="p">(</span>
</span><span id="PumpWoodMicroService-2350"><a href="#PumpWoodMicroService-2350"><span class="linenos">2350</span></a>            <span class="n">fileobj</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">file_content</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-2351"><a href="#PumpWoodMicroService-2351"><span class="linenos">2351</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="PumpWoodMicroService-2352"><a href="#PumpWoodMicroService-2352"><span class="linenos">2352</span></a>        <span class="n">columns_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;columns_info&quot;</span><span class="p">])</span>
</span><span id="PumpWoodMicroService-2353"><a href="#PumpWoodMicroService-2353"><span class="linenos">2353</span></a>        <span class="n">model_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;model_matrix&quot;</span><span class="p">])</span>
</span><span id="PumpWoodMicroService-2354"><a href="#PumpWoodMicroService-2354"><span class="linenos">2354</span></a>
</span><span id="PumpWoodMicroService-2355"><a href="#PumpWoodMicroService-2355"><span class="linenos">2355</span></a>        <span class="k">if</span> <span class="n">save_as_excel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2356"><a href="#PumpWoodMicroService-2356"><span class="linenos">2356</span></a>            <span class="n">writer</span> <span class="o">=</span> <span class="n">ExcelWriter</span><span class="p">(</span><span class="n">save_as_excel</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2357"><a href="#PumpWoodMicroService-2357"><span class="linenos">2357</span></a>            <span class="n">columns_info</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="s1">&#39;columns_info&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2358"><a href="#PumpWoodMicroService-2358"><span class="linenos">2358</span></a>            <span class="n">model_matrix</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="s1">&#39;model_matrix&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PumpWoodMicroService-2359"><a href="#PumpWoodMicroService-2359"><span class="linenos">2359</span></a>            <span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="PumpWoodMicroService-2360"><a href="#PumpWoodMicroService-2360"><span class="linenos">2360</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService-2361"><a href="#PumpWoodMicroService-2361"><span class="linenos">2361</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="PumpWoodMicroService-2362"><a href="#PumpWoodMicroService-2362"><span class="linenos">2362</span></a>                <span class="s2">&quot;columns_info&quot;</span><span class="p">:</span> <span class="n">columns_info</span><span class="p">,</span>
</span><span id="PumpWoodMicroService-2363"><a href="#PumpWoodMicroService-2363"><span class="linenos">2363</span></a>                <span class="s2">&quot;model_matrix&quot;</span><span class="p">:</span> <span class="n">model_matrix</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Class to define an inter-pumpwood MicroService.</p>

<p>Create an object ot help communication with Pumpwood based backends. It
manage login and token refresh if necessary.</p>

<p>It also implements parallel functions that split requests in parallel
process to reduce processing time.</p>
</div>


                            <div id="PumpWoodMicroService.list_registered_routes" class="classattr">
                                        <input id="PumpWoodMicroService.list_registered_routes-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_registered_routes</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.list_registered_routes-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.list_registered_routes"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.list_registered_routes-72"><a href="#PumpWoodMicroService.list_registered_routes-72"><span class="linenos">72</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_registered_routes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.list_registered_routes-73"><a href="#PumpWoodMicroService.list_registered_routes-73"><span class="linenos">73</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List routes that have been registed at Kong.&quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.list_registered_routes-74"><a href="#PumpWoodMicroService.list_registered_routes-74"><span class="linenos">74</span></a>        <span class="n">list_url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/routes/&#39;</span>
</span><span id="PumpWoodMicroService.list_registered_routes-75"><a href="#PumpWoodMicroService.list_registered_routes-75"><span class="linenos">75</span></a>        <span class="n">routes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.list_registered_routes-76"><a href="#PumpWoodMicroService.list_registered_routes-76"><span class="linenos">76</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_registered_routes-77"><a href="#PumpWoodMicroService.list_registered_routes-77"><span class="linenos">77</span></a>        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">routes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="PumpWoodMicroService.list_registered_routes-78"><a href="#PumpWoodMicroService.list_registered_routes-78"><span class="linenos">78</span></a>            <span class="n">item</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</span><span id="PumpWoodMicroService.list_registered_routes-79"><a href="#PumpWoodMicroService.list_registered_routes-79"><span class="linenos">79</span></a>        <span class="k">return</span> <span class="n">routes</span>
</span></pre></div>


            <div class="docstring"><p>List routes that have been registed at Kong.</p>
</div>


                            </div>
                            <div id="PumpWoodMicroService.is_microservice_registered" class="classattr">
                                        <input id="PumpWoodMicroService.is_microservice_registered-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">is_microservice_registered</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">microservice</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.is_microservice_registered-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.is_microservice_registered"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.is_microservice_registered-81"><a href="#PumpWoodMicroService.is_microservice_registered-81"><span class="linenos">81</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">is_microservice_registered</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">microservice</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-82"><a href="#PumpWoodMicroService.is_microservice_registered-82"><span class="linenos">82</span></a>                                   <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-83"><a href="#PumpWoodMicroService.is_microservice_registered-83"><span class="linenos">83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if a microservice (kong service) is registered at Kong.</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-84"><a href="#PumpWoodMicroService.is_microservice_registered-84"><span class="linenos">84</span></a>
</span><span id="PumpWoodMicroService.is_microservice_registered-85"><a href="#PumpWoodMicroService.is_microservice_registered-85"><span class="linenos">85</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-86"><a href="#PumpWoodMicroService.is_microservice_registered-86"><span class="linenos">86</span></a><span class="sd">            microservice (str):</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-87"><a href="#PumpWoodMicroService.is_microservice_registered-87"><span class="linenos">87</span></a><span class="sd">                Service associated with microservice registered on</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-88"><a href="#PumpWoodMicroService.is_microservice_registered-88"><span class="linenos">88</span></a><span class="sd">                Pumpwood Kong.</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-89"><a href="#PumpWoodMicroService.is_microservice_registered-89"><span class="linenos">89</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-90"><a href="#PumpWoodMicroService.is_microservice_registered-90"><span class="linenos">90</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-91"><a href="#PumpWoodMicroService.is_microservice_registered-91"><span class="linenos">91</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-92"><a href="#PumpWoodMicroService.is_microservice_registered-92"><span class="linenos">92</span></a>
</span><span id="PumpWoodMicroService.is_microservice_registered-93"><a href="#PumpWoodMicroService.is_microservice_registered-93"><span class="linenos">93</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-94"><a href="#PumpWoodMicroService.is_microservice_registered-94"><span class="linenos">94</span></a><span class="sd">            Return true if microservice is registered.</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-95"><a href="#PumpWoodMicroService.is_microservice_registered-95"><span class="linenos">95</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-96"><a href="#PumpWoodMicroService.is_microservice_registered-96"><span class="linenos">96</span></a>        <span class="n">routes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_registered_routes</span><span class="p">(</span><span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.is_microservice_registered-97"><a href="#PumpWoodMicroService.is_microservice_registered-97"><span class="linenos">97</span></a>        <span class="k">return</span> <span class="n">microservice</span> <span class="ow">in</span> <span class="n">routes</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Check if a microservice (kong service) is registered at Kong.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>microservice (str):</strong>  Service associated with microservice registered on
Pumpwood Kong.</li>
<li><strong>auth_header (dict):</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Return true if microservice is registered.</p>
</blockquote>
</div>


                            </div>
                            <div id="PumpWoodMicroService.list_registered_endpoints" class="classattr">
                                        <input id="PumpWoodMicroService.list_registered_endpoints-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_registered_endpoints</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">availability</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;front_avaiable&#39;</span></span><span class="return-annotation">) -> <span class="nb">list</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.list_registered_endpoints-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.list_registered_endpoints"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.list_registered_endpoints-99"><a href="#PumpWoodMicroService.list_registered_endpoints-99"><span class="linenos"> 99</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_registered_endpoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-100"><a href="#PumpWoodMicroService.list_registered_endpoints-100"><span class="linenos">100</span></a>                                  <span class="n">availability</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;front_avaiable&#39;</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-101"><a href="#PumpWoodMicroService.list_registered_endpoints-101"><span class="linenos">101</span></a>                                  <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-102"><a href="#PumpWoodMicroService.list_registered_endpoints-102"><span class="linenos">102</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List all routes and services that have been registed at Kong.</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-103"><a href="#PumpWoodMicroService.list_registered_endpoints-103"><span class="linenos">103</span></a>
</span><span id="PumpWoodMicroService.list_registered_endpoints-104"><a href="#PumpWoodMicroService.list_registered_endpoints-104"><span class="linenos">104</span></a><span class="sd">        It is possible to restrict the return to end-points that should be</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-105"><a href="#PumpWoodMicroService.list_registered_endpoints-105"><span class="linenos">105</span></a><span class="sd">        avaiable at the frontend. Using this feature it is possibel to &#39;hide&#39;</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-106"><a href="#PumpWoodMicroService.list_registered_endpoints-106"><span class="linenos">106</span></a><span class="sd">        services from GUI keeping them avaiable for programatic calls.</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-107"><a href="#PumpWoodMicroService.list_registered_endpoints-107"><span class="linenos">107</span></a>
</span><span id="PumpWoodMicroService.list_registered_endpoints-108"><a href="#PumpWoodMicroService.list_registered_endpoints-108"><span class="linenos">108</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-109"><a href="#PumpWoodMicroService.list_registered_endpoints-109"><span class="linenos">109</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-110"><a href="#PumpWoodMicroService.list_registered_endpoints-110"><span class="linenos">110</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-111"><a href="#PumpWoodMicroService.list_registered_endpoints-111"><span class="linenos">111</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-112"><a href="#PumpWoodMicroService.list_registered_endpoints-112"><span class="linenos">112</span></a><span class="sd">            availability:</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-113"><a href="#PumpWoodMicroService.list_registered_endpoints-113"><span class="linenos">113</span></a><span class="sd">                Set the availability that is associated with the service.</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-114"><a href="#PumpWoodMicroService.list_registered_endpoints-114"><span class="linenos">114</span></a><span class="sd">                So far it is implemented &#39;front_avaiable&#39; and &#39;all&#39;.</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-115"><a href="#PumpWoodMicroService.list_registered_endpoints-115"><span class="linenos">115</span></a>
</span><span id="PumpWoodMicroService.list_registered_endpoints-116"><a href="#PumpWoodMicroService.list_registered_endpoints-116"><span class="linenos">116</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-117"><a href="#PumpWoodMicroService.list_registered_endpoints-117"><span class="linenos">117</span></a><span class="sd">            Return a list of serialized services objects containing the</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-118"><a href="#PumpWoodMicroService.list_registered_endpoints-118"><span class="linenos">118</span></a><span class="sd">            routes associated with at `route_set`.</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-119"><a href="#PumpWoodMicroService.list_registered_endpoints-119"><span class="linenos">119</span></a>
</span><span id="PumpWoodMicroService.list_registered_endpoints-120"><a href="#PumpWoodMicroService.list_registered_endpoints-120"><span class="linenos">120</span></a><span class="sd">            Service and routes have `notes__verbose` and `description__verbose`</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-121"><a href="#PumpWoodMicroService.list_registered_endpoints-121"><span class="linenos">121</span></a><span class="sd">            that are  the repective strings associated with note and</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-122"><a href="#PumpWoodMicroService.list_registered_endpoints-122"><span class="linenos">122</span></a><span class="sd">            description but translated using Pumpwood&#39;s I8s,</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-123"><a href="#PumpWoodMicroService.list_registered_endpoints-123"><span class="linenos">123</span></a>
</span><span id="PumpWoodMicroService.list_registered_endpoints-124"><a href="#PumpWoodMicroService.list_registered_endpoints-124"><span class="linenos">124</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-125"><a href="#PumpWoodMicroService.list_registered_endpoints-125"><span class="linenos">125</span></a><span class="sd">            PumpWoodWrongParameters:</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-126"><a href="#PumpWoodMicroService.list_registered_endpoints-126"><span class="linenos">126</span></a><span class="sd">                Raise PumpWoodWrongParameters if availability passed as</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-127"><a href="#PumpWoodMicroService.list_registered_endpoints-127"><span class="linenos">127</span></a><span class="sd">                paraemter is not implemented.</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-128"><a href="#PumpWoodMicroService.list_registered_endpoints-128"><span class="linenos">128</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-129"><a href="#PumpWoodMicroService.list_registered_endpoints-129"><span class="linenos">129</span></a>        <span class="n">list_url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/endpoints/&#39;</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-130"><a href="#PumpWoodMicroService.list_registered_endpoints-130"><span class="linenos">130</span></a>        <span class="n">routes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-131"><a href="#PumpWoodMicroService.list_registered_endpoints-131"><span class="linenos">131</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;availability&#39;</span><span class="p">:</span> <span class="n">availability</span><span class="p">},</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-132"><a href="#PumpWoodMicroService.list_registered_endpoints-132"><span class="linenos">132</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_registered_endpoints-133"><a href="#PumpWoodMicroService.list_registered_endpoints-133"><span class="linenos">133</span></a>        <span class="k">return</span> <span class="n">routes</span>
</span></pre></div>


            <div class="docstring"><p>List all routes and services that have been registed at Kong.</p>

<p>It is possible to restrict the return to end-points that should be
avaiable at the frontend. Using this feature it is possibel to 'hide'
services from GUI keeping them avaiable for programatic calls.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
<li><strong>availability:</strong>  Set the availability that is associated with the service.
So far it is implemented 'front_avaiable' and 'all'.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Return a list of serialized services objects containing the
  routes associated with at <code>route_set</code>.</p>
  
  <p>Service and routes have <code>notes__verbose</code> and <code>description__verbose</code>
  that are  the repective strings associated with note and
  description but translated using Pumpwood's I8s,</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodWrongParameters:</strong>  Raise PumpWoodWrongParameters if availability passed as
paraemter is not implemented.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.dummy_call" class="classattr">
                                        <input id="PumpWoodMicroService.dummy_call-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dummy_call</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">payload</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.dummy_call-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.dummy_call"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.dummy_call-135"><a href="#PumpWoodMicroService.dummy_call-135"><span class="linenos">135</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dummy_call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.dummy_call-136"><a href="#PumpWoodMicroService.dummy_call-136"><span class="linenos">136</span></a>                   <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.dummy_call-137"><a href="#PumpWoodMicroService.dummy_call-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a dummy call to ensure headers and payload reaching app.</span>
</span><span id="PumpWoodMicroService.dummy_call-138"><a href="#PumpWoodMicroService.dummy_call-138"><span class="linenos">138</span></a>
</span><span id="PumpWoodMicroService.dummy_call-139"><a href="#PumpWoodMicroService.dummy_call-139"><span class="linenos">139</span></a><span class="sd">        The request just bounce on the server and return the headers and</span>
</span><span id="PumpWoodMicroService.dummy_call-140"><a href="#PumpWoodMicroService.dummy_call-140"><span class="linenos">140</span></a><span class="sd">        payload that reached the application. It is usefull for probing</span>
</span><span id="PumpWoodMicroService.dummy_call-141"><a href="#PumpWoodMicroService.dummy_call-141"><span class="linenos">141</span></a><span class="sd">        proxy servers, API gateways and other security and load balance</span>
</span><span id="PumpWoodMicroService.dummy_call-142"><a href="#PumpWoodMicroService.dummy_call-142"><span class="linenos">142</span></a><span class="sd">        tools.</span>
</span><span id="PumpWoodMicroService.dummy_call-143"><a href="#PumpWoodMicroService.dummy_call-143"><span class="linenos">143</span></a>
</span><span id="PumpWoodMicroService.dummy_call-144"><a href="#PumpWoodMicroService.dummy_call-144"><span class="linenos">144</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.dummy_call-145"><a href="#PumpWoodMicroService.dummy_call-145"><span class="linenos">145</span></a><span class="sd">            payload:</span>
</span><span id="PumpWoodMicroService.dummy_call-146"><a href="#PumpWoodMicroService.dummy_call-146"><span class="linenos">146</span></a><span class="sd">                Payload to be returned by the dummy call end-point.</span>
</span><span id="PumpWoodMicroService.dummy_call-147"><a href="#PumpWoodMicroService.dummy_call-147"><span class="linenos">147</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.dummy_call-148"><a href="#PumpWoodMicroService.dummy_call-148"><span class="linenos">148</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.dummy_call-149"><a href="#PumpWoodMicroService.dummy_call-149"><span class="linenos">149</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.dummy_call-150"><a href="#PumpWoodMicroService.dummy_call-150"><span class="linenos">150</span></a>
</span><span id="PumpWoodMicroService.dummy_call-151"><a href="#PumpWoodMicroService.dummy_call-151"><span class="linenos">151</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.dummy_call-152"><a href="#PumpWoodMicroService.dummy_call-152"><span class="linenos">152</span></a><span class="sd">            Return a dictonary with:</span>
</span><span id="PumpWoodMicroService.dummy_call-153"><a href="#PumpWoodMicroService.dummy_call-153"><span class="linenos">153</span></a><span class="sd">            - **full_path**: Full path of the request.</span>
</span><span id="PumpWoodMicroService.dummy_call-154"><a href="#PumpWoodMicroService.dummy_call-154"><span class="linenos">154</span></a><span class="sd">            - **method**: Method used at the call</span>
</span><span id="PumpWoodMicroService.dummy_call-155"><a href="#PumpWoodMicroService.dummy_call-155"><span class="linenos">155</span></a><span class="sd">            - **headers**: Headers at the request.</span>
</span><span id="PumpWoodMicroService.dummy_call-156"><a href="#PumpWoodMicroService.dummy_call-156"><span class="linenos">156</span></a><span class="sd">            - **data**: Post payload sent at the request.</span>
</span><span id="PumpWoodMicroService.dummy_call-157"><a href="#PumpWoodMicroService.dummy_call-157"><span class="linenos">157</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.dummy_call-158"><a href="#PumpWoodMicroService.dummy_call-158"><span class="linenos">158</span></a>        <span class="n">list_url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/dummy-call/&#39;</span>
</span><span id="PumpWoodMicroService.dummy_call-159"><a href="#PumpWoodMicroService.dummy_call-159"><span class="linenos">159</span></a>        <span class="k">if</span> <span class="n">payload</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.dummy_call-160"><a href="#PumpWoodMicroService.dummy_call-160"><span class="linenos">160</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.dummy_call-161"><a href="#PumpWoodMicroService.dummy_call-161"><span class="linenos">161</span></a>                <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.dummy_call-162"><a href="#PumpWoodMicroService.dummy_call-162"><span class="linenos">162</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.dummy_call-163"><a href="#PumpWoodMicroService.dummy_call-163"><span class="linenos">163</span></a>            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.dummy_call-164"><a href="#PumpWoodMicroService.dummy_call-164"><span class="linenos">164</span></a>                <span class="n">url</span><span class="o">=</span><span class="n">list_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.dummy_call-165"><a href="#PumpWoodMicroService.dummy_call-165"><span class="linenos">165</span></a>                <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a dummy call to ensure headers and payload reaching app.</p>

<p>The request just bounce on the server and return the headers and
payload that reached the application. It is usefull for probing
proxy servers, API gateways and other security and load balance
tools.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>payload:</strong>  Payload to be returned by the dummy call end-point.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Return a dictonary with:</p>
  
  <ul>
  <li><strong>full_path</strong>: Full path of the request.</li>
  <li><strong>method</strong>: Method used at the call</li>
  <li><strong>headers</strong>: Headers at the request.</li>
  <li><strong>data</strong>: Post payload sent at the request.</li>
  </ul>
</blockquote>
</div>


                            </div>
                            <div id="PumpWoodMicroService.dummy_raise" class="classattr">
                                        <input id="PumpWoodMicroService.dummy_raise-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">dummy_raise</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">exception_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">exception_deep</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">payload</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.dummy_raise-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.dummy_raise"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.dummy_raise-167"><a href="#PumpWoodMicroService.dummy_raise-167"><span class="linenos">167</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">dummy_raise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">exception_deep</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.dummy_raise-168"><a href="#PumpWoodMicroService.dummy_raise-168"><span class="linenos">168</span></a>                    <span class="n">payload</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.dummy_raise-169"><a href="#PumpWoodMicroService.dummy_raise-169"><span class="linenos">169</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Raise an Pumpwood error with the payload.</span>
</span><span id="PumpWoodMicroService.dummy_raise-170"><a href="#PumpWoodMicroService.dummy_raise-170"><span class="linenos">170</span></a>
</span><span id="PumpWoodMicroService.dummy_raise-171"><a href="#PumpWoodMicroService.dummy_raise-171"><span class="linenos">171</span></a><span class="sd">        This and point raises an Arbitrary PumpWoodException error, it can be</span>
</span><span id="PumpWoodMicroService.dummy_raise-172"><a href="#PumpWoodMicroService.dummy_raise-172"><span class="linenos">172</span></a><span class="sd">        used for debuging error treatment.</span>
</span><span id="PumpWoodMicroService.dummy_raise-173"><a href="#PumpWoodMicroService.dummy_raise-173"><span class="linenos">173</span></a>
</span><span id="PumpWoodMicroService.dummy_raise-174"><a href="#PumpWoodMicroService.dummy_raise-174"><span class="linenos">174</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.dummy_raise-175"><a href="#PumpWoodMicroService.dummy_raise-175"><span class="linenos">175</span></a><span class="sd">            exception_class:</span>
</span><span id="PumpWoodMicroService.dummy_raise-176"><a href="#PumpWoodMicroService.dummy_raise-176"><span class="linenos">176</span></a><span class="sd">                Class of the exception to be raised.</span>
</span><span id="PumpWoodMicroService.dummy_raise-177"><a href="#PumpWoodMicroService.dummy_raise-177"><span class="linenos">177</span></a><span class="sd">            exception_deep:</span>
</span><span id="PumpWoodMicroService.dummy_raise-178"><a href="#PumpWoodMicroService.dummy_raise-178"><span class="linenos">178</span></a><span class="sd">                Deep of the exception in microservice calls. This arg will</span>
</span><span id="PumpWoodMicroService.dummy_raise-179"><a href="#PumpWoodMicroService.dummy_raise-179"><span class="linenos">179</span></a><span class="sd">                make error recusive, calling the end-point it self for</span>
</span><span id="PumpWoodMicroService.dummy_raise-180"><a href="#PumpWoodMicroService.dummy_raise-180"><span class="linenos">180</span></a><span class="sd">                `exception_deep` time before raising the error.</span>
</span><span id="PumpWoodMicroService.dummy_raise-181"><a href="#PumpWoodMicroService.dummy_raise-181"><span class="linenos">181</span></a><span class="sd">            payload:</span>
</span><span id="PumpWoodMicroService.dummy_raise-182"><a href="#PumpWoodMicroService.dummy_raise-182"><span class="linenos">182</span></a><span class="sd">                Payload that will be returned with error.</span>
</span><span id="PumpWoodMicroService.dummy_raise-183"><a href="#PumpWoodMicroService.dummy_raise-183"><span class="linenos">183</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.dummy_raise-184"><a href="#PumpWoodMicroService.dummy_raise-184"><span class="linenos">184</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.dummy_raise-185"><a href="#PumpWoodMicroService.dummy_raise-185"><span class="linenos">185</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.dummy_raise-186"><a href="#PumpWoodMicroService.dummy_raise-186"><span class="linenos">186</span></a>
</span><span id="PumpWoodMicroService.dummy_raise-187"><a href="#PumpWoodMicroService.dummy_raise-187"><span class="linenos">187</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.dummy_raise-188"><a href="#PumpWoodMicroService.dummy_raise-188"><span class="linenos">188</span></a><span class="sd">            Should not return any results, all possible call should result</span>
</span><span id="PumpWoodMicroService.dummy_raise-189"><a href="#PumpWoodMicroService.dummy_raise-189"><span class="linenos">189</span></a><span class="sd">            in raising the correspondent error.</span>
</span><span id="PumpWoodMicroService.dummy_raise-190"><a href="#PumpWoodMicroService.dummy_raise-190"><span class="linenos">190</span></a>
</span><span id="PumpWoodMicroService.dummy_raise-191"><a href="#PumpWoodMicroService.dummy_raise-191"><span class="linenos">191</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.dummy_raise-192"><a href="#PumpWoodMicroService.dummy_raise-192"><span class="linenos">192</span></a><span class="sd">            Should raise the correspondent error passed on exception_class</span>
</span><span id="PumpWoodMicroService.dummy_raise-193"><a href="#PumpWoodMicroService.dummy_raise-193"><span class="linenos">193</span></a><span class="sd">            arg, with payload.</span>
</span><span id="PumpWoodMicroService.dummy_raise-194"><a href="#PumpWoodMicroService.dummy_raise-194"><span class="linenos">194</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.dummy_raise-195"><a href="#PumpWoodMicroService.dummy_raise-195"><span class="linenos">195</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;rest/pumpwood/dummy-raise/&#39;</span>
</span><span id="PumpWoodMicroService.dummy_raise-196"><a href="#PumpWoodMicroService.dummy_raise-196"><span class="linenos">196</span></a>        <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;exception_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exception_class</span>
</span><span id="PumpWoodMicroService.dummy_raise-197"><a href="#PumpWoodMicroService.dummy_raise-197"><span class="linenos">197</span></a>        <span class="n">payload</span><span class="p">[</span><span class="s2">&quot;exception_deep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">exception_deep</span>
</span><span id="PumpWoodMicroService.dummy_raise-198"><a href="#PumpWoodMicroService.dummy_raise-198"><span class="linenos">198</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">payload</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Raise an Pumpwood error with the payload.</p>

<p>This and point raises an Arbitrary PumpWoodException error, it can be
used for debuging error treatment.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>exception_class:</strong>  Class of the exception to be raised.</li>
<li><strong>exception_deep:</strong>  Deep of the exception in microservice calls. This arg will
make error recusive, calling the end-point it self for
<code>exception_deep</code> time before raising the error.</li>
<li><strong>payload:</strong>  Payload that will be returned with error.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Should not return any results, all possible call should result
  in raising the correspondent error.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>Should raise the correspondent error passed on exception_class</li>
<li>arg, with payload.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.get_pks_from_unique_field" class="classattr">
                                        <input id="PumpWoodMicroService.get_pks_from_unique_field-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_pks_from_unique_field</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">field</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.get_pks_from_unique_field-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.get_pks_from_unique_field"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.get_pks_from_unique_field-200"><a href="#PumpWoodMicroService.get_pks_from_unique_field-200"><span class="linenos">200</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_pks_from_unique_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-201"><a href="#PumpWoodMicroService.get_pks_from_unique_field-201"><span class="linenos">201</span></a>                                  <span class="n">values</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-202"><a href="#PumpWoodMicroService.get_pks_from_unique_field-202"><span class="linenos">202</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Get pk using unique fields values.</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-203"><a href="#PumpWoodMicroService.get_pks_from_unique_field-203"><span class="linenos">203</span></a>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-204"><a href="#PumpWoodMicroService.get_pks_from_unique_field-204"><span class="linenos">204</span></a><span class="sd">        Use unique field values to retrieve pk of the objects. This end-point</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-205"><a href="#PumpWoodMicroService.get_pks_from_unique_field-205"><span class="linenos">205</span></a><span class="sd">        is usefull for retrieving pks of the objects associated with unique</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-206"><a href="#PumpWoodMicroService.get_pks_from_unique_field-206"><span class="linenos">206</span></a><span class="sd">        fields such as `description` (unique on most model of pumpwood).</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-207"><a href="#PumpWoodMicroService.get_pks_from_unique_field-207"><span class="linenos">207</span></a>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-208"><a href="#PumpWoodMicroService.get_pks_from_unique_field-208"><span class="linenos">208</span></a><span class="sd">        ```python</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-209"><a href="#PumpWoodMicroService.get_pks_from_unique_field-209"><span class="linenos">209</span></a><span class="sd">        # Using description to fetch pks from objects</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-210"><a href="#PumpWoodMicroService.get_pks_from_unique_field-210"><span class="linenos">210</span></a><span class="sd">        data: pd.DataFrame = [data with unique description but without pk]</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-211"><a href="#PumpWoodMicroService.get_pks_from_unique_field-211"><span class="linenos">211</span></a><span class="sd">        data[&#39;attribute_id&#39;] = microservice.get_pks_from_unique_field(</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-212"><a href="#PumpWoodMicroService.get_pks_from_unique_field-212"><span class="linenos">212</span></a><span class="sd">            model_class=&quot;DescriptionAttribute&quot;,</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-213"><a href="#PumpWoodMicroService.get_pks_from_unique_field-213"><span class="linenos">213</span></a><span class="sd">            field=&quot;description&quot;, values=data[&#39;attribute&#39;])[&#39;pk&#39;]</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-214"><a href="#PumpWoodMicroService.get_pks_from_unique_field-214"><span class="linenos">214</span></a>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-215"><a href="#PumpWoodMicroService.get_pks_from_unique_field-215"><span class="linenos">215</span></a><span class="sd">        # Using a dimension key to fetch pk of the objects, dimension</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-216"><a href="#PumpWoodMicroService.get_pks_from_unique_field-216"><span class="linenos">216</span></a><span class="sd">        # key must be unique</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-217"><a href="#PumpWoodMicroService.get_pks_from_unique_field-217"><span class="linenos">217</span></a><span class="sd">        data[&#39;georea_id&#39;] = microservice.get_pks_from_unique_field(</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-218"><a href="#PumpWoodMicroService.get_pks_from_unique_field-218"><span class="linenos">218</span></a><span class="sd">            model_class=&quot;DescriptionGeoarea&quot;, field=&quot;dimension-&gt;city&quot;,</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-219"><a href="#PumpWoodMicroService.get_pks_from_unique_field-219"><span class="linenos">219</span></a><span class="sd">            values=data[&#39;city&#39;])[&#39;pk&#39;]</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-220"><a href="#PumpWoodMicroService.get_pks_from_unique_field-220"><span class="linenos">220</span></a><span class="sd">        ```</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-221"><a href="#PumpWoodMicroService.get_pks_from_unique_field-221"><span class="linenos">221</span></a>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-222"><a href="#PumpWoodMicroService.get_pks_from_unique_field-222"><span class="linenos">222</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-223"><a href="#PumpWoodMicroService.get_pks_from_unique_field-223"><span class="linenos">223</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-224"><a href="#PumpWoodMicroService.get_pks_from_unique_field-224"><span class="linenos">224</span></a><span class="sd">                Model class of the objects.</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-225"><a href="#PumpWoodMicroService.get_pks_from_unique_field-225"><span class="linenos">225</span></a><span class="sd">            field:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-226"><a href="#PumpWoodMicroService.get_pks_from_unique_field-226"><span class="linenos">226</span></a><span class="sd">                Unique field to fetch pk. It is possible to use dimension keys</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-227"><a href="#PumpWoodMicroService.get_pks_from_unique_field-227"><span class="linenos">227</span></a><span class="sd">                as unique field, for that use `dimension-&gt;[key]` notation.</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-228"><a href="#PumpWoodMicroService.get_pks_from_unique_field-228"><span class="linenos">228</span></a><span class="sd">            values:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-229"><a href="#PumpWoodMicroService.get_pks_from_unique_field-229"><span class="linenos">229</span></a><span class="sd">                List of the unique fields used to fetch primary keys.</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-230"><a href="#PumpWoodMicroService.get_pks_from_unique_field-230"><span class="linenos">230</span></a>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-231"><a href="#PumpWoodMicroService.get_pks_from_unique_field-231"><span class="linenos">231</span></a><span class="sd">        Return:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-232"><a href="#PumpWoodMicroService.get_pks_from_unique_field-232"><span class="linenos">232</span></a><span class="sd">            Return a dataframe in same order as values with columns:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-233"><a href="#PumpWoodMicroService.get_pks_from_unique_field-233"><span class="linenos">233</span></a><span class="sd">            - **pk**: Correspondent primary key of the unique value.</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-234"><a href="#PumpWoodMicroService.get_pks_from_unique_field-234"><span class="linenos">234</span></a><span class="sd">            - **[field]**: Column with same name of field argument,</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-235"><a href="#PumpWoodMicroService.get_pks_from_unique_field-235"><span class="linenos">235</span></a><span class="sd">                correspondent to pk.</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-236"><a href="#PumpWoodMicroService.get_pks_from_unique_field-236"><span class="linenos">236</span></a>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-237"><a href="#PumpWoodMicroService.get_pks_from_unique_field-237"><span class="linenos">237</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-238"><a href="#PumpWoodMicroService.get_pks_from_unique_field-238"><span class="linenos">238</span></a><span class="sd">            PumpWoodQueryException:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-239"><a href="#PumpWoodMicroService.get_pks_from_unique_field-239"><span class="linenos">239</span></a><span class="sd">                Raises if field is not found on the model and it is note</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-240"><a href="#PumpWoodMicroService.get_pks_from_unique_field-240"><span class="linenos">240</span></a><span class="sd">                associated with a dimension tag.</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-241"><a href="#PumpWoodMicroService.get_pks_from_unique_field-241"><span class="linenos">241</span></a><span class="sd">            PumpWoodQueryException:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-242"><a href="#PumpWoodMicroService.get_pks_from_unique_field-242"><span class="linenos">242</span></a><span class="sd">                Raises if `field` does not have a unique restriction on</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-243"><a href="#PumpWoodMicroService.get_pks_from_unique_field-243"><span class="linenos">243</span></a><span class="sd">                database. Dimension keys does not check for uniqueness on</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-244"><a href="#PumpWoodMicroService.get_pks_from_unique_field-244"><span class="linenos">244</span></a><span class="sd">                database, be carefull not to duplicate the lines.</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-245"><a href="#PumpWoodMicroService.get_pks_from_unique_field-245"><span class="linenos">245</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-246"><a href="#PumpWoodMicroService.get_pks_from_unique_field-246"><span class="linenos">246</span></a>        <span class="n">is_dimension_tag</span> <span class="o">=</span> <span class="s1">&#39;dimensions-&gt;&#39;</span> <span class="ow">in</span> <span class="n">field</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-247"><a href="#PumpWoodMicroService.get_pks_from_unique_field-247"><span class="linenos">247</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_dimension_tag</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-248"><a href="#PumpWoodMicroService.get_pks_from_unique_field-248"><span class="linenos">248</span></a>            <span class="n">fill_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_options</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-249"><a href="#PumpWoodMicroService.get_pks_from_unique_field-249"><span class="linenos">249</span></a>            <span class="n">field_details</span> <span class="o">=</span> <span class="n">fill_options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-250"><a href="#PumpWoodMicroService.get_pks_from_unique_field-250"><span class="linenos">250</span></a>            <span class="k">if</span> <span class="n">field_details</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-251"><a href="#PumpWoodMicroService.get_pks_from_unique_field-251"><span class="linenos">251</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-252"><a href="#PumpWoodMicroService.get_pks_from_unique_field-252"><span class="linenos">252</span></a>                    <span class="s2">&quot;Field is not a dimension tag and not found on model &quot;</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-253"><a href="#PumpWoodMicroService.get_pks_from_unique_field-253"><span class="linenos">253</span></a>                    <span class="s2">&quot;fields. Field [</span><span class="si">{field}</span><span class="s2">]&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-254"><a href="#PumpWoodMicroService.get_pks_from_unique_field-254"><span class="linenos">254</span></a>                <span class="k">raise</span> <span class="n">PumpWoodQueryException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-255"><a href="#PumpWoodMicroService.get_pks_from_unique_field-255"><span class="linenos">255</span></a>                    <span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">field</span><span class="p">})</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-256"><a href="#PumpWoodMicroService.get_pks_from_unique_field-256"><span class="linenos">256</span></a>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-257"><a href="#PumpWoodMicroService.get_pks_from_unique_field-257"><span class="linenos">257</span></a>            <span class="n">is_unique_field</span> <span class="o">=</span> <span class="n">field_details</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unique&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-258"><a href="#PumpWoodMicroService.get_pks_from_unique_field-258"><span class="linenos">258</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">is_unique_field</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-259"><a href="#PumpWoodMicroService.get_pks_from_unique_field-259"><span class="linenos">259</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Field [</span><span class="si">{}</span><span class="s2">] to get pk from is not unique&quot;</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-260"><a href="#PumpWoodMicroService.get_pks_from_unique_field-260"><span class="linenos">260</span></a>                <span class="k">raise</span> <span class="n">PumpWoodQueryException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-261"><a href="#PumpWoodMicroService.get_pks_from_unique_field-261"><span class="linenos">261</span></a>                    <span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;field&quot;</span><span class="p">:</span> <span class="n">field</span><span class="p">})</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-262"><a href="#PumpWoodMicroService.get_pks_from_unique_field-262"><span class="linenos">262</span></a>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-263"><a href="#PumpWoodMicroService.get_pks_from_unique_field-263"><span class="linenos">263</span></a>        <span class="n">filter_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">field</span> <span class="o">+</span> <span class="s2">&quot;__in&quot;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">values</span><span class="p">))}</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-264"><a href="#PumpWoodMicroService.get_pks_from_unique_field-264"><span class="linenos">264</span></a>        <span class="n">pk_map</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-265"><a href="#PumpWoodMicroService.get_pks_from_unique_field-265"><span class="linenos">265</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_dimension_tag</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-266"><a href="#PumpWoodMicroService.get_pks_from_unique_field-266"><span class="linenos">266</span></a>            <span class="n">list_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_without_pag</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-267"><a href="#PumpWoodMicroService.get_pks_from_unique_field-267"><span class="linenos">267</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">filter_dict</span><span class="o">=</span><span class="n">filter_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-268"><a href="#PumpWoodMicroService.get_pks_from_unique_field-268"><span class="linenos">268</span></a>                <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="n">field</span><span class="p">]),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="n">field</span><span class="p">])</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-269"><a href="#PumpWoodMicroService.get_pks_from_unique_field-269"><span class="linenos">269</span></a>            <span class="n">pk_map</span> <span class="o">=</span> <span class="n">list_results</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">field</span><span class="p">)[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-270"><a href="#PumpWoodMicroService.get_pks_from_unique_field-270"><span class="linenos">270</span></a>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-271"><a href="#PumpWoodMicroService.get_pks_from_unique_field-271"><span class="linenos">271</span></a>        <span class="c1"># If is dimension tag, fetch dimension and unpack it</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-272"><a href="#PumpWoodMicroService.get_pks_from_unique_field-272"><span class="linenos">272</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-273"><a href="#PumpWoodMicroService.get_pks_from_unique_field-273"><span class="linenos">273</span></a>            <span class="n">dimension_tag</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&gt;&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-274"><a href="#PumpWoodMicroService.get_pks_from_unique_field-274"><span class="linenos">274</span></a>            <span class="n">list_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_without_pag</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-275"><a href="#PumpWoodMicroService.get_pks_from_unique_field-275"><span class="linenos">275</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">filter_dict</span><span class="o">=</span><span class="n">filter_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-276"><a href="#PumpWoodMicroService.get_pks_from_unique_field-276"><span class="linenos">276</span></a>                <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="s2">&quot;dimensions&quot;</span><span class="p">]))</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-277"><a href="#PumpWoodMicroService.get_pks_from_unique_field-277"><span class="linenos">277</span></a>            <span class="n">pk_map</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-278"><a href="#PumpWoodMicroService.get_pks_from_unique_field-278"><span class="linenos">278</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_results</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-279"><a href="#PumpWoodMicroService.get_pks_from_unique_field-279"><span class="linenos">279</span></a>                <span class="n">pk_map</span> <span class="o">=</span> <span class="n">list_results</span>\
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-280"><a href="#PumpWoodMicroService.get_pks_from_unique_field-280"><span class="linenos">280</span></a>                    <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">unpack_dict_columns</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;dimensions&quot;</span><span class="p">])</span>\
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-281"><a href="#PumpWoodMicroService.get_pks_from_unique_field-281"><span class="linenos">281</span></a>                    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">dimension_tag</span><span class="p">)[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-282"><a href="#PumpWoodMicroService.get_pks_from_unique_field-282"><span class="linenos">282</span></a>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-283"><a href="#PumpWoodMicroService.get_pks_from_unique_field-283"><span class="linenos">283</span></a>        <span class="n">values_series</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-284"><a href="#PumpWoodMicroService.get_pks_from_unique_field-284"><span class="linenos">284</span></a>        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-285"><a href="#PumpWoodMicroService.get_pks_from_unique_field-285"><span class="linenos">285</span></a>            <span class="s2">&quot;pk&quot;</span><span class="p">:</span> <span class="n">values_series</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">pk_map</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">(),</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-286"><a href="#PumpWoodMicroService.get_pks_from_unique_field-286"><span class="linenos">286</span></a>            <span class="n">field</span><span class="p">:</span> <span class="n">values_series</span>
</span><span id="PumpWoodMicroService.get_pks_from_unique_field-287"><a href="#PumpWoodMicroService.get_pks_from_unique_field-287"><span class="linenos">287</span></a>        <span class="p">})</span>
</span></pre></div>


            <div class="docstring"><p>Get pk using unique fields values.</p>

<p>Use unique field values to retrieve pk of the objects. This end-point
is usefull for retrieving pks of the objects associated with unique
fields such as <code>description</code> (unique on most model of pumpwood).</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="c1"># Using description to fetch pks from objects</span>
<span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span> <span class="k">with</span> <span class="n">unique</span> <span class="n">description</span> <span class="n">but</span> <span class="n">without</span> <span class="n">pk</span><span class="p">]</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;attribute_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">microservice</span><span class="o">.</span><span class="n">get_pks_from_unique_field</span><span class="p">(</span>
    <span class="n">model_class</span><span class="o">=</span><span class="s2">&quot;DescriptionAttribute&quot;</span><span class="p">,</span>
    <span class="n">field</span><span class="o">=</span><span class="s2">&quot;description&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;attribute&#39;</span><span class="p">])[</span><span class="s1">&#39;pk&#39;</span><span class="p">]</span>

<span class="c1"># Using a dimension key to fetch pk of the objects, dimension</span>
<span class="c1"># key must be unique</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;georea_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">microservice</span><span class="o">.</span><span class="n">get_pks_from_unique_field</span><span class="p">(</span>
    <span class="n">model_class</span><span class="o">=</span><span class="s2">&quot;DescriptionGeoarea&quot;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="s2">&quot;dimension-&gt;city&quot;</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;city&#39;</span><span class="p">])[</span><span class="s1">&#39;pk&#39;</span><span class="p">]</span>
</code></pre>
</div>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class of the objects.</li>
<li><strong>field:</strong>  Unique field to fetch pk. It is possible to use dimension keys
as unique field, for that use <code>dimension-&gt;[key]</code> notation.</li>
<li><strong>values:</strong>  List of the unique fields used to fetch primary keys.</li>
</ul>

<h6 id="return">Return:</h6>

<blockquote>
  <p>Return a dataframe in same order as values with columns:</p>
  
  <ul>
  <li><strong>pk</strong>: Correspondent primary key of the unique value.</li>
  <li><strong>[field]</strong>: Column with same name of field argument,
  correspondent to pk.</li>
  </ul>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodQueryException:</strong>  Raises if field is not found on the model and it is note
associated with a dimension tag.</li>
<li><strong>PumpWoodQueryException:</strong>  Raises if <code>field</code> does not have a unique restriction on
database. Dimension keys does not check for uniqueness on
database, be carefull not to duplicate the lines.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.list" class="classattr">
                                        <input id="PumpWoodMicroService.list-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">order_by</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.list-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.list"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.list-293"><a href="#PumpWoodMicroService.list-293"><span class="linenos">293</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService.list-294"><a href="#PumpWoodMicroService.list-294"><span class="linenos">294</span></a>             <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">order_by</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="PumpWoodMicroService.list-295"><a href="#PumpWoodMicroService.list-295"><span class="linenos">295</span></a>             <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list-296"><a href="#PumpWoodMicroService.list-296"><span class="linenos">296</span></a>             <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list-297"><a href="#PumpWoodMicroService.list-297"><span class="linenos">297</span></a>             <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list-298"><a href="#PumpWoodMicroService.list-298"><span class="linenos">298</span></a>             <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.list-299"><a href="#PumpWoodMicroService.list-299"><span class="linenos">299</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List objects with pagination.</span>
</span><span id="PumpWoodMicroService.list-300"><a href="#PumpWoodMicroService.list-300"><span class="linenos">300</span></a>
</span><span id="PumpWoodMicroService.list-301"><a href="#PumpWoodMicroService.list-301"><span class="linenos">301</span></a><span class="sd">        List end-point (resumed data) of PumpWood like systems,</span>
</span><span id="PumpWoodMicroService.list-302"><a href="#PumpWoodMicroService.list-302"><span class="linenos">302</span></a><span class="sd">        results will be paginated. To get next pag, send all recived pk at</span>
</span><span id="PumpWoodMicroService.list-303"><a href="#PumpWoodMicroService.list-303"><span class="linenos">303</span></a><span class="sd">        exclude dict (ex.: `exclude_dict={pk__in: [1,2,...,30]}`).</span>
</span><span id="PumpWoodMicroService.list-304"><a href="#PumpWoodMicroService.list-304"><span class="linenos">304</span></a>
</span><span id="PumpWoodMicroService.list-305"><a href="#PumpWoodMicroService.list-305"><span class="linenos">305</span></a><span class="sd">        It is possible to return foreign keys objects associated with</span>
</span><span id="PumpWoodMicroService.list-306"><a href="#PumpWoodMicroService.list-306"><span class="linenos">306</span></a><span class="sd">        `model_class`. Use this with carefull since increase the backend</span>
</span><span id="PumpWoodMicroService.list-307"><a href="#PumpWoodMicroService.list-307"><span class="linenos">307</span></a><span class="sd">        infrastructure consumption, each object is a retrieve call per</span>
</span><span id="PumpWoodMicroService.list-308"><a href="#PumpWoodMicroService.list-308"><span class="linenos">308</span></a><span class="sd">        foreign key (otimization in progress).</span>
</span><span id="PumpWoodMicroService.list-309"><a href="#PumpWoodMicroService.list-309"><span class="linenos">309</span></a>
</span><span id="PumpWoodMicroService.list-310"><a href="#PumpWoodMicroService.list-310"><span class="linenos">310</span></a><span class="sd">        It is possible to use diferent operators using `__` after the name</span>
</span><span id="PumpWoodMicroService.list-311"><a href="#PumpWoodMicroService.list-311"><span class="linenos">311</span></a><span class="sd">        of the field, some of the operators avaiable:</span>
</span><span id="PumpWoodMicroService.list-312"><a href="#PumpWoodMicroService.list-312"><span class="linenos">312</span></a>
</span><span id="PumpWoodMicroService.list-313"><a href="#PumpWoodMicroService.list-313"><span class="linenos">313</span></a><span class="sd">        ### General operators</span>
</span><span id="PumpWoodMicroService.list-314"><a href="#PumpWoodMicroService.list-314"><span class="linenos">314</span></a><span class="sd">        - **__eq:** Check if the value is the same, same results if no</span>
</span><span id="PumpWoodMicroService.list-315"><a href="#PumpWoodMicroService.list-315"><span class="linenos">315</span></a><span class="sd">            operator is passed.</span>
</span><span id="PumpWoodMicroService.list-316"><a href="#PumpWoodMicroService.list-316"><span class="linenos">316</span></a><span class="sd">        - **__gt:** Check if value is greter then argument.</span>
</span><span id="PumpWoodMicroService.list-317"><a href="#PumpWoodMicroService.list-317"><span class="linenos">317</span></a><span class="sd">        - **__lt:** Check if value is less then argument.</span>
</span><span id="PumpWoodMicroService.list-318"><a href="#PumpWoodMicroService.list-318"><span class="linenos">318</span></a><span class="sd">        - **__gte:** Check if value is greter or equal then argument.</span>
</span><span id="PumpWoodMicroService.list-319"><a href="#PumpWoodMicroService.list-319"><span class="linenos">319</span></a><span class="sd">        - **__lte:** Check if value is less or equal then argument.</span>
</span><span id="PumpWoodMicroService.list-320"><a href="#PumpWoodMicroService.list-320"><span class="linenos">320</span></a><span class="sd">        - **__in:** Check if value is at a list, the argument of this operator</span>
</span><span id="PumpWoodMicroService.list-321"><a href="#PumpWoodMicroService.list-321"><span class="linenos">321</span></a><span class="sd">            must be a list.</span>
</span><span id="PumpWoodMicroService.list-322"><a href="#PumpWoodMicroService.list-322"><span class="linenos">322</span></a>
</span><span id="PumpWoodMicroService.list-323"><a href="#PumpWoodMicroService.list-323"><span class="linenos">323</span></a><span class="sd">        ### Text field operators</span>
</span><span id="PumpWoodMicroService.list-324"><a href="#PumpWoodMicroService.list-324"><span class="linenos">324</span></a><span class="sd">        - **__contains:** Check if value contains a string. It is case and</span>
</span><span id="PumpWoodMicroService.list-325"><a href="#PumpWoodMicroService.list-325"><span class="linenos">325</span></a><span class="sd">            accent sensitive.</span>
</span><span id="PumpWoodMicroService.list-326"><a href="#PumpWoodMicroService.list-326"><span class="linenos">326</span></a><span class="sd">        - **__icontains:** Check if a values contains a string, It is case</span>
</span><span id="PumpWoodMicroService.list-327"><a href="#PumpWoodMicroService.list-327"><span class="linenos">327</span></a><span class="sd">            insensitive and accent sensitive.</span>
</span><span id="PumpWoodMicroService.list-328"><a href="#PumpWoodMicroService.list-328"><span class="linenos">328</span></a><span class="sd">        - **__unaccent_icontains:** Check if a values contains a string, It is</span>
</span><span id="PumpWoodMicroService.list-329"><a href="#PumpWoodMicroService.list-329"><span class="linenos">329</span></a><span class="sd">            case insensitive and accent insensitive (consider a, à, á, ã, ...</span>
</span><span id="PumpWoodMicroService.list-330"><a href="#PumpWoodMicroService.list-330"><span class="linenos">330</span></a><span class="sd">            the same).</span>
</span><span id="PumpWoodMicroService.list-331"><a href="#PumpWoodMicroService.list-331"><span class="linenos">331</span></a><span class="sd">        - **__exact:** Same as __eq or not setting operator.</span>
</span><span id="PumpWoodMicroService.list-332"><a href="#PumpWoodMicroService.list-332"><span class="linenos">332</span></a><span class="sd">        - **__iexact:** Same as __eq, but case insensitive and</span>
</span><span id="PumpWoodMicroService.list-333"><a href="#PumpWoodMicroService.list-333"><span class="linenos">333</span></a><span class="sd">            accent sensitive.</span>
</span><span id="PumpWoodMicroService.list-334"><a href="#PumpWoodMicroService.list-334"><span class="linenos">334</span></a><span class="sd">        - **__unaccent_iexact:** Same as __eq, but case insensitive and</span>
</span><span id="PumpWoodMicroService.list-335"><a href="#PumpWoodMicroService.list-335"><span class="linenos">335</span></a><span class="sd">            accent insensitive.</span>
</span><span id="PumpWoodMicroService.list-336"><a href="#PumpWoodMicroService.list-336"><span class="linenos">336</span></a><span class="sd">        - **__startswith:** Check if the value stats with a sub-string.</span>
</span><span id="PumpWoodMicroService.list-337"><a href="#PumpWoodMicroService.list-337"><span class="linenos">337</span></a><span class="sd">            Case sensitive and accent sensitive.</span>
</span><span id="PumpWoodMicroService.list-338"><a href="#PumpWoodMicroService.list-338"><span class="linenos">338</span></a><span class="sd">        - **__istartswith:** Check if the value stats with a sub-string.</span>
</span><span id="PumpWoodMicroService.list-339"><a href="#PumpWoodMicroService.list-339"><span class="linenos">339</span></a><span class="sd">            Case insensitive and accent sensitive.</span>
</span><span id="PumpWoodMicroService.list-340"><a href="#PumpWoodMicroService.list-340"><span class="linenos">340</span></a><span class="sd">        - **__unaccent_istartswith:** Check if the value stats with a</span>
</span><span id="PumpWoodMicroService.list-341"><a href="#PumpWoodMicroService.list-341"><span class="linenos">341</span></a><span class="sd">            sub-string. Case insensitive and accent insensitive.</span>
</span><span id="PumpWoodMicroService.list-342"><a href="#PumpWoodMicroService.list-342"><span class="linenos">342</span></a><span class="sd">        - **__endswith:** Check if the value ends with a sub-string. Case</span>
</span><span id="PumpWoodMicroService.list-343"><a href="#PumpWoodMicroService.list-343"><span class="linenos">343</span></a><span class="sd">            sensitive and accent sensitive.</span>
</span><span id="PumpWoodMicroService.list-344"><a href="#PumpWoodMicroService.list-344"><span class="linenos">344</span></a><span class="sd">        - **__iendswith:** Check if the value ends with a sub-string. Case</span>
</span><span id="PumpWoodMicroService.list-345"><a href="#PumpWoodMicroService.list-345"><span class="linenos">345</span></a><span class="sd">            insensitive and accent sensitive.</span>
</span><span id="PumpWoodMicroService.list-346"><a href="#PumpWoodMicroService.list-346"><span class="linenos">346</span></a><span class="sd">        - **__unaccent_iendswith:** Check if the value ends with a sub-string.</span>
</span><span id="PumpWoodMicroService.list-347"><a href="#PumpWoodMicroService.list-347"><span class="linenos">347</span></a><span class="sd">            Case insensitive and accent insensitive.</span>
</span><span id="PumpWoodMicroService.list-348"><a href="#PumpWoodMicroService.list-348"><span class="linenos">348</span></a>
</span><span id="PumpWoodMicroService.list-349"><a href="#PumpWoodMicroService.list-349"><span class="linenos">349</span></a><span class="sd">        ### Null operators</span>
</span><span id="PumpWoodMicroService.list-350"><a href="#PumpWoodMicroService.list-350"><span class="linenos">350</span></a><span class="sd">        - **__isnull:** Check if field is null, it uses as argument a `boolean`</span>
</span><span id="PumpWoodMicroService.list-351"><a href="#PumpWoodMicroService.list-351"><span class="linenos">351</span></a><span class="sd">            value false will return all non NULL values and true will return</span>
</span><span id="PumpWoodMicroService.list-352"><a href="#PumpWoodMicroService.list-352"><span class="linenos">352</span></a><span class="sd">            NULL values.</span>
</span><span id="PumpWoodMicroService.list-353"><a href="#PumpWoodMicroService.list-353"><span class="linenos">353</span></a>
</span><span id="PumpWoodMicroService.list-354"><a href="#PumpWoodMicroService.list-354"><span class="linenos">354</span></a><span class="sd">        ### Date and datetime operators:</span>
</span><span id="PumpWoodMicroService.list-355"><a href="#PumpWoodMicroService.list-355"><span class="linenos">355</span></a><span class="sd">        - **__range:** Receive as argument a list of two elements and return</span>
</span><span id="PumpWoodMicroService.list-356"><a href="#PumpWoodMicroService.list-356"><span class="linenos">356</span></a><span class="sd">            objects that field dates are between those values.</span>
</span><span id="PumpWoodMicroService.list-357"><a href="#PumpWoodMicroService.list-357"><span class="linenos">357</span></a><span class="sd">        - **__year:** Return object that date field value year is equal to</span>
</span><span id="PumpWoodMicroService.list-358"><a href="#PumpWoodMicroService.list-358"><span class="linenos">358</span></a><span class="sd">            argument.</span>
</span><span id="PumpWoodMicroService.list-359"><a href="#PumpWoodMicroService.list-359"><span class="linenos">359</span></a><span class="sd">        - **__month:** Return object that date field value month is equal to</span>
</span><span id="PumpWoodMicroService.list-360"><a href="#PumpWoodMicroService.list-360"><span class="linenos">360</span></a><span class="sd">            argument.</span>
</span><span id="PumpWoodMicroService.list-361"><a href="#PumpWoodMicroService.list-361"><span class="linenos">361</span></a><span class="sd">        - **__day:** Return object that date field value day is equal to</span>
</span><span id="PumpWoodMicroService.list-362"><a href="#PumpWoodMicroService.list-362"><span class="linenos">362</span></a><span class="sd">            argument.</span>
</span><span id="PumpWoodMicroService.list-363"><a href="#PumpWoodMicroService.list-363"><span class="linenos">363</span></a>
</span><span id="PumpWoodMicroService.list-364"><a href="#PumpWoodMicroService.list-364"><span class="linenos">364</span></a><span class="sd">        ### Dictionary fields operators:</span>
</span><span id="PumpWoodMicroService.list-365"><a href="#PumpWoodMicroService.list-365"><span class="linenos">365</span></a><span class="sd">        - **__json_contained_by:**</span>
</span><span id="PumpWoodMicroService.list-366"><a href="#PumpWoodMicroService.list-366"><span class="linenos">366</span></a><span class="sd">            Uses the function [contained_by](https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.contained_by)</span>
</span><span id="PumpWoodMicroService.list-367"><a href="#PumpWoodMicroService.list-367"><span class="linenos">367</span></a><span class="sd">            from SQLAlchemy to test if keys are a proper subset of the keys of</span>
</span><span id="PumpWoodMicroService.list-368"><a href="#PumpWoodMicroService.list-368"><span class="linenos">368</span></a><span class="sd">            the argument jsonb expression (extracted from SQLAlchemy). The</span>
</span><span id="PumpWoodMicroService.list-369"><a href="#PumpWoodMicroService.list-369"><span class="linenos">369</span></a><span class="sd">            argument is a list.</span>
</span><span id="PumpWoodMicroService.list-370"><a href="#PumpWoodMicroService.list-370"><span class="linenos">370</span></a><span class="sd">        - **__json_has_any:**</span>
</span><span id="PumpWoodMicroService.list-371"><a href="#PumpWoodMicroService.list-371"><span class="linenos">371</span></a><span class="sd">            Uses the function [has_any](https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.has_any)</span>
</span><span id="PumpWoodMicroService.list-372"><a href="#PumpWoodMicroService.list-372"><span class="linenos">372</span></a><span class="sd">            from SQLAlchemy to test for presence of a key. Note that the key</span>
</span><span id="PumpWoodMicroService.list-373"><a href="#PumpWoodMicroService.list-373"><span class="linenos">373</span></a><span class="sd">            may be a SQLA expression. (extracted from SQLAlchemy). The</span>
</span><span id="PumpWoodMicroService.list-374"><a href="#PumpWoodMicroService.list-374"><span class="linenos">374</span></a><span class="sd">            argument is a list.</span>
</span><span id="PumpWoodMicroService.list-375"><a href="#PumpWoodMicroService.list-375"><span class="linenos">375</span></a><span class="sd">        - **__json_has_key:**</span>
</span><span id="PumpWoodMicroService.list-376"><a href="#PumpWoodMicroService.list-376"><span class="linenos">376</span></a><span class="sd">            Uses the function [has_key](https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.has_key)</span>
</span><span id="PumpWoodMicroService.list-377"><a href="#PumpWoodMicroService.list-377"><span class="linenos">377</span></a><span class="sd">            from SQLAlchemy to Test for presence of a key. Note that the key</span>
</span><span id="PumpWoodMicroService.list-378"><a href="#PumpWoodMicroService.list-378"><span class="linenos">378</span></a><span class="sd">            may be a SQLA expression. The argument is a str.</span>
</span><span id="PumpWoodMicroService.list-379"><a href="#PumpWoodMicroService.list-379"><span class="linenos">379</span></a>
</span><span id="PumpWoodMicroService.list-380"><a href="#PumpWoodMicroService.list-380"><span class="linenos">380</span></a><span class="sd">        ### Text similarity operators</span>
</span><span id="PumpWoodMicroService.list-381"><a href="#PumpWoodMicroService.list-381"><span class="linenos">381</span></a><span class="sd">        To use similariry querys on Postgres it is necessary to `pg_trgm` be</span>
</span><span id="PumpWoodMicroService.list-382"><a href="#PumpWoodMicroService.list-382"><span class="linenos">382</span></a><span class="sd">        instaled on server. Check [oficial documentation]</span>
</span><span id="PumpWoodMicroService.list-383"><a href="#PumpWoodMicroService.list-383"><span class="linenos">383</span></a><span class="sd">        (https://www.postgresql.org/docs/current/pgtrgm.html).</span>
</span><span id="PumpWoodMicroService.list-384"><a href="#PumpWoodMicroService.list-384"><span class="linenos">384</span></a>
</span><span id="PumpWoodMicroService.list-385"><a href="#PumpWoodMicroService.list-385"><span class="linenos">385</span></a><span class="sd">        - **__similarity:** Check if two strings are similar uses the `%`</span>
</span><span id="PumpWoodMicroService.list-386"><a href="#PumpWoodMicroService.list-386"><span class="linenos">386</span></a><span class="sd">            operador.</span>
</span><span id="PumpWoodMicroService.list-387"><a href="#PumpWoodMicroService.list-387"><span class="linenos">387</span></a><span class="sd">        - **__word_similar_left:** Check if two strings are similar uses the</span>
</span><span id="PumpWoodMicroService.list-388"><a href="#PumpWoodMicroService.list-388"><span class="linenos">388</span></a><span class="sd">            `&lt;%` operador.</span>
</span><span id="PumpWoodMicroService.list-389"><a href="#PumpWoodMicroService.list-389"><span class="linenos">389</span></a><span class="sd">        - **__word_similar_right:** Check if two strings are similar uses the</span>
</span><span id="PumpWoodMicroService.list-390"><a href="#PumpWoodMicroService.list-390"><span class="linenos">390</span></a><span class="sd">            `%&gt;` operador.</span>
</span><span id="PumpWoodMicroService.list-391"><a href="#PumpWoodMicroService.list-391"><span class="linenos">391</span></a><span class="sd">        - **__strict_word__similar_left:** Check if two strings are similar</span>
</span><span id="PumpWoodMicroService.list-392"><a href="#PumpWoodMicroService.list-392"><span class="linenos">392</span></a><span class="sd">            uses the `&lt;&lt;%` operador.</span>
</span><span id="PumpWoodMicroService.list-393"><a href="#PumpWoodMicroService.list-393"><span class="linenos">393</span></a><span class="sd">        - **__strict_word__similar_right:** Check if two strings are similar</span>
</span><span id="PumpWoodMicroService.list-394"><a href="#PumpWoodMicroService.list-394"><span class="linenos">394</span></a><span class="sd">            uses the `%&gt;&gt;` operador.</span>
</span><span id="PumpWoodMicroService.list-395"><a href="#PumpWoodMicroService.list-395"><span class="linenos">395</span></a>
</span><span id="PumpWoodMicroService.list-396"><a href="#PumpWoodMicroService.list-396"><span class="linenos">396</span></a><span class="sd">        Some usage examples:</span>
</span><span id="PumpWoodMicroService.list-397"><a href="#PumpWoodMicroService.list-397"><span class="linenos">397</span></a><span class="sd">        ```python</span>
</span><span id="PumpWoodMicroService.list-398"><a href="#PumpWoodMicroService.list-398"><span class="linenos">398</span></a><span class="sd">        # Return the first 3 results ordered decreasing acording to `time` and</span>
</span><span id="PumpWoodMicroService.list-399"><a href="#PumpWoodMicroService.list-399"><span class="linenos">399</span></a><span class="sd">        # them ordered by `modeling_unit_id`. Results must have time greater</span>
</span><span id="PumpWoodMicroService.list-400"><a href="#PumpWoodMicroService.list-400"><span class="linenos">400</span></a><span class="sd">        # or equal to 2017-01-01 and less or equal to 2017-06-01. It also</span>
</span><span id="PumpWoodMicroService.list-401"><a href="#PumpWoodMicroService.list-401"><span class="linenos">401</span></a><span class="sd">        # must have attribute_id equal to 6 and not contains modeling_unit_id</span>
</span><span id="PumpWoodMicroService.list-402"><a href="#PumpWoodMicroService.list-402"><span class="linenos">402</span></a><span class="sd">        # 3 or 4.</span>
</span><span id="PumpWoodMicroService.list-403"><a href="#PumpWoodMicroService.list-403"><span class="linenos">403</span></a><span class="sd">        microservice.list(</span>
</span><span id="PumpWoodMicroService.list-404"><a href="#PumpWoodMicroService.list-404"><span class="linenos">404</span></a><span class="sd">            model_class=&quot;DatabaseVariable&quot;,</span>
</span><span id="PumpWoodMicroService.list-405"><a href="#PumpWoodMicroService.list-405"><span class="linenos">405</span></a><span class="sd">            filter_dict={</span>
</span><span id="PumpWoodMicroService.list-406"><a href="#PumpWoodMicroService.list-406"><span class="linenos">406</span></a><span class="sd">                &quot;time__gte&quot;: &quot;2017-01-01 00:00:00&quot;,</span>
</span><span id="PumpWoodMicroService.list-407"><a href="#PumpWoodMicroService.list-407"><span class="linenos">407</span></a><span class="sd">                &quot;time__lte&quot;: &quot;2017-06-01 00:00:00&quot;,</span>
</span><span id="PumpWoodMicroService.list-408"><a href="#PumpWoodMicroService.list-408"><span class="linenos">408</span></a><span class="sd">                &quot;attribute_id&quot;: 6},</span>
</span><span id="PumpWoodMicroService.list-409"><a href="#PumpWoodMicroService.list-409"><span class="linenos">409</span></a><span class="sd">            exclude_dict={</span>
</span><span id="PumpWoodMicroService.list-410"><a href="#PumpWoodMicroService.list-410"><span class="linenos">410</span></a><span class="sd">                &quot;modeling_unit_id__in&quot;: [3, 4]},</span>
</span><span id="PumpWoodMicroService.list-411"><a href="#PumpWoodMicroService.list-411"><span class="linenos">411</span></a><span class="sd">            order_by=[&quot;-time&quot;, &quot;modeling_unit_id&quot;],</span>
</span><span id="PumpWoodMicroService.list-412"><a href="#PumpWoodMicroService.list-412"><span class="linenos">412</span></a><span class="sd">            limit=3,</span>
</span><span id="PumpWoodMicroService.list-413"><a href="#PumpWoodMicroService.list-413"><span class="linenos">413</span></a><span class="sd">            fields=[&quot;pk&quot;, &quot;model_class&quot;, &quot;time&quot;, &quot;modeling_unit_id&quot;, &quot;value&quot;])</span>
</span><span id="PumpWoodMicroService.list-414"><a href="#PumpWoodMicroService.list-414"><span class="linenos">414</span></a>
</span><span id="PumpWoodMicroService.list-415"><a href="#PumpWoodMicroService.list-415"><span class="linenos">415</span></a><span class="sd">        # Return all elements that dimensions field has a key type with</span>
</span><span id="PumpWoodMicroService.list-416"><a href="#PumpWoodMicroService.list-416"><span class="linenos">416</span></a><span class="sd">        # value contains `selling` insensitive to case and accent.</span>
</span><span id="PumpWoodMicroService.list-417"><a href="#PumpWoodMicroService.list-417"><span class="linenos">417</span></a><span class="sd">        microservice.list(</span>
</span><span id="PumpWoodMicroService.list-418"><a href="#PumpWoodMicroService.list-418"><span class="linenos">418</span></a><span class="sd">            model_class=&quot;DatabaseAttribute&quot;,</span>
</span><span id="PumpWoodMicroService.list-419"><a href="#PumpWoodMicroService.list-419"><span class="linenos">419</span></a><span class="sd">            filter_dict={</span>
</span><span id="PumpWoodMicroService.list-420"><a href="#PumpWoodMicroService.list-420"><span class="linenos">420</span></a><span class="sd">                &quot;dimensions-&gt;type__unaccent_icontains&quot;: &quot;selling&quot;})</span>
</span><span id="PumpWoodMicroService.list-421"><a href="#PumpWoodMicroService.list-421"><span class="linenos">421</span></a><span class="sd">        ```</span>
</span><span id="PumpWoodMicroService.list-422"><a href="#PumpWoodMicroService.list-422"><span class="linenos">422</span></a>
</span><span id="PumpWoodMicroService.list-423"><a href="#PumpWoodMicroService.list-423"><span class="linenos">423</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.list-424"><a href="#PumpWoodMicroService.list-424"><span class="linenos">424</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.list-425"><a href="#PumpWoodMicroService.list-425"><span class="linenos">425</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="PumpWoodMicroService.list-426"><a href="#PumpWoodMicroService.list-426"><span class="linenos">426</span></a><span class="sd">            filter_dict:</span>
</span><span id="PumpWoodMicroService.list-427"><a href="#PumpWoodMicroService.list-427"><span class="linenos">427</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="PumpWoodMicroService.list-428"><a href="#PumpWoodMicroService.list-428"><span class="linenos">428</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService.list-429"><a href="#PumpWoodMicroService.list-429"><span class="linenos">429</span></a><span class="sd">            exclude_dict:</span>
</span><span id="PumpWoodMicroService.list-430"><a href="#PumpWoodMicroService.list-430"><span class="linenos">430</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="PumpWoodMicroService.list-431"><a href="#PumpWoodMicroService.list-431"><span class="linenos">431</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService.list-432"><a href="#PumpWoodMicroService.list-432"><span class="linenos">432</span></a><span class="sd">            order_by: Order results acording to list of strings</span>
</span><span id="PumpWoodMicroService.list-433"><a href="#PumpWoodMicroService.list-433"><span class="linenos">433</span></a><span class="sd">                correspondent to fields. It is possible to use &#39;-&#39; at the</span>
</span><span id="PumpWoodMicroService.list-434"><a href="#PumpWoodMicroService.list-434"><span class="linenos">434</span></a><span class="sd">                begginng of the field name for reverse ordering. Ex.:</span>
</span><span id="PumpWoodMicroService.list-435"><a href="#PumpWoodMicroService.list-435"><span class="linenos">435</span></a><span class="sd">                [&#39;description&#39;] for accendent ordering and [&#39;-description&#39;]</span>
</span><span id="PumpWoodMicroService.list-436"><a href="#PumpWoodMicroService.list-436"><span class="linenos">436</span></a><span class="sd">                for descendent ordering.</span>
</span><span id="PumpWoodMicroService.list-437"><a href="#PumpWoodMicroService.list-437"><span class="linenos">437</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.list-438"><a href="#PumpWoodMicroService.list-438"><span class="linenos">438</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.list-439"><a href="#PumpWoodMicroService.list-439"><span class="linenos">439</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.list-440"><a href="#PumpWoodMicroService.list-440"><span class="linenos">440</span></a><span class="sd">            fields (list):</span>
</span><span id="PumpWoodMicroService.list-441"><a href="#PumpWoodMicroService.list-441"><span class="linenos">441</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="PumpWoodMicroService.list-442"><a href="#PumpWoodMicroService.list-442"><span class="linenos">442</span></a><span class="sd">            default_fields (bool):</span>
</span><span id="PumpWoodMicroService.list-443"><a href="#PumpWoodMicroService.list-443"><span class="linenos">443</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="PumpWoodMicroService.list-444"><a href="#PumpWoodMicroService.list-444"><span class="linenos">444</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="PumpWoodMicroService.list-445"><a href="#PumpWoodMicroService.list-445"><span class="linenos">445</span></a><span class="sd">            limit (int):</span>
</span><span id="PumpWoodMicroService.list-446"><a href="#PumpWoodMicroService.list-446"><span class="linenos">446</span></a><span class="sd">                Set the limit of elements of the returned query. By default,</span>
</span><span id="PumpWoodMicroService.list-447"><a href="#PumpWoodMicroService.list-447"><span class="linenos">447</span></a><span class="sd">                backend usually return 50 elements.</span>
</span><span id="PumpWoodMicroService.list-448"><a href="#PumpWoodMicroService.list-448"><span class="linenos">448</span></a><span class="sd">            foreign_key_fields (bool):</span>
</span><span id="PumpWoodMicroService.list-449"><a href="#PumpWoodMicroService.list-449"><span class="linenos">449</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="PumpWoodMicroService.list-450"><a href="#PumpWoodMicroService.list-450"><span class="linenos">450</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="PumpWoodMicroService.list-451"><a href="#PumpWoodMicroService.list-451"><span class="linenos">451</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="PumpWoodMicroService.list-452"><a href="#PumpWoodMicroService.list-452"><span class="linenos">452</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="PumpWoodMicroService.list-453"><a href="#PumpWoodMicroService.list-453"><span class="linenos">453</span></a><span class="sd">            **kwargs:</span>
</span><span id="PumpWoodMicroService.list-454"><a href="#PumpWoodMicroService.list-454"><span class="linenos">454</span></a><span class="sd">                Other parameters for compatibility.</span>
</span><span id="PumpWoodMicroService.list-455"><a href="#PumpWoodMicroService.list-455"><span class="linenos">455</span></a>
</span><span id="PumpWoodMicroService.list-456"><a href="#PumpWoodMicroService.list-456"><span class="linenos">456</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.list-457"><a href="#PumpWoodMicroService.list-457"><span class="linenos">457</span></a><span class="sd">          Containing objects serialized by list Serializer.</span>
</span><span id="PumpWoodMicroService.list-458"><a href="#PumpWoodMicroService.list-458"><span class="linenos">458</span></a>
</span><span id="PumpWoodMicroService.list-459"><a href="#PumpWoodMicroService.list-459"><span class="linenos">459</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.list-460"><a href="#PumpWoodMicroService.list-460"><span class="linenos">460</span></a><span class="sd">          No especific raises.</span>
</span><span id="PumpWoodMicroService.list-461"><a href="#PumpWoodMicroService.list-461"><span class="linenos">461</span></a><span class="sd">        &quot;&quot;&quot;</span> <span class="c1"># NOQA</span>
</span><span id="PumpWoodMicroService.list-462"><a href="#PumpWoodMicroService.list-462"><span class="linenos">462</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list-463"><a href="#PumpWoodMicroService.list-463"><span class="linenos">463</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PumpWoodMicroService.list-464"><a href="#PumpWoodMicroService.list-464"><span class="linenos">464</span></a>            <span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list-465"><a href="#PumpWoodMicroService.list-465"><span class="linenos">465</span></a>            <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="n">order_by</span><span class="p">,</span> <span class="s1">&#39;default_fields&#39;</span><span class="p">:</span> <span class="n">default_fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list-466"><a href="#PumpWoodMicroService.list-466"><span class="linenos">466</span></a>            <span class="s1">&#39;limit&#39;</span><span class="p">:</span> <span class="n">limit</span><span class="p">,</span> <span class="s1">&#39;foreign_key_fields&#39;</span><span class="p">:</span> <span class="n">foreign_key_fields</span><span class="p">}</span>
</span><span id="PumpWoodMicroService.list-467"><a href="#PumpWoodMicroService.list-467"><span class="linenos">467</span></a>        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list-468"><a href="#PumpWoodMicroService.list-468"><span class="linenos">468</span></a>            <span class="n">post_data</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>
</span><span id="PumpWoodMicroService.list-469"><a href="#PumpWoodMicroService.list-469"><span class="linenos">469</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.list-470"><a href="#PumpWoodMicroService.list-470"><span class="linenos">470</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>List objects with pagination.</p>

<p>List end-point (resumed data) of PumpWood like systems,
results will be paginated. To get next pag, send all recived pk at
exclude dict (ex.: <code>exclude_dict={pk__in: [1,2,...,30]}</code>).</p>

<p>It is possible to return foreign keys objects associated with
<code>model_class</code>. Use this with carefull since increase the backend
infrastructure consumption, each object is a retrieve call per
foreign key (otimization in progress).</p>

<p>It is possible to use diferent operators using <code>__</code> after the name
of the field, some of the operators avaiable:</p>

<h3 id="general-operators">General operators</h3>

<ul>
<li><strong>__eq:</strong> Check if the value is the same, same results if no
operator is passed.</li>
<li><strong>__gt:</strong> Check if value is greter then argument.</li>
<li><strong>__lt:</strong> Check if value is less then argument.</li>
<li><strong>__gte:</strong> Check if value is greter or equal then argument.</li>
<li><strong>__lte:</strong> Check if value is less or equal then argument.</li>
<li><strong>__in:</strong> Check if value is at a list, the argument of this operator
must be a list.</li>
</ul>

<h3 id="text-field-operators">Text field operators</h3>

<ul>
<li><strong>__contains:</strong> Check if value contains a string. It is case and
accent sensitive.</li>
<li><strong>__icontains:</strong> Check if a values contains a string, It is case
insensitive and accent sensitive.</li>
<li><strong>__unaccent_icontains:</strong> Check if a values contains a string, It is
case insensitive and accent insensitive (consider a, à, á, ã, ...
the same).</li>
<li><strong>__exact:</strong> Same as __eq or not setting operator.</li>
<li><strong>__iexact:</strong> Same as __eq, but case insensitive and
accent sensitive.</li>
<li><strong>__unaccent_iexact:</strong> Same as __eq, but case insensitive and
accent insensitive.</li>
<li><strong>__startswith:</strong> Check if the value stats with a sub-string.
Case sensitive and accent sensitive.</li>
<li><strong>__istartswith:</strong> Check if the value stats with a sub-string.
Case insensitive and accent sensitive.</li>
<li><strong>__unaccent_istartswith:</strong> Check if the value stats with a
sub-string. Case insensitive and accent insensitive.</li>
<li><strong>__endswith:</strong> Check if the value ends with a sub-string. Case
sensitive and accent sensitive.</li>
<li><strong>__iendswith:</strong> Check if the value ends with a sub-string. Case
insensitive and accent sensitive.</li>
<li><strong>__unaccent_iendswith:</strong> Check if the value ends with a sub-string.
Case insensitive and accent insensitive.</li>
</ul>

<h3 id="null-operators">Null operators</h3>

<ul>
<li><strong>__isnull:</strong> Check if field is null, it uses as argument a <code>boolean</code>
value false will return all non NULL values and true will return
NULL values.</li>
</ul>

<h3 id="date-and-datetime-operators">Date and datetime operators:</h3>

<ul>
<li><strong>__range:</strong> Receive as argument a list of two elements and return
objects that field dates are between those values.</li>
<li><strong>__year:</strong> Return object that date field value year is equal to
argument.</li>
<li><strong>__month:</strong> Return object that date field value month is equal to
argument.</li>
<li><strong>__day:</strong> Return object that date field value day is equal to
argument.</li>
</ul>

<h3 id="dictionary-fields-operators">Dictionary fields operators:</h3>

<ul>
<li><strong>__json_contained_by:</strong>
Uses the function <a href="https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.contained_by">contained_by</a>
from SQLAlchemy to test if keys are a proper subset of the keys of
the argument jsonb expression (extracted from SQLAlchemy). The
argument is a list.</li>
<li><strong>__json_has_any:</strong>
Uses the function <a href="https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.has_any">has_any</a>
from SQLAlchemy to test for presence of a key. Note that the key
may be a SQLA expression. (extracted from SQLAlchemy). The
argument is a list.</li>
<li><strong>__json_has_key:</strong>
Uses the function <a href="https://docs.sqlalchemy.org/en/20/dialects/postgresql.html#sqlalchemy.dialects.postgresql.JSONB.Comparator.has_key">has_key</a>
from SQLAlchemy to Test for presence of a key. Note that the key
may be a SQLA expression. The argument is a str.</li>
</ul>

<h3 id="text-similarity-operators">Text similarity operators</h3>

<p>To use similariry querys on Postgres it is necessary to <code>pg_trgm</code> be
instaled on server. Check [oficial documentation]
(https://www.postgresql.org/docs/current/pgtrgm.html).</p>

<ul>
<li><strong>__similarity:</strong> Check if two strings are similar uses the <code>%</code>
operador.</li>
<li><strong>__word_similar_left:</strong> Check if two strings are similar uses the
<code>&lt;%</code> operador.</li>
<li><strong>__word_similar_right:</strong> Check if two strings are similar uses the
<code>%&gt;</code> operador.</li>
<li><strong>__strict_word__similar_left:</strong> Check if two strings are similar
uses the <code>&lt;&lt;%</code> operador.</li>
<li><strong>__strict_word__similar_right:</strong> Check if two strings are similar
uses the <code>%&gt;&gt;</code> operador.</li>
</ul>

<p>Some usage examples:</p>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="c1"># Return the first 3 results ordered decreasing acording to `time` and</span>
<span class="c1"># them ordered by `modeling_unit_id`. Results must have time greater</span>
<span class="c1"># or equal to 2017-01-01 and less or equal to 2017-06-01. It also</span>
<span class="c1"># must have attribute_id equal to 6 and not contains modeling_unit_id</span>
<span class="c1"># 3 or 4.</span>
<span class="n">microservice</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
    <span class="n">model_class</span><span class="o">=</span><span class="s2">&quot;DatabaseVariable&quot;</span><span class="p">,</span>
    <span class="n">filter_dict</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;time__gte&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-01-01 00:00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;time__lte&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-06-01 00:00:00&quot;</span><span class="p">,</span>
        <span class="s2">&quot;attribute_id&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">},</span>
    <span class="n">exclude_dict</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;modeling_unit_id__in&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="n">order_by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;-time&quot;</span><span class="p">,</span> <span class="s2">&quot;modeling_unit_id&quot;</span><span class="p">],</span>
    <span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">,</span> <span class="s2">&quot;model_class&quot;</span><span class="p">,</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="s2">&quot;modeling_unit_id&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">])</span>

<span class="c1"># Return all elements that dimensions field has a key type with</span>
<span class="c1"># value contains `selling` insensitive to case and accent.</span>
<span class="n">microservice</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
    <span class="n">model_class</span><span class="o">=</span><span class="s2">&quot;DatabaseAttribute&quot;</span><span class="p">,</span>
    <span class="n">filter_dict</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;dimensions-&gt;type__unaccent_icontains&quot;</span><span class="p">:</span> <span class="s2">&quot;selling&quot;</span><span class="p">})</span>
</code></pre>
</div>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class of the end-point</li>
<li><strong>filter_dict:</strong>  Filter dict to be used at the query. Filter elements from query
return that satifies all statements of the dictonary.</li>
<li><strong>exclude_dict:</strong>  Exclude dict to be used at the query. Remove elements from
query return that satifies all statements of the dictonary.</li>
<li><strong>order_by:</strong>  Order results acording to list of strings
correspondent to fields. It is possible to use '-' at the
begginng of the field name for reverse ordering. Ex.:
['description'] for accendent ordering and ['-description']
for descendent ordering.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
<li><strong>fields (list):</strong>  Set the fields to be returned by the list end-point.</li>
<li><strong>default_fields (bool):</strong>  Boolean, if true and fields arguments None will return the
default fields set for list by the backend.</li>
<li><strong>limit (int):</strong>  Set the limit of elements of the returned query. By default,
backend usually return 50 elements.</li>
<li><strong>foreign_key_fields (bool):</strong>  Return forenging key objects. It will return the fk
corresponding object. Ex: <code>created_by_id</code> reference to
a user <code>model_class</code> the correspondent to User will be
returned at <code>created_by</code>.</li>
<li><strong>**kwargs:</strong>  Other parameters for compatibility.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Containing objects serialized by list Serializer.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No especific raises.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.list_by_chunks" class="classattr">
                                        <input id="PumpWoodMicroService.list_by_chunks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_by_chunks</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fields</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n"><a href="#PumpWoodMicroService.list">PumpWoodMicroService.list</a></span><span class="o">&gt;</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50000</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.list_by_chunks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.list_by_chunks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.list_by_chunks-472"><a href="#PumpWoodMicroService.list_by_chunks-472"><span class="linenos">472</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_by_chunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService.list_by_chunks-473"><a href="#PumpWoodMicroService.list_by_chunks-473"><span class="linenos">473</span></a>                       <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_by_chunks-474"><a href="#PumpWoodMicroService.list_by_chunks-474"><span class="linenos">474</span></a>                       <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_by_chunks-475"><a href="#PumpWoodMicroService.list_by_chunks-475"><span class="linenos">475</span></a>                       <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50000</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-476"><a href="#PumpWoodMicroService.list_by_chunks-476"><span class="linenos">476</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List object fetching them by chucks using pk to paginate.</span>
</span><span id="PumpWoodMicroService.list_by_chunks-477"><a href="#PumpWoodMicroService.list_by_chunks-477"><span class="linenos">477</span></a>
</span><span id="PumpWoodMicroService.list_by_chunks-478"><a href="#PumpWoodMicroService.list_by_chunks-478"><span class="linenos">478</span></a><span class="sd">        List data by chunck to load by datasets without breaking the backend</span>
</span><span id="PumpWoodMicroService.list_by_chunks-479"><a href="#PumpWoodMicroService.list_by_chunks-479"><span class="linenos">479</span></a><span class="sd">        or receive server timeout. It load chunks orderring the results using</span>
</span><span id="PumpWoodMicroService.list_by_chunks-480"><a href="#PumpWoodMicroService.list_by_chunks-480"><span class="linenos">480</span></a><span class="sd">        id of the tables, it can be changed but it should be unique otherwise</span>
</span><span id="PumpWoodMicroService.list_by_chunks-481"><a href="#PumpWoodMicroService.list_by_chunks-481"><span class="linenos">481</span></a><span class="sd">        unexpected results may occur.</span>
</span><span id="PumpWoodMicroService.list_by_chunks-482"><a href="#PumpWoodMicroService.list_by_chunks-482"><span class="linenos">482</span></a>
</span><span id="PumpWoodMicroService.list_by_chunks-483"><a href="#PumpWoodMicroService.list_by_chunks-483"><span class="linenos">483</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-484"><a href="#PumpWoodMicroService.list_by_chunks-484"><span class="linenos">484</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-485"><a href="#PumpWoodMicroService.list_by_chunks-485"><span class="linenos">485</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="PumpWoodMicroService.list_by_chunks-486"><a href="#PumpWoodMicroService.list_by_chunks-486"><span class="linenos">486</span></a><span class="sd">            filter_dict:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-487"><a href="#PumpWoodMicroService.list_by_chunks-487"><span class="linenos">487</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="PumpWoodMicroService.list_by_chunks-488"><a href="#PumpWoodMicroService.list_by_chunks-488"><span class="linenos">488</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService.list_by_chunks-489"><a href="#PumpWoodMicroService.list_by_chunks-489"><span class="linenos">489</span></a><span class="sd">            exclude_dict:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-490"><a href="#PumpWoodMicroService.list_by_chunks-490"><span class="linenos">490</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="PumpWoodMicroService.list_by_chunks-491"><a href="#PumpWoodMicroService.list_by_chunks-491"><span class="linenos">491</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService.list_by_chunks-492"><a href="#PumpWoodMicroService.list_by_chunks-492"><span class="linenos">492</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-493"><a href="#PumpWoodMicroService.list_by_chunks-493"><span class="linenos">493</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.list_by_chunks-494"><a href="#PumpWoodMicroService.list_by_chunks-494"><span class="linenos">494</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.list_by_chunks-495"><a href="#PumpWoodMicroService.list_by_chunks-495"><span class="linenos">495</span></a><span class="sd">            fields:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-496"><a href="#PumpWoodMicroService.list_by_chunks-496"><span class="linenos">496</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="PumpWoodMicroService.list_by_chunks-497"><a href="#PumpWoodMicroService.list_by_chunks-497"><span class="linenos">497</span></a><span class="sd">            default_fields:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-498"><a href="#PumpWoodMicroService.list_by_chunks-498"><span class="linenos">498</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="PumpWoodMicroService.list_by_chunks-499"><a href="#PumpWoodMicroService.list_by_chunks-499"><span class="linenos">499</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="PumpWoodMicroService.list_by_chunks-500"><a href="#PumpWoodMicroService.list_by_chunks-500"><span class="linenos">500</span></a><span class="sd">            chunk_size:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-501"><a href="#PumpWoodMicroService.list_by_chunks-501"><span class="linenos">501</span></a><span class="sd">                Number of objects to be fetched each query.</span>
</span><span id="PumpWoodMicroService.list_by_chunks-502"><a href="#PumpWoodMicroService.list_by_chunks-502"><span class="linenos">502</span></a><span class="sd">            **kwargs:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-503"><a href="#PumpWoodMicroService.list_by_chunks-503"><span class="linenos">503</span></a><span class="sd">                Other parameters for compatibility.</span>
</span><span id="PumpWoodMicroService.list_by_chunks-504"><a href="#PumpWoodMicroService.list_by_chunks-504"><span class="linenos">504</span></a>
</span><span id="PumpWoodMicroService.list_by_chunks-505"><a href="#PumpWoodMicroService.list_by_chunks-505"><span class="linenos">505</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-506"><a href="#PumpWoodMicroService.list_by_chunks-506"><span class="linenos">506</span></a><span class="sd">          Containing objects serialized by list Serializer.</span>
</span><span id="PumpWoodMicroService.list_by_chunks-507"><a href="#PumpWoodMicroService.list_by_chunks-507"><span class="linenos">507</span></a>
</span><span id="PumpWoodMicroService.list_by_chunks-508"><a href="#PumpWoodMicroService.list_by_chunks-508"><span class="linenos">508</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-509"><a href="#PumpWoodMicroService.list_by_chunks-509"><span class="linenos">509</span></a><span class="sd">          No especific raises.</span>
</span><span id="PumpWoodMicroService.list_by_chunks-510"><a href="#PumpWoodMicroService.list_by_chunks-510"><span class="linenos">510</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.list_by_chunks-511"><a href="#PumpWoodMicroService.list_by_chunks-511"><span class="linenos">511</span></a>        <span class="n">copy_filter_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">filter_dict</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_by_chunks-512"><a href="#PumpWoodMicroService.list_by_chunks-512"><span class="linenos">512</span></a>
</span><span id="PumpWoodMicroService.list_by_chunks-513"><a href="#PumpWoodMicroService.list_by_chunks-513"><span class="linenos">513</span></a>        <span class="n">list_all_results</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService.list_by_chunks-514"><a href="#PumpWoodMicroService.list_by_chunks-514"><span class="linenos">514</span></a>        <span class="n">max_order_col</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PumpWoodMicroService.list_by_chunks-515"><a href="#PumpWoodMicroService.list_by_chunks-515"><span class="linenos">515</span></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-516"><a href="#PumpWoodMicroService.list_by_chunks-516"><span class="linenos">516</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- fetching chunk [</span><span class="si">{}</span><span class="s2">]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_order_col</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.list_by_chunks-517"><a href="#PumpWoodMicroService.list_by_chunks-517"><span class="linenos">517</span></a>            <span class="n">copy_filter_dict</span><span class="p">[</span><span class="s2">&quot;pk__gt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">max_order_col</span>
</span><span id="PumpWoodMicroService.list_by_chunks-518"><a href="#PumpWoodMicroService.list_by_chunks-518"><span class="linenos">518</span></a>            <span class="n">temp_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.list_by_chunks-519"><a href="#PumpWoodMicroService.list_by_chunks-519"><span class="linenos">519</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">filter_dict</span><span class="o">=</span><span class="n">copy_filter_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_by_chunks-520"><a href="#PumpWoodMicroService.list_by_chunks-520"><span class="linenos">520</span></a>                <span class="n">exclude_dict</span><span class="o">=</span><span class="n">exclude_dict</span><span class="p">,</span> <span class="n">order_by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.list_by_chunks-521"><a href="#PumpWoodMicroService.list_by_chunks-521"><span class="linenos">521</span></a>                <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="n">fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_by_chunks-522"><a href="#PumpWoodMicroService.list_by_chunks-522"><span class="linenos">522</span></a>                <span class="n">default_fields</span><span class="o">=</span><span class="n">default_fields</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">chunk_size</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_by_chunks-523"><a href="#PumpWoodMicroService.list_by_chunks-523"><span class="linenos">523</span></a>
</span><span id="PumpWoodMicroService.list_by_chunks-524"><a href="#PumpWoodMicroService.list_by_chunks-524"><span class="linenos">524</span></a>            <span class="c1"># Break if results is empty</span>
</span><span id="PumpWoodMicroService.list_by_chunks-525"><a href="#PumpWoodMicroService.list_by_chunks-525"><span class="linenos">525</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">temp_results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_by_chunks-526"><a href="#PumpWoodMicroService.list_by_chunks-526"><span class="linenos">526</span></a>                <span class="k">break</span>
</span><span id="PumpWoodMicroService.list_by_chunks-527"><a href="#PumpWoodMicroService.list_by_chunks-527"><span class="linenos">527</span></a>
</span><span id="PumpWoodMicroService.list_by_chunks-528"><a href="#PumpWoodMicroService.list_by_chunks-528"><span class="linenos">528</span></a>            <span class="n">max_order_col</span> <span class="o">=</span> <span class="n">temp_results</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.list_by_chunks-529"><a href="#PumpWoodMicroService.list_by_chunks-529"><span class="linenos">529</span></a>            <span class="n">list_all_results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">temp_results</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_by_chunks-530"><a href="#PumpWoodMicroService.list_by_chunks-530"><span class="linenos">530</span></a>
</span><span id="PumpWoodMicroService.list_by_chunks-531"><a href="#PumpWoodMicroService.list_by_chunks-531"><span class="linenos">531</span></a>        <span class="k">return</span> <span class="n">list_all_results</span>
</span></pre></div>


            <div class="docstring"><p>List object fetching them by chucks using pk to paginate.</p>

<p>List data by chunck to load by datasets without breaking the backend
or receive server timeout. It load chunks orderring the results using
id of the tables, it can be changed but it should be unique otherwise
unexpected results may occur.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class of the end-point</li>
<li><strong>filter_dict:</strong>  Filter dict to be used at the query. Filter elements from query
return that satifies all statements of the dictonary.</li>
<li><strong>exclude_dict:</strong>  Exclude dict to be used at the query. Remove elements from
query return that satifies all statements of the dictonary.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
<li><strong>fields:</strong>  Set the fields to be returned by the list end-point.</li>
<li><strong>default_fields:</strong>  Boolean, if true and fields arguments None will return the
default fields set for list by the backend.</li>
<li><strong>chunk_size:</strong>  Number of objects to be fetched each query.</li>
<li><strong>**kwargs:</strong>  Other parameters for compatibility.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Containing objects serialized by list Serializer.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No especific raises.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.list_without_pag" class="classattr">
                                        <input id="PumpWoodMicroService.list_without_pag-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_without_pag</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">order_by</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n"><a href="#PumpWoodMicroService.list">PumpWoodMicroService.list</a></span><span class="o">&gt;</span> <span class="o">=</span> <span class="p">[]</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">return_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;list&#39;</span>,</span><span class="param">	<span class="n">convert_geometry</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">fields</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n"><a href="#PumpWoodMicroService.list">PumpWoodMicroService.list</a></span><span class="o">&gt;</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="o">**</span><span class="n">kwargs</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.list_without_pag-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.list_without_pag"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.list_without_pag-537"><a href="#PumpWoodMicroService.list_without_pag-537"><span class="linenos">537</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_without_pag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService.list_without_pag-538"><a href="#PumpWoodMicroService.list_without_pag-538"><span class="linenos">538</span></a>                         <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">order_by</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="PumpWoodMicroService.list_without_pag-539"><a href="#PumpWoodMicroService.list_without_pag-539"><span class="linenos">539</span></a>                         <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_without_pag-540"><a href="#PumpWoodMicroService.list_without_pag-540"><span class="linenos">540</span></a>                         <span class="n">convert_geometry</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_without_pag-541"><a href="#PumpWoodMicroService.list_without_pag-541"><span class="linenos">541</span></a>                         <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_without_pag-542"><a href="#PumpWoodMicroService.list_without_pag-542"><span class="linenos">542</span></a>                         <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.list_without_pag-543"><a href="#PumpWoodMicroService.list_without_pag-543"><span class="linenos">543</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List object without pagination.</span>
</span><span id="PumpWoodMicroService.list_without_pag-544"><a href="#PumpWoodMicroService.list_without_pag-544"><span class="linenos">544</span></a>
</span><span id="PumpWoodMicroService.list_without_pag-545"><a href="#PumpWoodMicroService.list_without_pag-545"><span class="linenos">545</span></a><span class="sd">        Function to post at list end-point (resumed data) of PumpWood like</span>
</span><span id="PumpWoodMicroService.list_without_pag-546"><a href="#PumpWoodMicroService.list_without_pag-546"><span class="linenos">546</span></a><span class="sd">        systems, results won&#39;t be paginated.</span>
</span><span id="PumpWoodMicroService.list_without_pag-547"><a href="#PumpWoodMicroService.list_without_pag-547"><span class="linenos">547</span></a><span class="sd">        **Be carefull with large returns.**</span>
</span><span id="PumpWoodMicroService.list_without_pag-548"><a href="#PumpWoodMicroService.list_without_pag-548"><span class="linenos">548</span></a>
</span><span id="PumpWoodMicroService.list_without_pag-549"><a href="#PumpWoodMicroService.list_without_pag-549"><span class="linenos">549</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.list_without_pag-550"><a href="#PumpWoodMicroService.list_without_pag-550"><span class="linenos">550</span></a><span class="sd">            model_class (str):</span>
</span><span id="PumpWoodMicroService.list_without_pag-551"><a href="#PumpWoodMicroService.list_without_pag-551"><span class="linenos">551</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="PumpWoodMicroService.list_without_pag-552"><a href="#PumpWoodMicroService.list_without_pag-552"><span class="linenos">552</span></a><span class="sd">            filter_dict (dict):</span>
</span><span id="PumpWoodMicroService.list_without_pag-553"><a href="#PumpWoodMicroService.list_without_pag-553"><span class="linenos">553</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="PumpWoodMicroService.list_without_pag-554"><a href="#PumpWoodMicroService.list_without_pag-554"><span class="linenos">554</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService.list_without_pag-555"><a href="#PumpWoodMicroService.list_without_pag-555"><span class="linenos">555</span></a><span class="sd">            exclude_dict (dict):</span>
</span><span id="PumpWoodMicroService.list_without_pag-556"><a href="#PumpWoodMicroService.list_without_pag-556"><span class="linenos">556</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="PumpWoodMicroService.list_without_pag-557"><a href="#PumpWoodMicroService.list_without_pag-557"><span class="linenos">557</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService.list_without_pag-558"><a href="#PumpWoodMicroService.list_without_pag-558"><span class="linenos">558</span></a><span class="sd">            order_by (bool):</span>
</span><span id="PumpWoodMicroService.list_without_pag-559"><a href="#PumpWoodMicroService.list_without_pag-559"><span class="linenos">559</span></a><span class="sd">                Order results acording to list of strings</span>
</span><span id="PumpWoodMicroService.list_without_pag-560"><a href="#PumpWoodMicroService.list_without_pag-560"><span class="linenos">560</span></a><span class="sd">                correspondent to fields. It is possible to use &#39;-&#39; at the</span>
</span><span id="PumpWoodMicroService.list_without_pag-561"><a href="#PumpWoodMicroService.list_without_pag-561"><span class="linenos">561</span></a><span class="sd">                begginng of the field name for reverse ordering. Ex.:</span>
</span><span id="PumpWoodMicroService.list_without_pag-562"><a href="#PumpWoodMicroService.list_without_pag-562"><span class="linenos">562</span></a><span class="sd">                [&#39;description&#39;] for accendent ordering and [&#39;-description&#39;]</span>
</span><span id="PumpWoodMicroService.list_without_pag-563"><a href="#PumpWoodMicroService.list_without_pag-563"><span class="linenos">563</span></a><span class="sd">                for descendent ordering.</span>
</span><span id="PumpWoodMicroService.list_without_pag-564"><a href="#PumpWoodMicroService.list_without_pag-564"><span class="linenos">564</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="PumpWoodMicroService.list_without_pag-565"><a href="#PumpWoodMicroService.list_without_pag-565"><span class="linenos">565</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.list_without_pag-566"><a href="#PumpWoodMicroService.list_without_pag-566"><span class="linenos">566</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.list_without_pag-567"><a href="#PumpWoodMicroService.list_without_pag-567"><span class="linenos">567</span></a><span class="sd">            fields (List[str]):</span>
</span><span id="PumpWoodMicroService.list_without_pag-568"><a href="#PumpWoodMicroService.list_without_pag-568"><span class="linenos">568</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="PumpWoodMicroService.list_without_pag-569"><a href="#PumpWoodMicroService.list_without_pag-569"><span class="linenos">569</span></a><span class="sd">            default_fields (bool):</span>
</span><span id="PumpWoodMicroService.list_without_pag-570"><a href="#PumpWoodMicroService.list_without_pag-570"><span class="linenos">570</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="PumpWoodMicroService.list_without_pag-571"><a href="#PumpWoodMicroService.list_without_pag-571"><span class="linenos">571</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="PumpWoodMicroService.list_without_pag-572"><a href="#PumpWoodMicroService.list_without_pag-572"><span class="linenos">572</span></a><span class="sd">            limit (int):</span>
</span><span id="PumpWoodMicroService.list_without_pag-573"><a href="#PumpWoodMicroService.list_without_pag-573"><span class="linenos">573</span></a><span class="sd">                Set the limit of elements of the returned query. By default,</span>
</span><span id="PumpWoodMicroService.list_without_pag-574"><a href="#PumpWoodMicroService.list_without_pag-574"><span class="linenos">574</span></a><span class="sd">                backend usually return 50 elements.</span>
</span><span id="PumpWoodMicroService.list_without_pag-575"><a href="#PumpWoodMicroService.list_without_pag-575"><span class="linenos">575</span></a><span class="sd">            foreign_key_fields (bool):</span>
</span><span id="PumpWoodMicroService.list_without_pag-576"><a href="#PumpWoodMicroService.list_without_pag-576"><span class="linenos">576</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="PumpWoodMicroService.list_without_pag-577"><a href="#PumpWoodMicroService.list_without_pag-577"><span class="linenos">577</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="PumpWoodMicroService.list_without_pag-578"><a href="#PumpWoodMicroService.list_without_pag-578"><span class="linenos">578</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="PumpWoodMicroService.list_without_pag-579"><a href="#PumpWoodMicroService.list_without_pag-579"><span class="linenos">579</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="PumpWoodMicroService.list_without_pag-580"><a href="#PumpWoodMicroService.list_without_pag-580"><span class="linenos">580</span></a><span class="sd">            convert_geometry (bool):</span>
</span><span id="PumpWoodMicroService.list_without_pag-581"><a href="#PumpWoodMicroService.list_without_pag-581"><span class="linenos">581</span></a><span class="sd">                If geometry columns should be convert to shapely geometry.</span>
</span><span id="PumpWoodMicroService.list_without_pag-582"><a href="#PumpWoodMicroService.list_without_pag-582"><span class="linenos">582</span></a><span class="sd">                Fields with key &#39;geometry&#39; will be considered geometry.</span>
</span><span id="PumpWoodMicroService.list_without_pag-583"><a href="#PumpWoodMicroService.list_without_pag-583"><span class="linenos">583</span></a><span class="sd">            return_type (str):</span>
</span><span id="PumpWoodMicroService.list_without_pag-584"><a href="#PumpWoodMicroService.list_without_pag-584"><span class="linenos">584</span></a><span class="sd">                Set return type to list of dictinary `list` or to a pandas</span>
</span><span id="PumpWoodMicroService.list_without_pag-585"><a href="#PumpWoodMicroService.list_without_pag-585"><span class="linenos">585</span></a><span class="sd">                dataframe `dataframe`.</span>
</span><span id="PumpWoodMicroService.list_without_pag-586"><a href="#PumpWoodMicroService.list_without_pag-586"><span class="linenos">586</span></a><span class="sd">            **kwargs:</span>
</span><span id="PumpWoodMicroService.list_without_pag-587"><a href="#PumpWoodMicroService.list_without_pag-587"><span class="linenos">587</span></a><span class="sd">                Other unused arguments for compatibility.</span>
</span><span id="PumpWoodMicroService.list_without_pag-588"><a href="#PumpWoodMicroService.list_without_pag-588"><span class="linenos">588</span></a>
</span><span id="PumpWoodMicroService.list_without_pag-589"><a href="#PumpWoodMicroService.list_without_pag-589"><span class="linenos">589</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.list_without_pag-590"><a href="#PumpWoodMicroService.list_without_pag-590"><span class="linenos">590</span></a><span class="sd">          Containing objects serialized by list Serializer.</span>
</span><span id="PumpWoodMicroService.list_without_pag-591"><a href="#PumpWoodMicroService.list_without_pag-591"><span class="linenos">591</span></a>
</span><span id="PumpWoodMicroService.list_without_pag-592"><a href="#PumpWoodMicroService.list_without_pag-592"><span class="linenos">592</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.list_without_pag-593"><a href="#PumpWoodMicroService.list_without_pag-593"><span class="linenos">593</span></a><span class="sd">          No especific raises.</span>
</span><span id="PumpWoodMicroService.list_without_pag-594"><a href="#PumpWoodMicroService.list_without_pag-594"><span class="linenos">594</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.list_without_pag-595"><a href="#PumpWoodMicroService.list_without_pag-595"><span class="linenos">595</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_without_pag-596"><a href="#PumpWoodMicroService.list_without_pag-596"><span class="linenos">596</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PumpWoodMicroService.list_without_pag-597"><a href="#PumpWoodMicroService.list_without_pag-597"><span class="linenos">597</span></a>            <span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_without_pag-598"><a href="#PumpWoodMicroService.list_without_pag-598"><span class="linenos">598</span></a>            <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="n">order_by</span><span class="p">,</span> <span class="s1">&#39;default_fields&#39;</span><span class="p">:</span> <span class="n">default_fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_without_pag-599"><a href="#PumpWoodMicroService.list_without_pag-599"><span class="linenos">599</span></a>            <span class="s1">&#39;foreign_key_fields&#39;</span><span class="p">:</span> <span class="n">foreign_key_fields</span><span class="p">}</span>
</span><span id="PumpWoodMicroService.list_without_pag-600"><a href="#PumpWoodMicroService.list_without_pag-600"><span class="linenos">600</span></a>
</span><span id="PumpWoodMicroService.list_without_pag-601"><a href="#PumpWoodMicroService.list_without_pag-601"><span class="linenos">601</span></a>        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_without_pag-602"><a href="#PumpWoodMicroService.list_without_pag-602"><span class="linenos">602</span></a>            <span class="n">post_data</span><span class="p">[</span><span class="s2">&quot;fields&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fields</span>
</span><span id="PumpWoodMicroService.list_without_pag-603"><a href="#PumpWoodMicroService.list_without_pag-603"><span class="linenos">603</span></a>        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.list_without_pag-604"><a href="#PumpWoodMicroService.list_without_pag-604"><span class="linenos">604</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_without_pag-605"><a href="#PumpWoodMicroService.list_without_pag-605"><span class="linenos">605</span></a>
</span><span id="PumpWoodMicroService.list_without_pag-606"><a href="#PumpWoodMicroService.list_without_pag-606"><span class="linenos">606</span></a>        <span class="c1">##################################################</span>
</span><span id="PumpWoodMicroService.list_without_pag-607"><a href="#PumpWoodMicroService.list_without_pag-607"><span class="linenos">607</span></a>        <span class="c1"># Converting geometry to Shapely objects in Python</span>
</span><span id="PumpWoodMicroService.list_without_pag-608"><a href="#PumpWoodMicroService.list_without_pag-608"><span class="linenos">608</span></a>        <span class="n">geometry_in_results</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PumpWoodMicroService.list_without_pag-609"><a href="#PumpWoodMicroService.list_without_pag-609"><span class="linenos">609</span></a>        <span class="k">if</span> <span class="n">convert_geometry</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_without_pag-610"><a href="#PumpWoodMicroService.list_without_pag-610"><span class="linenos">610</span></a>            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_without_pag-611"><a href="#PumpWoodMicroService.list_without_pag-611"><span class="linenos">611</span></a>                <span class="n">geometry_value</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;geometry&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_without_pag-612"><a href="#PumpWoodMicroService.list_without_pag-612"><span class="linenos">612</span></a>                <span class="k">if</span> <span class="n">geometry_value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_without_pag-613"><a href="#PumpWoodMicroService.list_without_pag-613"><span class="linenos">613</span></a>                    <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;geometry&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">geometry</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">geometry_value</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_without_pag-614"><a href="#PumpWoodMicroService.list_without_pag-614"><span class="linenos">614</span></a>                    <span class="n">geometry_in_results</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PumpWoodMicroService.list_without_pag-615"><a href="#PumpWoodMicroService.list_without_pag-615"><span class="linenos">615</span></a>        <span class="c1">##################################################</span>
</span><span id="PumpWoodMicroService.list_without_pag-616"><a href="#PumpWoodMicroService.list_without_pag-616"><span class="linenos">616</span></a>
</span><span id="PumpWoodMicroService.list_without_pag-617"><a href="#PumpWoodMicroService.list_without_pag-617"><span class="linenos">617</span></a>        <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_without_pag-618"><a href="#PumpWoodMicroService.list_without_pag-618"><span class="linenos">618</span></a>            <span class="k">return</span> <span class="n">results</span>
</span><span id="PumpWoodMicroService.list_without_pag-619"><a href="#PumpWoodMicroService.list_without_pag-619"><span class="linenos">619</span></a>        <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s1">&#39;dataframe&#39;</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_without_pag-620"><a href="#PumpWoodMicroService.list_without_pag-620"><span class="linenos">620</span></a>            <span class="k">if</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;descriptiongeoarea&quot;</span><span class="p">)</span> <span class="ow">and</span> \
</span><span id="PumpWoodMicroService.list_without_pag-621"><a href="#PumpWoodMicroService.list_without_pag-621"><span class="linenos">621</span></a>                    <span class="n">geometry_in_results</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_without_pag-622"><a href="#PumpWoodMicroService.list_without_pag-622"><span class="linenos">622</span></a>                <span class="k">return</span> <span class="n">geopd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="s1">&#39;geometry&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_without_pag-623"><a href="#PumpWoodMicroService.list_without_pag-623"><span class="linenos">623</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_without_pag-624"><a href="#PumpWoodMicroService.list_without_pag-624"><span class="linenos">624</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_without_pag-625"><a href="#PumpWoodMicroService.list_without_pag-625"><span class="linenos">625</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_without_pag-626"><a href="#PumpWoodMicroService.list_without_pag-626"><span class="linenos">626</span></a>            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;return_type must be &#39;list&#39; or &#39;dataframe&#39;&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>List object without pagination.</p>

<p>Function to post at list end-point (resumed data) of PumpWood like
systems, results won't be paginated.
<strong>Be carefull with large returns.</strong></p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class (str):</strong>  Model class of the end-point</li>
<li><strong>filter_dict (dict):</strong>  Filter dict to be used at the query. Filter elements from query
return that satifies all statements of the dictonary.</li>
<li><strong>exclude_dict (dict):</strong>  Exclude dict to be used at the query. Remove elements from
query return that satifies all statements of the dictonary.</li>
<li><strong>order_by (bool):</strong>  Order results acording to list of strings
correspondent to fields. It is possible to use '-' at the
begginng of the field name for reverse ordering. Ex.:
['description'] for accendent ordering and ['-description']
for descendent ordering.</li>
<li><strong>auth_header (dict):</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
<li><strong>fields (List[str]):</strong>  Set the fields to be returned by the list end-point.</li>
<li><strong>default_fields (bool):</strong>  Boolean, if true and fields arguments None will return the
default fields set for list by the backend.</li>
<li><strong>limit (int):</strong>  Set the limit of elements of the returned query. By default,
backend usually return 50 elements.</li>
<li><strong>foreign_key_fields (bool):</strong>  Return forenging key objects. It will return the fk
corresponding object. Ex: <code>created_by_id</code> reference to
a user <code>model_class</code> the correspondent to User will be
returned at <code>created_by</code>.</li>
<li><strong>convert_geometry (bool):</strong>  If geometry columns should be convert to shapely geometry.
Fields with key 'geometry' will be considered geometry.</li>
<li><strong>return_type (str):</strong>  Set return type to list of dictinary <code><a href="#PumpWoodMicroService.list">list</a></code> or to a pandas
dataframe <code>dataframe</code>.</li>
<li><strong>**kwargs:</strong>  Other unused arguments for compatibility.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Containing objects serialized by list Serializer.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No especific raises.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.list_dimensions" class="classattr">
                                        <input id="PumpWoodMicroService.list_dimensions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_dimensions</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.list_dimensions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.list_dimensions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.list_dimensions-632"><a href="#PumpWoodMicroService.list_dimensions-632"><span class="linenos">632</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService.list_dimensions-633"><a href="#PumpWoodMicroService.list_dimensions-633"><span class="linenos">633</span></a>                        <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.list_dimensions-634"><a href="#PumpWoodMicroService.list_dimensions-634"><span class="linenos">634</span></a>                        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.list_dimensions-635"><a href="#PumpWoodMicroService.list_dimensions-635"><span class="linenos">635</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List dimensions avaiable for model_class.</span>
</span><span id="PumpWoodMicroService.list_dimensions-636"><a href="#PumpWoodMicroService.list_dimensions-636"><span class="linenos">636</span></a>
</span><span id="PumpWoodMicroService.list_dimensions-637"><a href="#PumpWoodMicroService.list_dimensions-637"><span class="linenos">637</span></a><span class="sd">        It list all keys avaiable at dimension retricting the results with</span>
</span><span id="PumpWoodMicroService.list_dimensions-638"><a href="#PumpWoodMicroService.list_dimensions-638"><span class="linenos">638</span></a><span class="sd">        query parameters `filter_dict` and `exclude_dict`.</span>
</span><span id="PumpWoodMicroService.list_dimensions-639"><a href="#PumpWoodMicroService.list_dimensions-639"><span class="linenos">639</span></a>
</span><span id="PumpWoodMicroService.list_dimensions-640"><a href="#PumpWoodMicroService.list_dimensions-640"><span class="linenos">640</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.list_dimensions-641"><a href="#PumpWoodMicroService.list_dimensions-641"><span class="linenos">641</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.list_dimensions-642"><a href="#PumpWoodMicroService.list_dimensions-642"><span class="linenos">642</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="PumpWoodMicroService.list_dimensions-643"><a href="#PumpWoodMicroService.list_dimensions-643"><span class="linenos">643</span></a><span class="sd">            filter_dict:</span>
</span><span id="PumpWoodMicroService.list_dimensions-644"><a href="#PumpWoodMicroService.list_dimensions-644"><span class="linenos">644</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="PumpWoodMicroService.list_dimensions-645"><a href="#PumpWoodMicroService.list_dimensions-645"><span class="linenos">645</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService.list_dimensions-646"><a href="#PumpWoodMicroService.list_dimensions-646"><span class="linenos">646</span></a><span class="sd">            exclude_dict:</span>
</span><span id="PumpWoodMicroService.list_dimensions-647"><a href="#PumpWoodMicroService.list_dimensions-647"><span class="linenos">647</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="PumpWoodMicroService.list_dimensions-648"><a href="#PumpWoodMicroService.list_dimensions-648"><span class="linenos">648</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService.list_dimensions-649"><a href="#PumpWoodMicroService.list_dimensions-649"><span class="linenos">649</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.list_dimensions-650"><a href="#PumpWoodMicroService.list_dimensions-650"><span class="linenos">650</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.list_dimensions-651"><a href="#PumpWoodMicroService.list_dimensions-651"><span class="linenos">651</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.list_dimensions-652"><a href="#PumpWoodMicroService.list_dimensions-652"><span class="linenos">652</span></a>
</span><span id="PumpWoodMicroService.list_dimensions-653"><a href="#PumpWoodMicroService.list_dimensions-653"><span class="linenos">653</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.list_dimensions-654"><a href="#PumpWoodMicroService.list_dimensions-654"><span class="linenos">654</span></a><span class="sd">            List of keys avaiable in results from the query dict.</span>
</span><span id="PumpWoodMicroService.list_dimensions-655"><a href="#PumpWoodMicroService.list_dimensions-655"><span class="linenos">655</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.list_dimensions-656"><a href="#PumpWoodMicroService.list_dimensions-656"><span class="linenos">656</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_dimensions</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_dimensions-657"><a href="#PumpWoodMicroService.list_dimensions-657"><span class="linenos">657</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">}</span>
</span><span id="PumpWoodMicroService.list_dimensions-658"><a href="#PumpWoodMicroService.list_dimensions-658"><span class="linenos">658</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.list_dimensions-659"><a href="#PumpWoodMicroService.list_dimensions-659"><span class="linenos">659</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>List dimensions avaiable for model_class.</p>

<p>It list all keys avaiable at dimension retricting the results with
query parameters <code>filter_dict</code> and <code>exclude_dict</code>.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class of the end-point</li>
<li><strong>filter_dict:</strong>  Filter dict to be used at the query. Filter elements from query
return that satifies all statements of the dictonary.</li>
<li><strong>exclude_dict:</strong>  Exclude dict to be used at the query. Remove elements from
query return that satifies all statements of the dictonary.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of keys avaiable in results from the query dict.</p>
</blockquote>
</div>


                            </div>
                            <div id="PumpWoodMicroService.list_dimension_values" class="classattr">
                                        <input id="PumpWoodMicroService.list_dimension_values-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_dimension_values</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">key</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">any</span><span class="o">&gt;</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.list_dimension_values-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.list_dimension_values"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.list_dimension_values-665"><a href="#PumpWoodMicroService.list_dimension_values-665"><span class="linenos">665</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_dimension_values</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_dimension_values-666"><a href="#PumpWoodMicroService.list_dimension_values-666"><span class="linenos">666</span></a>                              <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService.list_dimension_values-667"><a href="#PumpWoodMicroService.list_dimension_values-667"><span class="linenos">667</span></a>                              <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">any</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.list_dimension_values-668"><a href="#PumpWoodMicroService.list_dimension_values-668"><span class="linenos">668</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;List values associated with dimensions key.</span>
</span><span id="PumpWoodMicroService.list_dimension_values-669"><a href="#PumpWoodMicroService.list_dimension_values-669"><span class="linenos">669</span></a>
</span><span id="PumpWoodMicroService.list_dimension_values-670"><a href="#PumpWoodMicroService.list_dimension_values-670"><span class="linenos">670</span></a><span class="sd">        It list all keys avaiable at dimension retricting the results with</span>
</span><span id="PumpWoodMicroService.list_dimension_values-671"><a href="#PumpWoodMicroService.list_dimension_values-671"><span class="linenos">671</span></a><span class="sd">        query parameters `filter_dict` and `exclude_dict`.</span>
</span><span id="PumpWoodMicroService.list_dimension_values-672"><a href="#PumpWoodMicroService.list_dimension_values-672"><span class="linenos">672</span></a>
</span><span id="PumpWoodMicroService.list_dimension_values-673"><a href="#PumpWoodMicroService.list_dimension_values-673"><span class="linenos">673</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.list_dimension_values-674"><a href="#PumpWoodMicroService.list_dimension_values-674"><span class="linenos">674</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.list_dimension_values-675"><a href="#PumpWoodMicroService.list_dimension_values-675"><span class="linenos">675</span></a><span class="sd">                Model class of the end-point</span>
</span><span id="PumpWoodMicroService.list_dimension_values-676"><a href="#PumpWoodMicroService.list_dimension_values-676"><span class="linenos">676</span></a><span class="sd">            filter_dict:</span>
</span><span id="PumpWoodMicroService.list_dimension_values-677"><a href="#PumpWoodMicroService.list_dimension_values-677"><span class="linenos">677</span></a><span class="sd">                Filter dict to be used at the query. Filter elements from query</span>
</span><span id="PumpWoodMicroService.list_dimension_values-678"><a href="#PumpWoodMicroService.list_dimension_values-678"><span class="linenos">678</span></a><span class="sd">                return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService.list_dimension_values-679"><a href="#PumpWoodMicroService.list_dimension_values-679"><span class="linenos">679</span></a><span class="sd">            exclude_dict:</span>
</span><span id="PumpWoodMicroService.list_dimension_values-680"><a href="#PumpWoodMicroService.list_dimension_values-680"><span class="linenos">680</span></a><span class="sd">                Exclude dict to be used at the query. Remove elements from</span>
</span><span id="PumpWoodMicroService.list_dimension_values-681"><a href="#PumpWoodMicroService.list_dimension_values-681"><span class="linenos">681</span></a><span class="sd">                query return that satifies all statements of the dictonary.</span>
</span><span id="PumpWoodMicroService.list_dimension_values-682"><a href="#PumpWoodMicroService.list_dimension_values-682"><span class="linenos">682</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.list_dimension_values-683"><a href="#PumpWoodMicroService.list_dimension_values-683"><span class="linenos">683</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.list_dimension_values-684"><a href="#PumpWoodMicroService.list_dimension_values-684"><span class="linenos">684</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.list_dimension_values-685"><a href="#PumpWoodMicroService.list_dimension_values-685"><span class="linenos">685</span></a><span class="sd">            key:</span>
</span><span id="PumpWoodMicroService.list_dimension_values-686"><a href="#PumpWoodMicroService.list_dimension_values-686"><span class="linenos">686</span></a><span class="sd">                Key to list the avaiable values using the query filter</span>
</span><span id="PumpWoodMicroService.list_dimension_values-687"><a href="#PumpWoodMicroService.list_dimension_values-687"><span class="linenos">687</span></a><span class="sd">                and exclude.</span>
</span><span id="PumpWoodMicroService.list_dimension_values-688"><a href="#PumpWoodMicroService.list_dimension_values-688"><span class="linenos">688</span></a>
</span><span id="PumpWoodMicroService.list_dimension_values-689"><a href="#PumpWoodMicroService.list_dimension_values-689"><span class="linenos">689</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.list_dimension_values-690"><a href="#PumpWoodMicroService.list_dimension_values-690"><span class="linenos">690</span></a><span class="sd">            List of values associated with dimensions key at the objects that</span>
</span><span id="PumpWoodMicroService.list_dimension_values-691"><a href="#PumpWoodMicroService.list_dimension_values-691"><span class="linenos">691</span></a><span class="sd">            are returned with `filter_dict` and `exclude_dict`.</span>
</span><span id="PumpWoodMicroService.list_dimension_values-692"><a href="#PumpWoodMicroService.list_dimension_values-692"><span class="linenos">692</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.list_dimension_values-693"><a href="#PumpWoodMicroService.list_dimension_values-693"><span class="linenos">693</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_dimension_values</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.list_dimension_values-694"><a href="#PumpWoodMicroService.list_dimension_values-694"><span class="linenos">694</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_dimension_values-695"><a href="#PumpWoodMicroService.list_dimension_values-695"><span class="linenos">695</span></a>                     <span class="s1">&#39;key&#39;</span><span class="p">:</span> <span class="n">key</span><span class="p">}</span>
</span><span id="PumpWoodMicroService.list_dimension_values-696"><a href="#PumpWoodMicroService.list_dimension_values-696"><span class="linenos">696</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.list_dimension_values-697"><a href="#PumpWoodMicroService.list_dimension_values-697"><span class="linenos">697</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>List values associated with dimensions key.</p>

<p>It list all keys avaiable at dimension retricting the results with
query parameters <code>filter_dict</code> and <code>exclude_dict</code>.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class of the end-point</li>
<li><strong>filter_dict:</strong>  Filter dict to be used at the query. Filter elements from query
return that satifies all statements of the dictonary.</li>
<li><strong>exclude_dict:</strong>  Exclude dict to be used at the query. Remove elements from
query return that satifies all statements of the dictonary.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
<li><strong>key:</strong>  Key to list the avaiable values using the query filter
and exclude.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of values associated with dimensions key at the objects that
  are returned with <code>filter_dict</code> and <code>exclude_dict</code>.</p>
</blockquote>
</div>


                            </div>
                            <div id="PumpWoodMicroService.list_actions" class="classattr">
                                        <input id="PumpWoodMicroService.list_actions-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_actions</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.list_actions-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.list_actions"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.list_actions-699"><a href="#PumpWoodMicroService.list_actions-699"><span class="linenos">699</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_actions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.list_actions-700"><a href="#PumpWoodMicroService.list_actions-700"><span class="linenos">700</span></a>                     <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.list_actions-701"><a href="#PumpWoodMicroService.list_actions-701"><span class="linenos">701</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a list of all actions avaiable at this model class.</span>
</span><span id="PumpWoodMicroService.list_actions-702"><a href="#PumpWoodMicroService.list_actions-702"><span class="linenos">702</span></a>
</span><span id="PumpWoodMicroService.list_actions-703"><a href="#PumpWoodMicroService.list_actions-703"><span class="linenos">703</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.list_actions-704"><a href="#PumpWoodMicroService.list_actions-704"><span class="linenos">704</span></a><span class="sd">          model_class:</span>
</span><span id="PumpWoodMicroService.list_actions-705"><a href="#PumpWoodMicroService.list_actions-705"><span class="linenos">705</span></a><span class="sd">              Model class to list possible actions.</span>
</span><span id="PumpWoodMicroService.list_actions-706"><a href="#PumpWoodMicroService.list_actions-706"><span class="linenos">706</span></a><span class="sd">          auth_header:</span>
</span><span id="PumpWoodMicroService.list_actions-707"><a href="#PumpWoodMicroService.list_actions-707"><span class="linenos">707</span></a><span class="sd">              Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.list_actions-708"><a href="#PumpWoodMicroService.list_actions-708"><span class="linenos">708</span></a><span class="sd">              at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.list_actions-709"><a href="#PumpWoodMicroService.list_actions-709"><span class="linenos">709</span></a>
</span><span id="PumpWoodMicroService.list_actions-710"><a href="#PumpWoodMicroService.list_actions-710"><span class="linenos">710</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.list_actions-711"><a href="#PumpWoodMicroService.list_actions-711"><span class="linenos">711</span></a><span class="sd">          List of possible actions and its descriptions.</span>
</span><span id="PumpWoodMicroService.list_actions-712"><a href="#PumpWoodMicroService.list_actions-712"><span class="linenos">712</span></a>
</span><span id="PumpWoodMicroService.list_actions-713"><a href="#PumpWoodMicroService.list_actions-713"><span class="linenos">713</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.list_actions-714"><a href="#PumpWoodMicroService.list_actions-714"><span class="linenos">714</span></a><span class="sd">            No particular errors.</span>
</span><span id="PumpWoodMicroService.list_actions-715"><a href="#PumpWoodMicroService.list_actions-715"><span class="linenos">715</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.list_actions-716"><a href="#PumpWoodMicroService.list_actions-716"><span class="linenos">716</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/actions/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="PumpWoodMicroService.list_actions-717"><a href="#PumpWoodMicroService.list_actions-717"><span class="linenos">717</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return a list of all actions avaiable at this model class.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class to list possible actions.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of possible actions and its descriptions.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No particular errors.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.execute_action" class="classattr">
                                        <input id="PumpWoodMicroService.execute_action-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">execute_action</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">action</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">pk</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">files</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n"><a href="#PumpWoodMicroService.list">PumpWoodMicroService.list</a></span><span class="o">&gt;</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.execute_action-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.execute_action"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.execute_action-727"><a href="#PumpWoodMicroService.execute_action-727"><span class="linenos">727</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">execute_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">action</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pk</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.execute_action-728"><a href="#PumpWoodMicroService.execute_action-728"><span class="linenos">728</span></a>                       <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">files</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.execute_action-729"><a href="#PumpWoodMicroService.execute_action-729"><span class="linenos">729</span></a>                       <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.execute_action-730"><a href="#PumpWoodMicroService.execute_action-730"><span class="linenos">730</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute action associated with a model class.</span>
</span><span id="PumpWoodMicroService.execute_action-731"><a href="#PumpWoodMicroService.execute_action-731"><span class="linenos">731</span></a>
</span><span id="PumpWoodMicroService.execute_action-732"><a href="#PumpWoodMicroService.execute_action-732"><span class="linenos">732</span></a><span class="sd">        If action is static or classfunction no pk is necessary.</span>
</span><span id="PumpWoodMicroService.execute_action-733"><a href="#PumpWoodMicroService.execute_action-733"><span class="linenos">733</span></a>
</span><span id="PumpWoodMicroService.execute_action-734"><a href="#PumpWoodMicroService.execute_action-734"><span class="linenos">734</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.execute_action-735"><a href="#PumpWoodMicroService.execute_action-735"><span class="linenos">735</span></a><span class="sd">            pk (int):</span>
</span><span id="PumpWoodMicroService.execute_action-736"><a href="#PumpWoodMicroService.execute_action-736"><span class="linenos">736</span></a><span class="sd">                PK of the object to run action at. If not set action will be</span>
</span><span id="PumpWoodMicroService.execute_action-737"><a href="#PumpWoodMicroService.execute_action-737"><span class="linenos">737</span></a><span class="sd">                considered a classmethod and will run over the class.</span>
</span><span id="PumpWoodMicroService.execute_action-738"><a href="#PumpWoodMicroService.execute_action-738"><span class="linenos">738</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.execute_action-739"><a href="#PumpWoodMicroService.execute_action-739"><span class="linenos">739</span></a><span class="sd">                Model class to run action the object</span>
</span><span id="PumpWoodMicroService.execute_action-740"><a href="#PumpWoodMicroService.execute_action-740"><span class="linenos">740</span></a><span class="sd">            action:</span>
</span><span id="PumpWoodMicroService.execute_action-741"><a href="#PumpWoodMicroService.execute_action-741"><span class="linenos">741</span></a><span class="sd">                Action that will be performed.</span>
</span><span id="PumpWoodMicroService.execute_action-742"><a href="#PumpWoodMicroService.execute_action-742"><span class="linenos">742</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.execute_action-743"><a href="#PumpWoodMicroService.execute_action-743"><span class="linenos">743</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.execute_action-744"><a href="#PumpWoodMicroService.execute_action-744"><span class="linenos">744</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.execute_action-745"><a href="#PumpWoodMicroService.execute_action-745"><span class="linenos">745</span></a><span class="sd">            parameters:</span>
</span><span id="PumpWoodMicroService.execute_action-746"><a href="#PumpWoodMicroService.execute_action-746"><span class="linenos">746</span></a><span class="sd">                Dictionary with the function parameters.</span>
</span><span id="PumpWoodMicroService.execute_action-747"><a href="#PumpWoodMicroService.execute_action-747"><span class="linenos">747</span></a><span class="sd">            files:</span>
</span><span id="PumpWoodMicroService.execute_action-748"><a href="#PumpWoodMicroService.execute_action-748"><span class="linenos">748</span></a><span class="sd">                A dictionary of files to be added to as a multi-part</span>
</span><span id="PumpWoodMicroService.execute_action-749"><a href="#PumpWoodMicroService.execute_action-749"><span class="linenos">749</span></a><span class="sd">                post request. File must be passed as a file object with read</span>
</span><span id="PumpWoodMicroService.execute_action-750"><a href="#PumpWoodMicroService.execute_action-750"><span class="linenos">750</span></a><span class="sd">                bytes.</span>
</span><span id="PumpWoodMicroService.execute_action-751"><a href="#PumpWoodMicroService.execute_action-751"><span class="linenos">751</span></a>
</span><span id="PumpWoodMicroService.execute_action-752"><a href="#PumpWoodMicroService.execute_action-752"><span class="linenos">752</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.execute_action-753"><a href="#PumpWoodMicroService.execute_action-753"><span class="linenos">753</span></a><span class="sd">            Return a dictonary with keys:</span>
</span><span id="PumpWoodMicroService.execute_action-754"><a href="#PumpWoodMicroService.execute_action-754"><span class="linenos">754</span></a><span class="sd">            - **result:**: Result of the action that was performed.</span>
</span><span id="PumpWoodMicroService.execute_action-755"><a href="#PumpWoodMicroService.execute_action-755"><span class="linenos">755</span></a><span class="sd">            - **action:**: Information of the action that was performed.</span>
</span><span id="PumpWoodMicroService.execute_action-756"><a href="#PumpWoodMicroService.execute_action-756"><span class="linenos">756</span></a><span class="sd">            - **parameters:** Parameters that were passed to perform the</span>
</span><span id="PumpWoodMicroService.execute_action-757"><a href="#PumpWoodMicroService.execute_action-757"><span class="linenos">757</span></a><span class="sd">                action.</span>
</span><span id="PumpWoodMicroService.execute_action-758"><a href="#PumpWoodMicroService.execute_action-758"><span class="linenos">758</span></a><span class="sd">            - **object:** If a pk was passed to execute and action (not</span>
</span><span id="PumpWoodMicroService.execute_action-759"><a href="#PumpWoodMicroService.execute_action-759"><span class="linenos">759</span></a><span class="sd">                classmethod or staticmethod), the object with the correspondent</span>
</span><span id="PumpWoodMicroService.execute_action-760"><a href="#PumpWoodMicroService.execute_action-760"><span class="linenos">760</span></a><span class="sd">                pk is returned.</span>
</span><span id="PumpWoodMicroService.execute_action-761"><a href="#PumpWoodMicroService.execute_action-761"><span class="linenos">761</span></a>
</span><span id="PumpWoodMicroService.execute_action-762"><a href="#PumpWoodMicroService.execute_action-762"><span class="linenos">762</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.execute_action-763"><a href="#PumpWoodMicroService.execute_action-763"><span class="linenos">763</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.execute_action-764"><a href="#PumpWoodMicroService.execute_action-764"><span class="linenos">764</span></a><span class="sd">                &#39;There is no method {action} in rest actions for {class_name}&#39;.</span>
</span><span id="PumpWoodMicroService.execute_action-765"><a href="#PumpWoodMicroService.execute_action-765"><span class="linenos">765</span></a><span class="sd">                This indicates that action requested is not associated with</span>
</span><span id="PumpWoodMicroService.execute_action-766"><a href="#PumpWoodMicroService.execute_action-766"><span class="linenos">766</span></a><span class="sd">                the model_class.</span>
</span><span id="PumpWoodMicroService.execute_action-767"><a href="#PumpWoodMicroService.execute_action-767"><span class="linenos">767</span></a><span class="sd">            PumpWoodActionArgsException:</span>
</span><span id="PumpWoodMicroService.execute_action-768"><a href="#PumpWoodMicroService.execute_action-768"><span class="linenos">768</span></a><span class="sd">                &#39;Function is not static and pk is Null&#39;. This indicate that</span>
</span><span id="PumpWoodMicroService.execute_action-769"><a href="#PumpWoodMicroService.execute_action-769"><span class="linenos">769</span></a><span class="sd">                the action solicitated is not static/class method and a pk</span>
</span><span id="PumpWoodMicroService.execute_action-770"><a href="#PumpWoodMicroService.execute_action-770"><span class="linenos">770</span></a><span class="sd">                was not passed as argument.</span>
</span><span id="PumpWoodMicroService.execute_action-771"><a href="#PumpWoodMicroService.execute_action-771"><span class="linenos">771</span></a><span class="sd">            PumpWoodActionArgsException:</span>
</span><span id="PumpWoodMicroService.execute_action-772"><a href="#PumpWoodMicroService.execute_action-772"><span class="linenos">772</span></a><span class="sd">                &#39;Function is static and pk is not Null&#39;. This indicate that</span>
</span><span id="PumpWoodMicroService.execute_action-773"><a href="#PumpWoodMicroService.execute_action-773"><span class="linenos">773</span></a><span class="sd">                the action solicitated is static/class method and a pk</span>
</span><span id="PumpWoodMicroService.execute_action-774"><a href="#PumpWoodMicroService.execute_action-774"><span class="linenos">774</span></a><span class="sd">                was passed as argument.</span>
</span><span id="PumpWoodMicroService.execute_action-775"><a href="#PumpWoodMicroService.execute_action-775"><span class="linenos">775</span></a><span class="sd">            PumpWoodObjectDoesNotExist:</span>
</span><span id="PumpWoodMicroService.execute_action-776"><a href="#PumpWoodMicroService.execute_action-776"><span class="linenos">776</span></a><span class="sd">                &#39;Requested object {model_class}[{pk}] not found.&#39;. This</span>
</span><span id="PumpWoodMicroService.execute_action-777"><a href="#PumpWoodMicroService.execute_action-777"><span class="linenos">777</span></a><span class="sd">                indicate that pk associated with model class was not found</span>
</span><span id="PumpWoodMicroService.execute_action-778"><a href="#PumpWoodMicroService.execute_action-778"><span class="linenos">778</span></a><span class="sd">                on database.</span>
</span><span id="PumpWoodMicroService.execute_action-779"><a href="#PumpWoodMicroService.execute_action-779"><span class="linenos">779</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.execute_action-780"><a href="#PumpWoodMicroService.execute_action-780"><span class="linenos">780</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_execute_action_url</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.execute_action-781"><a href="#PumpWoodMicroService.execute_action-781"><span class="linenos">781</span></a>            <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.execute_action-782"><a href="#PumpWoodMicroService.execute_action-782"><span class="linenos">782</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.execute_action-783"><a href="#PumpWoodMicroService.execute_action-783"><span class="linenos">783</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.execute_action-784"><a href="#PumpWoodMicroService.execute_action-784"><span class="linenos">784</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Execute action associated with a model class.</p>

<p>If action is static or classfunction no pk is necessary.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>pk (int):</strong>  PK of the object to run action at. If not set action will be
considered a classmethod and will run over the class.</li>
<li><strong>model_class:</strong>  Model class to run action the object</li>
<li><strong>action:</strong>  Action that will be performed.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
<li><strong>parameters:</strong>  Dictionary with the function parameters.</li>
<li><strong>files:</strong>  A dictionary of files to be added to as a multi-part
post request. File must be passed as a file object with read
bytes.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Return a dictonary with keys:</p>
  
  <ul>
  <li><strong>result:</strong>: Result of the action that was performed.</li>
  <li><strong>action:</strong>: Information of the action that was performed.</li>
  <li><strong>parameters:</strong> Parameters that were passed to perform the
  action.</li>
  <li><strong>object:</strong> If a pk was passed to execute and action (not
  classmethod or staticmethod), the object with the correspondent
  pk is returned.</li>
  </ul>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'There is no method {action} in rest actions for {class_name}'.
This indicates that action requested is not associated with
the model_class.</li>
<li><strong>PumpWoodActionArgsException:</strong>  'Function is not static and pk is Null'. This indicate that
the action solicitated is not static/class method and a pk
was not passed as argument.</li>
<li><strong>PumpWoodActionArgsException:</strong>  'Function is static and pk is not Null'. This indicate that
the action solicitated is static/class method and a pk
was passed as argument.</li>
<li><strong>PumpWoodObjectDoesNotExist:</strong>  'Requested object {model_class}[{pk}] not found.'. This
indicate that pk associated with model class was not found
on database.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.search_options" class="classattr">
                                        <input id="PumpWoodMicroService.search_options-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">search_options</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.search_options-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.search_options"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.search_options-786"><a href="#PumpWoodMicroService.search_options-786"><span class="linenos">786</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">search_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.search_options-787"><a href="#PumpWoodMicroService.search_options-787"><span class="linenos">787</span></a>                       <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.search_options-788"><a href="#PumpWoodMicroService.search_options-788"><span class="linenos">788</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return search options.</span>
</span><span id="PumpWoodMicroService.search_options-789"><a href="#PumpWoodMicroService.search_options-789"><span class="linenos">789</span></a>
</span><span id="PumpWoodMicroService.search_options-790"><a href="#PumpWoodMicroService.search_options-790"><span class="linenos">790</span></a><span class="sd">        DEPRECTED Use `list_options` function instead.</span>
</span><span id="PumpWoodMicroService.search_options-791"><a href="#PumpWoodMicroService.search_options-791"><span class="linenos">791</span></a>
</span><span id="PumpWoodMicroService.search_options-792"><a href="#PumpWoodMicroService.search_options-792"><span class="linenos">792</span></a><span class="sd">        Return information of the fields including avaiable options for</span>
</span><span id="PumpWoodMicroService.search_options-793"><a href="#PumpWoodMicroService.search_options-793"><span class="linenos">793</span></a><span class="sd">        options fields and model associated with the foreign key.</span>
</span><span id="PumpWoodMicroService.search_options-794"><a href="#PumpWoodMicroService.search_options-794"><span class="linenos">794</span></a>
</span><span id="PumpWoodMicroService.search_options-795"><a href="#PumpWoodMicroService.search_options-795"><span class="linenos">795</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.search_options-796"><a href="#PumpWoodMicroService.search_options-796"><span class="linenos">796</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.search_options-797"><a href="#PumpWoodMicroService.search_options-797"><span class="linenos">797</span></a><span class="sd">                Model class to check search parameters</span>
</span><span id="PumpWoodMicroService.search_options-798"><a href="#PumpWoodMicroService.search_options-798"><span class="linenos">798</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.search_options-799"><a href="#PumpWoodMicroService.search_options-799"><span class="linenos">799</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.search_options-800"><a href="#PumpWoodMicroService.search_options-800"><span class="linenos">800</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.search_options-801"><a href="#PumpWoodMicroService.search_options-801"><span class="linenos">801</span></a>
</span><span id="PumpWoodMicroService.search_options-802"><a href="#PumpWoodMicroService.search_options-802"><span class="linenos">802</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.search_options-803"><a href="#PumpWoodMicroService.search_options-803"><span class="linenos">803</span></a><span class="sd">            Return a dictonary with field names as keys and information of</span>
</span><span id="PumpWoodMicroService.search_options-804"><a href="#PumpWoodMicroService.search_options-804"><span class="linenos">804</span></a><span class="sd">            them as values. Information at values:</span>
</span><span id="PumpWoodMicroService.search_options-805"><a href="#PumpWoodMicroService.search_options-805"><span class="linenos">805</span></a><span class="sd">            - **primary_key [bool]:**: Boolean indicating if field is part</span>
</span><span id="PumpWoodMicroService.search_options-806"><a href="#PumpWoodMicroService.search_options-806"><span class="linenos">806</span></a><span class="sd">                of model_class primary key.</span>
</span><span id="PumpWoodMicroService.search_options-807"><a href="#PumpWoodMicroService.search_options-807"><span class="linenos">807</span></a><span class="sd">            - **column [str]:**: Name of the column.</span>
</span><span id="PumpWoodMicroService.search_options-808"><a href="#PumpWoodMicroService.search_options-808"><span class="linenos">808</span></a><span class="sd">            - **column__verbose [str]:** Name of the column translated using</span>
</span><span id="PumpWoodMicroService.search_options-809"><a href="#PumpWoodMicroService.search_options-809"><span class="linenos">809</span></a><span class="sd">                Pumpwood I8s.</span>
</span><span id="PumpWoodMicroService.search_options-810"><a href="#PumpWoodMicroService.search_options-810"><span class="linenos">810</span></a><span class="sd">            - **help_text [str]:** Help text associated with column.</span>
</span><span id="PumpWoodMicroService.search_options-811"><a href="#PumpWoodMicroService.search_options-811"><span class="linenos">811</span></a><span class="sd">            - **help_text__verbose [str]:** Help text associated with column</span>
</span><span id="PumpWoodMicroService.search_options-812"><a href="#PumpWoodMicroService.search_options-812"><span class="linenos">812</span></a><span class="sd">                translated using Pumpwood I8s.</span>
</span><span id="PumpWoodMicroService.search_options-813"><a href="#PumpWoodMicroService.search_options-813"><span class="linenos">813</span></a><span class="sd">            - **type [str]:** Python type associated with the column.</span>
</span><span id="PumpWoodMicroService.search_options-814"><a href="#PumpWoodMicroService.search_options-814"><span class="linenos">814</span></a><span class="sd">            - **nullable [bool]:** If field can be set as null (None).</span>
</span><span id="PumpWoodMicroService.search_options-815"><a href="#PumpWoodMicroService.search_options-815"><span class="linenos">815</span></a><span class="sd">            - **read_only [bool]:** If field is marked as read-only. Passsing</span>
</span><span id="PumpWoodMicroService.search_options-816"><a href="#PumpWoodMicroService.search_options-816"><span class="linenos">816</span></a><span class="sd">                information for this field will not be used in save end-point.</span>
</span><span id="PumpWoodMicroService.search_options-817"><a href="#PumpWoodMicroService.search_options-817"><span class="linenos">817</span></a><span class="sd">            - **default [any]:** Default value of the field if not set using</span>
</span><span id="PumpWoodMicroService.search_options-818"><a href="#PumpWoodMicroService.search_options-818"><span class="linenos">818</span></a><span class="sd">                save end-poin.</span>
</span><span id="PumpWoodMicroService.search_options-819"><a href="#PumpWoodMicroService.search_options-819"><span class="linenos">819</span></a><span class="sd">            - **unique [bool]:** If the there is a constrain in database</span>
</span><span id="PumpWoodMicroService.search_options-820"><a href="#PumpWoodMicroService.search_options-820"><span class="linenos">820</span></a><span class="sd">                setting this field to be unique.</span>
</span><span id="PumpWoodMicroService.search_options-821"><a href="#PumpWoodMicroService.search_options-821"><span class="linenos">821</span></a><span class="sd">            - **extra_info:** Some extra infomations used to pass associated</span>
</span><span id="PumpWoodMicroService.search_options-822"><a href="#PumpWoodMicroService.search_options-822"><span class="linenos">822</span></a><span class="sd">                model class for forenging key and related fields.</span>
</span><span id="PumpWoodMicroService.search_options-823"><a href="#PumpWoodMicroService.search_options-823"><span class="linenos">823</span></a><span class="sd">            - **in [dict]:** At options fields, have their options listed in</span>
</span><span id="PumpWoodMicroService.search_options-824"><a href="#PumpWoodMicroService.search_options-824"><span class="linenos">824</span></a><span class="sd">                `in` keys. It will return the values as key and de description</span>
</span><span id="PumpWoodMicroService.search_options-825"><a href="#PumpWoodMicroService.search_options-825"><span class="linenos">825</span></a><span class="sd">                and description__verbose (translated by Pumpwood I8s)</span>
</span><span id="PumpWoodMicroService.search_options-826"><a href="#PumpWoodMicroService.search_options-826"><span class="linenos">826</span></a><span class="sd">                as values.</span>
</span><span id="PumpWoodMicroService.search_options-827"><a href="#PumpWoodMicroService.search_options-827"><span class="linenos">827</span></a><span class="sd">            - **partition:** At pk field, this key indicates if the database</span>
</span><span id="PumpWoodMicroService.search_options-828"><a href="#PumpWoodMicroService.search_options-828"><span class="linenos">828</span></a><span class="sd">                if partitioned. Partitioned will perform better in queries if</span>
</span><span id="PumpWoodMicroService.search_options-829"><a href="#PumpWoodMicroService.search_options-829"><span class="linenos">829</span></a><span class="sd">                partition is used on filter or exclude clauses. If table has</span>
</span><span id="PumpWoodMicroService.search_options-830"><a href="#PumpWoodMicroService.search_options-830"><span class="linenos">830</span></a><span class="sd">                more than one level o partition, at least the first one must</span>
</span><span id="PumpWoodMicroService.search_options-831"><a href="#PumpWoodMicroService.search_options-831"><span class="linenos">831</span></a><span class="sd">                be used when retrieving data.</span>
</span><span id="PumpWoodMicroService.search_options-832"><a href="#PumpWoodMicroService.search_options-832"><span class="linenos">832</span></a>
</span><span id="PumpWoodMicroService.search_options-833"><a href="#PumpWoodMicroService.search_options-833"><span class="linenos">833</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.search_options-834"><a href="#PumpWoodMicroService.search_options-834"><span class="linenos">834</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService.search_options-835"><a href="#PumpWoodMicroService.search_options-835"><span class="linenos">835</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.search_options-836"><a href="#PumpWoodMicroService.search_options-836"><span class="linenos">836</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/options/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="p">)</span>
</span><span id="PumpWoodMicroService.search_options-837"><a href="#PumpWoodMicroService.search_options-837"><span class="linenos">837</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return search options.</p>

<p>DEPRECTED Use <code><a href="#PumpWoodMicroService.list_options">list_options</a></code> function instead.</p>

<p>Return information of the fields including avaiable options for
options fields and model associated with the foreign key.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class to check search parameters</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Return a dictonary with field names as keys and information of
  them as values. Information at values:</p>
  
  <ul>
  <li><strong>primary_key [bool]:</strong>: Boolean indicating if field is part
  of model_class primary key.</li>
  <li><strong>column [str]:</strong>: Name of the column.</li>
  <li><strong>column__verbose [str]:</strong> Name of the column translated using
  Pumpwood I8s.</li>
  <li><strong>help_text [str]:</strong> Help text associated with column.</li>
  <li><strong>help_text__verbose [str]:</strong> Help text associated with column
  translated using Pumpwood I8s.</li>
  <li><strong>type [str]:</strong> Python type associated with the column.</li>
  <li><strong>nullable [bool]:</strong> If field can be set as null (None).</li>
  <li><strong>read_only [bool]:</strong> If field is marked as read-only. Passsing
  information for this field will not be used in save end-point.</li>
  <li><strong>default [any]:</strong> Default value of the field if not set using
  save end-poin.</li>
  <li><strong>unique [bool]:</strong> If the there is a constrain in database
  setting this field to be unique.</li>
  <li><strong>extra_info:</strong> Some extra infomations used to pass associated
  model class for forenging key and related fields.</li>
  <li><strong>in [dict]:</strong> At options fields, have their options listed in
  <code>in</code> keys. It will return the values as key and de description
  and description__verbose (translated by Pumpwood I8s)
  as values.</li>
  <li><strong>partition:</strong> At pk field, this key indicates if the database
  if partitioned. Partitioned will perform better in queries if
  partition is used on filter or exclude clauses. If table has
  more than one level o partition, at least the first one must
  be used when retrieving data.</li>
  </ul>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No particular raises.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.fill_options" class="classattr">
                                        <input id="PumpWoodMicroService.fill_options-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fill_options</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span>,</span><span class="param">	<span class="n">parcial_obj_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.fill_options-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.fill_options"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.fill_options-839"><a href="#PumpWoodMicroService.fill_options-839"><span class="linenos">839</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fill_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">,</span> <span class="n">parcial_obj_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService.fill_options-840"><a href="#PumpWoodMicroService.fill_options-840"><span class="linenos">840</span></a>                     <span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.fill_options-841"><a href="#PumpWoodMicroService.fill_options-841"><span class="linenos">841</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options for object fields.</span>
</span><span id="PumpWoodMicroService.fill_options-842"><a href="#PumpWoodMicroService.fill_options-842"><span class="linenos">842</span></a>
</span><span id="PumpWoodMicroService.fill_options-843"><a href="#PumpWoodMicroService.fill_options-843"><span class="linenos">843</span></a><span class="sd">        DEPRECTED Use `fill_validation` function instead.</span>
</span><span id="PumpWoodMicroService.fill_options-844"><a href="#PumpWoodMicroService.fill_options-844"><span class="linenos">844</span></a>
</span><span id="PumpWoodMicroService.fill_options-845"><a href="#PumpWoodMicroService.fill_options-845"><span class="linenos">845</span></a><span class="sd">        This function send partial object data and return options to finish</span>
</span><span id="PumpWoodMicroService.fill_options-846"><a href="#PumpWoodMicroService.fill_options-846"><span class="linenos">846</span></a><span class="sd">        object fillment.</span>
</span><span id="PumpWoodMicroService.fill_options-847"><a href="#PumpWoodMicroService.fill_options-847"><span class="linenos">847</span></a>
</span><span id="PumpWoodMicroService.fill_options-848"><a href="#PumpWoodMicroService.fill_options-848"><span class="linenos">848</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.fill_options-849"><a href="#PumpWoodMicroService.fill_options-849"><span class="linenos">849</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.fill_options-850"><a href="#PumpWoodMicroService.fill_options-850"><span class="linenos">850</span></a><span class="sd">                Model class to check search parameters</span>
</span><span id="PumpWoodMicroService.fill_options-851"><a href="#PumpWoodMicroService.fill_options-851"><span class="linenos">851</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.fill_options-852"><a href="#PumpWoodMicroService.fill_options-852"><span class="linenos">852</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.fill_options-853"><a href="#PumpWoodMicroService.fill_options-853"><span class="linenos">853</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.fill_options-854"><a href="#PumpWoodMicroService.fill_options-854"><span class="linenos">854</span></a><span class="sd">            parcial_obj_dict:</span>
</span><span id="PumpWoodMicroService.fill_options-855"><a href="#PumpWoodMicroService.fill_options-855"><span class="linenos">855</span></a><span class="sd">                Partial object that is sent to backend for validation and</span>
</span><span id="PumpWoodMicroService.fill_options-856"><a href="#PumpWoodMicroService.fill_options-856"><span class="linenos">856</span></a><span class="sd">                update fill options acording to values passed for each field.</span>
</span><span id="PumpWoodMicroService.fill_options-857"><a href="#PumpWoodMicroService.fill_options-857"><span class="linenos">857</span></a><span class="sd">            field:</span>
</span><span id="PumpWoodMicroService.fill_options-858"><a href="#PumpWoodMicroService.fill_options-858"><span class="linenos">858</span></a><span class="sd">                Retrict validation for an especific field if implemented.</span>
</span><span id="PumpWoodMicroService.fill_options-859"><a href="#PumpWoodMicroService.fill_options-859"><span class="linenos">859</span></a>
</span><span id="PumpWoodMicroService.fill_options-860"><a href="#PumpWoodMicroService.fill_options-860"><span class="linenos">860</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.fill_options-861"><a href="#PumpWoodMicroService.fill_options-861"><span class="linenos">861</span></a><span class="sd">            Return a dictonary with field names as keys and information of</span>
</span><span id="PumpWoodMicroService.fill_options-862"><a href="#PumpWoodMicroService.fill_options-862"><span class="linenos">862</span></a><span class="sd">            them as values. Information at values:</span>
</span><span id="PumpWoodMicroService.fill_options-863"><a href="#PumpWoodMicroService.fill_options-863"><span class="linenos">863</span></a><span class="sd">            - **primary_key [bool]:**: Boolean indicating if field is part</span>
</span><span id="PumpWoodMicroService.fill_options-864"><a href="#PumpWoodMicroService.fill_options-864"><span class="linenos">864</span></a><span class="sd">                of model_class primary key.</span>
</span><span id="PumpWoodMicroService.fill_options-865"><a href="#PumpWoodMicroService.fill_options-865"><span class="linenos">865</span></a><span class="sd">            - **column [str]:**: Name of the column.</span>
</span><span id="PumpWoodMicroService.fill_options-866"><a href="#PumpWoodMicroService.fill_options-866"><span class="linenos">866</span></a><span class="sd">            - **column__verbose [str]:** Name of the column translated using</span>
</span><span id="PumpWoodMicroService.fill_options-867"><a href="#PumpWoodMicroService.fill_options-867"><span class="linenos">867</span></a><span class="sd">                Pumpwood I8s.</span>
</span><span id="PumpWoodMicroService.fill_options-868"><a href="#PumpWoodMicroService.fill_options-868"><span class="linenos">868</span></a><span class="sd">            - **help_text [str]:** Help text associated with column.</span>
</span><span id="PumpWoodMicroService.fill_options-869"><a href="#PumpWoodMicroService.fill_options-869"><span class="linenos">869</span></a><span class="sd">            - **help_text__verbose [str]:** Help text associated with column</span>
</span><span id="PumpWoodMicroService.fill_options-870"><a href="#PumpWoodMicroService.fill_options-870"><span class="linenos">870</span></a><span class="sd">                translated using Pumpwood I8s.</span>
</span><span id="PumpWoodMicroService.fill_options-871"><a href="#PumpWoodMicroService.fill_options-871"><span class="linenos">871</span></a><span class="sd">            - **type [str]:** Python type associated with the column.</span>
</span><span id="PumpWoodMicroService.fill_options-872"><a href="#PumpWoodMicroService.fill_options-872"><span class="linenos">872</span></a><span class="sd">            - **nullable [bool]:** If field can be set as null (None).</span>
</span><span id="PumpWoodMicroService.fill_options-873"><a href="#PumpWoodMicroService.fill_options-873"><span class="linenos">873</span></a><span class="sd">            - **read_only [bool]:** If field is marked as read-only. Passsing</span>
</span><span id="PumpWoodMicroService.fill_options-874"><a href="#PumpWoodMicroService.fill_options-874"><span class="linenos">874</span></a><span class="sd">                information for this field will not be used in save end-point.</span>
</span><span id="PumpWoodMicroService.fill_options-875"><a href="#PumpWoodMicroService.fill_options-875"><span class="linenos">875</span></a><span class="sd">            - **default [any]:** Default value of the field if not set using</span>
</span><span id="PumpWoodMicroService.fill_options-876"><a href="#PumpWoodMicroService.fill_options-876"><span class="linenos">876</span></a><span class="sd">                save end-poin.</span>
</span><span id="PumpWoodMicroService.fill_options-877"><a href="#PumpWoodMicroService.fill_options-877"><span class="linenos">877</span></a><span class="sd">            - **unique [bool]:** If the there is a constrain in database</span>
</span><span id="PumpWoodMicroService.fill_options-878"><a href="#PumpWoodMicroService.fill_options-878"><span class="linenos">878</span></a><span class="sd">                setting this field to be unique.</span>
</span><span id="PumpWoodMicroService.fill_options-879"><a href="#PumpWoodMicroService.fill_options-879"><span class="linenos">879</span></a><span class="sd">            - **extra_info:** Some extra infomations used to pass associated</span>
</span><span id="PumpWoodMicroService.fill_options-880"><a href="#PumpWoodMicroService.fill_options-880"><span class="linenos">880</span></a><span class="sd">                model class for forenging key and related fields.</span>
</span><span id="PumpWoodMicroService.fill_options-881"><a href="#PumpWoodMicroService.fill_options-881"><span class="linenos">881</span></a><span class="sd">            - **in [dict]:** At options fields, have their options listed in</span>
</span><span id="PumpWoodMicroService.fill_options-882"><a href="#PumpWoodMicroService.fill_options-882"><span class="linenos">882</span></a><span class="sd">                `in` keys. It will return the values as key and de description</span>
</span><span id="PumpWoodMicroService.fill_options-883"><a href="#PumpWoodMicroService.fill_options-883"><span class="linenos">883</span></a><span class="sd">                and description__verbose (translated by Pumpwood I8s)</span>
</span><span id="PumpWoodMicroService.fill_options-884"><a href="#PumpWoodMicroService.fill_options-884"><span class="linenos">884</span></a><span class="sd">                as values.</span>
</span><span id="PumpWoodMicroService.fill_options-885"><a href="#PumpWoodMicroService.fill_options-885"><span class="linenos">885</span></a><span class="sd">            - **partition:** At pk field, this key indicates if the database</span>
</span><span id="PumpWoodMicroService.fill_options-886"><a href="#PumpWoodMicroService.fill_options-886"><span class="linenos">886</span></a><span class="sd">                if partitioned. Partitioned will perform better in queries if</span>
</span><span id="PumpWoodMicroService.fill_options-887"><a href="#PumpWoodMicroService.fill_options-887"><span class="linenos">887</span></a><span class="sd">                partition is used on filter or exclude clauses. If table has</span>
</span><span id="PumpWoodMicroService.fill_options-888"><a href="#PumpWoodMicroService.fill_options-888"><span class="linenos">888</span></a><span class="sd">                more than one level o partition, at least the first one must</span>
</span><span id="PumpWoodMicroService.fill_options-889"><a href="#PumpWoodMicroService.fill_options-889"><span class="linenos">889</span></a><span class="sd">                be used when retrieving data.</span>
</span><span id="PumpWoodMicroService.fill_options-890"><a href="#PumpWoodMicroService.fill_options-890"><span class="linenos">890</span></a>
</span><span id="PumpWoodMicroService.fill_options-891"><a href="#PumpWoodMicroService.fill_options-891"><span class="linenos">891</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.fill_options-892"><a href="#PumpWoodMicroService.fill_options-892"><span class="linenos">892</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService.fill_options-893"><a href="#PumpWoodMicroService.fill_options-893"><span class="linenos">893</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.fill_options-894"><a href="#PumpWoodMicroService.fill_options-894"><span class="linenos">894</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">%s</span><span class="s2">/options/&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="p">)</span>
</span><span id="PumpWoodMicroService.fill_options-895"><a href="#PumpWoodMicroService.fill_options-895"><span class="linenos">895</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.fill_options-896"><a href="#PumpWoodMicroService.fill_options-896"><span class="linenos">896</span></a>            <span class="n">url_str</span> <span class="o">=</span> <span class="n">url_str</span> <span class="o">+</span> <span class="n">field</span>
</span><span id="PumpWoodMicroService.fill_options-897"><a href="#PumpWoodMicroService.fill_options-897"><span class="linenos">897</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.fill_options-898"><a href="#PumpWoodMicroService.fill_options-898"><span class="linenos">898</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parcial_obj_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.fill_options-899"><a href="#PumpWoodMicroService.fill_options-899"><span class="linenos">899</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return options for object fields.</p>

<p>DEPRECTED Use <code><a href="#PumpWoodMicroService.fill_validation">fill_validation</a></code> function instead.</p>

<p>This function send partial object data and return options to finish
object fillment.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class to check search parameters</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
<li><strong>parcial_obj_dict:</strong>  Partial object that is sent to backend for validation and
update fill options acording to values passed for each field.</li>
<li><strong>field:</strong>  Retrict validation for an especific field if implemented.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Return a dictonary with field names as keys and information of
  them as values. Information at values:</p>
  
  <ul>
  <li><strong>primary_key [bool]:</strong>: Boolean indicating if field is part
  of model_class primary key.</li>
  <li><strong>column [str]:</strong>: Name of the column.</li>
  <li><strong>column__verbose [str]:</strong> Name of the column translated using
  Pumpwood I8s.</li>
  <li><strong>help_text [str]:</strong> Help text associated with column.</li>
  <li><strong>help_text__verbose [str]:</strong> Help text associated with column
  translated using Pumpwood I8s.</li>
  <li><strong>type [str]:</strong> Python type associated with the column.</li>
  <li><strong>nullable [bool]:</strong> If field can be set as null (None).</li>
  <li><strong>read_only [bool]:</strong> If field is marked as read-only. Passsing
  information for this field will not be used in save end-point.</li>
  <li><strong>default [any]:</strong> Default value of the field if not set using
  save end-poin.</li>
  <li><strong>unique [bool]:</strong> If the there is a constrain in database
  setting this field to be unique.</li>
  <li><strong>extra_info:</strong> Some extra infomations used to pass associated
  model class for forenging key and related fields.</li>
  <li><strong>in [dict]:</strong> At options fields, have their options listed in
  <code>in</code> keys. It will return the values as key and de description
  and description__verbose (translated by Pumpwood I8s)
  as values.</li>
  <li><strong>partition:</strong> At pk field, this key indicates if the database
  if partitioned. Partitioned will perform better in queries if
  partition is used on filter or exclude clauses. If table has
  more than one level o partition, at least the first one must
  be used when retrieving data.</li>
  </ul>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No particular raises.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.list_options" class="classattr">
                                        <input id="PumpWoodMicroService.list_options-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">list_options</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.list_options-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.list_options"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.list_options-901"><a href="#PumpWoodMicroService.list_options-901"><span class="linenos">901</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">list_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.list_options-902"><a href="#PumpWoodMicroService.list_options-902"><span class="linenos">902</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options to render list views.</span>
</span><span id="PumpWoodMicroService.list_options-903"><a href="#PumpWoodMicroService.list_options-903"><span class="linenos">903</span></a>
</span><span id="PumpWoodMicroService.list_options-904"><a href="#PumpWoodMicroService.list_options-904"><span class="linenos">904</span></a><span class="sd">        This function send partial object data and return options to finish</span>
</span><span id="PumpWoodMicroService.list_options-905"><a href="#PumpWoodMicroService.list_options-905"><span class="linenos">905</span></a><span class="sd">        object fillment.</span>
</span><span id="PumpWoodMicroService.list_options-906"><a href="#PumpWoodMicroService.list_options-906"><span class="linenos">906</span></a>
</span><span id="PumpWoodMicroService.list_options-907"><a href="#PumpWoodMicroService.list_options-907"><span class="linenos">907</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.list_options-908"><a href="#PumpWoodMicroService.list_options-908"><span class="linenos">908</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.list_options-909"><a href="#PumpWoodMicroService.list_options-909"><span class="linenos">909</span></a><span class="sd">                Model class to check search parameters.</span>
</span><span id="PumpWoodMicroService.list_options-910"><a href="#PumpWoodMicroService.list_options-910"><span class="linenos">910</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.list_options-911"><a href="#PumpWoodMicroService.list_options-911"><span class="linenos">911</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.list_options-912"><a href="#PumpWoodMicroService.list_options-912"><span class="linenos">912</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.list_options-913"><a href="#PumpWoodMicroService.list_options-913"><span class="linenos">913</span></a>
</span><span id="PumpWoodMicroService.list_options-914"><a href="#PumpWoodMicroService.list_options-914"><span class="linenos">914</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.list_options-915"><a href="#PumpWoodMicroService.list_options-915"><span class="linenos">915</span></a><span class="sd">            Dictionary with keys:</span>
</span><span id="PumpWoodMicroService.list_options-916"><a href="#PumpWoodMicroService.list_options-916"><span class="linenos">916</span></a><span class="sd">            - **default_list_fields:** Default list field defined on the</span>
</span><span id="PumpWoodMicroService.list_options-917"><a href="#PumpWoodMicroService.list_options-917"><span class="linenos">917</span></a><span class="sd">                application backend.</span>
</span><span id="PumpWoodMicroService.list_options-918"><a href="#PumpWoodMicroService.list_options-918"><span class="linenos">918</span></a><span class="sd">            - **field_descriptions:** Description of the fields associated</span>
</span><span id="PumpWoodMicroService.list_options-919"><a href="#PumpWoodMicroService.list_options-919"><span class="linenos">919</span></a><span class="sd">                with the model class.</span>
</span><span id="PumpWoodMicroService.list_options-920"><a href="#PumpWoodMicroService.list_options-920"><span class="linenos">920</span></a>
</span><span id="PumpWoodMicroService.list_options-921"><a href="#PumpWoodMicroService.list_options-921"><span class="linenos">921</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.list_options-922"><a href="#PumpWoodMicroService.list_options-922"><span class="linenos">922</span></a><span class="sd">          No particular raise.</span>
</span><span id="PumpWoodMicroService.list_options-923"><a href="#PumpWoodMicroService.list_options-923"><span class="linenos">923</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.list_options-924"><a href="#PumpWoodMicroService.list_options-924"><span class="linenos">924</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">{basename}</span><span class="s2">/list-options/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.list_options-925"><a href="#PumpWoodMicroService.list_options-925"><span class="linenos">925</span></a>            <span class="n">basename</span><span class="o">=</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="PumpWoodMicroService.list_options-926"><a href="#PumpWoodMicroService.list_options-926"><span class="linenos">926</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.list_options-927"><a href="#PumpWoodMicroService.list_options-927"><span class="linenos">927</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return options to render list views.</p>

<p>This function send partial object data and return options to finish
object fillment.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class to check search parameters.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Dictionary with keys:</p>
  
  <ul>
  <li><strong>default_list_fields:</strong> Default list field defined on the
  application backend.</li>
  <li><strong>field_descriptions:</strong> Description of the fields associated
  with the model class.</li>
  </ul>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No particular raise.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.retrieve_options" class="classattr">
                                        <input id="PumpWoodMicroService.retrieve_options-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">retrieve_options</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>, </span><span class="param"><span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.retrieve_options-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.retrieve_options"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.retrieve_options-929"><a href="#PumpWoodMicroService.retrieve_options-929"><span class="linenos">929</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">retrieve_options</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.retrieve_options-930"><a href="#PumpWoodMicroService.retrieve_options-930"><span class="linenos">930</span></a>                         <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.retrieve_options-931"><a href="#PumpWoodMicroService.retrieve_options-931"><span class="linenos">931</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options to render retrieve views.</span>
</span><span id="PumpWoodMicroService.retrieve_options-932"><a href="#PumpWoodMicroService.retrieve_options-932"><span class="linenos">932</span></a>
</span><span id="PumpWoodMicroService.retrieve_options-933"><a href="#PumpWoodMicroService.retrieve_options-933"><span class="linenos">933</span></a><span class="sd">        Return information of the field sets that can be used to create</span>
</span><span id="PumpWoodMicroService.retrieve_options-934"><a href="#PumpWoodMicroService.retrieve_options-934"><span class="linenos">934</span></a><span class="sd">        frontend site. It also return a `verbose_field` which can be used</span>
</span><span id="PumpWoodMicroService.retrieve_options-935"><a href="#PumpWoodMicroService.retrieve_options-935"><span class="linenos">935</span></a><span class="sd">        to create the tittle of the page substituing the values with</span>
</span><span id="PumpWoodMicroService.retrieve_options-936"><a href="#PumpWoodMicroService.retrieve_options-936"><span class="linenos">936</span></a><span class="sd">        information of the object.</span>
</span><span id="PumpWoodMicroService.retrieve_options-937"><a href="#PumpWoodMicroService.retrieve_options-937"><span class="linenos">937</span></a>
</span><span id="PumpWoodMicroService.retrieve_options-938"><a href="#PumpWoodMicroService.retrieve_options-938"><span class="linenos">938</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.retrieve_options-939"><a href="#PumpWoodMicroService.retrieve_options-939"><span class="linenos">939</span></a><span class="sd">          model_class:</span>
</span><span id="PumpWoodMicroService.retrieve_options-940"><a href="#PumpWoodMicroService.retrieve_options-940"><span class="linenos">940</span></a><span class="sd">              Model class to check search parameters.</span>
</span><span id="PumpWoodMicroService.retrieve_options-941"><a href="#PumpWoodMicroService.retrieve_options-941"><span class="linenos">941</span></a><span class="sd">          auth_header:</span>
</span><span id="PumpWoodMicroService.retrieve_options-942"><a href="#PumpWoodMicroService.retrieve_options-942"><span class="linenos">942</span></a><span class="sd">              Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.retrieve_options-943"><a href="#PumpWoodMicroService.retrieve_options-943"><span class="linenos">943</span></a><span class="sd">              at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.retrieve_options-944"><a href="#PumpWoodMicroService.retrieve_options-944"><span class="linenos">944</span></a>
</span><span id="PumpWoodMicroService.retrieve_options-945"><a href="#PumpWoodMicroService.retrieve_options-945"><span class="linenos">945</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.retrieve_options-946"><a href="#PumpWoodMicroService.retrieve_options-946"><span class="linenos">946</span></a><span class="sd">            Return a dictinary with keys:</span>
</span><span id="PumpWoodMicroService.retrieve_options-947"><a href="#PumpWoodMicroService.retrieve_options-947"><span class="linenos">947</span></a><span class="sd">            - **verbose_field:** String sugesting how the tittle of the</span>
</span><span id="PumpWoodMicroService.retrieve_options-948"><a href="#PumpWoodMicroService.retrieve_options-948"><span class="linenos">948</span></a><span class="sd">                retrieve might be created. It will use Python format</span>
</span><span id="PumpWoodMicroService.retrieve_options-949"><a href="#PumpWoodMicroService.retrieve_options-949"><span class="linenos">949</span></a><span class="sd">                information ex.: `&#39;{pk} | {description}&#39;`.</span>
</span><span id="PumpWoodMicroService.retrieve_options-950"><a href="#PumpWoodMicroService.retrieve_options-950"><span class="linenos">950</span></a><span class="sd">            - **fieldset:** An dictinary with organization of data,</span>
</span><span id="PumpWoodMicroService.retrieve_options-951"><a href="#PumpWoodMicroService.retrieve_options-951"><span class="linenos">951</span></a><span class="sd">                setting field sets that could be grouped toguether in</span>
</span><span id="PumpWoodMicroService.retrieve_options-952"><a href="#PumpWoodMicroService.retrieve_options-952"><span class="linenos">952</span></a><span class="sd">                tabs.</span>
</span><span id="PumpWoodMicroService.retrieve_options-953"><a href="#PumpWoodMicroService.retrieve_options-953"><span class="linenos">953</span></a>
</span><span id="PumpWoodMicroService.retrieve_options-954"><a href="#PumpWoodMicroService.retrieve_options-954"><span class="linenos">954</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.retrieve_options-955"><a href="#PumpWoodMicroService.retrieve_options-955"><span class="linenos">955</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService.retrieve_options-956"><a href="#PumpWoodMicroService.retrieve_options-956"><span class="linenos">956</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.retrieve_options-957"><a href="#PumpWoodMicroService.retrieve_options-957"><span class="linenos">957</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">{basename}</span><span class="s2">/retrieve-options/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.retrieve_options-958"><a href="#PumpWoodMicroService.retrieve_options-958"><span class="linenos">958</span></a>            <span class="n">basename</span><span class="o">=</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="PumpWoodMicroService.retrieve_options-959"><a href="#PumpWoodMicroService.retrieve_options-959"><span class="linenos">959</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.retrieve_options-960"><a href="#PumpWoodMicroService.retrieve_options-960"><span class="linenos">960</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return options to render retrieve views.</p>

<p>Return information of the field sets that can be used to create
frontend site. It also return a <code>verbose_field</code> which can be used
to create the tittle of the page substituing the values with
information of the object.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class to check search parameters.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Return a dictinary with keys:</p>
  
  <ul>
  <li><strong>verbose_field:</strong> String sugesting how the tittle of the
  retrieve might be created. It will use Python format
  information ex.: <code>'{pk} | {description}'</code>.</li>
  <li><strong>fieldset:</strong> An dictinary with organization of data,
  setting field sets that could be grouped toguether in
  tabs.</li>
  </ul>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No particular raises.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.fill_validation" class="classattr">
                                        <input id="PumpWoodMicroService.fill_validation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">fill_validation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">parcial_obj_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">user_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;api&#39;</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.fill_validation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.fill_validation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.fill_validation-962"><a href="#PumpWoodMicroService.fill_validation-962"><span class="linenos"> 962</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">fill_validation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parcial_obj_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService.fill_validation-963"><a href="#PumpWoodMicroService.fill_validation-963"><span class="linenos"> 963</span></a>                        <span class="n">field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.fill_validation-964"><a href="#PumpWoodMicroService.fill_validation-964"><span class="linenos"> 964</span></a>                        <span class="n">user_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;api&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.fill_validation-965"><a href="#PumpWoodMicroService.fill_validation-965"><span class="linenos"> 965</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Return options for object fields.</span>
</span><span id="PumpWoodMicroService.fill_validation-966"><a href="#PumpWoodMicroService.fill_validation-966"><span class="linenos"> 966</span></a>
</span><span id="PumpWoodMicroService.fill_validation-967"><a href="#PumpWoodMicroService.fill_validation-967"><span class="linenos"> 967</span></a><span class="sd">        This function send partial object data and return options to finish</span>
</span><span id="PumpWoodMicroService.fill_validation-968"><a href="#PumpWoodMicroService.fill_validation-968"><span class="linenos"> 968</span></a><span class="sd">        object fillment.</span>
</span><span id="PumpWoodMicroService.fill_validation-969"><a href="#PumpWoodMicroService.fill_validation-969"><span class="linenos"> 969</span></a>
</span><span id="PumpWoodMicroService.fill_validation-970"><a href="#PumpWoodMicroService.fill_validation-970"><span class="linenos"> 970</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.fill_validation-971"><a href="#PumpWoodMicroService.fill_validation-971"><span class="linenos"> 971</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.fill_validation-972"><a href="#PumpWoodMicroService.fill_validation-972"><span class="linenos"> 972</span></a><span class="sd">                Model class to check search parameters.</span>
</span><span id="PumpWoodMicroService.fill_validation-973"><a href="#PumpWoodMicroService.fill_validation-973"><span class="linenos"> 973</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.fill_validation-974"><a href="#PumpWoodMicroService.fill_validation-974"><span class="linenos"> 974</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.fill_validation-975"><a href="#PumpWoodMicroService.fill_validation-975"><span class="linenos"> 975</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.fill_validation-976"><a href="#PumpWoodMicroService.fill_validation-976"><span class="linenos"> 976</span></a><span class="sd">            parcial_obj_dict:</span>
</span><span id="PumpWoodMicroService.fill_validation-977"><a href="#PumpWoodMicroService.fill_validation-977"><span class="linenos"> 977</span></a><span class="sd">                Partial object data to be validated by the backend.</span>
</span><span id="PumpWoodMicroService.fill_validation-978"><a href="#PumpWoodMicroService.fill_validation-978"><span class="linenos"> 978</span></a><span class="sd">            field:</span>
</span><span id="PumpWoodMicroService.fill_validation-979"><a href="#PumpWoodMicroService.fill_validation-979"><span class="linenos"> 979</span></a><span class="sd">                Set an especific field to be validated if implemented.</span>
</span><span id="PumpWoodMicroService.fill_validation-980"><a href="#PumpWoodMicroService.fill_validation-980"><span class="linenos"> 980</span></a><span class="sd">            user_type:</span>
</span><span id="PumpWoodMicroService.fill_validation-981"><a href="#PumpWoodMicroService.fill_validation-981"><span class="linenos"> 981</span></a><span class="sd">                Set the type of user is requesting fill validation. It is</span>
</span><span id="PumpWoodMicroService.fill_validation-982"><a href="#PumpWoodMicroService.fill_validation-982"><span class="linenos"> 982</span></a><span class="sd">                possible to set `api` and `gui`. Gui user_type will return</span>
</span><span id="PumpWoodMicroService.fill_validation-983"><a href="#PumpWoodMicroService.fill_validation-983"><span class="linenos"> 983</span></a><span class="sd">                fields listed in gui_readonly as read-only fields to</span>
</span><span id="PumpWoodMicroService.fill_validation-984"><a href="#PumpWoodMicroService.fill_validation-984"><span class="linenos"> 984</span></a><span class="sd">                facilitate navegation.</span>
</span><span id="PumpWoodMicroService.fill_validation-985"><a href="#PumpWoodMicroService.fill_validation-985"><span class="linenos"> 985</span></a>
</span><span id="PumpWoodMicroService.fill_validation-986"><a href="#PumpWoodMicroService.fill_validation-986"><span class="linenos"> 986</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.fill_validation-987"><a href="#PumpWoodMicroService.fill_validation-987"><span class="linenos"> 987</span></a><span class="sd">            Return a dictinary with keys:</span>
</span><span id="PumpWoodMicroService.fill_validation-988"><a href="#PumpWoodMicroService.fill_validation-988"><span class="linenos"> 988</span></a><span class="sd">            - **field_descriptions:** Same of fill_options, but setting as</span>
</span><span id="PumpWoodMicroService.fill_validation-989"><a href="#PumpWoodMicroService.fill_validation-989"><span class="linenos"> 989</span></a><span class="sd">                read_only=True fields listed on gui_readonly if</span>
</span><span id="PumpWoodMicroService.fill_validation-990"><a href="#PumpWoodMicroService.fill_validation-990"><span class="linenos"> 990</span></a><span class="sd">                user_type=&#39;gui&#39;.</span>
</span><span id="PumpWoodMicroService.fill_validation-991"><a href="#PumpWoodMicroService.fill_validation-991"><span class="linenos"> 991</span></a><span class="sd">            - **gui_readonly:** Return a list of fields that will be</span>
</span><span id="PumpWoodMicroService.fill_validation-992"><a href="#PumpWoodMicroService.fill_validation-992"><span class="linenos"> 992</span></a><span class="sd">                considered as read-only if user_type=&#39;gui&#39; is requested.</span>
</span><span id="PumpWoodMicroService.fill_validation-993"><a href="#PumpWoodMicroService.fill_validation-993"><span class="linenos"> 993</span></a>
</span><span id="PumpWoodMicroService.fill_validation-994"><a href="#PumpWoodMicroService.fill_validation-994"><span class="linenos"> 994</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.fill_validation-995"><a href="#PumpWoodMicroService.fill_validation-995"><span class="linenos"> 995</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService.fill_validation-996"><a href="#PumpWoodMicroService.fill_validation-996"><span class="linenos"> 996</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.fill_validation-997"><a href="#PumpWoodMicroService.fill_validation-997"><span class="linenos"> 997</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="s2">&quot;rest/</span><span class="si">{basename}</span><span class="s2">/retrieve-options/&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.fill_validation-998"><a href="#PumpWoodMicroService.fill_validation-998"><span class="linenos"> 998</span></a>            <span class="n">basename</span><span class="o">=</span><span class="n">model_class</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</span><span id="PumpWoodMicroService.fill_validation-999"><a href="#PumpWoodMicroService.fill_validation-999"><span class="linenos"> 999</span></a>        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;user_type&quot;</span><span class="p">:</span> <span class="n">user_type</span><span class="p">}</span>
</span><span id="PumpWoodMicroService.fill_validation-1000"><a href="#PumpWoodMicroService.fill_validation-1000"><span class="linenos">1000</span></a>        <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.fill_validation-1001"><a href="#PumpWoodMicroService.fill_validation-1001"><span class="linenos">1001</span></a>            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span>
</span><span id="PumpWoodMicroService.fill_validation-1002"><a href="#PumpWoodMicroService.fill_validation-1002"><span class="linenos">1002</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.fill_validation-1003"><a href="#PumpWoodMicroService.fill_validation-1003"><span class="linenos">1003</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">parcial_obj_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.fill_validation-1004"><a href="#PumpWoodMicroService.fill_validation-1004"><span class="linenos">1004</span></a>            <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Return options for object fields.</p>

<p>This function send partial object data and return options to finish
object fillment.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class to check search parameters.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
<li><strong>parcial_obj_dict:</strong>  Partial object data to be validated by the backend.</li>
<li><strong>field:</strong>  Set an especific field to be validated if implemented.</li>
<li><strong>user_type:</strong>  Set the type of user is requesting fill validation. It is
possible to set <code>api</code> and <code>gui</code>. Gui user_type will return
fields listed in gui_readonly as read-only fields to
facilitate navegation.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Return a dictinary with keys:</p>
  
  <ul>
  <li><strong>field_descriptions:</strong> Same of fill_options, but setting as
  read_only=True fields listed on gui_readonly if
  user_type='gui'.</li>
  <li><strong>gui_readonly:</strong> Return a list of fields that will be
  considered as read-only if user_type='gui' is requested.</li>
  </ul>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No particular raises.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.pivot" class="classattr">
                                        <input id="PumpWoodMicroService.pivot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">pivot</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>,</span><span class="param">	<span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;list&#39;</span>,</span><span class="param">	<span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">order_by</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>,</span><span class="param">	<span class="n">variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">add_pk_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">as_dataframe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.pivot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.pivot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.pivot-1010"><a href="#PumpWoodMicroService.pivot-1010"><span class="linenos">1010</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">pivot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="PumpWoodMicroService.pivot-1011"><a href="#PumpWoodMicroService.pivot-1011"><span class="linenos">1011</span></a>              <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService.pivot-1012"><a href="#PumpWoodMicroService.pivot-1012"><span class="linenos">1012</span></a>              <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">order_by</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[],</span>
</span><span id="PumpWoodMicroService.pivot-1013"><a href="#PumpWoodMicroService.pivot-1013"><span class="linenos">1013</span></a>              <span class="n">variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.pivot-1014"><a href="#PumpWoodMicroService.pivot-1014"><span class="linenos">1014</span></a>              <span class="n">add_pk_column</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.pivot-1015"><a href="#PumpWoodMicroService.pivot-1015"><span class="linenos">1015</span></a>              <span class="n">as_dataframe</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
</span><span id="PumpWoodMicroService.pivot-1016"><a href="#PumpWoodMicroService.pivot-1016"><span class="linenos">1016</span></a>              <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">],</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.pivot-1017"><a href="#PumpWoodMicroService.pivot-1017"><span class="linenos">1017</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Pivot object data acording to columns specified.</span>
</span><span id="PumpWoodMicroService.pivot-1018"><a href="#PumpWoodMicroService.pivot-1018"><span class="linenos">1018</span></a>
</span><span id="PumpWoodMicroService.pivot-1019"><a href="#PumpWoodMicroService.pivot-1019"><span class="linenos">1019</span></a><span class="sd">        Pivoting per-se is not usually used, beeing the name of the function</span>
</span><span id="PumpWoodMicroService.pivot-1020"><a href="#PumpWoodMicroService.pivot-1020"><span class="linenos">1020</span></a><span class="sd">        a legacy. Normality data transformation is done at the client level.</span>
</span><span id="PumpWoodMicroService.pivot-1021"><a href="#PumpWoodMicroService.pivot-1021"><span class="linenos">1021</span></a>
</span><span id="PumpWoodMicroService.pivot-1022"><a href="#PumpWoodMicroService.pivot-1022"><span class="linenos">1022</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.pivot-1023"><a href="#PumpWoodMicroService.pivot-1023"><span class="linenos">1023</span></a><span class="sd">            model_class (str):</span>
</span><span id="PumpWoodMicroService.pivot-1024"><a href="#PumpWoodMicroService.pivot-1024"><span class="linenos">1024</span></a><span class="sd">                Model class to check search parameters.</span>
</span><span id="PumpWoodMicroService.pivot-1025"><a href="#PumpWoodMicroService.pivot-1025"><span class="linenos">1025</span></a><span class="sd">            columns (List[str]):</span>
</span><span id="PumpWoodMicroService.pivot-1026"><a href="#PumpWoodMicroService.pivot-1026"><span class="linenos">1026</span></a><span class="sd">                List of fields to be used as columns when pivoting the data.</span>
</span><span id="PumpWoodMicroService.pivot-1027"><a href="#PumpWoodMicroService.pivot-1027"><span class="linenos">1027</span></a><span class="sd">            format (str):</span>
</span><span id="PumpWoodMicroService.pivot-1028"><a href="#PumpWoodMicroService.pivot-1028"><span class="linenos">1028</span></a><span class="sd">                Format to be used to convert pandas.DataFrame to</span>
</span><span id="PumpWoodMicroService.pivot-1029"><a href="#PumpWoodMicroService.pivot-1029"><span class="linenos">1029</span></a><span class="sd">                dictionary, must be in [&#39;dict&#39;,&#39;list&#39;,&#39;series&#39;,</span>
</span><span id="PumpWoodMicroService.pivot-1030"><a href="#PumpWoodMicroService.pivot-1030"><span class="linenos">1030</span></a><span class="sd">                &#39;split&#39;, &#39;records&#39;,&#39;index&#39;].</span>
</span><span id="PumpWoodMicroService.pivot-1031"><a href="#PumpWoodMicroService.pivot-1031"><span class="linenos">1031</span></a><span class="sd">            filter_dict (dict):</span>
</span><span id="PumpWoodMicroService.pivot-1032"><a href="#PumpWoodMicroService.pivot-1032"><span class="linenos">1032</span></a><span class="sd">                Same as list function.</span>
</span><span id="PumpWoodMicroService.pivot-1033"><a href="#PumpWoodMicroService.pivot-1033"><span class="linenos">1033</span></a><span class="sd">            exclude_dict (dict):</span>
</span><span id="PumpWoodMicroService.pivot-1034"><a href="#PumpWoodMicroService.pivot-1034"><span class="linenos">1034</span></a><span class="sd">                Same as list function.</span>
</span><span id="PumpWoodMicroService.pivot-1035"><a href="#PumpWoodMicroService.pivot-1035"><span class="linenos">1035</span></a><span class="sd">            order_by (List[str]):</span>
</span><span id="PumpWoodMicroService.pivot-1036"><a href="#PumpWoodMicroService.pivot-1036"><span class="linenos">1036</span></a><span class="sd">                 Same as list function.</span>
</span><span id="PumpWoodMicroService.pivot-1037"><a href="#PumpWoodMicroService.pivot-1037"><span class="linenos">1037</span></a><span class="sd">            variables (List[str]):</span>
</span><span id="PumpWoodMicroService.pivot-1038"><a href="#PumpWoodMicroService.pivot-1038"><span class="linenos">1038</span></a><span class="sd">                List of the fields to be returned, if None, the default</span>
</span><span id="PumpWoodMicroService.pivot-1039"><a href="#PumpWoodMicroService.pivot-1039"><span class="linenos">1039</span></a><span class="sd">                variables will be returned. Same as fields on list functions.</span>
</span><span id="PumpWoodMicroService.pivot-1040"><a href="#PumpWoodMicroService.pivot-1040"><span class="linenos">1040</span></a><span class="sd">            show_deleted (bool):</span>
</span><span id="PumpWoodMicroService.pivot-1041"><a href="#PumpWoodMicroService.pivot-1041"><span class="linenos">1041</span></a><span class="sd">                Fields with deleted column will have objects with deleted=True</span>
</span><span id="PumpWoodMicroService.pivot-1042"><a href="#PumpWoodMicroService.pivot-1042"><span class="linenos">1042</span></a><span class="sd">                omited from results. show_deleted=True will return this</span>
</span><span id="PumpWoodMicroService.pivot-1043"><a href="#PumpWoodMicroService.pivot-1043"><span class="linenos">1043</span></a><span class="sd">                information.</span>
</span><span id="PumpWoodMicroService.pivot-1044"><a href="#PumpWoodMicroService.pivot-1044"><span class="linenos">1044</span></a><span class="sd">            add_pk_column (bool):</span>
</span><span id="PumpWoodMicroService.pivot-1045"><a href="#PumpWoodMicroService.pivot-1045"><span class="linenos">1045</span></a><span class="sd">                If add pk values of the objects at pivot results. Adding</span>
</span><span id="PumpWoodMicroService.pivot-1046"><a href="#PumpWoodMicroService.pivot-1046"><span class="linenos">1046</span></a><span class="sd">                pk key on pivot end-points won&#39;t be possible to pivot since</span>
</span><span id="PumpWoodMicroService.pivot-1047"><a href="#PumpWoodMicroService.pivot-1047"><span class="linenos">1047</span></a><span class="sd">                pk is unique for each entry.</span>
</span><span id="PumpWoodMicroService.pivot-1048"><a href="#PumpWoodMicroService.pivot-1048"><span class="linenos">1048</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="PumpWoodMicroService.pivot-1049"><a href="#PumpWoodMicroService.pivot-1049"><span class="linenos">1049</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.pivot-1050"><a href="#PumpWoodMicroService.pivot-1050"><span class="linenos">1050</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.pivot-1051"><a href="#PumpWoodMicroService.pivot-1051"><span class="linenos">1051</span></a><span class="sd">            as_dataframe (bool):</span>
</span><span id="PumpWoodMicroService.pivot-1052"><a href="#PumpWoodMicroService.pivot-1052"><span class="linenos">1052</span></a><span class="sd">                If results should be returned as a dataframe.</span>
</span><span id="PumpWoodMicroService.pivot-1053"><a href="#PumpWoodMicroService.pivot-1053"><span class="linenos">1053</span></a>
</span><span id="PumpWoodMicroService.pivot-1054"><a href="#PumpWoodMicroService.pivot-1054"><span class="linenos">1054</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.pivot-1055"><a href="#PumpWoodMicroService.pivot-1055"><span class="linenos">1055</span></a><span class="sd">            Return a list or a dictinary depending on the format set on</span>
</span><span id="PumpWoodMicroService.pivot-1056"><a href="#PumpWoodMicroService.pivot-1056"><span class="linenos">1056</span></a><span class="sd">            format parameter.</span>
</span><span id="PumpWoodMicroService.pivot-1057"><a href="#PumpWoodMicroService.pivot-1057"><span class="linenos">1057</span></a>
</span><span id="PumpWoodMicroService.pivot-1058"><a href="#PumpWoodMicroService.pivot-1058"><span class="linenos">1058</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.pivot-1059"><a href="#PumpWoodMicroService.pivot-1059"><span class="linenos">1059</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.pivot-1060"><a href="#PumpWoodMicroService.pivot-1060"><span class="linenos">1060</span></a><span class="sd">                &#39;Columns must be a list of elements.&#39;. Indicates that the list</span>
</span><span id="PumpWoodMicroService.pivot-1061"><a href="#PumpWoodMicroService.pivot-1061"><span class="linenos">1061</span></a><span class="sd">                argument was not a list.</span>
</span><span id="PumpWoodMicroService.pivot-1062"><a href="#PumpWoodMicroService.pivot-1062"><span class="linenos">1062</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.pivot-1063"><a href="#PumpWoodMicroService.pivot-1063"><span class="linenos">1063</span></a><span class="sd">                &#39;Column chosen as pivot is not at model variables&#39;. Indicates</span>
</span><span id="PumpWoodMicroService.pivot-1064"><a href="#PumpWoodMicroService.pivot-1064"><span class="linenos">1064</span></a><span class="sd">                that columns that were set to pivot are not present on model</span>
</span><span id="PumpWoodMicroService.pivot-1065"><a href="#PumpWoodMicroService.pivot-1065"><span class="linenos">1065</span></a><span class="sd">                variables.</span>
</span><span id="PumpWoodMicroService.pivot-1066"><a href="#PumpWoodMicroService.pivot-1066"><span class="linenos">1066</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.pivot-1067"><a href="#PumpWoodMicroService.pivot-1067"><span class="linenos">1067</span></a><span class="sd">                &quot;Format must be in [&#39;dict&#39;,&#39;list&#39;,&#39;series&#39;,&#39;split&#39;,</span>
</span><span id="PumpWoodMicroService.pivot-1068"><a href="#PumpWoodMicroService.pivot-1068"><span class="linenos">1068</span></a><span class="sd">                &#39;records&#39;,&#39;index&#39;]&quot;. Indicates that format set as paramenter</span>
</span><span id="PumpWoodMicroService.pivot-1069"><a href="#PumpWoodMicroService.pivot-1069"><span class="linenos">1069</span></a><span class="sd">                is not implemented.</span>
</span><span id="PumpWoodMicroService.pivot-1070"><a href="#PumpWoodMicroService.pivot-1070"><span class="linenos">1070</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.pivot-1071"><a href="#PumpWoodMicroService.pivot-1071"><span class="linenos">1071</span></a><span class="sd">                &quot;Can not add pk column and pivot information&quot;. If</span>
</span><span id="PumpWoodMicroService.pivot-1072"><a href="#PumpWoodMicroService.pivot-1072"><span class="linenos">1072</span></a><span class="sd">                add_pk_column is True (results will have the pk column), it is</span>
</span><span id="PumpWoodMicroService.pivot-1073"><a href="#PumpWoodMicroService.pivot-1073"><span class="linenos">1073</span></a><span class="sd">                not possible to pivot the information (pk is an unique value</span>
</span><span id="PumpWoodMicroService.pivot-1074"><a href="#PumpWoodMicroService.pivot-1074"><span class="linenos">1074</span></a><span class="sd">                for each object, there is no reason to pivot it).</span>
</span><span id="PumpWoodMicroService.pivot-1075"><a href="#PumpWoodMicroService.pivot-1075"><span class="linenos">1075</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.pivot-1076"><a href="#PumpWoodMicroService.pivot-1076"><span class="linenos">1076</span></a><span class="sd">                &quot;&#39;value&#39; column not at melted data, it is not possible</span>
</span><span id="PumpWoodMicroService.pivot-1077"><a href="#PumpWoodMicroService.pivot-1077"><span class="linenos">1077</span></a><span class="sd">                to pivot dataframe.&quot;. Indicates that data does not have a value</span>
</span><span id="PumpWoodMicroService.pivot-1078"><a href="#PumpWoodMicroService.pivot-1078"><span class="linenos">1078</span></a><span class="sd">                column, it must have it to populate pivoted table.</span>
</span><span id="PumpWoodMicroService.pivot-1079"><a href="#PumpWoodMicroService.pivot-1079"><span class="linenos">1079</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.pivot-1080"><a href="#PumpWoodMicroService.pivot-1080"><span class="linenos">1080</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_pivot_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.pivot-1081"><a href="#PumpWoodMicroService.pivot-1081"><span class="linenos">1081</span></a>        <span class="n">post_data</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PumpWoodMicroService.pivot-1082"><a href="#PumpWoodMicroService.pivot-1082"><span class="linenos">1082</span></a>            <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="nb">format</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.pivot-1083"><a href="#PumpWoodMicroService.pivot-1083"><span class="linenos">1083</span></a>            <span class="s1">&#39;filter_dict&#39;</span><span class="p">:</span> <span class="n">filter_dict</span><span class="p">,</span> <span class="s1">&#39;exclude_dict&#39;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.pivot-1084"><a href="#PumpWoodMicroService.pivot-1084"><span class="linenos">1084</span></a>            <span class="s1">&#39;order_by&#39;</span><span class="p">:</span> <span class="n">order_by</span><span class="p">,</span> <span class="s2">&quot;variables&quot;</span><span class="p">:</span> <span class="n">variables</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.pivot-1085"><a href="#PumpWoodMicroService.pivot-1085"><span class="linenos">1085</span></a>            <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span> <span class="s2">&quot;add_pk_column&quot;</span><span class="p">:</span> <span class="n">add_pk_column</span><span class="p">}</span>
</span><span id="PumpWoodMicroService.pivot-1086"><a href="#PumpWoodMicroService.pivot-1086"><span class="linenos">1086</span></a>        <span class="n">pivot_results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.pivot-1087"><a href="#PumpWoodMicroService.pivot-1087"><span class="linenos">1087</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">post_data</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.pivot-1088"><a href="#PumpWoodMicroService.pivot-1088"><span class="linenos">1088</span></a>
</span><span id="PumpWoodMicroService.pivot-1089"><a href="#PumpWoodMicroService.pivot-1089"><span class="linenos">1089</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">add_pk_column</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.pivot-1090"><a href="#PumpWoodMicroService.pivot-1090"><span class="linenos">1090</span></a>            <span class="k">if</span> <span class="n">as_dataframe</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.pivot-1091"><a href="#PumpWoodMicroService.pivot-1091"><span class="linenos">1091</span></a>                <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pivot_results</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.pivot-1092"><a href="#PumpWoodMicroService.pivot-1092"><span class="linenos">1092</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.pivot-1093"><a href="#PumpWoodMicroService.pivot-1093"><span class="linenos">1093</span></a>                <span class="k">return</span> <span class="n">pivot_results</span>
</span><span id="PumpWoodMicroService.pivot-1094"><a href="#PumpWoodMicroService.pivot-1094"><span class="linenos">1094</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.pivot-1095"><a href="#PumpWoodMicroService.pivot-1095"><span class="linenos">1095</span></a>            <span class="n">pd_pivot_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">pivot_results</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.pivot-1096"><a href="#PumpWoodMicroService.pivot-1096"><span class="linenos">1096</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pd_pivot_results</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.pivot-1097"><a href="#PumpWoodMicroService.pivot-1097"><span class="linenos">1097</span></a>                <span class="n">fill_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_options</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.pivot-1098"><a href="#PumpWoodMicroService.pivot-1098"><span class="linenos">1098</span></a>                    <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.pivot-1099"><a href="#PumpWoodMicroService.pivot-1099"><span class="linenos">1099</span></a>                <span class="n">primary_keys</span> <span class="o">=</span> <span class="n">fill_options</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">][</span><span class="s2">&quot;column&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.pivot-1100"><a href="#PumpWoodMicroService.pivot-1100"><span class="linenos">1100</span></a>                <span class="n">pd_pivot_results</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd_pivot_results</span><span class="p">[</span><span class="n">primary_keys</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.pivot-1101"><a href="#PumpWoodMicroService.pivot-1101"><span class="linenos">1101</span></a>                    <span class="n">CompositePkBase64Converter</span><span class="o">.</span><span class="n">dump</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.pivot-1102"><a href="#PumpWoodMicroService.pivot-1102"><span class="linenos">1102</span></a>                    <span class="n">primary_keys</span><span class="o">=</span><span class="n">primary_keys</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.pivot-1103"><a href="#PumpWoodMicroService.pivot-1103"><span class="linenos">1103</span></a>            <span class="k">if</span> <span class="n">as_dataframe</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.pivot-1104"><a href="#PumpWoodMicroService.pivot-1104"><span class="linenos">1104</span></a>                <span class="k">return</span> <span class="n">pd_pivot_results</span>
</span><span id="PumpWoodMicroService.pivot-1105"><a href="#PumpWoodMicroService.pivot-1105"><span class="linenos">1105</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.pivot-1106"><a href="#PumpWoodMicroService.pivot-1106"><span class="linenos">1106</span></a>                <span class="k">return</span> <span class="n">pd_pivot_results</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Pivot object data acording to columns specified.</p>

<p>Pivoting per-se is not usually used, beeing the name of the function
a legacy. Normality data transformation is done at the client level.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class (str):</strong>  Model class to check search parameters.</li>
<li><strong>columns (List[str]):</strong>  List of fields to be used as columns when pivoting the data.</li>
<li><strong>format (str):</strong>  Format to be used to convert pandas.DataFrame to
dictionary, must be in ['dict','list','series',
'split', 'records','index'].</li>
<li><strong>filter_dict (dict):</strong>  Same as list function.</li>
<li><strong>exclude_dict (dict):</strong>  Same as list function.</li>
<li><strong>order_by (List[str]):</strong>  Same as list function.</li>
<li><strong>variables (List[str]):</strong>  List of the fields to be returned, if None, the default
variables will be returned. Same as fields on list functions.</li>
<li><strong>show_deleted (bool):</strong>  Fields with deleted column will have objects with deleted=True
omited from results. show_deleted=True will return this
information.</li>
<li><strong>add_pk_column (bool):</strong>  If add pk values of the objects at pivot results. Adding
pk key on pivot end-points won't be possible to pivot since
pk is unique for each entry.</li>
<li><strong>auth_header (dict):</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
<li><strong>as_dataframe (bool):</strong>  If results should be returned as a dataframe.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Return a list or a dictinary depending on the format set on
  format parameter.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'Columns must be a list of elements.'. Indicates that the list
argument was not a list.</li>
<li><strong>PumpWoodException:</strong>  'Column chosen as pivot is not at model variables'. Indicates
that columns that were set to pivot are not present on model
variables.</li>
<li><strong>PumpWoodException:</strong>  "Format must be in ['dict','list','series','split',
'records','index']". Indicates that format set as paramenter
is not implemented.</li>
<li><strong>PumpWoodException:</strong>  "Can not add pk column and pivot information". If
add_pk_column is True (results will have the pk column), it is
not possible to pivot the information (pk is an unique value
for each object, there is no reason to pivot it).</li>
<li><strong>PumpWoodException:</strong>  "'value' column not at melted data, it is not possible
to pivot dataframe.". Indicates that data does not have a value
column, it must have it to populate pivoted table.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.flat_list_by_chunks" class="classattr">
                                        <input id="PumpWoodMicroService.flat_list_by_chunks-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">flat_list_by_chunks</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000000</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">create_composite_pk</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">end_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.flat_list_by_chunks-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.flat_list_by_chunks"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.flat_list_by_chunks-1156"><a href="#PumpWoodMicroService.flat_list_by_chunks-1156"><span class="linenos">1156</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">flat_list_by_chunks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filter_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1157"><a href="#PumpWoodMicroService.flat_list_by_chunks-1157"><span class="linenos">1157</span></a>                            <span class="n">exclude_dict</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1158"><a href="#PumpWoodMicroService.flat_list_by_chunks-1158"><span class="linenos">1158</span></a>                            <span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1159"><a href="#PumpWoodMicroService.flat_list_by_chunks-1159"><span class="linenos">1159</span></a>                            <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1160"><a href="#PumpWoodMicroService.flat_list_by_chunks-1160"><span class="linenos">1160</span></a>                            <span class="n">chunk_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000000</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1161"><a href="#PumpWoodMicroService.flat_list_by_chunks-1161"><span class="linenos">1161</span></a>                            <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1162"><a href="#PumpWoodMicroService.flat_list_by_chunks-1162"><span class="linenos">1162</span></a>                            <span class="n">create_composite_pk</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1163"><a href="#PumpWoodMicroService.flat_list_by_chunks-1163"><span class="linenos">1163</span></a>                            <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1164"><a href="#PumpWoodMicroService.flat_list_by_chunks-1164"><span class="linenos">1164</span></a>                            <span class="n">end_date</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1165"><a href="#PumpWoodMicroService.flat_list_by_chunks-1165"><span class="linenos">1165</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Incrementally fetch data from pivot end-point.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1166"><a href="#PumpWoodMicroService.flat_list_by_chunks-1166"><span class="linenos">1166</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1167"><a href="#PumpWoodMicroService.flat_list_by_chunks-1167"><span class="linenos">1167</span></a><span class="sd">        Fetch data from pivot end-point paginating by id of chunk_size lenght.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1168"><a href="#PumpWoodMicroService.flat_list_by_chunks-1168"><span class="linenos">1168</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1169"><a href="#PumpWoodMicroService.flat_list_by_chunks-1169"><span class="linenos">1169</span></a><span class="sd">        If table is partitioned it will split the query acording to partition</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1170"><a href="#PumpWoodMicroService.flat_list_by_chunks-1170"><span class="linenos">1170</span></a><span class="sd">        to facilitate query at the database.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1171"><a href="#PumpWoodMicroService.flat_list_by_chunks-1171"><span class="linenos">1171</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1172"><a href="#PumpWoodMicroService.flat_list_by_chunks-1172"><span class="linenos">1172</span></a><span class="sd">        If start_date and end_date are set, also breaks the query by month</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1173"><a href="#PumpWoodMicroService.flat_list_by_chunks-1173"><span class="linenos">1173</span></a><span class="sd">        retrieving each month data in parallel.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1174"><a href="#PumpWoodMicroService.flat_list_by_chunks-1174"><span class="linenos">1174</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1175"><a href="#PumpWoodMicroService.flat_list_by_chunks-1175"><span class="linenos">1175</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1176"><a href="#PumpWoodMicroService.flat_list_by_chunks-1176"><span class="linenos">1176</span></a><span class="sd">            model_class (str):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1177"><a href="#PumpWoodMicroService.flat_list_by_chunks-1177"><span class="linenos">1177</span></a><span class="sd">                Model class to be pivoted.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1178"><a href="#PumpWoodMicroService.flat_list_by_chunks-1178"><span class="linenos">1178</span></a><span class="sd">            filter_dict (dict):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1179"><a href="#PumpWoodMicroService.flat_list_by_chunks-1179"><span class="linenos">1179</span></a><span class="sd">                Dictionary to to be used in objects.filter argument</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1180"><a href="#PumpWoodMicroService.flat_list_by_chunks-1180"><span class="linenos">1180</span></a><span class="sd">                (Same as list end-point).</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1181"><a href="#PumpWoodMicroService.flat_list_by_chunks-1181"><span class="linenos">1181</span></a><span class="sd">            exclude_dict (dict):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1182"><a href="#PumpWoodMicroService.flat_list_by_chunks-1182"><span class="linenos">1182</span></a><span class="sd">                Dictionary to to be used in objects.exclude argument</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1183"><a href="#PumpWoodMicroService.flat_list_by_chunks-1183"><span class="linenos">1183</span></a><span class="sd">                (Same as list end-point).</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1184"><a href="#PumpWoodMicroService.flat_list_by_chunks-1184"><span class="linenos">1184</span></a><span class="sd">            fields (List[str] | None):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1185"><a href="#PumpWoodMicroService.flat_list_by_chunks-1185"><span class="linenos">1185</span></a><span class="sd">                List of the variables to be returned,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1186"><a href="#PumpWoodMicroService.flat_list_by_chunks-1186"><span class="linenos">1186</span></a><span class="sd">                if None, the default variables will be returned.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1187"><a href="#PumpWoodMicroService.flat_list_by_chunks-1187"><span class="linenos">1187</span></a><span class="sd">                If fields is set, dataframe will return that columns</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1188"><a href="#PumpWoodMicroService.flat_list_by_chunks-1188"><span class="linenos">1188</span></a><span class="sd">                even if data is empty.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1189"><a href="#PumpWoodMicroService.flat_list_by_chunks-1189"><span class="linenos">1189</span></a><span class="sd">            start_date (datetime | str):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1190"><a href="#PumpWoodMicroService.flat_list_by_chunks-1190"><span class="linenos">1190</span></a><span class="sd">                Set a begin date for the query. If begin and end date are</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1191"><a href="#PumpWoodMicroService.flat_list_by_chunks-1191"><span class="linenos">1191</span></a><span class="sd">                set, query will be splited with chucks by month that will be</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1192"><a href="#PumpWoodMicroService.flat_list_by_chunks-1192"><span class="linenos">1192</span></a><span class="sd">                requested in parallel.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1193"><a href="#PumpWoodMicroService.flat_list_by_chunks-1193"><span class="linenos">1193</span></a><span class="sd">            end_date (datetime | str):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1194"><a href="#PumpWoodMicroService.flat_list_by_chunks-1194"><span class="linenos">1194</span></a><span class="sd">                Set a end date for the query. If begin and end date are</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1195"><a href="#PumpWoodMicroService.flat_list_by_chunks-1195"><span class="linenos">1195</span></a><span class="sd">                set, query will be splited with chucks by month that will be</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1196"><a href="#PumpWoodMicroService.flat_list_by_chunks-1196"><span class="linenos">1196</span></a><span class="sd">                requested in parallel.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1197"><a href="#PumpWoodMicroService.flat_list_by_chunks-1197"><span class="linenos">1197</span></a><span class="sd">            show_deleted (bool):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1198"><a href="#PumpWoodMicroService.flat_list_by_chunks-1198"><span class="linenos">1198</span></a><span class="sd">                If deleted data should be returned.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1199"><a href="#PumpWoodMicroService.flat_list_by_chunks-1199"><span class="linenos">1199</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1200"><a href="#PumpWoodMicroService.flat_list_by_chunks-1200"><span class="linenos">1200</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1201"><a href="#PumpWoodMicroService.flat_list_by_chunks-1201"><span class="linenos">1201</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1202"><a href="#PumpWoodMicroService.flat_list_by_chunks-1202"><span class="linenos">1202</span></a><span class="sd">            chunk_size (int):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1203"><a href="#PumpWoodMicroService.flat_list_by_chunks-1203"><span class="linenos">1203</span></a><span class="sd">                Limit of data to fetch per call.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1204"><a href="#PumpWoodMicroService.flat_list_by_chunks-1204"><span class="linenos">1204</span></a><span class="sd">            n_parallel (int):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1205"><a href="#PumpWoodMicroService.flat_list_by_chunks-1205"><span class="linenos">1205</span></a><span class="sd">                Number of parallel process to perform.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1206"><a href="#PumpWoodMicroService.flat_list_by_chunks-1206"><span class="linenos">1206</span></a><span class="sd">            create_composite_pk (bool):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1207"><a href="#PumpWoodMicroService.flat_list_by_chunks-1207"><span class="linenos">1207</span></a><span class="sd">                If true and table has a composite pk, it will create pk</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1208"><a href="#PumpWoodMicroService.flat_list_by_chunks-1208"><span class="linenos">1208</span></a><span class="sd">                value based on the hash on the json serialized dictionary</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1209"><a href="#PumpWoodMicroService.flat_list_by_chunks-1209"><span class="linenos">1209</span></a><span class="sd">                of the components of the primary key.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1210"><a href="#PumpWoodMicroService.flat_list_by_chunks-1210"><span class="linenos">1210</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1211"><a href="#PumpWoodMicroService.flat_list_by_chunks-1211"><span class="linenos">1211</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1212"><a href="#PumpWoodMicroService.flat_list_by_chunks-1212"><span class="linenos">1212</span></a><span class="sd">            Returns a dataframe with all information fetched.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1213"><a href="#PumpWoodMicroService.flat_list_by_chunks-1213"><span class="linenos">1213</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1214"><a href="#PumpWoodMicroService.flat_list_by_chunks-1214"><span class="linenos">1214</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1215"><a href="#PumpWoodMicroService.flat_list_by_chunks-1215"><span class="linenos">1215</span></a><span class="sd">            No particular raise.</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1216"><a href="#PumpWoodMicroService.flat_list_by_chunks-1216"><span class="linenos">1216</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1217"><a href="#PumpWoodMicroService.flat_list_by_chunks-1217"><span class="linenos">1217</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1218"><a href="#PumpWoodMicroService.flat_list_by_chunks-1218"><span class="linenos">1218</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1219"><a href="#PumpWoodMicroService.flat_list_by_chunks-1219"><span class="linenos">1219</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1220"><a href="#PumpWoodMicroService.flat_list_by_chunks-1220"><span class="linenos">1220</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1221"><a href="#PumpWoodMicroService.flat_list_by_chunks-1221"><span class="linenos">1221</span></a>        <span class="n">temp_filter_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">filter_dict</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1222"><a href="#PumpWoodMicroService.flat_list_by_chunks-1222"><span class="linenos">1222</span></a>        <span class="n">fill_options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fill_options</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1223"><a href="#PumpWoodMicroService.flat_list_by_chunks-1223"><span class="linenos">1223</span></a>            <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1224"><a href="#PumpWoodMicroService.flat_list_by_chunks-1224"><span class="linenos">1224</span></a>        <span class="n">primary_keys</span> <span class="o">=</span> <span class="n">fill_options</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">][</span><span class="s2">&quot;column&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1225"><a href="#PumpWoodMicroService.flat_list_by_chunks-1225"><span class="linenos">1225</span></a>        <span class="n">partition</span> <span class="o">=</span> <span class="n">fill_options</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;partition&quot;</span><span class="p">,</span> <span class="p">[])</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1226"><a href="#PumpWoodMicroService.flat_list_by_chunks-1226"><span class="linenos">1226</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1227"><a href="#PumpWoodMicroService.flat_list_by_chunks-1227"><span class="linenos">1227</span></a>        <span class="c1"># Create a list of month and include start and end dates if not at</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1228"><a href="#PumpWoodMicroService.flat_list_by_chunks-1228"><span class="linenos">1228</span></a>        <span class="c1"># the beginning of a month</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1229"><a href="#PumpWoodMicroService.flat_list_by_chunks-1229"><span class="linenos">1229</span></a>        <span class="n">month_sequence</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1230"><a href="#PumpWoodMicroService.flat_list_by_chunks-1230"><span class="linenos">1230</span></a>        <span class="k">if</span> <span class="p">(</span><span class="n">start_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">end_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1231"><a href="#PumpWoodMicroService.flat_list_by_chunks-1231"><span class="linenos">1231</span></a>            <span class="n">start_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">start_date</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1232"><a href="#PumpWoodMicroService.flat_list_by_chunks-1232"><span class="linenos">1232</span></a>            <span class="n">end_date</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">end_date</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1233"><a href="#PumpWoodMicroService.flat_list_by_chunks-1233"><span class="linenos">1233</span></a>            <span class="n">list_month_sequence</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1234"><a href="#PumpWoodMicroService.flat_list_by_chunks-1234"><span class="linenos">1234</span></a>                <span class="n">start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_date</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s1">&#39;MS&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1235"><a href="#PumpWoodMicroService.flat_list_by_chunks-1235"><span class="linenos">1235</span></a>            <span class="n">month_sequence</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1236"><a href="#PumpWoodMicroService.flat_list_by_chunks-1236"><span class="linenos">1236</span></a>                <span class="p">[</span><span class="n">start_date</span><span class="p">]</span> <span class="o">+</span> <span class="n">list_month_sequence</span> <span class="o">+</span> <span class="p">[</span><span class="n">end_date</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1237"><a href="#PumpWoodMicroService.flat_list_by_chunks-1237"><span class="linenos">1237</span></a>            <span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1238"><a href="#PumpWoodMicroService.flat_list_by_chunks-1238"><span class="linenos">1238</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1239"><a href="#PumpWoodMicroService.flat_list_by_chunks-1239"><span class="linenos">1239</span></a>            <span class="n">month_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="n">month_sequence</span><span class="p">})</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1240"><a href="#PumpWoodMicroService.flat_list_by_chunks-1240"><span class="linenos">1240</span></a>            <span class="n">month_df</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">month_df</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shift</span><span class="p">()</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1241"><a href="#PumpWoodMicroService.flat_list_by_chunks-1241"><span class="linenos">1241</span></a>            <span class="n">month_df</span> <span class="o">=</span> <span class="n">month_df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1242"><a href="#PumpWoodMicroService.flat_list_by_chunks-1242"><span class="linenos">1242</span></a>            <span class="n">month_sequence</span> <span class="o">=</span> <span class="n">month_df</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s2">&quot;records&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1243"><a href="#PumpWoodMicroService.flat_list_by_chunks-1243"><span class="linenos">1243</span></a>        <span class="k">elif</span> <span class="p">(</span><span class="n">start_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">end_date</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1244"><a href="#PumpWoodMicroService.flat_list_by_chunks-1244"><span class="linenos">1244</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1245"><a href="#PumpWoodMicroService.flat_list_by_chunks-1245"><span class="linenos">1245</span></a>                <span class="s2">&quot;To break query in chunks using start_date and end_date &quot;</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1246"><a href="#PumpWoodMicroService.flat_list_by_chunks-1246"><span class="linenos">1246</span></a>                <span class="s2">&quot;both must be set.</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1247"><a href="#PumpWoodMicroService.flat_list_by_chunks-1247"><span class="linenos">1247</span></a>                <span class="s2">&quot;start_date: </span><span class="si">{start_date}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1248"><a href="#PumpWoodMicroService.flat_list_by_chunks-1248"><span class="linenos">1248</span></a>                <span class="s2">&quot;end_date: </span><span class="si">{end_date}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1249"><a href="#PumpWoodMicroService.flat_list_by_chunks-1249"><span class="linenos">1249</span></a>                    <span class="n">start_date</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="o">=</span><span class="n">end_date</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1250"><a href="#PumpWoodMicroService.flat_list_by_chunks-1250"><span class="linenos">1250</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1251"><a href="#PumpWoodMicroService.flat_list_by_chunks-1251"><span class="linenos">1251</span></a>                <span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">payload</span><span class="o">=</span><span class="p">{</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1252"><a href="#PumpWoodMicroService.flat_list_by_chunks-1252"><span class="linenos">1252</span></a>                    <span class="s2">&quot;start_date&quot;</span><span class="p">:</span> <span class="n">start_date</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1253"><a href="#PumpWoodMicroService.flat_list_by_chunks-1253"><span class="linenos">1253</span></a>                    <span class="s2">&quot;end_date&quot;</span><span class="p">:</span> <span class="n">end_date</span><span class="p">})</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1254"><a href="#PumpWoodMicroService.flat_list_by_chunks-1254"><span class="linenos">1254</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1255"><a href="#PumpWoodMicroService.flat_list_by_chunks-1255"><span class="linenos">1255</span></a>        <span class="n">resp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1256"><a href="#PumpWoodMicroService.flat_list_by_chunks-1256"><span class="linenos">1256</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1257"><a href="#PumpWoodMicroService.flat_list_by_chunks-1257"><span class="linenos">1257</span></a>        <span class="c1">##########################################################</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1258"><a href="#PumpWoodMicroService.flat_list_by_chunks-1258"><span class="linenos">1258</span></a>        <span class="c1"># If table have more than one partition, run in parallel #</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1259"><a href="#PumpWoodMicroService.flat_list_by_chunks-1259"><span class="linenos">1259</span></a>        <span class="c1"># the {partition}__in elements along with dates          #</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1260"><a href="#PumpWoodMicroService.flat_list_by_chunks-1260"><span class="linenos">1260</span></a>        <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1261"><a href="#PumpWoodMicroService.flat_list_by_chunks-1261"><span class="linenos">1261</span></a>            <span class="n">partition_col_1st</span> <span class="o">=</span> <span class="n">partition</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1262"><a href="#PumpWoodMicroService.flat_list_by_chunks-1262"><span class="linenos">1262</span></a>            <span class="n">filter_dict_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">temp_filter_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1263"><a href="#PumpWoodMicroService.flat_list_by_chunks-1263"><span class="linenos">1263</span></a>            <span class="n">partition_filter</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1264"><a href="#PumpWoodMicroService.flat_list_by_chunks-1264"><span class="linenos">1264</span></a>            <span class="n">count_partition_col_1st_filters</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1265"><a href="#PumpWoodMicroService.flat_list_by_chunks-1265"><span class="linenos">1265</span></a>            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">filter_dict_keys</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1266"><a href="#PumpWoodMicroService.flat_list_by_chunks-1266"><span class="linenos">1266</span></a>                <span class="k">if</span> <span class="n">partition_col_1st</span> <span class="o">+</span> <span class="s2">&quot;__in&quot;</span> <span class="o">==</span> <span class="n">col</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1267"><a href="#PumpWoodMicroService.flat_list_by_chunks-1267"><span class="linenos">1267</span></a>                    <span class="n">partition_filter</span> <span class="o">=</span> <span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1268"><a href="#PumpWoodMicroService.flat_list_by_chunks-1268"><span class="linenos">1268</span></a>                    <span class="k">del</span> <span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1269"><a href="#PumpWoodMicroService.flat_list_by_chunks-1269"><span class="linenos">1269</span></a>                    <span class="n">count_partition_col_1st_filters</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1270"><a href="#PumpWoodMicroService.flat_list_by_chunks-1270"><span class="linenos">1270</span></a>                        <span class="n">count_partition_col_1st_filters</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1271"><a href="#PumpWoodMicroService.flat_list_by_chunks-1271"><span class="linenos">1271</span></a>                <span class="k">elif</span> <span class="n">partition_col_1st</span> <span class="o">==</span> <span class="n">col</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1272"><a href="#PumpWoodMicroService.flat_list_by_chunks-1272"><span class="linenos">1272</span></a>                    <span class="n">partition_filter</span> <span class="o">=</span> <span class="p">[</span><span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1273"><a href="#PumpWoodMicroService.flat_list_by_chunks-1273"><span class="linenos">1273</span></a>                    <span class="k">del</span> <span class="n">temp_filter_dict</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1274"><a href="#PumpWoodMicroService.flat_list_by_chunks-1274"><span class="linenos">1274</span></a>                    <span class="n">count_partition_col_1st_filters</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1275"><a href="#PumpWoodMicroService.flat_list_by_chunks-1275"><span class="linenos">1275</span></a>                        <span class="n">count_partition_col_1st_filters</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1276"><a href="#PumpWoodMicroService.flat_list_by_chunks-1276"><span class="linenos">1276</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1277"><a href="#PumpWoodMicroService.flat_list_by_chunks-1277"><span class="linenos">1277</span></a>            <span class="c1"># Validating query for partitioned tables</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1278"><a href="#PumpWoodMicroService.flat_list_by_chunks-1278"><span class="linenos">1278</span></a>            <span class="k">if</span> <span class="n">partition_filter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1279"><a href="#PumpWoodMicroService.flat_list_by_chunks-1279"><span class="linenos">1279</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1280"><a href="#PumpWoodMicroService.flat_list_by_chunks-1280"><span class="linenos">1280</span></a>                    <span class="s2">&quot;Table is partitioned with sub-partitions, running &quot;</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1281"><a href="#PumpWoodMicroService.flat_list_by_chunks-1281"><span class="linenos">1281</span></a>                    <span class="s2">&quot;queries without at least first level partition will &quot;</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1282"><a href="#PumpWoodMicroService.flat_list_by_chunks-1282"><span class="linenos">1282</span></a>                    <span class="s2">&quot;lead to long waiting times or hanging queries. Please &quot;</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1283"><a href="#PumpWoodMicroService.flat_list_by_chunks-1283"><span class="linenos">1283</span></a>                    <span class="s2">&quot;use first partition level in filter_dict with equal &quot;</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1284"><a href="#PumpWoodMicroService.flat_list_by_chunks-1284"><span class="linenos">1284</span></a>                    <span class="s2">&quot;or in operators. Table partitions: </span><span class="si">{}</span><span class="s2">&quot;</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1285"><a href="#PumpWoodMicroService.flat_list_by_chunks-1285"><span class="linenos">1285</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">partition</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1286"><a href="#PumpWoodMicroService.flat_list_by_chunks-1286"><span class="linenos">1286</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1287"><a href="#PumpWoodMicroService.flat_list_by_chunks-1287"><span class="linenos">1287</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1288"><a href="#PumpWoodMicroService.flat_list_by_chunks-1288"><span class="linenos">1288</span></a>            <span class="k">if</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">count_partition_col_1st_filters</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1289"><a href="#PumpWoodMicroService.flat_list_by_chunks-1289"><span class="linenos">1289</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1290"><a href="#PumpWoodMicroService.flat_list_by_chunks-1290"><span class="linenos">1290</span></a>                    <span class="s2">&quot;Please give some help for the dev here, use just one &quot;</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1291"><a href="#PumpWoodMicroService.flat_list_by_chunks-1291"><span class="linenos">1291</span></a>                    <span class="s2">&quot;filter_dict entry for first partition...&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1292"><a href="#PumpWoodMicroService.flat_list_by_chunks-1292"><span class="linenos">1292</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1293"><a href="#PumpWoodMicroService.flat_list_by_chunks-1293"><span class="linenos">1293</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1294"><a href="#PumpWoodMicroService.flat_list_by_chunks-1294"><span class="linenos">1294</span></a>            <span class="c1"># Parallelizing query using partition columns</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1295"><a href="#PumpWoodMicroService.flat_list_by_chunks-1295"><span class="linenos">1295</span></a>            <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1296"><a href="#PumpWoodMicroService.flat_list_by_chunks-1296"><span class="linenos">1296</span></a>            <span class="k">for</span> <span class="n">filter_key</span> <span class="ow">in</span> <span class="n">partition_filter</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1297"><a href="#PumpWoodMicroService.flat_list_by_chunks-1297"><span class="linenos">1297</span></a>                <span class="n">request_filter_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">temp_filter_dict</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1298"><a href="#PumpWoodMicroService.flat_list_by_chunks-1298"><span class="linenos">1298</span></a>                <span class="n">request_filter_dict</span><span class="p">[</span><span class="n">partition_col_1st</span><span class="p">]</span> <span class="o">=</span> <span class="n">filter_key</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1299"><a href="#PumpWoodMicroService.flat_list_by_chunks-1299"><span class="linenos">1299</span></a>                <span class="k">if</span> <span class="n">month_sequence</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1300"><a href="#PumpWoodMicroService.flat_list_by_chunks-1300"><span class="linenos">1300</span></a>                    <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1301"><a href="#PumpWoodMicroService.flat_list_by_chunks-1301"><span class="linenos">1301</span></a>                        <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1302"><a href="#PumpWoodMicroService.flat_list_by_chunks-1302"><span class="linenos">1302</span></a>                        <span class="s2">&quot;filter_dict&quot;</span><span class="p">:</span> <span class="n">request_filter_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1303"><a href="#PumpWoodMicroService.flat_list_by_chunks-1303"><span class="linenos">1303</span></a>                        <span class="s2">&quot;exclude_dict&quot;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1304"><a href="#PumpWoodMicroService.flat_list_by_chunks-1304"><span class="linenos">1304</span></a>                        <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1305"><a href="#PumpWoodMicroService.flat_list_by_chunks-1305"><span class="linenos">1305</span></a>                        <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1306"><a href="#PumpWoodMicroService.flat_list_by_chunks-1306"><span class="linenos">1306</span></a>                        <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1307"><a href="#PumpWoodMicroService.flat_list_by_chunks-1307"><span class="linenos">1307</span></a>                        <span class="s2">&quot;chunk_size&quot;</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">})</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1308"><a href="#PumpWoodMicroService.flat_list_by_chunks-1308"><span class="linenos">1308</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1309"><a href="#PumpWoodMicroService.flat_list_by_chunks-1309"><span class="linenos">1309</span></a>                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">month_sequence</span><span class="p">)):</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1310"><a href="#PumpWoodMicroService.flat_list_by_chunks-1310"><span class="linenos">1310</span></a>                        <span class="n">request_filter_dict_t</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1311"><a href="#PumpWoodMicroService.flat_list_by_chunks-1311"><span class="linenos">1311</span></a>                            <span class="n">request_filter_dict</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1312"><a href="#PumpWoodMicroService.flat_list_by_chunks-1312"><span class="linenos">1312</span></a>                        <span class="c1"># If is not the last interval, query using open</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1313"><a href="#PumpWoodMicroService.flat_list_by_chunks-1313"><span class="linenos">1313</span></a>                        <span class="c1"># right interval so subsequence queries does</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1314"><a href="#PumpWoodMicroService.flat_list_by_chunks-1314"><span class="linenos">1314</span></a>                        <span class="c1"># not overlap</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1315"><a href="#PumpWoodMicroService.flat_list_by_chunks-1315"><span class="linenos">1315</span></a>                        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">month_sequence</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1316"><a href="#PumpWoodMicroService.flat_list_by_chunks-1316"><span class="linenos">1316</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__gte&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1317"><a href="#PumpWoodMicroService.flat_list_by_chunks-1317"><span class="linenos">1317</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1318"><a href="#PumpWoodMicroService.flat_list_by_chunks-1318"><span class="linenos">1318</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__lt&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1319"><a href="#PumpWoodMicroService.flat_list_by_chunks-1319"><span class="linenos">1319</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1320"><a href="#PumpWoodMicroService.flat_list_by_chunks-1320"><span class="linenos">1320</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1321"><a href="#PumpWoodMicroService.flat_list_by_chunks-1321"><span class="linenos">1321</span></a>                        <span class="c1"># At the last interval use closed right interval so</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1322"><a href="#PumpWoodMicroService.flat_list_by_chunks-1322"><span class="linenos">1322</span></a>                        <span class="c1"># last element is also included in the interval</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1323"><a href="#PumpWoodMicroService.flat_list_by_chunks-1323"><span class="linenos">1323</span></a>                        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1324"><a href="#PumpWoodMicroService.flat_list_by_chunks-1324"><span class="linenos">1324</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__gte&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1325"><a href="#PumpWoodMicroService.flat_list_by_chunks-1325"><span class="linenos">1325</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1326"><a href="#PumpWoodMicroService.flat_list_by_chunks-1326"><span class="linenos">1326</span></a>                            <span class="n">request_filter_dict_t</span><span class="p">[</span><span class="s2">&quot;time__lte&quot;</span><span class="p">]</span> <span class="o">=</span> \
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1327"><a href="#PumpWoodMicroService.flat_list_by_chunks-1327"><span class="linenos">1327</span></a>                                <span class="n">month_sequence</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;end&quot;</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1328"><a href="#PumpWoodMicroService.flat_list_by_chunks-1328"><span class="linenos">1328</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1329"><a href="#PumpWoodMicroService.flat_list_by_chunks-1329"><span class="linenos">1329</span></a>                        <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1330"><a href="#PumpWoodMicroService.flat_list_by_chunks-1330"><span class="linenos">1330</span></a>                            <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1331"><a href="#PumpWoodMicroService.flat_list_by_chunks-1331"><span class="linenos">1331</span></a>                            <span class="s2">&quot;filter_dict&quot;</span><span class="p">:</span> <span class="n">request_filter_dict_t</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1332"><a href="#PumpWoodMicroService.flat_list_by_chunks-1332"><span class="linenos">1332</span></a>                            <span class="s2">&quot;exclude_dict&quot;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1333"><a href="#PumpWoodMicroService.flat_list_by_chunks-1333"><span class="linenos">1333</span></a>                            <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1334"><a href="#PumpWoodMicroService.flat_list_by_chunks-1334"><span class="linenos">1334</span></a>                            <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1335"><a href="#PumpWoodMicroService.flat_list_by_chunks-1335"><span class="linenos">1335</span></a>                            <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1336"><a href="#PumpWoodMicroService.flat_list_by_chunks-1336"><span class="linenos">1336</span></a>                            <span class="s2">&quot;chunk_size&quot;</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">})</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1337"><a href="#PumpWoodMicroService.flat_list_by_chunks-1337"><span class="linenos">1337</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1338"><a href="#PumpWoodMicroService.flat_list_by_chunks-1338"><span class="linenos">1338</span></a>            <span class="c1"># Perform parallel calls to backend each chucked by chunk_size</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1339"><a href="#PumpWoodMicroService.flat_list_by_chunks-1339"><span class="linenos">1339</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel flat list: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">pool_arguments</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1340"><a href="#PumpWoodMicroService.flat_list_by_chunks-1340"><span class="linenos">1340</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1341"><a href="#PumpWoodMicroService.flat_list_by_chunks-1341"><span class="linenos">1341</span></a>                <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1342"><a href="#PumpWoodMicroService.flat_list_by_chunks-1342"><span class="linenos">1342</span></a>                    <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1343"><a href="#PumpWoodMicroService.flat_list_by_chunks-1343"><span class="linenos">1343</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">_flat_list_by_chunks_helper</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1344"><a href="#PumpWoodMicroService.flat_list_by_chunks-1344"><span class="linenos">1344</span></a>                        <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1345"><a href="#PumpWoodMicroService.flat_list_by_chunks-1345"><span class="linenos">1345</span></a>                <span class="n">resp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1346"><a href="#PumpWoodMicroService.flat_list_by_chunks-1346"><span class="linenos">1346</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1347"><a href="#PumpWoodMicroService.flat_list_by_chunks-1347"><span class="linenos">1347</span></a>                <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1348"><a href="#PumpWoodMicroService.flat_list_by_chunks-1348"><span class="linenos">1348</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">## Finished parallel flat list: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">pool_arguments</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1349"><a href="#PumpWoodMicroService.flat_list_by_chunks-1349"><span class="linenos">1349</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1350"><a href="#PumpWoodMicroService.flat_list_by_chunks-1350"><span class="linenos">1350</span></a>        <span class="c1">############################################</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1351"><a href="#PumpWoodMicroService.flat_list_by_chunks-1351"><span class="linenos">1351</span></a>        <span class="c1"># If table have partition, run in parallel #</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1352"><a href="#PumpWoodMicroService.flat_list_by_chunks-1352"><span class="linenos">1352</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1353"><a href="#PumpWoodMicroService.flat_list_by_chunks-1353"><span class="linenos">1353</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1354"><a href="#PumpWoodMicroService.flat_list_by_chunks-1354"><span class="linenos">1354</span></a>                <span class="n">results_key_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flat_list_by_chunks_helper</span><span class="p">({</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1355"><a href="#PumpWoodMicroService.flat_list_by_chunks-1355"><span class="linenos">1355</span></a>                    <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1356"><a href="#PumpWoodMicroService.flat_list_by_chunks-1356"><span class="linenos">1356</span></a>                    <span class="s2">&quot;filter_dict&quot;</span><span class="p">:</span> <span class="n">temp_filter_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1357"><a href="#PumpWoodMicroService.flat_list_by_chunks-1357"><span class="linenos">1357</span></a>                    <span class="s2">&quot;exclude_dict&quot;</span><span class="p">:</span> <span class="n">exclude_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1358"><a href="#PumpWoodMicroService.flat_list_by_chunks-1358"><span class="linenos">1358</span></a>                    <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1359"><a href="#PumpWoodMicroService.flat_list_by_chunks-1359"><span class="linenos">1359</span></a>                    <span class="s2">&quot;show_deleted&quot;</span><span class="p">:</span> <span class="n">show_deleted</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1360"><a href="#PumpWoodMicroService.flat_list_by_chunks-1360"><span class="linenos">1360</span></a>                    <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1361"><a href="#PumpWoodMicroService.flat_list_by_chunks-1361"><span class="linenos">1361</span></a>                    <span class="s2">&quot;chunk_size&quot;</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">})</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1362"><a href="#PumpWoodMicroService.flat_list_by_chunks-1362"><span class="linenos">1362</span></a>                <span class="n">resp_df</span> <span class="o">=</span> <span class="n">results_key_data</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1363"><a href="#PumpWoodMicroService.flat_list_by_chunks-1363"><span class="linenos">1363</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1364"><a href="#PumpWoodMicroService.flat_list_by_chunks-1364"><span class="linenos">1364</span></a>                <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1365"><a href="#PumpWoodMicroService.flat_list_by_chunks-1365"><span class="linenos">1365</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1366"><a href="#PumpWoodMicroService.flat_list_by_chunks-1366"><span class="linenos">1366</span></a>        <span class="k">if</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">partition</span><span class="p">))</span> <span class="ow">and</span> <span class="n">create_composite_pk</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1367"><a href="#PumpWoodMicroService.flat_list_by_chunks-1367"><span class="linenos">1367</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Creating composite pk&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1368"><a href="#PumpWoodMicroService.flat_list_by_chunks-1368"><span class="linenos">1368</span></a>            <span class="n">resp_df</span><span class="p">[</span><span class="s2">&quot;pk&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resp_df</span><span class="p">[</span><span class="n">primary_keys</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1369"><a href="#PumpWoodMicroService.flat_list_by_chunks-1369"><span class="linenos">1369</span></a>                <span class="n">CompositePkBase64Converter</span><span class="o">.</span><span class="n">dump</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1370"><a href="#PumpWoodMicroService.flat_list_by_chunks-1370"><span class="linenos">1370</span></a>                <span class="n">primary_keys</span><span class="o">=</span><span class="n">primary_keys</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1371"><a href="#PumpWoodMicroService.flat_list_by_chunks-1371"><span class="linenos">1371</span></a>            <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1372"><a href="#PumpWoodMicroService.flat_list_by_chunks-1372"><span class="linenos">1372</span></a>                <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;pk&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">fields</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1373"><a href="#PumpWoodMicroService.flat_list_by_chunks-1373"><span class="linenos">1373</span></a>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1374"><a href="#PumpWoodMicroService.flat_list_by_chunks-1374"><span class="linenos">1374</span></a>        <span class="c1"># Adjust columns to return the columns set at fields</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1375"><a href="#PumpWoodMicroService.flat_list_by_chunks-1375"><span class="linenos">1375</span></a>        <span class="k">if</span> <span class="n">fields</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1376"><a href="#PumpWoodMicroService.flat_list_by_chunks-1376"><span class="linenos">1376</span></a>            <span class="n">resp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resp_df</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">fields</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.flat_list_by_chunks-1377"><a href="#PumpWoodMicroService.flat_list_by_chunks-1377"><span class="linenos">1377</span></a>        <span class="k">return</span> <span class="n">resp_df</span>
</span></pre></div>


            <div class="docstring"><p>Incrementally fetch data from pivot end-point.</p>

<p>Fetch data from pivot end-point paginating by id of chunk_size lenght.</p>

<p>If table is partitioned it will split the query acording to partition
to facilitate query at the database.</p>

<p>If start_date and end_date are set, also breaks the query by month
retrieving each month data in parallel.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class (str):</strong>  Model class to be pivoted.</li>
<li><strong>filter_dict (dict):</strong>  Dictionary to to be used in objects.filter argument
(Same as list end-point).</li>
<li><strong>exclude_dict (dict):</strong>  Dictionary to to be used in objects.exclude argument
(Same as list end-point).</li>
<li><strong>fields (List[str] | None):</strong>  List of the variables to be returned,
if None, the default variables will be returned.
If fields is set, dataframe will return that columns
even if data is empty.</li>
<li><strong>start_date (datetime | str):</strong>  Set a begin date for the query. If begin and end date are
set, query will be splited with chucks by month that will be
requested in parallel.</li>
<li><strong>end_date (datetime | str):</strong>  Set a end date for the query. If begin and end date are
set, query will be splited with chucks by month that will be
requested in parallel.</li>
<li><strong>show_deleted (bool):</strong>  If deleted data should be returned.</li>
<li><strong>auth_header (dict):</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
<li><strong>chunk_size (int):</strong>  Limit of data to fetch per call.</li>
<li><strong>n_parallel (int):</strong>  Number of parallel process to perform.</li>
<li><strong>create_composite_pk (bool):</strong>  If true and table has a composite pk, it will create pk
value based on the hash on the json serialized dictionary
of the components of the primary key.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Returns a dataframe with all information fetched.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No particular raise.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.bulk_save" class="classattr">
                                        <input id="PumpWoodMicroService.bulk_save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">bulk_save</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">data_to_save</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n"><a href="#PumpWoodMicroService.list">PumpWoodMicroService.list</a></span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="nb">dict</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.bulk_save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.bulk_save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.bulk_save-1383"><a href="#PumpWoodMicroService.bulk_save-1383"><span class="linenos">1383</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">bulk_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data_to_save</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.bulk_save-1384"><a href="#PumpWoodMicroService.bulk_save-1384"><span class="linenos">1384</span></a>                  <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.bulk_save-1385"><a href="#PumpWoodMicroService.bulk_save-1385"><span class="linenos">1385</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Save a list of objects with one request.</span>
</span><span id="PumpWoodMicroService.bulk_save-1386"><a href="#PumpWoodMicroService.bulk_save-1386"><span class="linenos">1386</span></a>
</span><span id="PumpWoodMicroService.bulk_save-1387"><a href="#PumpWoodMicroService.bulk_save-1387"><span class="linenos">1387</span></a><span class="sd">        It is used with a unique call save many objects at the same time. It</span>
</span><span id="PumpWoodMicroService.bulk_save-1388"><a href="#PumpWoodMicroService.bulk_save-1388"><span class="linenos">1388</span></a><span class="sd">        is necessary that the end-point is able to receive bulk save requests</span>
</span><span id="PumpWoodMicroService.bulk_save-1389"><a href="#PumpWoodMicroService.bulk_save-1389"><span class="linenos">1389</span></a><span class="sd">        and all objects been of the same model class.</span>
</span><span id="PumpWoodMicroService.bulk_save-1390"><a href="#PumpWoodMicroService.bulk_save-1390"><span class="linenos">1390</span></a>
</span><span id="PumpWoodMicroService.bulk_save-1391"><a href="#PumpWoodMicroService.bulk_save-1391"><span class="linenos">1391</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.bulk_save-1392"><a href="#PumpWoodMicroService.bulk_save-1392"><span class="linenos">1392</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.bulk_save-1393"><a href="#PumpWoodMicroService.bulk_save-1393"><span class="linenos">1393</span></a><span class="sd">                Data model class.</span>
</span><span id="PumpWoodMicroService.bulk_save-1394"><a href="#PumpWoodMicroService.bulk_save-1394"><span class="linenos">1394</span></a><span class="sd">            data_to_save:</span>
</span><span id="PumpWoodMicroService.bulk_save-1395"><a href="#PumpWoodMicroService.bulk_save-1395"><span class="linenos">1395</span></a><span class="sd">                A list of objects to be saved.</span>
</span><span id="PumpWoodMicroService.bulk_save-1396"><a href="#PumpWoodMicroService.bulk_save-1396"><span class="linenos">1396</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.bulk_save-1397"><a href="#PumpWoodMicroService.bulk_save-1397"><span class="linenos">1397</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.bulk_save-1398"><a href="#PumpWoodMicroService.bulk_save-1398"><span class="linenos">1398</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.bulk_save-1399"><a href="#PumpWoodMicroService.bulk_save-1399"><span class="linenos">1399</span></a>
</span><span id="PumpWoodMicroService.bulk_save-1400"><a href="#PumpWoodMicroService.bulk_save-1400"><span class="linenos">1400</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.bulk_save-1401"><a href="#PumpWoodMicroService.bulk_save-1401"><span class="linenos">1401</span></a><span class="sd">            A dictinary with `saved_count` as key indicating the number of</span>
</span><span id="PumpWoodMicroService.bulk_save-1402"><a href="#PumpWoodMicroService.bulk_save-1402"><span class="linenos">1402</span></a><span class="sd">            objects that were saved in database.</span>
</span><span id="PumpWoodMicroService.bulk_save-1403"><a href="#PumpWoodMicroService.bulk_save-1403"><span class="linenos">1403</span></a>
</span><span id="PumpWoodMicroService.bulk_save-1404"><a href="#PumpWoodMicroService.bulk_save-1404"><span class="linenos">1404</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.bulk_save-1405"><a href="#PumpWoodMicroService.bulk_save-1405"><span class="linenos">1405</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.bulk_save-1406"><a href="#PumpWoodMicroService.bulk_save-1406"><span class="linenos">1406</span></a><span class="sd">                &#39;Expected columns and data columns do not match: Expected</span>
</span><span id="PumpWoodMicroService.bulk_save-1407"><a href="#PumpWoodMicroService.bulk_save-1407"><span class="linenos">1407</span></a><span class="sd">                columns: {expected} Data columns: {data_cols}&#39;. Indicates</span>
</span><span id="PumpWoodMicroService.bulk_save-1408"><a href="#PumpWoodMicroService.bulk_save-1408"><span class="linenos">1408</span></a><span class="sd">                that the expected fields of the object were not met at the</span>
</span><span id="PumpWoodMicroService.bulk_save-1409"><a href="#PumpWoodMicroService.bulk_save-1409"><span class="linenos">1409</span></a><span class="sd">                objects passed to save.</span>
</span><span id="PumpWoodMicroService.bulk_save-1410"><a href="#PumpWoodMicroService.bulk_save-1410"><span class="linenos">1410</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.bulk_save-1411"><a href="#PumpWoodMicroService.bulk_save-1411"><span class="linenos">1411</span></a><span class="sd">                Other sqlalchemy and psycopg2 errors not associated with</span>
</span><span id="PumpWoodMicroService.bulk_save-1412"><a href="#PumpWoodMicroService.bulk_save-1412"><span class="linenos">1412</span></a><span class="sd">                IntegrityError.</span>
</span><span id="PumpWoodMicroService.bulk_save-1413"><a href="#PumpWoodMicroService.bulk_save-1413"><span class="linenos">1413</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.bulk_save-1414"><a href="#PumpWoodMicroService.bulk_save-1414"><span class="linenos">1414</span></a><span class="sd">                &#39;Bulk save not avaiable.&#39;. Indicates that Bulk save end-point</span>
</span><span id="PumpWoodMicroService.bulk_save-1415"><a href="#PumpWoodMicroService.bulk_save-1415"><span class="linenos">1415</span></a><span class="sd">                was not configured for this model_class.</span>
</span><span id="PumpWoodMicroService.bulk_save-1416"><a href="#PumpWoodMicroService.bulk_save-1416"><span class="linenos">1416</span></a><span class="sd">            PumpWoodIntegrityError:</span>
</span><span id="PumpWoodMicroService.bulk_save-1417"><a href="#PumpWoodMicroService.bulk_save-1417"><span class="linenos">1417</span></a><span class="sd">                Raise integrity errors from sqlalchemy and psycopg2. Usually</span>
</span><span id="PumpWoodMicroService.bulk_save-1418"><a href="#PumpWoodMicroService.bulk_save-1418"><span class="linenos">1418</span></a><span class="sd">                associated with uniqueness of some column.</span>
</span><span id="PumpWoodMicroService.bulk_save-1419"><a href="#PumpWoodMicroService.bulk_save-1419"><span class="linenos">1419</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.bulk_save-1420"><a href="#PumpWoodMicroService.bulk_save-1420"><span class="linenos">1420</span></a>        <span class="n">url_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_bulk_save_url</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.bulk_save-1421"><a href="#PumpWoodMicroService.bulk_save-1421"><span class="linenos">1421</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.bulk_save-1422"><a href="#PumpWoodMicroService.bulk_save-1422"><span class="linenos">1422</span></a>            <span class="n">url</span><span class="o">=</span><span class="n">url_str</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_to_save</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.bulk_save-1423"><a href="#PumpWoodMicroService.bulk_save-1423"><span class="linenos">1423</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Save a list of objects with one request.</p>

<p>It is used with a unique call save many objects at the same time. It
is necessary that the end-point is able to receive bulk save requests
and all objects been of the same model class.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Data model class.</li>
<li><strong>data_to_save:</strong>  A list of objects to be saved.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A dictinary with <code>saved_count</code> as key indicating the number of
  objects that were saved in database.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'Expected columns and data columns do not match: Expected
columns: {expected} Data columns: {data_cols}'. Indicates
that the expected fields of the object were not met at the
objects passed to save.</li>
<li><strong>PumpWoodException:</strong>  Other sqlalchemy and psycopg2 errors not associated with
IntegrityError.</li>
<li><strong>PumpWoodException:</strong>  'Bulk save not avaiable.'. Indicates that Bulk save end-point
was not configured for this model_class.</li>
<li><strong>PumpWoodIntegrityError:</strong>  Raise integrity errors from sqlalchemy and psycopg2. Usually
associated with uniqueness of some column.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.flatten_parallel" class="classattr">
                                        <input id="PumpWoodMicroService.flatten_parallel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator decorator-staticmethod">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">flatten_parallel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">parallel_result</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n"><a href="#PumpWoodMicroService.list">PumpWoodMicroService.list</a></span><span class="o">&gt;</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.flatten_parallel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.flatten_parallel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.flatten_parallel-1427"><a href="#PumpWoodMicroService.flatten_parallel-1427"><span class="linenos">1427</span></a>    <span class="nd">@staticmethod</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1428"><a href="#PumpWoodMicroService.flatten_parallel-1428"><span class="linenos">1428</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">flatten_parallel</span><span class="p">(</span><span class="n">parallel_result</span><span class="p">:</span> <span class="nb">list</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1429"><a href="#PumpWoodMicroService.flatten_parallel-1429"><span class="linenos">1429</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Concat all parallel return to one list.</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1430"><a href="#PumpWoodMicroService.flatten_parallel-1430"><span class="linenos">1430</span></a>
</span><span id="PumpWoodMicroService.flatten_parallel-1431"><a href="#PumpWoodMicroService.flatten_parallel-1431"><span class="linenos">1431</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1432"><a href="#PumpWoodMicroService.flatten_parallel-1432"><span class="linenos">1432</span></a><span class="sd">            parallel_result:</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1433"><a href="#PumpWoodMicroService.flatten_parallel-1433"><span class="linenos">1433</span></a><span class="sd">                A list of lists to be flated (concatenate</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1434"><a href="#PumpWoodMicroService.flatten_parallel-1434"><span class="linenos">1434</span></a><span class="sd">                all lists into one).</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1435"><a href="#PumpWoodMicroService.flatten_parallel-1435"><span class="linenos">1435</span></a>
</span><span id="PumpWoodMicroService.flatten_parallel-1436"><a href="#PumpWoodMicroService.flatten_parallel-1436"><span class="linenos">1436</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1437"><a href="#PumpWoodMicroService.flatten_parallel-1437"><span class="linenos">1437</span></a><span class="sd">            A list with all sub list itens.</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1438"><a href="#PumpWoodMicroService.flatten_parallel-1438"><span class="linenos">1438</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1439"><a href="#PumpWoodMicroService.flatten_parallel-1439"><span class="linenos">1439</span></a>        <span class="k">return</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1440"><a href="#PumpWoodMicroService.flatten_parallel-1440"><span class="linenos">1440</span></a>            <span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="ow">in</span> <span class="n">parallel_result</span>
</span><span id="PumpWoodMicroService.flatten_parallel-1441"><a href="#PumpWoodMicroService.flatten_parallel-1441"><span class="linenos">1441</span></a>            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sublist</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Concat all parallel return to one list.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>parallel_result:</strong>  A list of lists to be flated (concatenate
all lists into one).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>A list with all sub list itens.</p>
</blockquote>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_request_get" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_request_get-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_request_get</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">urls_list</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n"><a href="#PumpWoodMicroService.list">PumpWoodMicroService.list</a></span><span class="o">&gt;</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">any</span><span class="o">&gt;</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_request_get-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_request_get"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_request_get-1452"><a href="#PumpWoodMicroService.parallel_request_get-1452"><span class="linenos">1452</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_request_get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">urls_list</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1453"><a href="#PumpWoodMicroService.parallel_request_get-1453"><span class="linenos">1453</span></a>                             <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1454"><a href="#PumpWoodMicroService.parallel_request_get-1454"><span class="linenos">1454</span></a>                             <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">any</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1455"><a href="#PumpWoodMicroService.parallel_request_get-1455"><span class="linenos">1455</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel get requests.</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1456"><a href="#PumpWoodMicroService.parallel_request_get-1456"><span class="linenos">1456</span></a>
</span><span id="PumpWoodMicroService.parallel_request_get-1457"><a href="#PumpWoodMicroService.parallel_request_get-1457"><span class="linenos">1457</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1458"><a href="#PumpWoodMicroService.parallel_request_get-1458"><span class="linenos">1458</span></a><span class="sd">            urls_list:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1459"><a href="#PumpWoodMicroService.parallel_request_get-1459"><span class="linenos">1459</span></a><span class="sd">                List of urls to make get requests.</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1460"><a href="#PumpWoodMicroService.parallel_request_get-1460"><span class="linenos">1460</span></a><span class="sd">            parameters:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1461"><a href="#PumpWoodMicroService.parallel_request_get-1461"><span class="linenos">1461</span></a><span class="sd">                A list of dictionary or a dictionary that will be replicated</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1462"><a href="#PumpWoodMicroService.parallel_request_get-1462"><span class="linenos">1462</span></a><span class="sd">                len(urls_list) and passed to parallel request as url</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1463"><a href="#PumpWoodMicroService.parallel_request_get-1463"><span class="linenos">1463</span></a><span class="sd">                parameter. If not set, empty dictionary will be passed to all</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1464"><a href="#PumpWoodMicroService.parallel_request_get-1464"><span class="linenos">1464</span></a><span class="sd">                request as default.</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1465"><a href="#PumpWoodMicroService.parallel_request_get-1465"><span class="linenos">1465</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1466"><a href="#PumpWoodMicroService.parallel_request_get-1466"><span class="linenos">1466</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1467"><a href="#PumpWoodMicroService.parallel_request_get-1467"><span class="linenos">1467</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1468"><a href="#PumpWoodMicroService.parallel_request_get-1468"><span class="linenos">1468</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1469"><a href="#PumpWoodMicroService.parallel_request_get-1469"><span class="linenos">1469</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1470"><a href="#PumpWoodMicroService.parallel_request_get-1470"><span class="linenos">1470</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1471"><a href="#PumpWoodMicroService.parallel_request_get-1471"><span class="linenos">1471</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1472"><a href="#PumpWoodMicroService.parallel_request_get-1472"><span class="linenos">1472</span></a>
</span><span id="PumpWoodMicroService.parallel_request_get-1473"><a href="#PumpWoodMicroService.parallel_request_get-1473"><span class="linenos">1473</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1474"><a href="#PumpWoodMicroService.parallel_request_get-1474"><span class="linenos">1474</span></a><span class="sd">            Return a list with all get request reponses. The results are</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1475"><a href="#PumpWoodMicroService.parallel_request_get-1475"><span class="linenos">1475</span></a><span class="sd">            on the same order of argument list.</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1476"><a href="#PumpWoodMicroService.parallel_request_get-1476"><span class="linenos">1476</span></a>
</span><span id="PumpWoodMicroService.parallel_request_get-1477"><a href="#PumpWoodMicroService.parallel_request_get-1477"><span class="linenos">1477</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1478"><a href="#PumpWoodMicroService.parallel_request_get-1478"><span class="linenos">1478</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1479"><a href="#PumpWoodMicroService.parallel_request_get-1479"><span class="linenos">1479</span></a><span class="sd">                &#39;lenght of urls_list[{}] is different of parameters[{}]&#39;.</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1480"><a href="#PumpWoodMicroService.parallel_request_get-1480"><span class="linenos">1480</span></a><span class="sd">                Indicates that the function arguments `urls_list` and</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1481"><a href="#PumpWoodMicroService.parallel_request_get-1481"><span class="linenos">1481</span></a><span class="sd">                `parameters` (when passed as a list of dictionaries)</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1482"><a href="#PumpWoodMicroService.parallel_request_get-1482"><span class="linenos">1482</span></a><span class="sd">                does not have de same lenght.</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1483"><a href="#PumpWoodMicroService.parallel_request_get-1483"><span class="linenos">1483</span></a><span class="sd">            PumpWoodNotImplementedError:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1484"><a href="#PumpWoodMicroService.parallel_request_get-1484"><span class="linenos">1484</span></a><span class="sd">                &#39;paraemters type[{}] is not implemented&#39;. Indicates that</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1485"><a href="#PumpWoodMicroService.parallel_request_get-1485"><span class="linenos">1485</span></a><span class="sd">                `parameters` passed as function argument is not a list of dict</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1486"><a href="#PumpWoodMicroService.parallel_request_get-1486"><span class="linenos">1486</span></a><span class="sd">                or a dictinary, so not implemented.</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1487"><a href="#PumpWoodMicroService.parallel_request_get-1487"><span class="linenos">1487</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1488"><a href="#PumpWoodMicroService.parallel_request_get-1488"><span class="linenos">1488</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1489"><a href="#PumpWoodMicroService.parallel_request_get-1489"><span class="linenos">1489</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1490"><a href="#PumpWoodMicroService.parallel_request_get-1490"><span class="linenos">1490</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1491"><a href="#PumpWoodMicroService.parallel_request_get-1491"><span class="linenos">1491</span></a>
</span><span id="PumpWoodMicroService.parallel_request_get-1492"><a href="#PumpWoodMicroService.parallel_request_get-1492"><span class="linenos">1492</span></a>        <span class="c1"># Create URL parameters if not set as parameter with</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1493"><a href="#PumpWoodMicroService.parallel_request_get-1493"><span class="linenos">1493</span></a>        <span class="c1"># empty dicionaries</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1494"><a href="#PumpWoodMicroService.parallel_request_get-1494"><span class="linenos">1494</span></a>        <span class="n">n_urls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1495"><a href="#PumpWoodMicroService.parallel_request_get-1495"><span class="linenos">1495</span></a>        <span class="n">parameters_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1496"><a href="#PumpWoodMicroService.parallel_request_get-1496"><span class="linenos">1496</span></a>        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1497"><a href="#PumpWoodMicroService.parallel_request_get-1497"><span class="linenos">1497</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1498"><a href="#PumpWoodMicroService.parallel_request_get-1498"><span class="linenos">1498</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1499"><a href="#PumpWoodMicroService.parallel_request_get-1499"><span class="linenos">1499</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{</span><span class="n">parameters</span><span class="p">}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1500"><a href="#PumpWoodMicroService.parallel_request_get-1500"><span class="linenos">1500</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1501"><a href="#PumpWoodMicroService.parallel_request_get-1501"><span class="linenos">1501</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_urls</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1502"><a href="#PumpWoodMicroService.parallel_request_get-1502"><span class="linenos">1502</span></a>                <span class="n">parameters_list</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1503"><a href="#PumpWoodMicroService.parallel_request_get-1503"><span class="linenos">1503</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1504"><a href="#PumpWoodMicroService.parallel_request_get-1504"><span class="linenos">1504</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1505"><a href="#PumpWoodMicroService.parallel_request_get-1505"><span class="linenos">1505</span></a>                    <span class="s1">&#39;lenght of urls_list[</span><span class="si">{}</span><span class="s1">] is different of &#39;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1506"><a href="#PumpWoodMicroService.parallel_request_get-1506"><span class="linenos">1506</span></a>                    <span class="s1">&#39;parameters[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1507"><a href="#PumpWoodMicroService.parallel_request_get-1507"><span class="linenos">1507</span></a>                        <span class="n">n_urls</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1508"><a href="#PumpWoodMicroService.parallel_request_get-1508"><span class="linenos">1508</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1509"><a href="#PumpWoodMicroService.parallel_request_get-1509"><span class="linenos">1509</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1510"><a href="#PumpWoodMicroService.parallel_request_get-1510"><span class="linenos">1510</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;paraemters type[</span><span class="si">{}</span><span class="s1">] is not implemented&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1511"><a href="#PumpWoodMicroService.parallel_request_get-1511"><span class="linenos">1511</span></a>                <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)))</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1512"><a href="#PumpWoodMicroService.parallel_request_get-1512"><span class="linenos">1512</span></a>            <span class="k">raise</span> <span class="n">PumpWoodNotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1513"><a href="#PumpWoodMicroService.parallel_request_get-1513"><span class="linenos">1513</span></a>
</span><span id="PumpWoodMicroService.parallel_request_get-1514"><a href="#PumpWoodMicroService.parallel_request_get-1514"><span class="linenos">1514</span></a>        <span class="c1"># Create Pool arguments to run in parallel</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1515"><a href="#PumpWoodMicroService.parallel_request_get-1515"><span class="linenos">1515</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1516"><a href="#PumpWoodMicroService.parallel_request_get-1516"><span class="linenos">1516</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)):</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1517"><a href="#PumpWoodMicroService.parallel_request_get-1517"><span class="linenos">1517</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1518"><a href="#PumpWoodMicroService.parallel_request_get-1518"><span class="linenos">1518</span></a>                <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">urls_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;auth_header&#39;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1519"><a href="#PumpWoodMicroService.parallel_request_get-1519"><span class="linenos">1519</span></a>                <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="n">parameters_list</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1520"><a href="#PumpWoodMicroService.parallel_request_get-1520"><span class="linenos">1520</span></a>
</span><span id="PumpWoodMicroService.parallel_request_get-1521"><a href="#PumpWoodMicroService.parallel_request_get-1521"><span class="linenos">1521</span></a>        <span class="c1"># Run requests in parallel</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1522"><a href="#PumpWoodMicroService.parallel_request_get-1522"><span class="linenos">1522</span></a>        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1523"><a href="#PumpWoodMicroService.parallel_request_get-1523"><span class="linenos">1523</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_request_get_wrapper</span><span class="p">,</span> <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1524"><a href="#PumpWoodMicroService.parallel_request_get-1524"><span class="linenos">1524</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_request_get-1525"><a href="#PumpWoodMicroService.parallel_request_get-1525"><span class="linenos">1525</span></a>        <span class="k">return</span> <span class="n">results</span>
</span></pre></div>


            <div class="docstring"><p>Make [n_parallel] parallel get requests.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>urls_list:</strong>  List of urls to make get requests.</li>
<li><strong>parameters:</strong>  A list of dictionary or a dictionary that will be replicated
len(urls_list) and passed to parallel request as url
parameter. If not set, empty dictionary will be passed to all
request as default.</li>
<li><strong>n_parallel:</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Return a list with all get request reponses. The results are
  on the same order of argument list.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'lenght of urls_list[{}] is different of parameters[{}]'.
Indicates that the function arguments <code>urls_list</code> and
<code>parameters</code> (when passed as a list of dictionaries)
does not have de same lenght.</li>
<li><strong>PumpWoodNotImplementedError:</strong>  'paraemters type[{}] is not implemented'. Indicates that
<code>parameters</code> passed as function argument is not a list of dict
or a dictinary, so not implemented.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.paralell_request_post" class="classattr">
                                        <input id="PumpWoodMicroService.paralell_request_post-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">paralell_request_post</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">urls_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">data_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>,</span><span class="param">	<span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="o">&lt;</span><span class="n">built</span><span class="o">-</span><span class="ow">in</span> <span class="n">function</span> <span class="nb">any</span><span class="o">&gt;</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.paralell_request_post-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.paralell_request_post"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.paralell_request_post-1536"><a href="#PumpWoodMicroService.paralell_request_post-1536"><span class="linenos">1536</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">paralell_request_post</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">urls_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1537"><a href="#PumpWoodMicroService.paralell_request_post-1537"><span class="linenos">1537</span></a>                              <span class="n">data_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1538"><a href="#PumpWoodMicroService.paralell_request_post-1538"><span class="linenos">1538</span></a>                              <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1539"><a href="#PumpWoodMicroService.paralell_request_post-1539"><span class="linenos">1539</span></a>                              <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1540"><a href="#PumpWoodMicroService.paralell_request_post-1540"><span class="linenos">1540</span></a>                              <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">any</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1541"><a href="#PumpWoodMicroService.paralell_request_post-1541"><span class="linenos">1541</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel post request.</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1542"><a href="#PumpWoodMicroService.paralell_request_post-1542"><span class="linenos">1542</span></a>
</span><span id="PumpWoodMicroService.paralell_request_post-1543"><a href="#PumpWoodMicroService.paralell_request_post-1543"><span class="linenos">1543</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1544"><a href="#PumpWoodMicroService.paralell_request_post-1544"><span class="linenos">1544</span></a><span class="sd">            urls_list:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1545"><a href="#PumpWoodMicroService.paralell_request_post-1545"><span class="linenos">1545</span></a><span class="sd">                List of urls to make get requests.</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1546"><a href="#PumpWoodMicroService.paralell_request_post-1546"><span class="linenos">1546</span></a><span class="sd">            data_list:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1547"><a href="#PumpWoodMicroService.paralell_request_post-1547"><span class="linenos">1547</span></a><span class="sd">                List of data to be used as post payloads.</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1548"><a href="#PumpWoodMicroService.paralell_request_post-1548"><span class="linenos">1548</span></a><span class="sd">            parameters:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1549"><a href="#PumpWoodMicroService.paralell_request_post-1549"><span class="linenos">1549</span></a><span class="sd">                URL paramenters to make the post requests.</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1550"><a href="#PumpWoodMicroService.paralell_request_post-1550"><span class="linenos">1550</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1551"><a href="#PumpWoodMicroService.paralell_request_post-1551"><span class="linenos">1551</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1552"><a href="#PumpWoodMicroService.paralell_request_post-1552"><span class="linenos">1552</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1553"><a href="#PumpWoodMicroService.paralell_request_post-1553"><span class="linenos">1553</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1554"><a href="#PumpWoodMicroService.paralell_request_post-1554"><span class="linenos">1554</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1555"><a href="#PumpWoodMicroService.paralell_request_post-1555"><span class="linenos">1555</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1556"><a href="#PumpWoodMicroService.paralell_request_post-1556"><span class="linenos">1556</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1557"><a href="#PumpWoodMicroService.paralell_request_post-1557"><span class="linenos">1557</span></a>
</span><span id="PumpWoodMicroService.paralell_request_post-1558"><a href="#PumpWoodMicroService.paralell_request_post-1558"><span class="linenos">1558</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1559"><a href="#PumpWoodMicroService.paralell_request_post-1559"><span class="linenos">1559</span></a><span class="sd">            List of the post request reponses.</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1560"><a href="#PumpWoodMicroService.paralell_request_post-1560"><span class="linenos">1560</span></a>
</span><span id="PumpWoodMicroService.paralell_request_post-1561"><a href="#PumpWoodMicroService.paralell_request_post-1561"><span class="linenos">1561</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1562"><a href="#PumpWoodMicroService.paralell_request_post-1562"><span class="linenos">1562</span></a><span class="sd">            No particular raises</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1563"><a href="#PumpWoodMicroService.paralell_request_post-1563"><span class="linenos">1563</span></a>
</span><span id="PumpWoodMicroService.paralell_request_post-1564"><a href="#PumpWoodMicroService.paralell_request_post-1564"><span class="linenos">1564</span></a><span class="sd">        Example:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1565"><a href="#PumpWoodMicroService.paralell_request_post-1565"><span class="linenos">1565</span></a><span class="sd">            No example yet.</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1566"><a href="#PumpWoodMicroService.paralell_request_post-1566"><span class="linenos">1566</span></a>
</span><span id="PumpWoodMicroService.paralell_request_post-1567"><a href="#PumpWoodMicroService.paralell_request_post-1567"><span class="linenos">1567</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1568"><a href="#PumpWoodMicroService.paralell_request_post-1568"><span class="linenos">1568</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1569"><a href="#PumpWoodMicroService.paralell_request_post-1569"><span class="linenos">1569</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1570"><a href="#PumpWoodMicroService.paralell_request_post-1570"><span class="linenos">1570</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1571"><a href="#PumpWoodMicroService.paralell_request_post-1571"><span class="linenos">1571</span></a>
</span><span id="PumpWoodMicroService.paralell_request_post-1572"><a href="#PumpWoodMicroService.paralell_request_post-1572"><span class="linenos">1572</span></a>        <span class="c1"># Create URL parameters if not set as parameter with</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1573"><a href="#PumpWoodMicroService.paralell_request_post-1573"><span class="linenos">1573</span></a>        <span class="c1"># empty dicionaries</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1574"><a href="#PumpWoodMicroService.paralell_request_post-1574"><span class="linenos">1574</span></a>        <span class="n">n_urls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1575"><a href="#PumpWoodMicroService.paralell_request_post-1575"><span class="linenos">1575</span></a>        <span class="n">parameters_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1576"><a href="#PumpWoodMicroService.paralell_request_post-1576"><span class="linenos">1576</span></a>        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1577"><a href="#PumpWoodMicroService.paralell_request_post-1577"><span class="linenos">1577</span></a>            <span class="n">parameters_list</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1578"><a href="#PumpWoodMicroService.paralell_request_post-1578"><span class="linenos">1578</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1579"><a href="#PumpWoodMicroService.paralell_request_post-1579"><span class="linenos">1579</span></a>            <span class="n">parameters_list</span> <span class="o">=</span> <span class="p">[{</span><span class="n">parameters</span><span class="p">}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1580"><a href="#PumpWoodMicroService.paralell_request_post-1580"><span class="linenos">1580</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1581"><a href="#PumpWoodMicroService.paralell_request_post-1581"><span class="linenos">1581</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_urls</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1582"><a href="#PumpWoodMicroService.paralell_request_post-1582"><span class="linenos">1582</span></a>                <span class="n">parameters_list</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1583"><a href="#PumpWoodMicroService.paralell_request_post-1583"><span class="linenos">1583</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1584"><a href="#PumpWoodMicroService.paralell_request_post-1584"><span class="linenos">1584</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1585"><a href="#PumpWoodMicroService.paralell_request_post-1585"><span class="linenos">1585</span></a>                    <span class="s1">&#39;lenght of urls_list[</span><span class="si">{}</span><span class="s1">] is different of &#39;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1586"><a href="#PumpWoodMicroService.paralell_request_post-1586"><span class="linenos">1586</span></a>                    <span class="s1">&#39;parameters[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1587"><a href="#PumpWoodMicroService.paralell_request_post-1587"><span class="linenos">1587</span></a>                        <span class="n">n_urls</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1588"><a href="#PumpWoodMicroService.paralell_request_post-1588"><span class="linenos">1588</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1589"><a href="#PumpWoodMicroService.paralell_request_post-1589"><span class="linenos">1589</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1590"><a href="#PumpWoodMicroService.paralell_request_post-1590"><span class="linenos">1590</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;paraemters type[</span><span class="si">{}</span><span class="s1">] is not implemented&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1591"><a href="#PumpWoodMicroService.paralell_request_post-1591"><span class="linenos">1591</span></a>                <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)))</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1592"><a href="#PumpWoodMicroService.paralell_request_post-1592"><span class="linenos">1592</span></a>            <span class="k">raise</span> <span class="n">PumpWoodNotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1593"><a href="#PumpWoodMicroService.paralell_request_post-1593"><span class="linenos">1593</span></a>
</span><span id="PumpWoodMicroService.paralell_request_post-1594"><a href="#PumpWoodMicroService.paralell_request_post-1594"><span class="linenos">1594</span></a>        <span class="c1"># Validate if length of URL is the same of data_list</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1595"><a href="#PumpWoodMicroService.paralell_request_post-1595"><span class="linenos">1595</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1596"><a href="#PumpWoodMicroService.paralell_request_post-1596"><span class="linenos">1596</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1597"><a href="#PumpWoodMicroService.paralell_request_post-1597"><span class="linenos">1597</span></a>                <span class="s1">&#39;len(urls_list)[</span><span class="si">{}</span><span class="s1">] must be equal &#39;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1598"><a href="#PumpWoodMicroService.paralell_request_post-1598"><span class="linenos">1598</span></a>                <span class="s1">&#39;to len(data_list)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1599"><a href="#PumpWoodMicroService.paralell_request_post-1599"><span class="linenos">1599</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1600"><a href="#PumpWoodMicroService.paralell_request_post-1600"><span class="linenos">1600</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1601"><a href="#PumpWoodMicroService.paralell_request_post-1601"><span class="linenos">1601</span></a>
</span><span id="PumpWoodMicroService.paralell_request_post-1602"><a href="#PumpWoodMicroService.paralell_request_post-1602"><span class="linenos">1602</span></a>        <span class="c1"># Create the arguments for parallel requests</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1603"><a href="#PumpWoodMicroService.paralell_request_post-1603"><span class="linenos">1603</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1604"><a href="#PumpWoodMicroService.paralell_request_post-1604"><span class="linenos">1604</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)):</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1605"><a href="#PumpWoodMicroService.paralell_request_post-1605"><span class="linenos">1605</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1606"><a href="#PumpWoodMicroService.paralell_request_post-1606"><span class="linenos">1606</span></a>                <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">urls_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1607"><a href="#PumpWoodMicroService.paralell_request_post-1607"><span class="linenos">1607</span></a>                <span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1608"><a href="#PumpWoodMicroService.paralell_request_post-1608"><span class="linenos">1608</span></a>                <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="n">parameters_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1609"><a href="#PumpWoodMicroService.paralell_request_post-1609"><span class="linenos">1609</span></a>                <span class="s1">&#39;auth_header&#39;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">})</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1610"><a href="#PumpWoodMicroService.paralell_request_post-1610"><span class="linenos">1610</span></a>
</span><span id="PumpWoodMicroService.paralell_request_post-1611"><a href="#PumpWoodMicroService.paralell_request_post-1611"><span class="linenos">1611</span></a>        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1612"><a href="#PumpWoodMicroService.paralell_request_post-1612"><span class="linenos">1612</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_request_post_wrapper</span><span class="p">,</span> <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1613"><a href="#PumpWoodMicroService.paralell_request_post-1613"><span class="linenos">1613</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.paralell_request_post-1614"><a href="#PumpWoodMicroService.paralell_request_post-1614"><span class="linenos">1614</span></a>        <span class="k">return</span> <span class="n">results</span>
</span></pre></div>


            <div class="docstring"><p>Make [n_parallel] parallel post request.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>urls_list:</strong>  List of urls to make get requests.</li>
<li><strong>data_list:</strong>  List of data to be used as post payloads.</li>
<li><strong>parameters:</strong>  URL paramenters to make the post requests.</li>
<li><strong>n_parallel:</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of the post request reponses.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No particular raises</li>
</ul>

<h6 id="example">Example:</h6>

<blockquote>
  <p>No example yet.</p>
</blockquote>
</div>


                            </div>
                            <div id="PumpWoodMicroService.paralell_request_delete" class="classattr">
                                        <input id="PumpWoodMicroService.paralell_request_delete-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">paralell_request_delete</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">urls_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.paralell_request_delete-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.paralell_request_delete"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.paralell_request_delete-1625"><a href="#PumpWoodMicroService.paralell_request_delete-1625"><span class="linenos">1625</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">paralell_request_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">urls_list</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1626"><a href="#PumpWoodMicroService.paralell_request_delete-1626"><span class="linenos">1626</span></a>                                <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1627"><a href="#PumpWoodMicroService.paralell_request_delete-1627"><span class="linenos">1627</span></a>                                <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1628"><a href="#PumpWoodMicroService.paralell_request_delete-1628"><span class="linenos">1628</span></a>                                <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1629"><a href="#PumpWoodMicroService.paralell_request_delete-1629"><span class="linenos">1629</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel delete request.</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1630"><a href="#PumpWoodMicroService.paralell_request_delete-1630"><span class="linenos">1630</span></a>
</span><span id="PumpWoodMicroService.paralell_request_delete-1631"><a href="#PumpWoodMicroService.paralell_request_delete-1631"><span class="linenos">1631</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1632"><a href="#PumpWoodMicroService.paralell_request_delete-1632"><span class="linenos">1632</span></a><span class="sd">            urls_list:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1633"><a href="#PumpWoodMicroService.paralell_request_delete-1633"><span class="linenos">1633</span></a><span class="sd">                List of urls to make get requests.</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1634"><a href="#PumpWoodMicroService.paralell_request_delete-1634"><span class="linenos">1634</span></a><span class="sd">            parameters:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1635"><a href="#PumpWoodMicroService.paralell_request_delete-1635"><span class="linenos">1635</span></a><span class="sd">                URL paramenters to make the post requests.</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1636"><a href="#PumpWoodMicroService.paralell_request_delete-1636"><span class="linenos">1636</span></a><span class="sd">            n_parallel (int): Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1637"><a href="#PumpWoodMicroService.paralell_request_delete-1637"><span class="linenos">1637</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1638"><a href="#PumpWoodMicroService.paralell_request_delete-1638"><span class="linenos">1638</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1639"><a href="#PumpWoodMicroService.paralell_request_delete-1639"><span class="linenos">1639</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1640"><a href="#PumpWoodMicroService.paralell_request_delete-1640"><span class="linenos">1640</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1641"><a href="#PumpWoodMicroService.paralell_request_delete-1641"><span class="linenos">1641</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1642"><a href="#PumpWoodMicroService.paralell_request_delete-1642"><span class="linenos">1642</span></a>
</span><span id="PumpWoodMicroService.paralell_request_delete-1643"><a href="#PumpWoodMicroService.paralell_request_delete-1643"><span class="linenos">1643</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1644"><a href="#PumpWoodMicroService.paralell_request_delete-1644"><span class="linenos">1644</span></a><span class="sd">            list: List of the get request reponses.</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1645"><a href="#PumpWoodMicroService.paralell_request_delete-1645"><span class="linenos">1645</span></a>
</span><span id="PumpWoodMicroService.paralell_request_delete-1646"><a href="#PumpWoodMicroService.paralell_request_delete-1646"><span class="linenos">1646</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1647"><a href="#PumpWoodMicroService.paralell_request_delete-1647"><span class="linenos">1647</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1648"><a href="#PumpWoodMicroService.paralell_request_delete-1648"><span class="linenos">1648</span></a>
</span><span id="PumpWoodMicroService.paralell_request_delete-1649"><a href="#PumpWoodMicroService.paralell_request_delete-1649"><span class="linenos">1649</span></a><span class="sd">        Example:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1650"><a href="#PumpWoodMicroService.paralell_request_delete-1650"><span class="linenos">1650</span></a><span class="sd">            No example yet.</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1651"><a href="#PumpWoodMicroService.paralell_request_delete-1651"><span class="linenos">1651</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1652"><a href="#PumpWoodMicroService.paralell_request_delete-1652"><span class="linenos">1652</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1653"><a href="#PumpWoodMicroService.paralell_request_delete-1653"><span class="linenos">1653</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1654"><a href="#PumpWoodMicroService.paralell_request_delete-1654"><span class="linenos">1654</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1655"><a href="#PumpWoodMicroService.paralell_request_delete-1655"><span class="linenos">1655</span></a>
</span><span id="PumpWoodMicroService.paralell_request_delete-1656"><a href="#PumpWoodMicroService.paralell_request_delete-1656"><span class="linenos">1656</span></a>        <span class="c1"># Create URL parameters if not set as parameter with</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1657"><a href="#PumpWoodMicroService.paralell_request_delete-1657"><span class="linenos">1657</span></a>        <span class="c1"># empty dicionaries</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1658"><a href="#PumpWoodMicroService.paralell_request_delete-1658"><span class="linenos">1658</span></a>        <span class="n">n_urls</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1659"><a href="#PumpWoodMicroService.paralell_request_delete-1659"><span class="linenos">1659</span></a>        <span class="n">parameters_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1660"><a href="#PumpWoodMicroService.paralell_request_delete-1660"><span class="linenos">1660</span></a>        <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1661"><a href="#PumpWoodMicroService.paralell_request_delete-1661"><span class="linenos">1661</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1662"><a href="#PumpWoodMicroService.paralell_request_delete-1662"><span class="linenos">1662</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">dict</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1663"><a href="#PumpWoodMicroService.paralell_request_delete-1663"><span class="linenos">1663</span></a>            <span class="n">parameters</span> <span class="o">=</span> <span class="p">[{</span><span class="n">parameters</span><span class="p">}]</span> <span class="o">*</span> <span class="n">n_urls</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1664"><a href="#PumpWoodMicroService.paralell_request_delete-1664"><span class="linenos">1664</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1665"><a href="#PumpWoodMicroService.paralell_request_delete-1665"><span class="linenos">1665</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_urls</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1666"><a href="#PumpWoodMicroService.paralell_request_delete-1666"><span class="linenos">1666</span></a>                <span class="n">parameters_list</span> <span class="o">=</span> <span class="n">parameters</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1667"><a href="#PumpWoodMicroService.paralell_request_delete-1667"><span class="linenos">1667</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1668"><a href="#PumpWoodMicroService.paralell_request_delete-1668"><span class="linenos">1668</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1669"><a href="#PumpWoodMicroService.paralell_request_delete-1669"><span class="linenos">1669</span></a>                    <span class="s1">&#39;lenght of urls_list[</span><span class="si">{}</span><span class="s1">] is different of &#39;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1670"><a href="#PumpWoodMicroService.paralell_request_delete-1670"><span class="linenos">1670</span></a>                    <span class="s1">&#39;parameters[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1671"><a href="#PumpWoodMicroService.paralell_request_delete-1671"><span class="linenos">1671</span></a>                        <span class="n">n_urls</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1672"><a href="#PumpWoodMicroService.paralell_request_delete-1672"><span class="linenos">1672</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1673"><a href="#PumpWoodMicroService.paralell_request_delete-1673"><span class="linenos">1673</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1674"><a href="#PumpWoodMicroService.paralell_request_delete-1674"><span class="linenos">1674</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;paraemters type[</span><span class="si">{}</span><span class="s1">] is not implemented&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1675"><a href="#PumpWoodMicroService.paralell_request_delete-1675"><span class="linenos">1675</span></a>                <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)))</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1676"><a href="#PumpWoodMicroService.paralell_request_delete-1676"><span class="linenos">1676</span></a>            <span class="k">raise</span> <span class="n">PumpWoodNotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1677"><a href="#PumpWoodMicroService.paralell_request_delete-1677"><span class="linenos">1677</span></a>
</span><span id="PumpWoodMicroService.paralell_request_delete-1678"><a href="#PumpWoodMicroService.paralell_request_delete-1678"><span class="linenos">1678</span></a>        <span class="c1"># Create Pool arguments to run in parallel</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1679"><a href="#PumpWoodMicroService.paralell_request_delete-1679"><span class="linenos">1679</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1680"><a href="#PumpWoodMicroService.paralell_request_delete-1680"><span class="linenos">1680</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">)):</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1681"><a href="#PumpWoodMicroService.paralell_request_delete-1681"><span class="linenos">1681</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1682"><a href="#PumpWoodMicroService.paralell_request_delete-1682"><span class="linenos">1682</span></a>                <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="n">urls_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;auth_header&#39;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1683"><a href="#PumpWoodMicroService.paralell_request_delete-1683"><span class="linenos">1683</span></a>                <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="n">parameters_list</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1684"><a href="#PumpWoodMicroService.paralell_request_delete-1684"><span class="linenos">1684</span></a>
</span><span id="PumpWoodMicroService.paralell_request_delete-1685"><a href="#PumpWoodMicroService.paralell_request_delete-1685"><span class="linenos">1685</span></a>        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1686"><a href="#PumpWoodMicroService.paralell_request_delete-1686"><span class="linenos">1686</span></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_request_delete_wrapper</span><span class="p">,</span> <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1687"><a href="#PumpWoodMicroService.paralell_request_delete-1687"><span class="linenos">1687</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.paralell_request_delete-1688"><a href="#PumpWoodMicroService.paralell_request_delete-1688"><span class="linenos">1688</span></a>        <span class="k">return</span> <span class="n">results</span>
</span></pre></div>


            <div class="docstring"><p>Make [n_parallel] parallel delete request.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>urls_list:</strong>  List of urls to make get requests.</li>
<li><strong>parameters:</strong>  URL paramenters to make the post requests.</li>
<li><strong>n_parallel (int):</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: List of the get request reponses.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No particular raises.</li>
</ul>

<h6 id="example">Example:</h6>

<blockquote>
  <p>No example yet.</p>
</blockquote>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_retrieve" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_retrieve-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_retrieve</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">related_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">fields</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n"><a href="#PumpWoodMicroService.list">PumpWoodMicroService.list</a></span><span class="o">&gt;</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_retrieve-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_retrieve"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_retrieve-1692"><a href="#PumpWoodMicroService.parallel_retrieve-1692"><span class="linenos">1692</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_retrieve</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1693"><a href="#PumpWoodMicroService.parallel_retrieve-1693"><span class="linenos">1693</span></a>                          <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1694"><a href="#PumpWoodMicroService.parallel_retrieve-1694"><span class="linenos">1694</span></a>                          <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1695"><a href="#PumpWoodMicroService.parallel_retrieve-1695"><span class="linenos">1695</span></a>                          <span class="n">related_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1696"><a href="#PumpWoodMicroService.parallel_retrieve-1696"><span class="linenos">1696</span></a>                          <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1697"><a href="#PumpWoodMicroService.parallel_retrieve-1697"><span class="linenos">1697</span></a>                          <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1698"><a href="#PumpWoodMicroService.parallel_retrieve-1698"><span class="linenos">1698</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel retrieve request.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1699"><a href="#PumpWoodMicroService.parallel_retrieve-1699"><span class="linenos">1699</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve-1700"><a href="#PumpWoodMicroService.parallel_retrieve-1700"><span class="linenos">1700</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1701"><a href="#PumpWoodMicroService.parallel_retrieve-1701"><span class="linenos">1701</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1702"><a href="#PumpWoodMicroService.parallel_retrieve-1702"><span class="linenos">1702</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1703"><a href="#PumpWoodMicroService.parallel_retrieve-1703"><span class="linenos">1703</span></a><span class="sd">            list_pk:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1704"><a href="#PumpWoodMicroService.parallel_retrieve-1704"><span class="linenos">1704</span></a><span class="sd">                List of the pks to retrieve.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1705"><a href="#PumpWoodMicroService.parallel_retrieve-1705"><span class="linenos">1705</span></a><span class="sd">            fields:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1706"><a href="#PumpWoodMicroService.parallel_retrieve-1706"><span class="linenos">1706</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1707"><a href="#PumpWoodMicroService.parallel_retrieve-1707"><span class="linenos">1707</span></a><span class="sd">            default_fields:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1708"><a href="#PumpWoodMicroService.parallel_retrieve-1708"><span class="linenos">1708</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1709"><a href="#PumpWoodMicroService.parallel_retrieve-1709"><span class="linenos">1709</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1710"><a href="#PumpWoodMicroService.parallel_retrieve-1710"><span class="linenos">1710</span></a><span class="sd">            foreign_key_fields:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1711"><a href="#PumpWoodMicroService.parallel_retrieve-1711"><span class="linenos">1711</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1712"><a href="#PumpWoodMicroService.parallel_retrieve-1712"><span class="linenos">1712</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1713"><a href="#PumpWoodMicroService.parallel_retrieve-1713"><span class="linenos">1713</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1714"><a href="#PumpWoodMicroService.parallel_retrieve-1714"><span class="linenos">1714</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1715"><a href="#PumpWoodMicroService.parallel_retrieve-1715"><span class="linenos">1715</span></a><span class="sd">            related_fields:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1716"><a href="#PumpWoodMicroService.parallel_retrieve-1716"><span class="linenos">1716</span></a><span class="sd">                Return related fields objects. Related field objects are</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1717"><a href="#PumpWoodMicroService.parallel_retrieve-1717"><span class="linenos">1717</span></a><span class="sd">                objects that have a forenging key associated with this</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1718"><a href="#PumpWoodMicroService.parallel_retrieve-1718"><span class="linenos">1718</span></a><span class="sd">                model_class, results will be returned as a list of</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1719"><a href="#PumpWoodMicroService.parallel_retrieve-1719"><span class="linenos">1719</span></a><span class="sd">                dictionaries usually in a field with `_set` at end.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1720"><a href="#PumpWoodMicroService.parallel_retrieve-1720"><span class="linenos">1720</span></a><span class="sd">                Returning related_fields consume backend resorces, use</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1721"><a href="#PumpWoodMicroService.parallel_retrieve-1721"><span class="linenos">1721</span></a><span class="sd">                carefully.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1722"><a href="#PumpWoodMicroService.parallel_retrieve-1722"><span class="linenos">1722</span></a><span class="sd">            n_parallel (int): Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1723"><a href="#PumpWoodMicroService.parallel_retrieve-1723"><span class="linenos">1723</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1724"><a href="#PumpWoodMicroService.parallel_retrieve-1724"><span class="linenos">1724</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1725"><a href="#PumpWoodMicroService.parallel_retrieve-1725"><span class="linenos">1725</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1726"><a href="#PumpWoodMicroService.parallel_retrieve-1726"><span class="linenos">1726</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1727"><a href="#PumpWoodMicroService.parallel_retrieve-1727"><span class="linenos">1727</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1728"><a href="#PumpWoodMicroService.parallel_retrieve-1728"><span class="linenos">1728</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve-1729"><a href="#PumpWoodMicroService.parallel_retrieve-1729"><span class="linenos">1729</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1730"><a href="#PumpWoodMicroService.parallel_retrieve-1730"><span class="linenos">1730</span></a><span class="sd">            List of the retrieve request data.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1731"><a href="#PumpWoodMicroService.parallel_retrieve-1731"><span class="linenos">1731</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve-1732"><a href="#PumpWoodMicroService.parallel_retrieve-1732"><span class="linenos">1732</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1733"><a href="#PumpWoodMicroService.parallel_retrieve-1733"><span class="linenos">1733</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1734"><a href="#PumpWoodMicroService.parallel_retrieve-1734"><span class="linenos">1734</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_pk)[{}]&#39;. Indicates that</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1735"><a href="#PumpWoodMicroService.parallel_retrieve-1735"><span class="linenos">1735</span></a><span class="sd">                the lenght of the arguments model_class and list_pk are</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1736"><a href="#PumpWoodMicroService.parallel_retrieve-1736"><span class="linenos">1736</span></a><span class="sd">                incompatible.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1737"><a href="#PumpWoodMicroService.parallel_retrieve-1737"><span class="linenos">1737</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1738"><a href="#PumpWoodMicroService.parallel_retrieve-1738"><span class="linenos">1738</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1739"><a href="#PumpWoodMicroService.parallel_retrieve-1739"><span class="linenos">1739</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1740"><a href="#PumpWoodMicroService.parallel_retrieve-1740"><span class="linenos">1740</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1741"><a href="#PumpWoodMicroService.parallel_retrieve-1741"><span class="linenos">1741</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve-1742"><a href="#PumpWoodMicroService.parallel_retrieve-1742"><span class="linenos">1742</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1743"><a href="#PumpWoodMicroService.parallel_retrieve-1743"><span class="linenos">1743</span></a>            <span class="n">model_class</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1744"><a href="#PumpWoodMicroService.parallel_retrieve-1744"><span class="linenos">1744</span></a>        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1745"><a href="#PumpWoodMicroService.parallel_retrieve-1745"><span class="linenos">1745</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1746"><a href="#PumpWoodMicroService.parallel_retrieve-1746"><span class="linenos">1746</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1747"><a href="#PumpWoodMicroService.parallel_retrieve-1747"><span class="linenos">1747</span></a>                    <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_pk)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1748"><a href="#PumpWoodMicroService.parallel_retrieve-1748"><span class="linenos">1748</span></a>                        <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1749"><a href="#PumpWoodMicroService.parallel_retrieve-1749"><span class="linenos">1749</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1750"><a href="#PumpWoodMicroService.parallel_retrieve-1750"><span class="linenos">1750</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve-1751"><a href="#PumpWoodMicroService.parallel_retrieve-1751"><span class="linenos">1751</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1752"><a href="#PumpWoodMicroService.parallel_retrieve-1752"><span class="linenos">1752</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_retrieve_url</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1753"><a href="#PumpWoodMicroService.parallel_retrieve-1753"><span class="linenos">1753</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pk</span><span class="o">=</span><span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1754"><a href="#PumpWoodMicroService.parallel_retrieve-1754"><span class="linenos">1754</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">))]</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1755"><a href="#PumpWoodMicroService.parallel_retrieve-1755"><span class="linenos">1755</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve-1756"><a href="#PumpWoodMicroService.parallel_retrieve-1756"><span class="linenos">1756</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1757"><a href="#PumpWoodMicroService.parallel_retrieve-1757"><span class="linenos">1757</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1758"><a href="#PumpWoodMicroService.parallel_retrieve-1758"><span class="linenos">1758</span></a>            <span class="n">parameters</span><span class="o">=</span><span class="p">{</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1759"><a href="#PumpWoodMicroService.parallel_retrieve-1759"><span class="linenos">1759</span></a>                <span class="s2">&quot;fields&quot;</span><span class="p">:</span> <span class="n">fields</span><span class="p">,</span> <span class="s2">&quot;default_fields&quot;</span><span class="p">:</span> <span class="n">default_fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1760"><a href="#PumpWoodMicroService.parallel_retrieve-1760"><span class="linenos">1760</span></a>                <span class="s2">&quot;foreign_key_fields&quot;</span><span class="p">:</span> <span class="n">foreign_key_fields</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1761"><a href="#PumpWoodMicroService.parallel_retrieve-1761"><span class="linenos">1761</span></a>                <span class="s2">&quot;related_fields&quot;</span><span class="p">:</span> <span class="n">related_fields</span><span class="p">},</span>
</span><span id="PumpWoodMicroService.parallel_retrieve-1762"><a href="#PumpWoodMicroService.parallel_retrieve-1762"><span class="linenos">1762</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Make [n_parallel] parallel retrieve request.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model Class to retrieve.</li>
<li><strong>list_pk:</strong>  List of the pks to retrieve.</li>
<li><strong>fields:</strong>  Set the fields to be returned by the list end-point.</li>
<li><strong>default_fields:</strong>  Boolean, if true and fields arguments None will return the
default fields set for list by the backend.</li>
<li><strong>foreign_key_fields:</strong>  Return forenging key objects. It will return the fk
corresponding object. Ex: <code>created_by_id</code> reference to
a user <code>model_class</code> the correspondent to User will be
returned at <code>created_by</code>.</li>
<li><strong>related_fields:</strong>  Return related fields objects. Related field objects are
objects that have a forenging key associated with this
model_class, results will be returned as a list of
dictionaries usually in a field with <code>_set</code> at end.
Returning related_fields consume backend resorces, use
carefully.</li>
<li><strong>n_parallel (int):</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of the retrieve request data.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'len(model_class)[{}] != len(list_pk)[{}]'. Indicates that
the lenght of the arguments model_class and list_pk are
incompatible.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_retrieve_file" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_retrieve_file-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_retrieve_file</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">file_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span>,</span><span class="param">	<span class="n">save_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>,</span><span class="param">	<span class="n">list_file_name</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">if_exists</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_retrieve_file-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_retrieve_file"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_retrieve_file-1772"><a href="#PumpWoodMicroService.parallel_retrieve_file-1772"><span class="linenos">1772</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_retrieve_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1773"><a href="#PumpWoodMicroService.parallel_retrieve_file-1773"><span class="linenos">1773</span></a>                               <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">file_field</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1774"><a href="#PumpWoodMicroService.parallel_retrieve_file-1774"><span class="linenos">1774</span></a>                               <span class="n">save_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span><span class="p">,</span> <span class="n">save_file</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1775"><a href="#PumpWoodMicroService.parallel_retrieve_file-1775"><span class="linenos">1775</span></a>                               <span class="n">list_file_name</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1776"><a href="#PumpWoodMicroService.parallel_retrieve_file-1776"><span class="linenos">1776</span></a>                               <span class="n">if_exists</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fail&quot;</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1777"><a href="#PumpWoodMicroService.parallel_retrieve_file-1777"><span class="linenos">1777</span></a>                               <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1778"><a href="#PumpWoodMicroService.parallel_retrieve_file-1778"><span class="linenos">1778</span></a>                               <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1779"><a href="#PumpWoodMicroService.parallel_retrieve_file-1779"><span class="linenos">1779</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make many [n_parallel] retrieve request.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1780"><a href="#PumpWoodMicroService.parallel_retrieve_file-1780"><span class="linenos">1780</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1781"><a href="#PumpWoodMicroService.parallel_retrieve_file-1781"><span class="linenos">1781</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1782"><a href="#PumpWoodMicroService.parallel_retrieve_file-1782"><span class="linenos">1782</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1783"><a href="#PumpWoodMicroService.parallel_retrieve_file-1783"><span class="linenos">1783</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1784"><a href="#PumpWoodMicroService.parallel_retrieve_file-1784"><span class="linenos">1784</span></a><span class="sd">            list_pk:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1785"><a href="#PumpWoodMicroService.parallel_retrieve_file-1785"><span class="linenos">1785</span></a><span class="sd">                List of the pks to retrieve.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1786"><a href="#PumpWoodMicroService.parallel_retrieve_file-1786"><span class="linenos">1786</span></a><span class="sd">            file_field:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1787"><a href="#PumpWoodMicroService.parallel_retrieve_file-1787"><span class="linenos">1787</span></a><span class="sd">                Indicates the file field to download from.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1788"><a href="#PumpWoodMicroService.parallel_retrieve_file-1788"><span class="linenos">1788</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1789"><a href="#PumpWoodMicroService.parallel_retrieve_file-1789"><span class="linenos">1789</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1790"><a href="#PumpWoodMicroService.parallel_retrieve_file-1790"><span class="linenos">1790</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1791"><a href="#PumpWoodMicroService.parallel_retrieve_file-1791"><span class="linenos">1791</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1792"><a href="#PumpWoodMicroService.parallel_retrieve_file-1792"><span class="linenos">1792</span></a><span class="sd">            save_path:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1793"><a href="#PumpWoodMicroService.parallel_retrieve_file-1793"><span class="linenos">1793</span></a><span class="sd">                Path to be used to save files.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1794"><a href="#PumpWoodMicroService.parallel_retrieve_file-1794"><span class="linenos">1794</span></a><span class="sd">            save_file:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1795"><a href="#PumpWoodMicroService.parallel_retrieve_file-1795"><span class="linenos">1795</span></a><span class="sd">                True save file locally, False return file content as bites.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1796"><a href="#PumpWoodMicroService.parallel_retrieve_file-1796"><span class="linenos">1796</span></a><span class="sd">            list_file_name:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1797"><a href="#PumpWoodMicroService.parallel_retrieve_file-1797"><span class="linenos">1797</span></a><span class="sd">                Set a file name for each file download.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1798"><a href="#PumpWoodMicroService.parallel_retrieve_file-1798"><span class="linenos">1798</span></a><span class="sd">            if_exists:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1799"><a href="#PumpWoodMicroService.parallel_retrieve_file-1799"><span class="linenos">1799</span></a><span class="sd">                Set how treat when a file will be saved</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1800"><a href="#PumpWoodMicroService.parallel_retrieve_file-1800"><span class="linenos">1800</span></a><span class="sd">                and there is another at same path. &quot;fail&quot; will raise an error;</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1801"><a href="#PumpWoodMicroService.parallel_retrieve_file-1801"><span class="linenos">1801</span></a><span class="sd">                &quot;overwrite&quot; will overwrite the file with the new one; &quot;skip&quot;</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1802"><a href="#PumpWoodMicroService.parallel_retrieve_file-1802"><span class="linenos">1802</span></a><span class="sd">                when list_file_name is set, check before downloaded it file</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1803"><a href="#PumpWoodMicroService.parallel_retrieve_file-1803"><span class="linenos">1803</span></a><span class="sd">                already exists, if so skip the download.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1804"><a href="#PumpWoodMicroService.parallel_retrieve_file-1804"><span class="linenos">1804</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1805"><a href="#PumpWoodMicroService.parallel_retrieve_file-1805"><span class="linenos">1805</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1806"><a href="#PumpWoodMicroService.parallel_retrieve_file-1806"><span class="linenos">1806</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1807"><a href="#PumpWoodMicroService.parallel_retrieve_file-1807"><span class="linenos">1807</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1808"><a href="#PumpWoodMicroService.parallel_retrieve_file-1808"><span class="linenos">1808</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1809"><a href="#PumpWoodMicroService.parallel_retrieve_file-1809"><span class="linenos">1809</span></a><span class="sd">            List of the retrieve file request data.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1810"><a href="#PumpWoodMicroService.parallel_retrieve_file-1810"><span class="linenos">1810</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1811"><a href="#PumpWoodMicroService.parallel_retrieve_file-1811"><span class="linenos">1811</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1812"><a href="#PumpWoodMicroService.parallel_retrieve_file-1812"><span class="linenos">1812</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1813"><a href="#PumpWoodMicroService.parallel_retrieve_file-1813"><span class="linenos">1813</span></a><span class="sd">                &#39;Lenght of list_file_name and list_pk are not equal:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1814"><a href="#PumpWoodMicroService.parallel_retrieve_file-1814"><span class="linenos">1814</span></a><span class="sd">                len(list_file_name)={list_file_name}; len(list_pk)={list_pk}&#39;.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1815"><a href="#PumpWoodMicroService.parallel_retrieve_file-1815"><span class="linenos">1815</span></a><span class="sd">                Indicates that len(list_file_name) and len(list_pk) function</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1816"><a href="#PumpWoodMicroService.parallel_retrieve_file-1816"><span class="linenos">1816</span></a><span class="sd">                arguments are not equal.</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1817"><a href="#PumpWoodMicroService.parallel_retrieve_file-1817"><span class="linenos">1817</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1818"><a href="#PumpWoodMicroService.parallel_retrieve_file-1818"><span class="linenos">1818</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1819"><a href="#PumpWoodMicroService.parallel_retrieve_file-1819"><span class="linenos">1819</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1820"><a href="#PumpWoodMicroService.parallel_retrieve_file-1820"><span class="linenos">1820</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1821"><a href="#PumpWoodMicroService.parallel_retrieve_file-1821"><span class="linenos">1821</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1822"><a href="#PumpWoodMicroService.parallel_retrieve_file-1822"><span class="linenos">1822</span></a>        <span class="k">if</span> <span class="n">list_file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1823"><a href="#PumpWoodMicroService.parallel_retrieve_file-1823"><span class="linenos">1823</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_file_name</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1824"><a href="#PumpWoodMicroService.parallel_retrieve_file-1824"><span class="linenos">1824</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">((</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1825"><a href="#PumpWoodMicroService.parallel_retrieve_file-1825"><span class="linenos">1825</span></a>                    <span class="s2">&quot;Lenght of list_file_name and list_pk are not equal:</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1826"><a href="#PumpWoodMicroService.parallel_retrieve_file-1826"><span class="linenos">1826</span></a>                    <span class="s2">&quot;len(list_file_name)=</span><span class="si">{list_file_name}</span><span class="s2">; &quot;</span> <span class="o">+</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1827"><a href="#PumpWoodMicroService.parallel_retrieve_file-1827"><span class="linenos">1827</span></a>                    <span class="s2">&quot;len(list_pk)=</span><span class="si">{list_pk}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1828"><a href="#PumpWoodMicroService.parallel_retrieve_file-1828"><span class="linenos">1828</span></a>                        <span class="n">list_file_name</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">list_file_name</span><span class="p">),</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1829"><a href="#PumpWoodMicroService.parallel_retrieve_file-1829"><span class="linenos">1829</span></a>                        <span class="n">list_pk</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)))</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1830"><a href="#PumpWoodMicroService.parallel_retrieve_file-1830"><span class="linenos">1830</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1831"><a href="#PumpWoodMicroService.parallel_retrieve_file-1831"><span class="linenos">1831</span></a>        <span class="n">pool_arguments</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1832"><a href="#PumpWoodMicroService.parallel_retrieve_file-1832"><span class="linenos">1832</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)):</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1833"><a href="#PumpWoodMicroService.parallel_retrieve_file-1833"><span class="linenos">1833</span></a>            <span class="n">pk</span> <span class="o">=</span> <span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1834"><a href="#PumpWoodMicroService.parallel_retrieve_file-1834"><span class="linenos">1834</span></a>            <span class="n">file_name</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1835"><a href="#PumpWoodMicroService.parallel_retrieve_file-1835"><span class="linenos">1835</span></a>            <span class="k">if</span> <span class="n">list_file_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1836"><a href="#PumpWoodMicroService.parallel_retrieve_file-1836"><span class="linenos">1836</span></a>                <span class="n">file_name</span> <span class="o">=</span> <span class="n">list_file_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1837"><a href="#PumpWoodMicroService.parallel_retrieve_file-1837"><span class="linenos">1837</span></a>            <span class="n">pool_arguments</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1838"><a href="#PumpWoodMicroService.parallel_retrieve_file-1838"><span class="linenos">1838</span></a>                <span class="s2">&quot;model_class&quot;</span><span class="p">:</span> <span class="n">model_class</span><span class="p">,</span> <span class="s2">&quot;pk&quot;</span><span class="p">:</span> <span class="n">pk</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1839"><a href="#PumpWoodMicroService.parallel_retrieve_file-1839"><span class="linenos">1839</span></a>                <span class="s2">&quot;file_field&quot;</span><span class="p">:</span> <span class="n">file_field</span><span class="p">,</span> <span class="s2">&quot;auth_header&quot;</span><span class="p">:</span> <span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1840"><a href="#PumpWoodMicroService.parallel_retrieve_file-1840"><span class="linenos">1840</span></a>                <span class="s2">&quot;save_file&quot;</span><span class="p">:</span> <span class="n">save_file</span><span class="p">,</span> <span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="n">file_name</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1841"><a href="#PumpWoodMicroService.parallel_retrieve_file-1841"><span class="linenos">1841</span></a>                <span class="s2">&quot;save_path&quot;</span><span class="p">:</span> <span class="n">save_path</span><span class="p">,</span> <span class="s2">&quot;if_exists&quot;</span><span class="p">:</span> <span class="n">if_exists</span><span class="p">})</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1842"><a href="#PumpWoodMicroService.parallel_retrieve_file-1842"><span class="linenos">1842</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1843"><a href="#PumpWoodMicroService.parallel_retrieve_file-1843"><span class="linenos">1843</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1844"><a href="#PumpWoodMicroService.parallel_retrieve_file-1844"><span class="linenos">1844</span></a>            <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">n_parallel</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1845"><a href="#PumpWoodMicroService.parallel_retrieve_file-1845"><span class="linenos">1845</span></a>                <span class="n">results</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1846"><a href="#PumpWoodMicroService.parallel_retrieve_file-1846"><span class="linenos">1846</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">_request_retrieve_file_wrapper</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1847"><a href="#PumpWoodMicroService.parallel_retrieve_file-1847"><span class="linenos">1847</span></a>                    <span class="n">pool_arguments</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1848"><a href="#PumpWoodMicroService.parallel_retrieve_file-1848"><span class="linenos">1848</span></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1849"><a href="#PumpWoodMicroService.parallel_retrieve_file-1849"><span class="linenos">1849</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1850"><a href="#PumpWoodMicroService.parallel_retrieve_file-1850"><span class="linenos">1850</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1851"><a href="#PumpWoodMicroService.parallel_retrieve_file-1851"><span class="linenos">1851</span></a>
</span><span id="PumpWoodMicroService.parallel_retrieve_file-1852"><a href="#PumpWoodMicroService.parallel_retrieve_file-1852"><span class="linenos">1852</span></a>        <span class="k">return</span> <span class="n">results</span>
</span></pre></div>


            <div class="docstring"><p>Make many [n_parallel] retrieve request.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model Class to retrieve.</li>
<li><strong>list_pk:</strong>  List of the pks to retrieve.</li>
<li><strong>file_field:</strong>  Indicates the file field to download from.</li>
<li><strong>n_parallel:</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>save_path:</strong>  Path to be used to save files.</li>
<li><strong>save_file:</strong>  True save file locally, False return file content as bites.</li>
<li><strong>list_file_name:</strong>  Set a file name for each file download.</li>
<li><strong>if_exists:</strong>  Set how treat when a file will be saved
and there is another at same path. "fail" will raise an error;
"overwrite" will overwrite the file with the new one; "skip"
when list_file_name is set, check before downloaded it file
already exists, if so skip the download.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of the retrieve file request data.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'Lenght of list_file_name and list_pk are not equal:
len(list_file_name)={list_file_name}; len(list_pk)={list_pk}'.
Indicates that len(list_file_name) and len(list_pk) function
arguments are not equal.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_list" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_list-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_list</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">fields</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n"><a href="#PumpWoodMicroService.list">PumpWoodMicroService.list</a></span><span class="o">&gt;</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_list-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_list"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_list-1854"><a href="#PumpWoodMicroService.parallel_list-1854"><span class="linenos">1854</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService.parallel_list-1855"><a href="#PumpWoodMicroService.parallel_list-1855"><span class="linenos">1855</span></a>                      <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_list-1856"><a href="#PumpWoodMicroService.parallel_list-1856"><span class="linenos">1856</span></a>                      <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fields</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_list-1857"><a href="#PumpWoodMicroService.parallel_list-1857"><span class="linenos">1857</span></a>                      <span class="n">default_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_list-1858"><a href="#PumpWoodMicroService.parallel_list-1858"><span class="linenos">1858</span></a>                      <span class="n">foreign_key_fields</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.parallel_list-1859"><a href="#PumpWoodMicroService.parallel_list-1859"><span class="linenos">1859</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel list request.</span>
</span><span id="PumpWoodMicroService.parallel_list-1860"><a href="#PumpWoodMicroService.parallel_list-1860"><span class="linenos">1860</span></a>
</span><span id="PumpWoodMicroService.parallel_list-1861"><a href="#PumpWoodMicroService.parallel_list-1861"><span class="linenos">1861</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_list-1862"><a href="#PumpWoodMicroService.parallel_list-1862"><span class="linenos">1862</span></a><span class="sd">            model_class (str):</span>
</span><span id="PumpWoodMicroService.parallel_list-1863"><a href="#PumpWoodMicroService.parallel_list-1863"><span class="linenos">1863</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="PumpWoodMicroService.parallel_list-1864"><a href="#PumpWoodMicroService.parallel_list-1864"><span class="linenos">1864</span></a><span class="sd">            list_args (List[dict]):</span>
</span><span id="PumpWoodMicroService.parallel_list-1865"><a href="#PumpWoodMicroService.parallel_list-1865"><span class="linenos">1865</span></a><span class="sd">                A list of list request args (filter_dict,</span>
</span><span id="PumpWoodMicroService.parallel_list-1866"><a href="#PumpWoodMicroService.parallel_list-1866"><span class="linenos">1866</span></a><span class="sd">                exclude_dict, order_by, fields, default_fields, limit,</span>
</span><span id="PumpWoodMicroService.parallel_list-1867"><a href="#PumpWoodMicroService.parallel_list-1867"><span class="linenos">1867</span></a><span class="sd">                foreign_key_fields).</span>
</span><span id="PumpWoodMicroService.parallel_list-1868"><a href="#PumpWoodMicroService.parallel_list-1868"><span class="linenos">1868</span></a><span class="sd">            n_parallel (int): Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_list-1869"><a href="#PumpWoodMicroService.parallel_list-1869"><span class="linenos">1869</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_list-1870"><a href="#PumpWoodMicroService.parallel_list-1870"><span class="linenos">1870</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_list-1871"><a href="#PumpWoodMicroService.parallel_list-1871"><span class="linenos">1871</span></a><span class="sd">            auth_header (dict):</span>
</span><span id="PumpWoodMicroService.parallel_list-1872"><a href="#PumpWoodMicroService.parallel_list-1872"><span class="linenos">1872</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_list-1873"><a href="#PumpWoodMicroService.parallel_list-1873"><span class="linenos">1873</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_list-1874"><a href="#PumpWoodMicroService.parallel_list-1874"><span class="linenos">1874</span></a><span class="sd">            fields (List[str]):</span>
</span><span id="PumpWoodMicroService.parallel_list-1875"><a href="#PumpWoodMicroService.parallel_list-1875"><span class="linenos">1875</span></a><span class="sd">                Set the fields to be returned by the list end-point.</span>
</span><span id="PumpWoodMicroService.parallel_list-1876"><a href="#PumpWoodMicroService.parallel_list-1876"><span class="linenos">1876</span></a><span class="sd">            default_fields (bool):</span>
</span><span id="PumpWoodMicroService.parallel_list-1877"><a href="#PumpWoodMicroService.parallel_list-1877"><span class="linenos">1877</span></a><span class="sd">                Boolean, if true and fields arguments None will return the</span>
</span><span id="PumpWoodMicroService.parallel_list-1878"><a href="#PumpWoodMicroService.parallel_list-1878"><span class="linenos">1878</span></a><span class="sd">                default fields set for list by the backend.</span>
</span><span id="PumpWoodMicroService.parallel_list-1879"><a href="#PumpWoodMicroService.parallel_list-1879"><span class="linenos">1879</span></a><span class="sd">            limit (int):</span>
</span><span id="PumpWoodMicroService.parallel_list-1880"><a href="#PumpWoodMicroService.parallel_list-1880"><span class="linenos">1880</span></a><span class="sd">                Set the limit of elements of the returned query. By default,</span>
</span><span id="PumpWoodMicroService.parallel_list-1881"><a href="#PumpWoodMicroService.parallel_list-1881"><span class="linenos">1881</span></a><span class="sd">                backend usually return 50 elements.</span>
</span><span id="PumpWoodMicroService.parallel_list-1882"><a href="#PumpWoodMicroService.parallel_list-1882"><span class="linenos">1882</span></a><span class="sd">            foreign_key_fields (bool):</span>
</span><span id="PumpWoodMicroService.parallel_list-1883"><a href="#PumpWoodMicroService.parallel_list-1883"><span class="linenos">1883</span></a><span class="sd">                Return forenging key objects. It will return the fk</span>
</span><span id="PumpWoodMicroService.parallel_list-1884"><a href="#PumpWoodMicroService.parallel_list-1884"><span class="linenos">1884</span></a><span class="sd">                corresponding object. Ex: `created_by_id` reference to</span>
</span><span id="PumpWoodMicroService.parallel_list-1885"><a href="#PumpWoodMicroService.parallel_list-1885"><span class="linenos">1885</span></a><span class="sd">                a user `model_class` the correspondent to User will be</span>
</span><span id="PumpWoodMicroService.parallel_list-1886"><a href="#PumpWoodMicroService.parallel_list-1886"><span class="linenos">1886</span></a><span class="sd">                returned at `created_by`.</span>
</span><span id="PumpWoodMicroService.parallel_list-1887"><a href="#PumpWoodMicroService.parallel_list-1887"><span class="linenos">1887</span></a>
</span><span id="PumpWoodMicroService.parallel_list-1888"><a href="#PumpWoodMicroService.parallel_list-1888"><span class="linenos">1888</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_list-1889"><a href="#PumpWoodMicroService.parallel_list-1889"><span class="linenos">1889</span></a><span class="sd">            Flatten List of the list request reponses.</span>
</span><span id="PumpWoodMicroService.parallel_list-1890"><a href="#PumpWoodMicroService.parallel_list-1890"><span class="linenos">1890</span></a>
</span><span id="PumpWoodMicroService.parallel_list-1891"><a href="#PumpWoodMicroService.parallel_list-1891"><span class="linenos">1891</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.parallel_list-1892"><a href="#PumpWoodMicroService.parallel_list-1892"><span class="linenos">1892</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.parallel_list-1893"><a href="#PumpWoodMicroService.parallel_list-1893"><span class="linenos">1893</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates that</span>
</span><span id="PumpWoodMicroService.parallel_list-1894"><a href="#PumpWoodMicroService.parallel_list-1894"><span class="linenos">1894</span></a><span class="sd">                lenght of model_class and list_args arguments are not equal.</span>
</span><span id="PumpWoodMicroService.parallel_list-1895"><a href="#PumpWoodMicroService.parallel_list-1895"><span class="linenos">1895</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_list-1896"><a href="#PumpWoodMicroService.parallel_list-1896"><span class="linenos">1896</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_list-1897"><a href="#PumpWoodMicroService.parallel_list-1897"><span class="linenos">1897</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_list-1898"><a href="#PumpWoodMicroService.parallel_list-1898"><span class="linenos">1898</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_list-1899"><a href="#PumpWoodMicroService.parallel_list-1899"><span class="linenos">1899</span></a>
</span><span id="PumpWoodMicroService.parallel_list-1900"><a href="#PumpWoodMicroService.parallel_list-1900"><span class="linenos">1900</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.parallel_list-1901"><a href="#PumpWoodMicroService.parallel_list-1901"><span class="linenos">1901</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_list-1902"><a href="#PumpWoodMicroService.parallel_list-1902"><span class="linenos">1902</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_list_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_list-1903"><a href="#PumpWoodMicroService.parallel_list-1903"><span class="linenos">1903</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_list-1904"><a href="#PumpWoodMicroService.parallel_list-1904"><span class="linenos">1904</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_list-1905"><a href="#PumpWoodMicroService.parallel_list-1905"><span class="linenos">1905</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_list-1906"><a href="#PumpWoodMicroService.parallel_list-1906"><span class="linenos">1906</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_list-1907"><a href="#PumpWoodMicroService.parallel_list-1907"><span class="linenos">1907</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_list-1908"><a href="#PumpWoodMicroService.parallel_list-1908"><span class="linenos">1908</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_list_url</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model_class</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.parallel_list-1909"><a href="#PumpWoodMicroService.parallel_list-1909"><span class="linenos">1909</span></a>
</span><span id="PumpWoodMicroService.parallel_list-1910"><a href="#PumpWoodMicroService.parallel_list-1910"><span class="linenos">1910</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_list: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_list-1911"><a href="#PumpWoodMicroService.parallel_list-1911"><span class="linenos">1911</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_list-1912"><a href="#PumpWoodMicroService.parallel_list-1912"><span class="linenos">1912</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_list-1913"><a href="#PumpWoodMicroService.parallel_list-1913"><span class="linenos">1913</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Make [n_parallel] parallel list request.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class (str):</strong>  Model Class to retrieve.</li>
<li><strong>list_args (List[dict]):</strong>  A list of list request args (filter_dict,
exclude_dict, order_by, fields, default_fields, limit,
foreign_key_fields).</li>
<li><strong>n_parallel (int):</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header (dict):</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
<li><strong>fields (List[str]):</strong>  Set the fields to be returned by the list end-point.</li>
<li><strong>default_fields (bool):</strong>  Boolean, if true and fields arguments None will return the
default fields set for list by the backend.</li>
<li><strong>limit (int):</strong>  Set the limit of elements of the returned query. By default,
backend usually return 50 elements.</li>
<li><strong>foreign_key_fields (bool):</strong>  Return forenging key objects. It will return the fk
corresponding object. Ex: <code>created_by_id</code> reference to
a user <code>model_class</code> the correspondent to User will be
returned at <code>created_by</code>.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Flatten List of the list request reponses.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'len(model_class)[{}] != len(list_args)[{}]'. Indicates that
lenght of model_class and list_args arguments are not equal.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_list_without_pag" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_list_without_pag-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_list_without_pag</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_list_without_pag-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_list_without_pag"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_list_without_pag-1915"><a href="#PumpWoodMicroService.parallel_list_without_pag-1915"><span class="linenos">1915</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_list_without_pag</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1916"><a href="#PumpWoodMicroService.parallel_list_without_pag-1916"><span class="linenos">1916</span></a>                                  <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1917"><a href="#PumpWoodMicroService.parallel_list_without_pag-1917"><span class="linenos">1917</span></a>                                  <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1918"><a href="#PumpWoodMicroService.parallel_list_without_pag-1918"><span class="linenos">1918</span></a>                                  <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1919"><a href="#PumpWoodMicroService.parallel_list_without_pag-1919"><span class="linenos">1919</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel list_without_pag request.</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1920"><a href="#PumpWoodMicroService.parallel_list_without_pag-1920"><span class="linenos">1920</span></a>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1921"><a href="#PumpWoodMicroService.parallel_list_without_pag-1921"><span class="linenos">1921</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1922"><a href="#PumpWoodMicroService.parallel_list_without_pag-1922"><span class="linenos">1922</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1923"><a href="#PumpWoodMicroService.parallel_list_without_pag-1923"><span class="linenos">1923</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1924"><a href="#PumpWoodMicroService.parallel_list_without_pag-1924"><span class="linenos">1924</span></a><span class="sd">            list_args:</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1925"><a href="#PumpWoodMicroService.parallel_list_without_pag-1925"><span class="linenos">1925</span></a><span class="sd">                A list of list request args (filter_dict,</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1926"><a href="#PumpWoodMicroService.parallel_list_without_pag-1926"><span class="linenos">1926</span></a><span class="sd">                exclude_dict, order_by, fields, default_fields, limit,</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1927"><a href="#PumpWoodMicroService.parallel_list_without_pag-1927"><span class="linenos">1927</span></a><span class="sd">                foreign_key_fields).</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1928"><a href="#PumpWoodMicroService.parallel_list_without_pag-1928"><span class="linenos">1928</span></a><span class="sd">            n_parallel (int):</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1929"><a href="#PumpWoodMicroService.parallel_list_without_pag-1929"><span class="linenos">1929</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1930"><a href="#PumpWoodMicroService.parallel_list_without_pag-1930"><span class="linenos">1930</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1931"><a href="#PumpWoodMicroService.parallel_list_without_pag-1931"><span class="linenos">1931</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1932"><a href="#PumpWoodMicroService.parallel_list_without_pag-1932"><span class="linenos">1932</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1933"><a href="#PumpWoodMicroService.parallel_list_without_pag-1933"><span class="linenos">1933</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1934"><a href="#PumpWoodMicroService.parallel_list_without_pag-1934"><span class="linenos">1934</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1935"><a href="#PumpWoodMicroService.parallel_list_without_pag-1935"><span class="linenos">1935</span></a>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1936"><a href="#PumpWoodMicroService.parallel_list_without_pag-1936"><span class="linenos">1936</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1937"><a href="#PumpWoodMicroService.parallel_list_without_pag-1937"><span class="linenos">1937</span></a><span class="sd">            Flatten List of the list request reponses.</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1938"><a href="#PumpWoodMicroService.parallel_list_without_pag-1938"><span class="linenos">1938</span></a>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1939"><a href="#PumpWoodMicroService.parallel_list_without_pag-1939"><span class="linenos">1939</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1940"><a href="#PumpWoodMicroService.parallel_list_without_pag-1940"><span class="linenos">1940</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1941"><a href="#PumpWoodMicroService.parallel_list_without_pag-1941"><span class="linenos">1941</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates that</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1942"><a href="#PumpWoodMicroService.parallel_list_without_pag-1942"><span class="linenos">1942</span></a><span class="sd">                lenght of model_class and list_args arguments are not equal.</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1943"><a href="#PumpWoodMicroService.parallel_list_without_pag-1943"><span class="linenos">1943</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1944"><a href="#PumpWoodMicroService.parallel_list_without_pag-1944"><span class="linenos">1944</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1945"><a href="#PumpWoodMicroService.parallel_list_without_pag-1945"><span class="linenos">1945</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1946"><a href="#PumpWoodMicroService.parallel_list_without_pag-1946"><span class="linenos">1946</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1947"><a href="#PumpWoodMicroService.parallel_list_without_pag-1947"><span class="linenos">1947</span></a>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1948"><a href="#PumpWoodMicroService.parallel_list_without_pag-1948"><span class="linenos">1948</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1949"><a href="#PumpWoodMicroService.parallel_list_without_pag-1949"><span class="linenos">1949</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1950"><a href="#PumpWoodMicroService.parallel_list_without_pag-1950"><span class="linenos">1950</span></a>            <span class="n">url_temp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1951"><a href="#PumpWoodMicroService.parallel_list_without_pag-1951"><span class="linenos">1951</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="n">url_temp</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1952"><a href="#PumpWoodMicroService.parallel_list_without_pag-1952"><span class="linenos">1952</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1953"><a href="#PumpWoodMicroService.parallel_list_without_pag-1953"><span class="linenos">1953</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1954"><a href="#PumpWoodMicroService.parallel_list_without_pag-1954"><span class="linenos">1954</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1955"><a href="#PumpWoodMicroService.parallel_list_without_pag-1955"><span class="linenos">1955</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1956"><a href="#PumpWoodMicroService.parallel_list_without_pag-1956"><span class="linenos">1956</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1957"><a href="#PumpWoodMicroService.parallel_list_without_pag-1957"><span class="linenos">1957</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1958"><a href="#PumpWoodMicroService.parallel_list_without_pag-1958"><span class="linenos">1958</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model_class</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1959"><a href="#PumpWoodMicroService.parallel_list_without_pag-1959"><span class="linenos">1959</span></a>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1960"><a href="#PumpWoodMicroService.parallel_list_without_pag-1960"><span class="linenos">1960</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_list_without_pag: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1961"><a href="#PumpWoodMicroService.parallel_list_without_pag-1961"><span class="linenos">1961</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1962"><a href="#PumpWoodMicroService.parallel_list_without_pag-1962"><span class="linenos">1962</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_list_without_pag-1963"><a href="#PumpWoodMicroService.parallel_list_without_pag-1963"><span class="linenos">1963</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Make [n_parallel] parallel list_without_pag request.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model Class to retrieve.</li>
<li><strong>list_args:</strong>  A list of list request args (filter_dict,
exclude_dict, order_by, fields, default_fields, limit,
foreign_key_fields).</li>
<li><strong>n_parallel (int):</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>Flatten List of the list request reponses.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'len(model_class)[{}] != len(list_args)[{}]'. Indicates that
lenght of model_class and list_args arguments are not equal.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_list_one" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_list_one-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_list_one</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_list_one-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_list_one"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_list_one-1965"><a href="#PumpWoodMicroService.parallel_list_one-1965"><span class="linenos">1965</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_list_one</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1966"><a href="#PumpWoodMicroService.parallel_list_one-1966"><span class="linenos">1966</span></a>                          <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1967"><a href="#PumpWoodMicroService.parallel_list_one-1967"><span class="linenos">1967</span></a>                          <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1968"><a href="#PumpWoodMicroService.parallel_list_one-1968"><span class="linenos">1968</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel list_one request.</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1969"><a href="#PumpWoodMicroService.parallel_list_one-1969"><span class="linenos">1969</span></a>
</span><span id="PumpWoodMicroService.parallel_list_one-1970"><a href="#PumpWoodMicroService.parallel_list_one-1970"><span class="linenos">1970</span></a><span class="sd">        DEPRECTED user retrieve call with default_fields=True.</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1971"><a href="#PumpWoodMicroService.parallel_list_one-1971"><span class="linenos">1971</span></a>
</span><span id="PumpWoodMicroService.parallel_list_one-1972"><a href="#PumpWoodMicroService.parallel_list_one-1972"><span class="linenos">1972</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1973"><a href="#PumpWoodMicroService.parallel_list_one-1973"><span class="linenos">1973</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1974"><a href="#PumpWoodMicroService.parallel_list_one-1974"><span class="linenos">1974</span></a><span class="sd">                Model Class to list one.</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1975"><a href="#PumpWoodMicroService.parallel_list_one-1975"><span class="linenos">1975</span></a><span class="sd">            list_pk:</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1976"><a href="#PumpWoodMicroService.parallel_list_one-1976"><span class="linenos">1976</span></a><span class="sd">                List of the pks to list one.</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1977"><a href="#PumpWoodMicroService.parallel_list_one-1977"><span class="linenos">1977</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1978"><a href="#PumpWoodMicroService.parallel_list_one-1978"><span class="linenos">1978</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1979"><a href="#PumpWoodMicroService.parallel_list_one-1979"><span class="linenos">1979</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1980"><a href="#PumpWoodMicroService.parallel_list_one-1980"><span class="linenos">1980</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1981"><a href="#PumpWoodMicroService.parallel_list_one-1981"><span class="linenos">1981</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1982"><a href="#PumpWoodMicroService.parallel_list_one-1982"><span class="linenos">1982</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1983"><a href="#PumpWoodMicroService.parallel_list_one-1983"><span class="linenos">1983</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1984"><a href="#PumpWoodMicroService.parallel_list_one-1984"><span class="linenos">1984</span></a>
</span><span id="PumpWoodMicroService.parallel_list_one-1985"><a href="#PumpWoodMicroService.parallel_list_one-1985"><span class="linenos">1985</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1986"><a href="#PumpWoodMicroService.parallel_list_one-1986"><span class="linenos">1986</span></a><span class="sd">            List of the list_one request data.</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1987"><a href="#PumpWoodMicroService.parallel_list_one-1987"><span class="linenos">1987</span></a>
</span><span id="PumpWoodMicroService.parallel_list_one-1988"><a href="#PumpWoodMicroService.parallel_list_one-1988"><span class="linenos">1988</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1989"><a href="#PumpWoodMicroService.parallel_list_one-1989"><span class="linenos">1989</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1990"><a href="#PumpWoodMicroService.parallel_list_one-1990"><span class="linenos">1990</span></a><span class="sd">                &#39;len(model_class) != len(list_pk)&#39;. Indicates that lenght</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1991"><a href="#PumpWoodMicroService.parallel_list_one-1991"><span class="linenos">1991</span></a><span class="sd">                of model_class and list_pk arguments are not equal.</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1992"><a href="#PumpWoodMicroService.parallel_list_one-1992"><span class="linenos">1992</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1993"><a href="#PumpWoodMicroService.parallel_list_one-1993"><span class="linenos">1993</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1994"><a href="#PumpWoodMicroService.parallel_list_one-1994"><span class="linenos">1994</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1995"><a href="#PumpWoodMicroService.parallel_list_one-1995"><span class="linenos">1995</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1996"><a href="#PumpWoodMicroService.parallel_list_one-1996"><span class="linenos">1996</span></a>
</span><span id="PumpWoodMicroService.parallel_list_one-1997"><a href="#PumpWoodMicroService.parallel_list_one-1997"><span class="linenos">1997</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1998"><a href="#PumpWoodMicroService.parallel_list_one-1998"><span class="linenos">1998</span></a>            <span class="n">model_class</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_list_one-1999"><a href="#PumpWoodMicroService.parallel_list_one-1999"><span class="linenos">1999</span></a>
</span><span id="PumpWoodMicroService.parallel_list_one-2000"><a href="#PumpWoodMicroService.parallel_list_one-2000"><span class="linenos">2000</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_list_one-2001"><a href="#PumpWoodMicroService.parallel_list_one-2001"><span class="linenos">2001</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="s1">&#39;len(model_class) != len(list_pk)&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_list_one-2002"><a href="#PumpWoodMicroService.parallel_list_one-2002"><span class="linenos">2002</span></a>
</span><span id="PumpWoodMicroService.parallel_list_one-2003"><a href="#PumpWoodMicroService.parallel_list_one-2003"><span class="linenos">2003</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService.parallel_list_one-2004"><a href="#PumpWoodMicroService.parallel_list_one-2004"><span class="linenos">2004</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_one_url</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.parallel_list_one-2005"><a href="#PumpWoodMicroService.parallel_list_one-2005"><span class="linenos">2005</span></a>                                     <span class="n">pk</span><span class="o">=</span><span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="PumpWoodMicroService.parallel_list_one-2006"><a href="#PumpWoodMicroService.parallel_list_one-2006"><span class="linenos">2006</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">))]</span>
</span><span id="PumpWoodMicroService.parallel_list_one-2007"><a href="#PumpWoodMicroService.parallel_list_one-2007"><span class="linenos">2007</span></a>
</span><span id="PumpWoodMicroService.parallel_list_one-2008"><a href="#PumpWoodMicroService.parallel_list_one-2008"><span class="linenos">2008</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_list_one: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_list_one-2009"><a href="#PumpWoodMicroService.parallel_list_one-2009"><span class="linenos">2009</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_list_one-2010"><a href="#PumpWoodMicroService.parallel_list_one-2010"><span class="linenos">2010</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_list_one-2011"><a href="#PumpWoodMicroService.parallel_list_one-2011"><span class="linenos">2011</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Make [n_parallel] parallel list_one request.</p>

<p>DEPRECTED user retrieve call with default_fields=True.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model Class to list one.</li>
<li><strong>list_pk:</strong>  List of the pks to list one.</li>
<li><strong>n_parallel:</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of the list_one request data.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'len(model_class) != len(list_pk)'. Indicates that lenght
of model_class and list_pk arguments are not equal.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_save" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_save</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">list_obj_dict</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_save-2013"><a href="#PumpWoodMicroService.parallel_save-2013"><span class="linenos">2013</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">list_obj_dict</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.parallel_save-2014"><a href="#PumpWoodMicroService.parallel_save-2014"><span class="linenos">2014</span></a>                      <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_save-2015"><a href="#PumpWoodMicroService.parallel_save-2015"><span class="linenos">2015</span></a>                      <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.parallel_save-2016"><a href="#PumpWoodMicroService.parallel_save-2016"><span class="linenos">2016</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel save requests.</span>
</span><span id="PumpWoodMicroService.parallel_save-2017"><a href="#PumpWoodMicroService.parallel_save-2017"><span class="linenos">2017</span></a>
</span><span id="PumpWoodMicroService.parallel_save-2018"><a href="#PumpWoodMicroService.parallel_save-2018"><span class="linenos">2018</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_save-2019"><a href="#PumpWoodMicroService.parallel_save-2019"><span class="linenos">2019</span></a><span class="sd">            list_obj_dict:</span>
</span><span id="PumpWoodMicroService.parallel_save-2020"><a href="#PumpWoodMicroService.parallel_save-2020"><span class="linenos">2020</span></a><span class="sd">                List of dictionaries containing PumpWood objects</span>
</span><span id="PumpWoodMicroService.parallel_save-2021"><a href="#PumpWoodMicroService.parallel_save-2021"><span class="linenos">2021</span></a><span class="sd">                (must have at least &#39;model_class&#39; key).</span>
</span><span id="PumpWoodMicroService.parallel_save-2022"><a href="#PumpWoodMicroService.parallel_save-2022"><span class="linenos">2022</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService.parallel_save-2023"><a href="#PumpWoodMicroService.parallel_save-2023"><span class="linenos">2023</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_save-2024"><a href="#PumpWoodMicroService.parallel_save-2024"><span class="linenos">2024</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_save-2025"><a href="#PumpWoodMicroService.parallel_save-2025"><span class="linenos">2025</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_save-2026"><a href="#PumpWoodMicroService.parallel_save-2026"><span class="linenos">2026</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.parallel_save-2027"><a href="#PumpWoodMicroService.parallel_save-2027"><span class="linenos">2027</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_save-2028"><a href="#PumpWoodMicroService.parallel_save-2028"><span class="linenos">2028</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_save-2029"><a href="#PumpWoodMicroService.parallel_save-2029"><span class="linenos">2029</span></a>
</span><span id="PumpWoodMicroService.parallel_save-2030"><a href="#PumpWoodMicroService.parallel_save-2030"><span class="linenos">2030</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_save-2031"><a href="#PumpWoodMicroService.parallel_save-2031"><span class="linenos">2031</span></a><span class="sd">            List of the save request data.</span>
</span><span id="PumpWoodMicroService.parallel_save-2032"><a href="#PumpWoodMicroService.parallel_save-2032"><span class="linenos">2032</span></a>
</span><span id="PumpWoodMicroService.parallel_save-2033"><a href="#PumpWoodMicroService.parallel_save-2033"><span class="linenos">2033</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.parallel_save-2034"><a href="#PumpWoodMicroService.parallel_save-2034"><span class="linenos">2034</span></a><span class="sd">            No particular raises</span>
</span><span id="PumpWoodMicroService.parallel_save-2035"><a href="#PumpWoodMicroService.parallel_save-2035"><span class="linenos">2035</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_save-2036"><a href="#PumpWoodMicroService.parallel_save-2036"><span class="linenos">2036</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_save-2037"><a href="#PumpWoodMicroService.parallel_save-2037"><span class="linenos">2037</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_save-2038"><a href="#PumpWoodMicroService.parallel_save-2038"><span class="linenos">2038</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_save-2039"><a href="#PumpWoodMicroService.parallel_save-2039"><span class="linenos">2039</span></a>
</span><span id="PumpWoodMicroService.parallel_save-2040"><a href="#PumpWoodMicroService.parallel_save-2040"><span class="linenos">2040</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService.parallel_save-2041"><a href="#PumpWoodMicroService.parallel_save-2041"><span class="linenos">2041</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_save_url</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s1">&#39;model_class&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">list_obj_dict</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.parallel_save-2042"><a href="#PumpWoodMicroService.parallel_save-2042"><span class="linenos">2042</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_save: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_save-2043"><a href="#PumpWoodMicroService.parallel_save-2043"><span class="linenos">2043</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_save-2044"><a href="#PumpWoodMicroService.parallel_save-2044"><span class="linenos">2044</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_obj_dict</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_save-2045"><a href="#PumpWoodMicroService.parallel_save-2045"><span class="linenos">2045</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Make [n_parallel] parallel save requests.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>list_obj_dict:</strong>  List of dictionaries containing PumpWood objects
(must have at least 'model_class' key).</li>
<li><strong>n_parallel:</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of the save request data.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No particular raises</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_delete" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_delete-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_delete</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_delete-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_delete"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_delete-2047"><a href="#PumpWoodMicroService.parallel_delete-2047"><span class="linenos">2047</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService.parallel_delete-2048"><a href="#PumpWoodMicroService.parallel_delete-2048"><span class="linenos">2048</span></a>                        <span class="n">list_pk</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_delete-2049"><a href="#PumpWoodMicroService.parallel_delete-2049"><span class="linenos">2049</span></a>                        <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_delete-2050"><a href="#PumpWoodMicroService.parallel_delete-2050"><span class="linenos">2050</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make many [n_parallel] delete requests.</span>
</span><span id="PumpWoodMicroService.parallel_delete-2051"><a href="#PumpWoodMicroService.parallel_delete-2051"><span class="linenos">2051</span></a>
</span><span id="PumpWoodMicroService.parallel_delete-2052"><a href="#PumpWoodMicroService.parallel_delete-2052"><span class="linenos">2052</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_delete-2053"><a href="#PumpWoodMicroService.parallel_delete-2053"><span class="linenos">2053</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.parallel_delete-2054"><a href="#PumpWoodMicroService.parallel_delete-2054"><span class="linenos">2054</span></a><span class="sd">                Model Class to list one.</span>
</span><span id="PumpWoodMicroService.parallel_delete-2055"><a href="#PumpWoodMicroService.parallel_delete-2055"><span class="linenos">2055</span></a><span class="sd">            list_pk:</span>
</span><span id="PumpWoodMicroService.parallel_delete-2056"><a href="#PumpWoodMicroService.parallel_delete-2056"><span class="linenos">2056</span></a><span class="sd">                List of the pks to list one.</span>
</span><span id="PumpWoodMicroService.parallel_delete-2057"><a href="#PumpWoodMicroService.parallel_delete-2057"><span class="linenos">2057</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService.parallel_delete-2058"><a href="#PumpWoodMicroService.parallel_delete-2058"><span class="linenos">2058</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_delete-2059"><a href="#PumpWoodMicroService.parallel_delete-2059"><span class="linenos">2059</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_delete-2060"><a href="#PumpWoodMicroService.parallel_delete-2060"><span class="linenos">2060</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_delete-2061"><a href="#PumpWoodMicroService.parallel_delete-2061"><span class="linenos">2061</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.parallel_delete-2062"><a href="#PumpWoodMicroService.parallel_delete-2062"><span class="linenos">2062</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_delete-2063"><a href="#PumpWoodMicroService.parallel_delete-2063"><span class="linenos">2063</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_delete-2064"><a href="#PumpWoodMicroService.parallel_delete-2064"><span class="linenos">2064</span></a>
</span><span id="PumpWoodMicroService.parallel_delete-2065"><a href="#PumpWoodMicroService.parallel_delete-2065"><span class="linenos">2065</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_delete-2066"><a href="#PumpWoodMicroService.parallel_delete-2066"><span class="linenos">2066</span></a><span class="sd">            List of the delete request data.</span>
</span><span id="PumpWoodMicroService.parallel_delete-2067"><a href="#PumpWoodMicroService.parallel_delete-2067"><span class="linenos">2067</span></a>
</span><span id="PumpWoodMicroService.parallel_delete-2068"><a href="#PumpWoodMicroService.parallel_delete-2068"><span class="linenos">2068</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.parallel_delete-2069"><a href="#PumpWoodMicroService.parallel_delete-2069"><span class="linenos">2069</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.parallel_delete-2070"><a href="#PumpWoodMicroService.parallel_delete-2070"><span class="linenos">2070</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates</span>
</span><span id="PumpWoodMicroService.parallel_delete-2071"><a href="#PumpWoodMicroService.parallel_delete-2071"><span class="linenos">2071</span></a><span class="sd">                that length of model_class and list_args arguments are not</span>
</span><span id="PumpWoodMicroService.parallel_delete-2072"><a href="#PumpWoodMicroService.parallel_delete-2072"><span class="linenos">2072</span></a><span class="sd">                equal.</span>
</span><span id="PumpWoodMicroService.parallel_delete-2073"><a href="#PumpWoodMicroService.parallel_delete-2073"><span class="linenos">2073</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_delete-2074"><a href="#PumpWoodMicroService.parallel_delete-2074"><span class="linenos">2074</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_delete-2075"><a href="#PumpWoodMicroService.parallel_delete-2075"><span class="linenos">2075</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_delete-2076"><a href="#PumpWoodMicroService.parallel_delete-2076"><span class="linenos">2076</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_delete-2077"><a href="#PumpWoodMicroService.parallel_delete-2077"><span class="linenos">2077</span></a>
</span><span id="PumpWoodMicroService.parallel_delete-2078"><a href="#PumpWoodMicroService.parallel_delete-2078"><span class="linenos">2078</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_delete-2079"><a href="#PumpWoodMicroService.parallel_delete-2079"><span class="linenos">2079</span></a>            <span class="n">model_class</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_delete-2080"><a href="#PumpWoodMicroService.parallel_delete-2080"><span class="linenos">2080</span></a>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_delete-2081"><a href="#PumpWoodMicroService.parallel_delete-2081"><span class="linenos">2081</span></a>            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_delete-2082"><a href="#PumpWoodMicroService.parallel_delete-2082"><span class="linenos">2082</span></a>                <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_pk</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_delete-2083"><a href="#PumpWoodMicroService.parallel_delete-2083"><span class="linenos">2083</span></a>            <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_delete-2084"><a href="#PumpWoodMicroService.parallel_delete-2084"><span class="linenos">2084</span></a>
</span><span id="PumpWoodMicroService.parallel_delete-2085"><a href="#PumpWoodMicroService.parallel_delete-2085"><span class="linenos">2085</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService.parallel_delete-2086"><a href="#PumpWoodMicroService.parallel_delete-2086"><span class="linenos">2086</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_delete_request_url</span><span class="p">(</span><span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.parallel_delete-2087"><a href="#PumpWoodMicroService.parallel_delete-2087"><span class="linenos">2087</span></a>                                           <span class="n">pk</span><span class="o">=</span><span class="n">list_pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="PumpWoodMicroService.parallel_delete-2088"><a href="#PumpWoodMicroService.parallel_delete-2088"><span class="linenos">2088</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">))]</span>
</span><span id="PumpWoodMicroService.parallel_delete-2089"><a href="#PumpWoodMicroService.parallel_delete-2089"><span class="linenos">2089</span></a>
</span><span id="PumpWoodMicroService.parallel_delete-2090"><a href="#PumpWoodMicroService.parallel_delete-2090"><span class="linenos">2090</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_delete: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_delete-2091"><a href="#PumpWoodMicroService.parallel_delete-2091"><span class="linenos">2091</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parallel_request_get</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_delete-2092"><a href="#PumpWoodMicroService.parallel_delete-2092"><span class="linenos">2092</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_delete-2093"><a href="#PumpWoodMicroService.parallel_delete-2093"><span class="linenos">2093</span></a>            <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Make many [n_parallel] delete requests.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model Class to list one.</li>
<li><strong>list_pk:</strong>  List of the pks to list one.</li>
<li><strong>n_parallel:</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of the delete request data.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'len(model_class)[{}] != len(list_args)[{}]'. Indicates
that length of model_class and list_args arguments are not
equal.</li>
</ul>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_delete_many" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_delete_many-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_delete_many</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_delete_many-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_delete_many"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_delete_many-2095"><a href="#PumpWoodMicroService.parallel_delete_many-2095"><span class="linenos">2095</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_delete_many</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2096"><a href="#PumpWoodMicroService.parallel_delete_many-2096"><span class="linenos">2096</span></a>                             <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2097"><a href="#PumpWoodMicroService.parallel_delete_many-2097"><span class="linenos">2097</span></a>                             <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2098"><a href="#PumpWoodMicroService.parallel_delete_many-2098"><span class="linenos">2098</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel delete_many request.</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2099"><a href="#PumpWoodMicroService.parallel_delete_many-2099"><span class="linenos">2099</span></a>
</span><span id="PumpWoodMicroService.parallel_delete_many-2100"><a href="#PumpWoodMicroService.parallel_delete_many-2100"><span class="linenos">2100</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2101"><a href="#PumpWoodMicroService.parallel_delete_many-2101"><span class="linenos">2101</span></a><span class="sd">            model_class (str):</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2102"><a href="#PumpWoodMicroService.parallel_delete_many-2102"><span class="linenos">2102</span></a><span class="sd">                Model Class to delete many.</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2103"><a href="#PumpWoodMicroService.parallel_delete_many-2103"><span class="linenos">2103</span></a><span class="sd">            list_args (list):</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2104"><a href="#PumpWoodMicroService.parallel_delete_many-2104"><span class="linenos">2104</span></a><span class="sd">                A list of list request args (filter_dict, exclude_dict).</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2105"><a href="#PumpWoodMicroService.parallel_delete_many-2105"><span class="linenos">2105</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2106"><a href="#PumpWoodMicroService.parallel_delete_many-2106"><span class="linenos">2106</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2107"><a href="#PumpWoodMicroService.parallel_delete_many-2107"><span class="linenos">2107</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2108"><a href="#PumpWoodMicroService.parallel_delete_many-2108"><span class="linenos">2108</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2109"><a href="#PumpWoodMicroService.parallel_delete_many-2109"><span class="linenos">2109</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2110"><a href="#PumpWoodMicroService.parallel_delete_many-2110"><span class="linenos">2110</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2111"><a href="#PumpWoodMicroService.parallel_delete_many-2111"><span class="linenos">2111</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2112"><a href="#PumpWoodMicroService.parallel_delete_many-2112"><span class="linenos">2112</span></a>
</span><span id="PumpWoodMicroService.parallel_delete_many-2113"><a href="#PumpWoodMicroService.parallel_delete_many-2113"><span class="linenos">2113</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2114"><a href="#PumpWoodMicroService.parallel_delete_many-2114"><span class="linenos">2114</span></a><span class="sd">            List of the delete many request reponses.</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2115"><a href="#PumpWoodMicroService.parallel_delete_many-2115"><span class="linenos">2115</span></a>
</span><span id="PumpWoodMicroService.parallel_delete_many-2116"><a href="#PumpWoodMicroService.parallel_delete_many-2116"><span class="linenos">2116</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2117"><a href="#PumpWoodMicroService.parallel_delete_many-2117"><span class="linenos">2117</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2118"><a href="#PumpWoodMicroService.parallel_delete_many-2118"><span class="linenos">2118</span></a><span class="sd">                &#39;len(model_class)[{}] != len(list_args)[{}]&#39;. Indicates</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2119"><a href="#PumpWoodMicroService.parallel_delete_many-2119"><span class="linenos">2119</span></a><span class="sd">                that length of model_class and list_args arguments</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2120"><a href="#PumpWoodMicroService.parallel_delete_many-2120"><span class="linenos">2120</span></a><span class="sd">                are not equal.</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2121"><a href="#PumpWoodMicroService.parallel_delete_many-2121"><span class="linenos">2121</span></a>
</span><span id="PumpWoodMicroService.parallel_delete_many-2122"><a href="#PumpWoodMicroService.parallel_delete_many-2122"><span class="linenos">2122</span></a><span class="sd">        Example:</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2123"><a href="#PumpWoodMicroService.parallel_delete_many-2123"><span class="linenos">2123</span></a><span class="sd">            No example yet.</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2124"><a href="#PumpWoodMicroService.parallel_delete_many-2124"><span class="linenos">2124</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2125"><a href="#PumpWoodMicroService.parallel_delete_many-2125"><span class="linenos">2125</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2126"><a href="#PumpWoodMicroService.parallel_delete_many-2126"><span class="linenos">2126</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2127"><a href="#PumpWoodMicroService.parallel_delete_many-2127"><span class="linenos">2127</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2128"><a href="#PumpWoodMicroService.parallel_delete_many-2128"><span class="linenos">2128</span></a>
</span><span id="PumpWoodMicroService.parallel_delete_many-2129"><a href="#PumpWoodMicroService.parallel_delete_many-2129"><span class="linenos">2129</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2130"><a href="#PumpWoodMicroService.parallel_delete_many-2130"><span class="linenos">2130</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2131"><a href="#PumpWoodMicroService.parallel_delete_many-2131"><span class="linenos">2131</span></a>            <span class="n">url_temp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_delete_many_request_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2132"><a href="#PumpWoodMicroService.parallel_delete_many-2132"><span class="linenos">2132</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="n">url_temp</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2133"><a href="#PumpWoodMicroService.parallel_delete_many-2133"><span class="linenos">2133</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2134"><a href="#PumpWoodMicroService.parallel_delete_many-2134"><span class="linenos">2134</span></a>            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2135"><a href="#PumpWoodMicroService.parallel_delete_many-2135"><span class="linenos">2135</span></a>                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(model_class)[</span><span class="si">{}</span><span class="s1">] != len(list_args)[</span><span class="si">{}</span><span class="s1">]&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2136"><a href="#PumpWoodMicroService.parallel_delete_many-2136"><span class="linenos">2136</span></a>                    <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2137"><a href="#PumpWoodMicroService.parallel_delete_many-2137"><span class="linenos">2137</span></a>                <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2138"><a href="#PumpWoodMicroService.parallel_delete_many-2138"><span class="linenos">2138</span></a>            <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2139"><a href="#PumpWoodMicroService.parallel_delete_many-2139"><span class="linenos">2139</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">_build_list_without_pag_url</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model_class</span><span class="p">]</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2140"><a href="#PumpWoodMicroService.parallel_delete_many-2140"><span class="linenos">2140</span></a>
</span><span id="PumpWoodMicroService.parallel_delete_many-2141"><a href="#PumpWoodMicroService.parallel_delete_many-2141"><span class="linenos">2141</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_delete_many: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2142"><a href="#PumpWoodMicroService.parallel_delete_many-2142"><span class="linenos">2142</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2143"><a href="#PumpWoodMicroService.parallel_delete_many-2143"><span class="linenos">2143</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_delete_many-2144"><a href="#PumpWoodMicroService.parallel_delete_many-2144"><span class="linenos">2144</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Make [n_parallel] parallel delete_many request.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class (str):</strong>  Model Class to delete many.</li>
<li><strong>list_args (list):</strong>  A list of list request args (filter_dict, exclude_dict).</li>
<li><strong>n_parallel:</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of the delete many request reponses.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'len(model_class)[{}] != len(list_args)[{}]'. Indicates
that length of model_class and list_args arguments
are not equal.</li>
</ul>

<h6 id="example">Example:</h6>

<blockquote>
  <p>No example yet.</p>
</blockquote>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_execute_action" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_execute_action-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_execute_action</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">pk</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>,</span><span class="param">	<span class="n">action</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>,</span><span class="param">	<span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_execute_action-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_execute_action"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_execute_action-2146"><a href="#PumpWoodMicroService.parallel_execute_action-2146"><span class="linenos">2146</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_execute_action</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2147"><a href="#PumpWoodMicroService.parallel_execute_action-2147"><span class="linenos">2147</span></a>                                <span class="n">pk</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2148"><a href="#PumpWoodMicroService.parallel_execute_action-2148"><span class="linenos">2148</span></a>                                <span class="n">action</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2149"><a href="#PumpWoodMicroService.parallel_execute_action-2149"><span class="linenos">2149</span></a>                                <span class="n">parameters</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{},</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2150"><a href="#PumpWoodMicroService.parallel_execute_action-2150"><span class="linenos">2150</span></a>                                <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2151"><a href="#PumpWoodMicroService.parallel_execute_action-2151"><span class="linenos">2151</span></a>                                <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2152"><a href="#PumpWoodMicroService.parallel_execute_action-2152"><span class="linenos">2152</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel execute_action requests.</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2153"><a href="#PumpWoodMicroService.parallel_execute_action-2153"><span class="linenos">2153</span></a>
</span><span id="PumpWoodMicroService.parallel_execute_action-2154"><a href="#PumpWoodMicroService.parallel_execute_action-2154"><span class="linenos">2154</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2155"><a href="#PumpWoodMicroService.parallel_execute_action-2155"><span class="linenos">2155</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2156"><a href="#PumpWoodMicroService.parallel_execute_action-2156"><span class="linenos">2156</span></a><span class="sd">                Model Class to perform action over,</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2157"><a href="#PumpWoodMicroService.parallel_execute_action-2157"><span class="linenos">2157</span></a><span class="sd">                or a list of model class o make diferent actions.</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2158"><a href="#PumpWoodMicroService.parallel_execute_action-2158"><span class="linenos">2158</span></a><span class="sd">            pk:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2159"><a href="#PumpWoodMicroService.parallel_execute_action-2159"><span class="linenos">2159</span></a><span class="sd">                A list of the pks to perform action or a</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2160"><a href="#PumpWoodMicroService.parallel_execute_action-2160"><span class="linenos">2160</span></a><span class="sd">                single pk to perform action with different paraemters.</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2161"><a href="#PumpWoodMicroService.parallel_execute_action-2161"><span class="linenos">2161</span></a><span class="sd">            action:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2162"><a href="#PumpWoodMicroService.parallel_execute_action-2162"><span class="linenos">2162</span></a><span class="sd">                A list of actions to perform or a single</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2163"><a href="#PumpWoodMicroService.parallel_execute_action-2163"><span class="linenos">2163</span></a><span class="sd">                action to perform over all pks and parameters.</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2164"><a href="#PumpWoodMicroService.parallel_execute_action-2164"><span class="linenos">2164</span></a><span class="sd">            parameters:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2165"><a href="#PumpWoodMicroService.parallel_execute_action-2165"><span class="linenos">2165</span></a><span class="sd">                Parameters used to perform actions</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2166"><a href="#PumpWoodMicroService.parallel_execute_action-2166"><span class="linenos">2166</span></a><span class="sd">                or a single dict to be used in all actions.</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2167"><a href="#PumpWoodMicroService.parallel_execute_action-2167"><span class="linenos">2167</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2168"><a href="#PumpWoodMicroService.parallel_execute_action-2168"><span class="linenos">2168</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2169"><a href="#PumpWoodMicroService.parallel_execute_action-2169"><span class="linenos">2169</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2170"><a href="#PumpWoodMicroService.parallel_execute_action-2170"><span class="linenos">2170</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2171"><a href="#PumpWoodMicroService.parallel_execute_action-2171"><span class="linenos">2171</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2172"><a href="#PumpWoodMicroService.parallel_execute_action-2172"><span class="linenos">2172</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2173"><a href="#PumpWoodMicroService.parallel_execute_action-2173"><span class="linenos">2173</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2174"><a href="#PumpWoodMicroService.parallel_execute_action-2174"><span class="linenos">2174</span></a>
</span><span id="PumpWoodMicroService.parallel_execute_action-2175"><a href="#PumpWoodMicroService.parallel_execute_action-2175"><span class="linenos">2175</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2176"><a href="#PumpWoodMicroService.parallel_execute_action-2176"><span class="linenos">2176</span></a><span class="sd">            List of the execute_action request data.</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2177"><a href="#PumpWoodMicroService.parallel_execute_action-2177"><span class="linenos">2177</span></a>
</span><span id="PumpWoodMicroService.parallel_execute_action-2178"><a href="#PumpWoodMicroService.parallel_execute_action-2178"><span class="linenos">2178</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2179"><a href="#PumpWoodMicroService.parallel_execute_action-2179"><span class="linenos">2179</span></a><span class="sd">            PumpWoodException:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2180"><a href="#PumpWoodMicroService.parallel_execute_action-2180"><span class="linenos">2180</span></a><span class="sd">                &#39;parallel_length != len([argument])&#39;. Indicates that function</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2181"><a href="#PumpWoodMicroService.parallel_execute_action-2181"><span class="linenos">2181</span></a><span class="sd">                arguments does not have all the same lenght.</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2182"><a href="#PumpWoodMicroService.parallel_execute_action-2182"><span class="linenos">2182</span></a>
</span><span id="PumpWoodMicroService.parallel_execute_action-2183"><a href="#PumpWoodMicroService.parallel_execute_action-2183"><span class="linenos">2183</span></a><span class="sd">        Example:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2184"><a href="#PumpWoodMicroService.parallel_execute_action-2184"><span class="linenos">2184</span></a><span class="sd">            No example yet.</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2185"><a href="#PumpWoodMicroService.parallel_execute_action-2185"><span class="linenos">2185</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2186"><a href="#PumpWoodMicroService.parallel_execute_action-2186"><span class="linenos">2186</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2187"><a href="#PumpWoodMicroService.parallel_execute_action-2187"><span class="linenos">2187</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2188"><a href="#PumpWoodMicroService.parallel_execute_action-2188"><span class="linenos">2188</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2189"><a href="#PumpWoodMicroService.parallel_execute_action-2189"><span class="linenos">2189</span></a>
</span><span id="PumpWoodMicroService.parallel_execute_action-2190"><a href="#PumpWoodMicroService.parallel_execute_action-2190"><span class="linenos">2190</span></a>        <span class="n">parallel_length</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2191"><a href="#PumpWoodMicroService.parallel_execute_action-2191"><span class="linenos">2191</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2192"><a href="#PumpWoodMicroService.parallel_execute_action-2192"><span class="linenos">2192</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2193"><a href="#PumpWoodMicroService.parallel_execute_action-2193"><span class="linenos">2193</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2194"><a href="#PumpWoodMicroService.parallel_execute_action-2194"><span class="linenos">2194</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2195"><a href="#PumpWoodMicroService.parallel_execute_action-2195"><span class="linenos">2195</span></a>                        <span class="s1">&#39;parallel_length != len(model_class)&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2196"><a href="#PumpWoodMicroService.parallel_execute_action-2196"><span class="linenos">2196</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2197"><a href="#PumpWoodMicroService.parallel_execute_action-2197"><span class="linenos">2197</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2198"><a href="#PumpWoodMicroService.parallel_execute_action-2198"><span class="linenos">2198</span></a>
</span><span id="PumpWoodMicroService.parallel_execute_action-2199"><a href="#PumpWoodMicroService.parallel_execute_action-2199"><span class="linenos">2199</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2200"><a href="#PumpWoodMicroService.parallel_execute_action-2200"><span class="linenos">2200</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2201"><a href="#PumpWoodMicroService.parallel_execute_action-2201"><span class="linenos">2201</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pk</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2202"><a href="#PumpWoodMicroService.parallel_execute_action-2202"><span class="linenos">2202</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2203"><a href="#PumpWoodMicroService.parallel_execute_action-2203"><span class="linenos">2203</span></a>                        <span class="s1">&#39;parallel_length != len(pk)&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2204"><a href="#PumpWoodMicroService.parallel_execute_action-2204"><span class="linenos">2204</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2205"><a href="#PumpWoodMicroService.parallel_execute_action-2205"><span class="linenos">2205</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2206"><a href="#PumpWoodMicroService.parallel_execute_action-2206"><span class="linenos">2206</span></a>
</span><span id="PumpWoodMicroService.parallel_execute_action-2207"><a href="#PumpWoodMicroService.parallel_execute_action-2207"><span class="linenos">2207</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2208"><a href="#PumpWoodMicroService.parallel_execute_action-2208"><span class="linenos">2208</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2209"><a href="#PumpWoodMicroService.parallel_execute_action-2209"><span class="linenos">2209</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">action</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2210"><a href="#PumpWoodMicroService.parallel_execute_action-2210"><span class="linenos">2210</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2211"><a href="#PumpWoodMicroService.parallel_execute_action-2211"><span class="linenos">2211</span></a>                        <span class="s1">&#39;parallel_length != len(action)&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2212"><a href="#PumpWoodMicroService.parallel_execute_action-2212"><span class="linenos">2212</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2213"><a href="#PumpWoodMicroService.parallel_execute_action-2213"><span class="linenos">2213</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2214"><a href="#PumpWoodMicroService.parallel_execute_action-2214"><span class="linenos">2214</span></a>
</span><span id="PumpWoodMicroService.parallel_execute_action-2215"><a href="#PumpWoodMicroService.parallel_execute_action-2215"><span class="linenos">2215</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2216"><a href="#PumpWoodMicroService.parallel_execute_action-2216"><span class="linenos">2216</span></a>            <span class="k">if</span> <span class="n">parallel_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2217"><a href="#PumpWoodMicroService.parallel_execute_action-2217"><span class="linenos">2217</span></a>                <span class="k">if</span> <span class="n">parallel_length</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2218"><a href="#PumpWoodMicroService.parallel_execute_action-2218"><span class="linenos">2218</span></a>                    <span class="k">raise</span> <span class="n">PumpWoodException</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2219"><a href="#PumpWoodMicroService.parallel_execute_action-2219"><span class="linenos">2219</span></a>                        <span class="s1">&#39;parallel_length != len(parameters)&#39;</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2220"><a href="#PumpWoodMicroService.parallel_execute_action-2220"><span class="linenos">2220</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2221"><a href="#PumpWoodMicroService.parallel_execute_action-2221"><span class="linenos">2221</span></a>                <span class="n">parallel_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2222"><a href="#PumpWoodMicroService.parallel_execute_action-2222"><span class="linenos">2222</span></a>
</span><span id="PumpWoodMicroService.parallel_execute_action-2223"><a href="#PumpWoodMicroService.parallel_execute_action-2223"><span class="linenos">2223</span></a>        <span class="n">model_class</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2224"><a href="#PumpWoodMicroService.parallel_execute_action-2224"><span class="linenos">2224</span></a>            <span class="n">model_class</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2225"><a href="#PumpWoodMicroService.parallel_execute_action-2225"><span class="linenos">2225</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">model_class</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2226"><a href="#PumpWoodMicroService.parallel_execute_action-2226"><span class="linenos">2226</span></a>        <span class="n">pk</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2227"><a href="#PumpWoodMicroService.parallel_execute_action-2227"><span class="linenos">2227</span></a>            <span class="n">pk</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">pk</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2228"><a href="#PumpWoodMicroService.parallel_execute_action-2228"><span class="linenos">2228</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">pk</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2229"><a href="#PumpWoodMicroService.parallel_execute_action-2229"><span class="linenos">2229</span></a>        <span class="n">action</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2230"><a href="#PumpWoodMicroService.parallel_execute_action-2230"><span class="linenos">2230</span></a>            <span class="n">action</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2231"><a href="#PumpWoodMicroService.parallel_execute_action-2231"><span class="linenos">2231</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">action</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2232"><a href="#PumpWoodMicroService.parallel_execute_action-2232"><span class="linenos">2232</span></a>        <span class="n">parameters</span> <span class="o">=</span> <span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2233"><a href="#PumpWoodMicroService.parallel_execute_action-2233"><span class="linenos">2233</span></a>            <span class="n">parameters</span> <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2234"><a href="#PumpWoodMicroService.parallel_execute_action-2234"><span class="linenos">2234</span></a>            <span class="k">else</span> <span class="p">[</span><span class="n">parameters</span><span class="p">]</span> <span class="o">*</span> <span class="n">parallel_length</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2235"><a href="#PumpWoodMicroService.parallel_execute_action-2235"><span class="linenos">2235</span></a>
</span><span id="PumpWoodMicroService.parallel_execute_action-2236"><a href="#PumpWoodMicroService.parallel_execute_action-2236"><span class="linenos">2236</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2237"><a href="#PumpWoodMicroService.parallel_execute_action-2237"><span class="linenos">2237</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">_build_execute_action_url</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2238"><a href="#PumpWoodMicroService.parallel_execute_action-2238"><span class="linenos">2238</span></a>                <span class="n">model_class</span><span class="o">=</span><span class="n">model_class</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">action</span><span class="o">=</span><span class="n">action</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2239"><a href="#PumpWoodMicroService.parallel_execute_action-2239"><span class="linenos">2239</span></a>            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">parallel_length</span><span class="p">)]</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2240"><a href="#PumpWoodMicroService.parallel_execute_action-2240"><span class="linenos">2240</span></a>
</span><span id="PumpWoodMicroService.parallel_execute_action-2241"><a href="#PumpWoodMicroService.parallel_execute_action-2241"><span class="linenos">2241</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_execute_action: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2242"><a href="#PumpWoodMicroService.parallel_execute_action-2242"><span class="linenos">2242</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2243"><a href="#PumpWoodMicroService.parallel_execute_action-2243"><span class="linenos">2243</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_execute_action-2244"><a href="#PumpWoodMicroService.parallel_execute_action-2244"><span class="linenos">2244</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Make [n_parallel] parallel execute_action requests.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model Class to perform action over,
or a list of model class o make diferent actions.</li>
<li><strong>pk:</strong>  A list of the pks to perform action or a
single pk to perform action with different paraemters.</li>
<li><strong>action:</strong>  A list of actions to perform or a single
action to perform over all pks and parameters.</li>
<li><strong>parameters:</strong>  Parameters used to perform actions
or a single dict to be used in all actions.</li>
<li><strong>n_parallel:</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of the execute_action request data.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li><strong>PumpWoodException:</strong>  'parallel_length != len([argument])'. Indicates that function
arguments does not have all the same lenght.</li>
</ul>

<h6 id="example">Example:</h6>

<blockquote>
  <p>No example yet.</p>
</blockquote>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_bulk_save" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_bulk_save-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_bulk_save</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">data_to_save</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pandas</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_bulk_save-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_bulk_save"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_bulk_save-2246"><a href="#PumpWoodMicroService.parallel_bulk_save-2246"><span class="linenos">2246</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_bulk_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2247"><a href="#PumpWoodMicroService.parallel_bulk_save-2247"><span class="linenos">2247</span></a>                           <span class="n">data_to_save</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]],</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2248"><a href="#PumpWoodMicroService.parallel_bulk_save-2248"><span class="linenos">2248</span></a>                           <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2249"><a href="#PumpWoodMicroService.parallel_bulk_save-2249"><span class="linenos">2249</span></a>                           <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2250"><a href="#PumpWoodMicroService.parallel_bulk_save-2250"><span class="linenos">2250</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Break data_to_save in many parallel bulk_save requests.</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2251"><a href="#PumpWoodMicroService.parallel_bulk_save-2251"><span class="linenos">2251</span></a>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2252"><a href="#PumpWoodMicroService.parallel_bulk_save-2252"><span class="linenos">2252</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2253"><a href="#PumpWoodMicroService.parallel_bulk_save-2253"><span class="linenos">2253</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2254"><a href="#PumpWoodMicroService.parallel_bulk_save-2254"><span class="linenos">2254</span></a><span class="sd">                Model class of the data that will be saved.</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2255"><a href="#PumpWoodMicroService.parallel_bulk_save-2255"><span class="linenos">2255</span></a><span class="sd">            data_to_save:</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2256"><a href="#PumpWoodMicroService.parallel_bulk_save-2256"><span class="linenos">2256</span></a><span class="sd">                Data that will be saved</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2257"><a href="#PumpWoodMicroService.parallel_bulk_save-2257"><span class="linenos">2257</span></a><span class="sd">            chunksize:</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2258"><a href="#PumpWoodMicroService.parallel_bulk_save-2258"><span class="linenos">2258</span></a><span class="sd">                Length of each parallel bulk save chunk.</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2259"><a href="#PumpWoodMicroService.parallel_bulk_save-2259"><span class="linenos">2259</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2260"><a href="#PumpWoodMicroService.parallel_bulk_save-2260"><span class="linenos">2260</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2261"><a href="#PumpWoodMicroService.parallel_bulk_save-2261"><span class="linenos">2261</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2262"><a href="#PumpWoodMicroService.parallel_bulk_save-2262"><span class="linenos">2262</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2263"><a href="#PumpWoodMicroService.parallel_bulk_save-2263"><span class="linenos">2263</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2264"><a href="#PumpWoodMicroService.parallel_bulk_save-2264"><span class="linenos">2264</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2265"><a href="#PumpWoodMicroService.parallel_bulk_save-2265"><span class="linenos">2265</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2266"><a href="#PumpWoodMicroService.parallel_bulk_save-2266"><span class="linenos">2266</span></a>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2267"><a href="#PumpWoodMicroService.parallel_bulk_save-2267"><span class="linenos">2267</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2268"><a href="#PumpWoodMicroService.parallel_bulk_save-2268"><span class="linenos">2268</span></a><span class="sd">            List of the responses of bulk_save.</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2269"><a href="#PumpWoodMicroService.parallel_bulk_save-2269"><span class="linenos">2269</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2270"><a href="#PumpWoodMicroService.parallel_bulk_save-2270"><span class="linenos">2270</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2271"><a href="#PumpWoodMicroService.parallel_bulk_save-2271"><span class="linenos">2271</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2272"><a href="#PumpWoodMicroService.parallel_bulk_save-2272"><span class="linenos">2272</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2273"><a href="#PumpWoodMicroService.parallel_bulk_save-2273"><span class="linenos">2273</span></a>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2274"><a href="#PumpWoodMicroService.parallel_bulk_save-2274"><span class="linenos">2274</span></a>        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">data_to_save</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2275"><a href="#PumpWoodMicroService.parallel_bulk_save-2275"><span class="linenos">2275</span></a>            <span class="n">data_to_save</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_to_save</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2276"><a href="#PumpWoodMicroService.parallel_bulk_save-2276"><span class="linenos">2276</span></a>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2277"><a href="#PumpWoodMicroService.parallel_bulk_save-2277"><span class="linenos">2277</span></a>        <span class="n">chunks</span> <span class="o">=</span> <span class="n">break_in_chunks</span><span class="p">(</span><span class="n">df_to_break</span><span class="o">=</span><span class="n">data_to_save</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2278"><a href="#PumpWoodMicroService.parallel_bulk_save-2278"><span class="linenos">2278</span></a>        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_bulk_save_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2279"><a href="#PumpWoodMicroService.parallel_bulk_save-2279"><span class="linenos">2279</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">url</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunks</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2280"><a href="#PumpWoodMicroService.parallel_bulk_save-2280"><span class="linenos">2280</span></a>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2281"><a href="#PumpWoodMicroService.parallel_bulk_save-2281"><span class="linenos">2281</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_bulk_save: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2282"><a href="#PumpWoodMicroService.parallel_bulk_save-2282"><span class="linenos">2282</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2283"><a href="#PumpWoodMicroService.parallel_bulk_save-2283"><span class="linenos">2283</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">chunks</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_bulk_save-2284"><a href="#PumpWoodMicroService.parallel_bulk_save-2284"><span class="linenos">2284</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Break data_to_save in many parallel bulk_save requests.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model class of the data that will be saved.</li>
<li><strong>data_to_save:</strong>  Data that will be saved</li>
<li><strong>chunksize:</strong>  Length of each parallel bulk save chunk.</li>
<li><strong>n_parallel:</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of the responses of bulk_save.</p>
</blockquote>
</div>


                            </div>
                            <div id="PumpWoodMicroService.parallel_pivot" class="classattr">
                                        <input id="PumpWoodMicroService.parallel_pivot-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">parallel_pivot</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>,</span><span class="param">	<span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>,</span><span class="param">	<span class="nb">format</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">variables</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">function</span> <span class="n"><a href="#PumpWoodMicroService.list">PumpWoodMicroService.list</a></span><span class="o">&gt;</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.parallel_pivot-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.parallel_pivot"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.parallel_pivot-2286"><a href="#PumpWoodMicroService.parallel_pivot-2286"><span class="linenos">2286</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">parallel_pivot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model_class</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">list_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2287"><a href="#PumpWoodMicroService.parallel_pivot-2287"><span class="linenos">2287</span></a>                       <span class="n">columns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">n_parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2288"><a href="#PumpWoodMicroService.parallel_pivot-2288"><span class="linenos">2288</span></a>                       <span class="n">variables</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">show_deleted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2289"><a href="#PumpWoodMicroService.parallel_pivot-2289"><span class="linenos">2289</span></a>                       <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2290"><a href="#PumpWoodMicroService.parallel_pivot-2290"><span class="linenos">2290</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Make [n_parallel] parallel pivot request.</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2291"><a href="#PumpWoodMicroService.parallel_pivot-2291"><span class="linenos">2291</span></a>
</span><span id="PumpWoodMicroService.parallel_pivot-2292"><a href="#PumpWoodMicroService.parallel_pivot-2292"><span class="linenos">2292</span></a><span class="sd">        Args:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2293"><a href="#PumpWoodMicroService.parallel_pivot-2293"><span class="linenos">2293</span></a><span class="sd">            model_class:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2294"><a href="#PumpWoodMicroService.parallel_pivot-2294"><span class="linenos">2294</span></a><span class="sd">                Model Class to retrieve.</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2295"><a href="#PumpWoodMicroService.parallel_pivot-2295"><span class="linenos">2295</span></a><span class="sd">            list_args:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2296"><a href="#PumpWoodMicroService.parallel_pivot-2296"><span class="linenos">2296</span></a><span class="sd">                A list of list request args (filter_dict,exclude_dict,</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2297"><a href="#PumpWoodMicroService.parallel_pivot-2297"><span class="linenos">2297</span></a><span class="sd">                order_by).</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2298"><a href="#PumpWoodMicroService.parallel_pivot-2298"><span class="linenos">2298</span></a><span class="sd">            columns:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2299"><a href="#PumpWoodMicroService.parallel_pivot-2299"><span class="linenos">2299</span></a><span class="sd">                List of columns at the pivoted table.</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2300"><a href="#PumpWoodMicroService.parallel_pivot-2300"><span class="linenos">2300</span></a><span class="sd">            format:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2301"><a href="#PumpWoodMicroService.parallel_pivot-2301"><span class="linenos">2301</span></a><span class="sd">                Format of returned table. See pandas.DataFrame</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2302"><a href="#PumpWoodMicroService.parallel_pivot-2302"><span class="linenos">2302</span></a><span class="sd">                to_dict args.</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2303"><a href="#PumpWoodMicroService.parallel_pivot-2303"><span class="linenos">2303</span></a><span class="sd">            n_parallel:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2304"><a href="#PumpWoodMicroService.parallel_pivot-2304"><span class="linenos">2304</span></a><span class="sd">                Number of simultaneus get requests, if not set</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2305"><a href="#PumpWoodMicroService.parallel_pivot-2305"><span class="linenos">2305</span></a><span class="sd">                get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2306"><a href="#PumpWoodMicroService.parallel_pivot-2306"><span class="linenos">2306</span></a><span class="sd">                not set then 4 will be considered.</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2307"><a href="#PumpWoodMicroService.parallel_pivot-2307"><span class="linenos">2307</span></a><span class="sd">            variables:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2308"><a href="#PumpWoodMicroService.parallel_pivot-2308"><span class="linenos">2308</span></a><span class="sd">                Restrict the fields that will be returned at the query.</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2309"><a href="#PumpWoodMicroService.parallel_pivot-2309"><span class="linenos">2309</span></a><span class="sd">            show_deleted:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2310"><a href="#PumpWoodMicroService.parallel_pivot-2310"><span class="linenos">2310</span></a><span class="sd">                If results should include data with deleted=True. This will</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2311"><a href="#PumpWoodMicroService.parallel_pivot-2311"><span class="linenos">2311</span></a><span class="sd">                be ignored if model class does not have deleted field.</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2312"><a href="#PumpWoodMicroService.parallel_pivot-2312"><span class="linenos">2312</span></a><span class="sd">            auth_header:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2313"><a href="#PumpWoodMicroService.parallel_pivot-2313"><span class="linenos">2313</span></a><span class="sd">                Auth header to substitute the microservice original</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2314"><a href="#PumpWoodMicroService.parallel_pivot-2314"><span class="linenos">2314</span></a><span class="sd">                at the request (user impersonation).</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2315"><a href="#PumpWoodMicroService.parallel_pivot-2315"><span class="linenos">2315</span></a>
</span><span id="PumpWoodMicroService.parallel_pivot-2316"><a href="#PumpWoodMicroService.parallel_pivot-2316"><span class="linenos">2316</span></a><span class="sd">        Returns:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2317"><a href="#PumpWoodMicroService.parallel_pivot-2317"><span class="linenos">2317</span></a><span class="sd">            List of the pivot request reponses.</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2318"><a href="#PumpWoodMicroService.parallel_pivot-2318"><span class="linenos">2318</span></a>
</span><span id="PumpWoodMicroService.parallel_pivot-2319"><a href="#PumpWoodMicroService.parallel_pivot-2319"><span class="linenos">2319</span></a><span class="sd">        Raises:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2320"><a href="#PumpWoodMicroService.parallel_pivot-2320"><span class="linenos">2320</span></a><span class="sd">            No particular raises.</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2321"><a href="#PumpWoodMicroService.parallel_pivot-2321"><span class="linenos">2321</span></a>
</span><span id="PumpWoodMicroService.parallel_pivot-2322"><a href="#PumpWoodMicroService.parallel_pivot-2322"><span class="linenos">2322</span></a><span class="sd">        Example:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2323"><a href="#PumpWoodMicroService.parallel_pivot-2323"><span class="linenos">2323</span></a><span class="sd">            No example yet.</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2324"><a href="#PumpWoodMicroService.parallel_pivot-2324"><span class="linenos">2324</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2325"><a href="#PumpWoodMicroService.parallel_pivot-2325"><span class="linenos">2325</span></a>        <span class="k">if</span> <span class="n">n_parallel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2326"><a href="#PumpWoodMicroService.parallel_pivot-2326"><span class="linenos">2326</span></a>            <span class="n">n_parallel</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2327"><a href="#PumpWoodMicroService.parallel_pivot-2327"><span class="linenos">2327</span></a>                <span class="s2">&quot;PUMPWOOD_COMUNICATION__N_PARALLEL&quot;</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2328"><a href="#PumpWoodMicroService.parallel_pivot-2328"><span class="linenos">2328</span></a>
</span><span id="PumpWoodMicroService.parallel_pivot-2329"><a href="#PumpWoodMicroService.parallel_pivot-2329"><span class="linenos">2329</span></a>        <span class="n">url_temp</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_pivot_url</span><span class="p">(</span><span class="n">model_class</span><span class="p">)]</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2330"><a href="#PumpWoodMicroService.parallel_pivot-2330"><span class="linenos">2330</span></a>        <span class="n">urls_list</span> <span class="o">=</span> <span class="n">url_temp</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_args</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2331"><a href="#PumpWoodMicroService.parallel_pivot-2331"><span class="linenos">2331</span></a>        <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">list_args</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2332"><a href="#PumpWoodMicroService.parallel_pivot-2332"><span class="linenos">2332</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;variables&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">variables</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2333"><a href="#PumpWoodMicroService.parallel_pivot-2333"><span class="linenos">2333</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;show_deleted&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">show_deleted</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2334"><a href="#PumpWoodMicroService.parallel_pivot-2334"><span class="linenos">2334</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;columns&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">columns</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2335"><a href="#PumpWoodMicroService.parallel_pivot-2335"><span class="linenos">2335</span></a>            <span class="n">q</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">format</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2336"><a href="#PumpWoodMicroService.parallel_pivot-2336"><span class="linenos">2336</span></a>
</span><span id="PumpWoodMicroService.parallel_pivot-2337"><a href="#PumpWoodMicroService.parallel_pivot-2337"><span class="linenos">2337</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;## Starting parallel_pivot: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">urls_list</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2338"><a href="#PumpWoodMicroService.parallel_pivot-2338"><span class="linenos">2338</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">paralell_request_post</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2339"><a href="#PumpWoodMicroService.parallel_pivot-2339"><span class="linenos">2339</span></a>            <span class="n">urls_list</span><span class="o">=</span><span class="n">urls_list</span><span class="p">,</span> <span class="n">data_list</span><span class="o">=</span><span class="n">list_args</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.parallel_pivot-2340"><a href="#PumpWoodMicroService.parallel_pivot-2340"><span class="linenos">2340</span></a>            <span class="n">n_parallel</span><span class="o">=</span><span class="n">n_parallel</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Make [n_parallel] parallel pivot request.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>model_class:</strong>  Model Class to retrieve.</li>
<li><strong>list_args:</strong>  A list of list request args (filter_dict,exclude_dict,
order_by).</li>
<li><strong>columns:</strong>  List of columns at the pivoted table.</li>
<li><strong>format:</strong>  Format of returned table. See pandas.DataFrame
to_dict args.</li>
<li><strong>n_parallel:</strong>  Number of simultaneus get requests, if not set
get from PUMPWOOD_COMUNICATION__N_PARALLEL env variable, if
not set then 4 will be considered.</li>
<li><strong>variables:</strong>  Restrict the fields that will be returned at the query.</li>
<li><strong>show_deleted:</strong>  If results should include data with deleted=True. This will
be ignored if model class does not have deleted field.</li>
<li><strong>auth_header:</strong>  Auth header to substitute the microservice original
at the request (user impersonation).</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>List of the pivot request reponses.</p>
</blockquote>

<h6 id="raises">Raises:</h6>

<ul>
<li>No particular raises.</li>
</ul>

<h6 id="example">Example:</h6>

<blockquote>
  <p>No example yet.</p>
</blockquote>
</div>


                            </div>
                            <div id="PumpWoodMicroService.get_queue_matrix" class="classattr">
                                        <input id="PumpWoodMicroService.get_queue_matrix-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_queue_matrix</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">queue_pk</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">save_as_excel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="PumpWoodMicroService.get_queue_matrix-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PumpWoodMicroService.get_queue_matrix"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PumpWoodMicroService.get_queue_matrix-2342"><a href="#PumpWoodMicroService.get_queue_matrix-2342"><span class="linenos">2342</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">get_queue_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">queue_pk</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">auth_header</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2343"><a href="#PumpWoodMicroService.get_queue_matrix-2343"><span class="linenos">2343</span></a>                         <span class="n">save_as_excel</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2344"><a href="#PumpWoodMicroService.get_queue_matrix-2344"><span class="linenos">2344</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Download model queue estimation matrix. In development...&quot;&quot;&quot;</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2345"><a href="#PumpWoodMicroService.get_queue_matrix-2345"><span class="linenos">2345</span></a>        <span class="n">file_content</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retrieve_file</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2346"><a href="#PumpWoodMicroService.get_queue_matrix-2346"><span class="linenos">2346</span></a>            <span class="n">model_class</span><span class="o">=</span><span class="s2">&quot;ModelQueue&quot;</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">queue_pk</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2347"><a href="#PumpWoodMicroService.get_queue_matrix-2347"><span class="linenos">2347</span></a>            <span class="n">file_field</span><span class="o">=</span><span class="s2">&quot;model_matrix_file&quot;</span><span class="p">,</span> <span class="n">auth_header</span><span class="o">=</span><span class="n">auth_header</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2348"><a href="#PumpWoodMicroService.get_queue_matrix-2348"><span class="linenos">2348</span></a>            <span class="n">save_file</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2349"><a href="#PumpWoodMicroService.get_queue_matrix-2349"><span class="linenos">2349</span></a>        <span class="n">content</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">GzipFile</span><span class="p">(</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2350"><a href="#PumpWoodMicroService.get_queue_matrix-2350"><span class="linenos">2350</span></a>            <span class="n">fileobj</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">file_content</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2351"><a href="#PumpWoodMicroService.get_queue_matrix-2351"><span class="linenos">2351</span></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">content</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2352"><a href="#PumpWoodMicroService.get_queue_matrix-2352"><span class="linenos">2352</span></a>        <span class="n">columns_info</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;columns_info&quot;</span><span class="p">])</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2353"><a href="#PumpWoodMicroService.get_queue_matrix-2353"><span class="linenos">2353</span></a>        <span class="n">model_matrix</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;model_matrix&quot;</span><span class="p">])</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2354"><a href="#PumpWoodMicroService.get_queue_matrix-2354"><span class="linenos">2354</span></a>
</span><span id="PumpWoodMicroService.get_queue_matrix-2355"><a href="#PumpWoodMicroService.get_queue_matrix-2355"><span class="linenos">2355</span></a>        <span class="k">if</span> <span class="n">save_as_excel</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2356"><a href="#PumpWoodMicroService.get_queue_matrix-2356"><span class="linenos">2356</span></a>            <span class="n">writer</span> <span class="o">=</span> <span class="n">ExcelWriter</span><span class="p">(</span><span class="n">save_as_excel</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2357"><a href="#PumpWoodMicroService.get_queue_matrix-2357"><span class="linenos">2357</span></a>            <span class="n">columns_info</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="s1">&#39;columns_info&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2358"><a href="#PumpWoodMicroService.get_queue_matrix-2358"><span class="linenos">2358</span></a>            <span class="n">model_matrix</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="s1">&#39;model_matrix&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2359"><a href="#PumpWoodMicroService.get_queue_matrix-2359"><span class="linenos">2359</span></a>            <span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2360"><a href="#PumpWoodMicroService.get_queue_matrix-2360"><span class="linenos">2360</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2361"><a href="#PumpWoodMicroService.get_queue_matrix-2361"><span class="linenos">2361</span></a>            <span class="k">return</span> <span class="p">{</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2362"><a href="#PumpWoodMicroService.get_queue_matrix-2362"><span class="linenos">2362</span></a>                <span class="s2">&quot;columns_info&quot;</span><span class="p">:</span> <span class="n">columns_info</span><span class="p">,</span>
</span><span id="PumpWoodMicroService.get_queue_matrix-2363"><a href="#PumpWoodMicroService.get_queue_matrix-2363"><span class="linenos">2363</span></a>                <span class="s2">&quot;model_matrix&quot;</span><span class="p">:</span> <span class="n">model_matrix</span><span class="p">}</span>
</span></pre></div>


            <div class="docstring"><p>Download model queue estimation matrix. In development...</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>